function _mergeNamespaces(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const Ee in n)if(Ee!=="default"&&!(Ee in e)){const Ce=Object.getOwnPropertyDescriptor(n,Ee);Ce&&Object.defineProperty(e,Ee,Ce.get?Ce:{enumerable:!0,get:()=>n[Ee]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const Ee of document.querySelectorAll('link[rel="modulepreload"]'))n(Ee);new MutationObserver(Ee=>{for(const Ce of Ee)if(Ce.type==="childList")for(const De of Ce.addedNodes)De.tagName==="LINK"&&De.rel==="modulepreload"&&n(De)}).observe(document,{childList:!0,subtree:!0});function r(Ee){const Ce={};return Ee.integrity&&(Ce.integrity=Ee.integrity),Ee.referrerPolicy&&(Ce.referrerPolicy=Ee.referrerPolicy),Ee.crossOrigin==="use-credentials"?Ce.credentials="include":Ee.crossOrigin==="anonymous"?Ce.credentials="omit":Ce.credentials="same-origin",Ce}function n(Ee){if(Ee.ep)return;Ee.ep=!0;const Ce=r(Ee);fetch(Ee.href,Ce)}})();var commonjsGlobal=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function getDefaultExportFromCjs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function getAugmentedNamespace(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var Ee=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,Ee.get?Ee:{enumerable:!0,get:function(){return e[n]}})}),r}var jsxRuntime={exports:{}},reactJsxRuntime_production={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactJsxRuntime_production;function requireReactJsxRuntime_production(){if(hasRequiredReactJsxRuntime_production)return reactJsxRuntime_production;hasRequiredReactJsxRuntime_production=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function r(n,Ee,Ce){var De=null;if(Ce!==void 0&&(De=""+Ce),Ee.key!==void 0&&(De=""+Ee.key),"key"in Ee){Ce={};for(var Me in Ee)Me!=="key"&&(Ce[Me]=Ee[Me])}else Ce=Ee;return Ee=Ce.ref,{$$typeof:e,type:n,key:De,ref:Ee!==void 0?Ee:null,props:Ce}}return reactJsxRuntime_production.Fragment=t,reactJsxRuntime_production.jsx=r,reactJsxRuntime_production.jsxs=r,reactJsxRuntime_production}var hasRequiredJsxRuntime;function requireJsxRuntime(){return hasRequiredJsxRuntime||(hasRequiredJsxRuntime=1,jsxRuntime.exports=requireReactJsxRuntime_production()),jsxRuntime.exports}var jsxRuntimeExports=requireJsxRuntime(),react={exports:{}},react_production={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReact_production;function requireReact_production(){if(hasRequiredReact_production)return react_production;hasRequiredReact_production=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),n=Symbol.for("react.strict_mode"),Ee=Symbol.for("react.profiler"),Ce=Symbol.for("react.consumer"),De=Symbol.for("react.context"),Me=Symbol.for("react.forward_ref"),ze=Symbol.for("react.suspense"),Oe=Symbol.for("react.memo"),Be=Symbol.for("react.lazy"),He=Symbol.for("react.activity"),Ve=Symbol.iterator;function Xe(ur){return ur===null||typeof ur!="object"?null:(ur=Ve&&ur[Ve]||ur["@@iterator"],typeof ur=="function"?ur:null)}var We={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Ge=Object.assign,$e={};function Ke(ur,Je,nr){this.props=ur,this.context=Je,this.refs=$e,this.updater=nr||We}Ke.prototype.isReactComponent={},Ke.prototype.setState=function(ur,Je){if(typeof ur!="object"&&typeof ur!="function"&&ur!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,ur,Je,"setState")},Ke.prototype.forceUpdate=function(ur){this.updater.enqueueForceUpdate(this,ur,"forceUpdate")};function rr(){}rr.prototype=Ke.prototype;function tr(ur,Je,nr){this.props=ur,this.context=Je,this.refs=$e,this.updater=nr||We}var sr=tr.prototype=new rr;sr.constructor=tr,Ge(sr,Ke.prototype),sr.isPureReactComponent=!0;var ar=Array.isArray;function hr(){}var pr={H:null,A:null,T:null,S:null},yr=Object.prototype.hasOwnProperty;function fr(ur,Je,nr){var or=nr.ref;return{$$typeof:e,type:ur,key:Je,ref:or!==void 0?or:null,props:nr}}function Rr(ur,Je){return fr(ur.type,Je,ur.props)}function mr(ur){return typeof ur=="object"&&ur!==null&&ur.$$typeof===e}function wr(ur){var Je={"=":"=0",":":"=2"};return"$"+ur.replace(/[=:]/g,function(nr){return Je[nr]})}var Fr=/\/+/g;function Mr(ur,Je){return typeof ur=="object"&&ur!==null&&ur.key!=null?wr(""+ur.key):Je.toString(36)}function Hr(ur){switch(ur.status){case"fulfilled":return ur.value;case"rejected":throw ur.reason;default:switch(typeof ur.status=="string"?ur.then(hr,hr):(ur.status="pending",ur.then(function(Je){ur.status==="pending"&&(ur.status="fulfilled",ur.value=Je)},function(Je){ur.status==="pending"&&(ur.status="rejected",ur.reason=Je)})),ur.status){case"fulfilled":return ur.value;case"rejected":throw ur.reason}}throw ur}function Nr(ur,Je,nr,or,lr){var St=typeof ur;(St==="undefined"||St==="boolean")&&(ur=null);var dr=!1;if(ur===null)dr=!0;else switch(St){case"bigint":case"string":case"number":dr=!0;break;case"object":switch(ur.$$typeof){case e:case t:dr=!0;break;case Be:return dr=ur._init,Nr(dr(ur._payload),Je,nr,or,lr)}}if(dr)return lr=lr(ur),dr=or===""?"."+Mr(ur,0):or,ar(lr)?(nr="",dr!=null&&(nr=dr.replace(Fr,"$&/")+"/"),Nr(lr,Je,nr,"",function(kr){return kr})):lr!=null&&(mr(lr)&&(lr=Rr(lr,nr+(lr.key==null||ur&&ur.key===lr.key?"":(""+lr.key).replace(Fr,"$&/")+"/")+dr)),Je.push(lr)),1;dr=0;var vr=or===""?".":or+":";if(ar(ur))for(var br=0;br<ur.length;br++)or=ur[br],St=vr+Mr(or,br),dr+=Nr(or,Je,nr,St,lr);else if(br=Xe(ur),typeof br=="function")for(ur=br.call(ur),br=0;!(or=ur.next()).done;)or=or.value,St=vr+Mr(or,br++),dr+=Nr(or,Je,nr,St,lr);else if(St==="object"){if(typeof ur.then=="function")return Nr(Hr(ur),Je,nr,or,lr);throw Je=String(ur),Error("Objects are not valid as a React child (found: "+(Je==="[object Object]"?"object with keys {"+Object.keys(ur).join(", ")+"}":Je)+"). If you meant to render a collection of children, use an array instead.")}return dr}function Ar(ur,Je,nr){if(ur==null)return ur;var or=[],lr=0;return Nr(ur,or,"","",function(St){return Je.call(nr,St,lr++)}),or}function xr(ur){if(ur._status===-1){var Je=ur._result;Je=Je(),Je.then(function(nr){(ur._status===0||ur._status===-1)&&(ur._status=1,ur._result=nr)},function(nr){(ur._status===0||ur._status===-1)&&(ur._status=2,ur._result=nr)}),ur._status===-1&&(ur._status=0,ur._result=Je)}if(ur._status===1)return ur._result.default;throw ur._result}var ir=typeof reportError=="function"?reportError:function(ur){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Je=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof ur=="object"&&ur!==null&&typeof ur.message=="string"?String(ur.message):String(ur),error:ur});if(!window.dispatchEvent(Je))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",ur);return}console.error(ur)},_r={map:Ar,forEach:function(ur,Je,nr){Ar(ur,function(){Je.apply(this,arguments)},nr)},count:function(ur){var Je=0;return Ar(ur,function(){Je++}),Je},toArray:function(ur){return Ar(ur,function(Je){return Je})||[]},only:function(ur){if(!mr(ur))throw Error("React.Children.only expected to receive a single React element child.");return ur}};return react_production.Activity=He,react_production.Children=_r,react_production.Component=Ke,react_production.Fragment=r,react_production.Profiler=Ee,react_production.PureComponent=tr,react_production.StrictMode=n,react_production.Suspense=ze,react_production.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=pr,react_production.__COMPILER_RUNTIME={__proto__:null,c:function(ur){return pr.H.useMemoCache(ur)}},react_production.cache=function(ur){return function(){return ur.apply(null,arguments)}},react_production.cacheSignal=function(){return null},react_production.cloneElement=function(ur,Je,nr){if(ur==null)throw Error("The argument must be a React element, but you passed "+ur+".");var or=Ge({},ur.props),lr=ur.key;if(Je!=null)for(St in Je.key!==void 0&&(lr=""+Je.key),Je)!yr.call(Je,St)||St==="key"||St==="__self"||St==="__source"||St==="ref"&&Je.ref===void 0||(or[St]=Je[St]);var St=arguments.length-2;if(St===1)or.children=nr;else if(1<St){for(var dr=Array(St),vr=0;vr<St;vr++)dr[vr]=arguments[vr+2];or.children=dr}return fr(ur.type,lr,or)},react_production.createContext=function(ur){return ur={$$typeof:De,_currentValue:ur,_currentValue2:ur,_threadCount:0,Provider:null,Consumer:null},ur.Provider=ur,ur.Consumer={$$typeof:Ce,_context:ur},ur},react_production.createElement=function(ur,Je,nr){var or,lr={},St=null;if(Je!=null)for(or in Je.key!==void 0&&(St=""+Je.key),Je)yr.call(Je,or)&&or!=="key"&&or!=="__self"&&or!=="__source"&&(lr[or]=Je[or]);var dr=arguments.length-2;if(dr===1)lr.children=nr;else if(1<dr){for(var vr=Array(dr),br=0;br<dr;br++)vr[br]=arguments[br+2];lr.children=vr}if(ur&&ur.defaultProps)for(or in dr=ur.defaultProps,dr)lr[or]===void 0&&(lr[or]=dr[or]);return fr(ur,St,lr)},react_production.createRef=function(){return{current:null}},react_production.forwardRef=function(ur){return{$$typeof:Me,render:ur}},react_production.isValidElement=mr,react_production.lazy=function(ur){return{$$typeof:Be,_payload:{_status:-1,_result:ur},_init:xr}},react_production.memo=function(ur,Je){return{$$typeof:Oe,type:ur,compare:Je===void 0?null:Je}},react_production.startTransition=function(ur){var Je=pr.T,nr={};pr.T=nr;try{var or=ur(),lr=pr.S;lr!==null&&lr(nr,or),typeof or=="object"&&or!==null&&typeof or.then=="function"&&or.then(hr,ir)}catch(St){ir(St)}finally{Je!==null&&nr.types!==null&&(Je.types=nr.types),pr.T=Je}},react_production.unstable_useCacheRefresh=function(){return pr.H.useCacheRefresh()},react_production.use=function(ur){return pr.H.use(ur)},react_production.useActionState=function(ur,Je,nr){return pr.H.useActionState(ur,Je,nr)},react_production.useCallback=function(ur,Je){return pr.H.useCallback(ur,Je)},react_production.useContext=function(ur){return pr.H.useContext(ur)},react_production.useDebugValue=function(){},react_production.useDeferredValue=function(ur,Je){return pr.H.useDeferredValue(ur,Je)},react_production.useEffect=function(ur,Je){return pr.H.useEffect(ur,Je)},react_production.useEffectEvent=function(ur){return pr.H.useEffectEvent(ur)},react_production.useId=function(){return pr.H.useId()},react_production.useImperativeHandle=function(ur,Je,nr){return pr.H.useImperativeHandle(ur,Je,nr)},react_production.useInsertionEffect=function(ur,Je){return pr.H.useInsertionEffect(ur,Je)},react_production.useLayoutEffect=function(ur,Je){return pr.H.useLayoutEffect(ur,Je)},react_production.useMemo=function(ur,Je){return pr.H.useMemo(ur,Je)},react_production.useOptimistic=function(ur,Je){return pr.H.useOptimistic(ur,Je)},react_production.useReducer=function(ur,Je,nr){return pr.H.useReducer(ur,Je,nr)},react_production.useRef=function(ur){return pr.H.useRef(ur)},react_production.useState=function(ur){return pr.H.useState(ur)},react_production.useSyncExternalStore=function(ur,Je,nr){return pr.H.useSyncExternalStore(ur,Je,nr)},react_production.useTransition=function(){return pr.H.useTransition()},react_production.version="19.2.4",react_production}var hasRequiredReact;function requireReact(){return hasRequiredReact||(hasRequiredReact=1,react.exports=requireReact_production()),react.exports}var reactExports=requireReact();const React=getDefaultExportFromCjs(reactExports);var client={exports:{}},reactDomClient_production={},scheduler={exports:{}},scheduler_production={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredScheduler_production;function requireScheduler_production(){return hasRequiredScheduler_production||(hasRequiredScheduler_production=1,(function(e){function t(Nr,Ar){var xr=Nr.length;Nr.push(Ar);e:for(;0<xr;){var ir=xr-1>>>1,_r=Nr[ir];if(0<Ee(_r,Ar))Nr[ir]=Ar,Nr[xr]=_r,xr=ir;else break e}}function r(Nr){return Nr.length===0?null:Nr[0]}function n(Nr){if(Nr.length===0)return null;var Ar=Nr[0],xr=Nr.pop();if(xr!==Ar){Nr[0]=xr;e:for(var ir=0,_r=Nr.length,ur=_r>>>1;ir<ur;){var Je=2*(ir+1)-1,nr=Nr[Je],or=Je+1,lr=Nr[or];if(0>Ee(nr,xr))or<_r&&0>Ee(lr,nr)?(Nr[ir]=lr,Nr[or]=xr,ir=or):(Nr[ir]=nr,Nr[Je]=xr,ir=Je);else if(or<_r&&0>Ee(lr,xr))Nr[ir]=lr,Nr[or]=xr,ir=or;else break e}}return Ar}function Ee(Nr,Ar){var xr=Nr.sortIndex-Ar.sortIndex;return xr!==0?xr:Nr.id-Ar.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var Ce=performance;e.unstable_now=function(){return Ce.now()}}else{var De=Date,Me=De.now();e.unstable_now=function(){return De.now()-Me}}var ze=[],Oe=[],Be=1,He=null,Ve=3,Xe=!1,We=!1,Ge=!1,$e=!1,Ke=typeof setTimeout=="function"?setTimeout:null,rr=typeof clearTimeout=="function"?clearTimeout:null,tr=typeof setImmediate<"u"?setImmediate:null;function sr(Nr){for(var Ar=r(Oe);Ar!==null;){if(Ar.callback===null)n(Oe);else if(Ar.startTime<=Nr)n(Oe),Ar.sortIndex=Ar.expirationTime,t(ze,Ar);else break;Ar=r(Oe)}}function ar(Nr){if(Ge=!1,sr(Nr),!We)if(r(ze)!==null)We=!0,hr||(hr=!0,wr());else{var Ar=r(Oe);Ar!==null&&Hr(ar,Ar.startTime-Nr)}}var hr=!1,pr=-1,yr=5,fr=-1;function Rr(){return $e?!0:!(e.unstable_now()-fr<yr)}function mr(){if($e=!1,hr){var Nr=e.unstable_now();fr=Nr;var Ar=!0;try{e:{We=!1,Ge&&(Ge=!1,rr(pr),pr=-1),Xe=!0;var xr=Ve;try{t:{for(sr(Nr),He=r(ze);He!==null&&!(He.expirationTime>Nr&&Rr());){var ir=He.callback;if(typeof ir=="function"){He.callback=null,Ve=He.priorityLevel;var _r=ir(He.expirationTime<=Nr);if(Nr=e.unstable_now(),typeof _r=="function"){He.callback=_r,sr(Nr),Ar=!0;break t}He===r(ze)&&n(ze),sr(Nr)}else n(ze);He=r(ze)}if(He!==null)Ar=!0;else{var ur=r(Oe);ur!==null&&Hr(ar,ur.startTime-Nr),Ar=!1}}break e}finally{He=null,Ve=xr,Xe=!1}Ar=void 0}}finally{Ar?wr():hr=!1}}}var wr;if(typeof tr=="function")wr=function(){tr(mr)};else if(typeof MessageChannel<"u"){var Fr=new MessageChannel,Mr=Fr.port2;Fr.port1.onmessage=mr,wr=function(){Mr.postMessage(null)}}else wr=function(){Ke(mr,0)};function Hr(Nr,Ar){pr=Ke(function(){Nr(e.unstable_now())},Ar)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(Nr){Nr.callback=null},e.unstable_forceFrameRate=function(Nr){0>Nr||125<Nr?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):yr=0<Nr?Math.floor(1e3/Nr):5},e.unstable_getCurrentPriorityLevel=function(){return Ve},e.unstable_next=function(Nr){switch(Ve){case 1:case 2:case 3:var Ar=3;break;default:Ar=Ve}var xr=Ve;Ve=Ar;try{return Nr()}finally{Ve=xr}},e.unstable_requestPaint=function(){$e=!0},e.unstable_runWithPriority=function(Nr,Ar){switch(Nr){case 1:case 2:case 3:case 4:case 5:break;default:Nr=3}var xr=Ve;Ve=Nr;try{return Ar()}finally{Ve=xr}},e.unstable_scheduleCallback=function(Nr,Ar,xr){var ir=e.unstable_now();switch(typeof xr=="object"&&xr!==null?(xr=xr.delay,xr=typeof xr=="number"&&0<xr?ir+xr:ir):xr=ir,Nr){case 1:var _r=-1;break;case 2:_r=250;break;case 5:_r=1073741823;break;case 4:_r=1e4;break;default:_r=5e3}return _r=xr+_r,Nr={id:Be++,callback:Ar,priorityLevel:Nr,startTime:xr,expirationTime:_r,sortIndex:-1},xr>ir?(Nr.sortIndex=xr,t(Oe,Nr),r(ze)===null&&Nr===r(Oe)&&(Ge?(rr(pr),pr=-1):Ge=!0,Hr(ar,xr-ir))):(Nr.sortIndex=_r,t(ze,Nr),We||Xe||(We=!0,hr||(hr=!0,wr()))),Nr},e.unstable_shouldYield=Rr,e.unstable_wrapCallback=function(Nr){var Ar=Ve;return function(){var xr=Ve;Ve=Ar;try{return Nr.apply(this,arguments)}finally{Ve=xr}}}})(scheduler_production)),scheduler_production}var hasRequiredScheduler;function requireScheduler(){return hasRequiredScheduler||(hasRequiredScheduler=1,scheduler.exports=requireScheduler_production()),scheduler.exports}var reactDom={exports:{}},reactDom_production={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDom_production;function requireReactDom_production(){if(hasRequiredReactDom_production)return reactDom_production;hasRequiredReactDom_production=1;var e=requireReact();function t(ze){var Oe="https://react.dev/errors/"+ze;if(1<arguments.length){Oe+="?args[]="+encodeURIComponent(arguments[1]);for(var Be=2;Be<arguments.length;Be++)Oe+="&args[]="+encodeURIComponent(arguments[Be])}return"Minified React error #"+ze+"; visit "+Oe+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(){}var n={d:{f:r,r:function(){throw Error(t(522))},D:r,C:r,L:r,m:r,X:r,S:r,M:r},p:0,findDOMNode:null},Ee=Symbol.for("react.portal");function Ce(ze,Oe,Be){var He=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ee,key:He==null?null:""+He,children:ze,containerInfo:Oe,implementation:Be}}var De=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function Me(ze,Oe){if(ze==="font")return"";if(typeof Oe=="string")return Oe==="use-credentials"?Oe:""}return reactDom_production.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=n,reactDom_production.createPortal=function(ze,Oe){var Be=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Oe||Oe.nodeType!==1&&Oe.nodeType!==9&&Oe.nodeType!==11)throw Error(t(299));return Ce(ze,Oe,null,Be)},reactDom_production.flushSync=function(ze){var Oe=De.T,Be=n.p;try{if(De.T=null,n.p=2,ze)return ze()}finally{De.T=Oe,n.p=Be,n.d.f()}},reactDom_production.preconnect=function(ze,Oe){typeof ze=="string"&&(Oe?(Oe=Oe.crossOrigin,Oe=typeof Oe=="string"?Oe==="use-credentials"?Oe:"":void 0):Oe=null,n.d.C(ze,Oe))},reactDom_production.prefetchDNS=function(ze){typeof ze=="string"&&n.d.D(ze)},reactDom_production.preinit=function(ze,Oe){if(typeof ze=="string"&&Oe&&typeof Oe.as=="string"){var Be=Oe.as,He=Me(Be,Oe.crossOrigin),Ve=typeof Oe.integrity=="string"?Oe.integrity:void 0,Xe=typeof Oe.fetchPriority=="string"?Oe.fetchPriority:void 0;Be==="style"?n.d.S(ze,typeof Oe.precedence=="string"?Oe.precedence:void 0,{crossOrigin:He,integrity:Ve,fetchPriority:Xe}):Be==="script"&&n.d.X(ze,{crossOrigin:He,integrity:Ve,fetchPriority:Xe,nonce:typeof Oe.nonce=="string"?Oe.nonce:void 0})}},reactDom_production.preinitModule=function(ze,Oe){if(typeof ze=="string")if(typeof Oe=="object"&&Oe!==null){if(Oe.as==null||Oe.as==="script"){var Be=Me(Oe.as,Oe.crossOrigin);n.d.M(ze,{crossOrigin:Be,integrity:typeof Oe.integrity=="string"?Oe.integrity:void 0,nonce:typeof Oe.nonce=="string"?Oe.nonce:void 0})}}else Oe==null&&n.d.M(ze)},reactDom_production.preload=function(ze,Oe){if(typeof ze=="string"&&typeof Oe=="object"&&Oe!==null&&typeof Oe.as=="string"){var Be=Oe.as,He=Me(Be,Oe.crossOrigin);n.d.L(ze,Be,{crossOrigin:He,integrity:typeof Oe.integrity=="string"?Oe.integrity:void 0,nonce:typeof Oe.nonce=="string"?Oe.nonce:void 0,type:typeof Oe.type=="string"?Oe.type:void 0,fetchPriority:typeof Oe.fetchPriority=="string"?Oe.fetchPriority:void 0,referrerPolicy:typeof Oe.referrerPolicy=="string"?Oe.referrerPolicy:void 0,imageSrcSet:typeof Oe.imageSrcSet=="string"?Oe.imageSrcSet:void 0,imageSizes:typeof Oe.imageSizes=="string"?Oe.imageSizes:void 0,media:typeof Oe.media=="string"?Oe.media:void 0})}},reactDom_production.preloadModule=function(ze,Oe){if(typeof ze=="string")if(Oe){var Be=Me(Oe.as,Oe.crossOrigin);n.d.m(ze,{as:typeof Oe.as=="string"&&Oe.as!=="script"?Oe.as:void 0,crossOrigin:Be,integrity:typeof Oe.integrity=="string"?Oe.integrity:void 0})}else n.d.m(ze)},reactDom_production.requestFormReset=function(ze){n.d.r(ze)},reactDom_production.unstable_batchedUpdates=function(ze,Oe){return ze(Oe)},reactDom_production.useFormState=function(ze,Oe,Be){return De.H.useFormState(ze,Oe,Be)},reactDom_production.useFormStatus=function(){return De.H.useHostTransitionStatus()},reactDom_production.version="19.2.4",reactDom_production}var hasRequiredReactDom;function requireReactDom(){if(hasRequiredReactDom)return reactDom.exports;hasRequiredReactDom=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),reactDom.exports=requireReactDom_production(),reactDom.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hasRequiredReactDomClient_production;function requireReactDomClient_production(){if(hasRequiredReactDomClient_production)return reactDomClient_production;hasRequiredReactDomClient_production=1;var e=requireScheduler(),t=requireReact(),r=requireReactDom();function n(Te){var Re="https://react.dev/errors/"+Te;if(1<arguments.length){Re+="?args[]="+encodeURIComponent(arguments[1]);for(var Ue=2;Ue<arguments.length;Ue++)Re+="&args[]="+encodeURIComponent(arguments[Ue])}return"Minified React error #"+Te+"; visit "+Re+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function Ee(Te){return!(!Te||Te.nodeType!==1&&Te.nodeType!==9&&Te.nodeType!==11)}function Ce(Te){var Re=Te,Ue=Te;if(Te.alternate)for(;Re.return;)Re=Re.return;else{Te=Re;do Re=Te,(Re.flags&4098)!==0&&(Ue=Re.return),Te=Re.return;while(Te)}return Re.tag===3?Ue:null}function De(Te){if(Te.tag===13){var Re=Te.memoizedState;if(Re===null&&(Te=Te.alternate,Te!==null&&(Re=Te.memoizedState)),Re!==null)return Re.dehydrated}return null}function Me(Te){if(Te.tag===31){var Re=Te.memoizedState;if(Re===null&&(Te=Te.alternate,Te!==null&&(Re=Te.memoizedState)),Re!==null)return Re.dehydrated}return null}function ze(Te){if(Ce(Te)!==Te)throw Error(n(188))}function Oe(Te){var Re=Te.alternate;if(!Re){if(Re=Ce(Te),Re===null)throw Error(n(188));return Re!==Te?null:Te}for(var Ue=Te,qe=Re;;){var Ze=Ue.return;if(Ze===null)break;var er=Ze.alternate;if(er===null){if(qe=Ze.return,qe!==null){Ue=qe;continue}break}if(Ze.child===er.child){for(er=Ze.child;er;){if(er===Ue)return ze(Ze),Te;if(er===qe)return ze(Ze),Re;er=er.sibling}throw Error(n(188))}if(Ue.return!==qe.return)Ue=Ze,qe=er;else{for(var Tr=!1,jr=Ze.child;jr;){if(jr===Ue){Tr=!0,Ue=Ze,qe=er;break}if(jr===qe){Tr=!0,qe=Ze,Ue=er;break}jr=jr.sibling}if(!Tr){for(jr=er.child;jr;){if(jr===Ue){Tr=!0,Ue=er,qe=Ze;break}if(jr===qe){Tr=!0,qe=er,Ue=Ze;break}jr=jr.sibling}if(!Tr)throw Error(n(189))}}if(Ue.alternate!==qe)throw Error(n(190))}if(Ue.tag!==3)throw Error(n(188));return Ue.stateNode.current===Ue?Te:Re}function Be(Te){var Re=Te.tag;if(Re===5||Re===26||Re===27||Re===6)return Te;for(Te=Te.child;Te!==null;){if(Re=Be(Te),Re!==null)return Re;Te=Te.sibling}return null}var He=Object.assign,Ve=Symbol.for("react.element"),Xe=Symbol.for("react.transitional.element"),We=Symbol.for("react.portal"),Ge=Symbol.for("react.fragment"),$e=Symbol.for("react.strict_mode"),Ke=Symbol.for("react.profiler"),rr=Symbol.for("react.consumer"),tr=Symbol.for("react.context"),sr=Symbol.for("react.forward_ref"),ar=Symbol.for("react.suspense"),hr=Symbol.for("react.suspense_list"),pr=Symbol.for("react.memo"),yr=Symbol.for("react.lazy"),fr=Symbol.for("react.activity"),Rr=Symbol.for("react.memo_cache_sentinel"),mr=Symbol.iterator;function wr(Te){return Te===null||typeof Te!="object"?null:(Te=mr&&Te[mr]||Te["@@iterator"],typeof Te=="function"?Te:null)}var Fr=Symbol.for("react.client.reference");function Mr(Te){if(Te==null)return null;if(typeof Te=="function")return Te.$$typeof===Fr?null:Te.displayName||Te.name||null;if(typeof Te=="string")return Te;switch(Te){case Ge:return"Fragment";case Ke:return"Profiler";case $e:return"StrictMode";case ar:return"Suspense";case hr:return"SuspenseList";case fr:return"Activity"}if(typeof Te=="object")switch(Te.$$typeof){case We:return"Portal";case tr:return Te.displayName||"Context";case rr:return(Te._context.displayName||"Context")+".Consumer";case sr:var Re=Te.render;return Te=Te.displayName,Te||(Te=Re.displayName||Re.name||"",Te=Te!==""?"ForwardRef("+Te+")":"ForwardRef"),Te;case pr:return Re=Te.displayName||null,Re!==null?Re:Mr(Te.type)||"Memo";case yr:Re=Te._payload,Te=Te._init;try{return Mr(Te(Re))}catch{}}return null}var Hr=Array.isArray,Nr=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ar=r.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,xr={pending:!1,data:null,method:null,action:null},ir=[],_r=-1;function ur(Te){return{current:Te}}function Je(Te){0>_r||(Te.current=ir[_r],ir[_r]=null,_r--)}function nr(Te,Re){_r++,ir[_r]=Te.current,Te.current=Re}var or=ur(null),lr=ur(null),St=ur(null),dr=ur(null);function vr(Te,Re){switch(nr(St,Re),nr(lr,Te),nr(or,null),Re.nodeType){case 9:case 11:Te=(Te=Re.documentElement)&&(Te=Te.namespaceURI)?xp(Te):0;break;default:if(Te=Re.tagName,Re=Re.namespaceURI)Re=xp(Re),Te=vp(Re,Te);else switch(Te){case"svg":Te=1;break;case"math":Te=2;break;default:Te=0}}Je(or),nr(or,Te)}function br(){Je(or),Je(lr),Je(St)}function kr(Te){Te.memoizedState!==null&&nr(dr,Te);var Re=or.current,Ue=vp(Re,Te.type);Re!==Ue&&(nr(lr,Te),nr(or,Ue))}function Pr(Te){lr.current===Te&&(Je(or),Je(lr)),dr.current===Te&&(Je(dr),Tf._currentValue=xr)}var Er,Zr;function ua(Te){if(Er===void 0)try{throw Error()}catch(Ue){var Re=Ue.stack.trim().match(/\n( *(at )?)/);Er=Re&&Re[1]||"",Zr=-1<Ue.stack.indexOf(`
    at`)?" (<anonymous>)":-1<Ue.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Er+Te+Zr}var Cr=!1;function Jr(Te,Re){if(!Te||Cr)return"";Cr=!0;var Ue=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var qe={DetermineComponentFrameRoot:function(){try{if(Re){var Ua=function(){throw Error()};if(Object.defineProperty(Ua.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ua,[])}catch(Ra){var Ta=Ra}Reflect.construct(Te,[],Ua)}else{try{Ua.call()}catch(Ra){Ta=Ra}Te.call(Ua.prototype)}}else{try{throw Error()}catch(Ra){Ta=Ra}(Ua=Te())&&typeof Ua.catch=="function"&&Ua.catch(function(){})}}catch(Ra){if(Ra&&Ta&&typeof Ra.stack=="string")return[Ra.stack,Ta.stack]}return[null,null]}};qe.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var Ze=Object.getOwnPropertyDescriptor(qe.DetermineComponentFrameRoot,"name");Ze&&Ze.configurable&&Object.defineProperty(qe.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var er=qe.DetermineComponentFrameRoot(),Tr=er[0],jr=er[1];if(Tr&&jr){var ea=Tr.split(`
`),Ea=jr.split(`
`);for(Ze=qe=0;qe<ea.length&&!ea[qe].includes("DetermineComponentFrameRoot");)qe++;for(;Ze<Ea.length&&!Ea[Ze].includes("DetermineComponentFrameRoot");)Ze++;if(qe===ea.length||Ze===Ea.length)for(qe=ea.length-1,Ze=Ea.length-1;1<=qe&&0<=Ze&&ea[qe]!==Ea[Ze];)Ze--;for(;1<=qe&&0<=Ze;qe--,Ze--)if(ea[qe]!==Ea[Ze]){if(qe!==1||Ze!==1)do if(qe--,Ze--,0>Ze||ea[qe]!==Ea[Ze]){var Pa=`
`+ea[qe].replace(" at new "," at ");return Te.displayName&&Pa.includes("<anonymous>")&&(Pa=Pa.replace("<anonymous>",Te.displayName)),Pa}while(1<=qe&&0<=Ze);break}}}finally{Cr=!1,Error.prepareStackTrace=Ue}return(Ue=Te?Te.displayName||Te.name:"")?ua(Ue):""}function Qr(Te,Re){switch(Te.tag){case 26:case 27:case 5:return ua(Te.type);case 16:return ua("Lazy");case 13:return Te.child!==Re&&Re!==null?ua("Suspense Fallback"):ua("Suspense");case 19:return ua("SuspenseList");case 0:case 15:return Jr(Te.type,!1);case 11:return Jr(Te.type.render,!1);case 1:return Jr(Te.type,!0);case 31:return ua("Activity");default:return""}}function oa(Te){try{var Re="",Ue=null;do Re+=Qr(Te,Ue),Ue=Te,Te=Te.return;while(Te);return Re}catch(qe){return`
Error generating stack: `+qe.message+`
`+qe.stack}}var ta=Object.prototype.hasOwnProperty,Na=e.unstable_scheduleCallback,Ca=e.unstable_cancelCallback,za=e.unstable_shouldYield,Xa=e.unstable_requestPaint,Ya=e.unstable_now,nn=e.unstable_getCurrentPriorityLevel,on=e.unstable_ImmediatePriority,yn=e.unstable_UserBlockingPriority,fn=e.unstable_NormalPriority,Qa=e.unstable_LowPriority,Ka=e.unstable_IdlePriority,en=e.log,Bn=e.unstable_setDisableYieldValue,vn=null,va=null;function aa(Te){if(typeof en=="function"&&Bn(Te),va&&typeof va.setStrictMode=="function")try{va.setStrictMode(vn,Te)}catch{}}var ia=Math.clz32?Math.clz32:pa,Oa=Math.log,ca=Math.LN2;function pa(Te){return Te>>>=0,Te===0?32:31-(Oa(Te)/ca|0)|0}var xa=256,$a=262144,ka=4194304;function La(Te){var Re=Te&42;if(Re!==0)return Re;switch(Te&-Te){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return Te&261888;case 262144:case 524288:case 1048576:case 2097152:return Te&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return Te&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return Te}}function Wa(Te,Re,Ue){var qe=Te.pendingLanes;if(qe===0)return 0;var Ze=0,er=Te.suspendedLanes,Tr=Te.pingedLanes;Te=Te.warmLanes;var jr=qe&134217727;return jr!==0?(qe=jr&~er,qe!==0?Ze=La(qe):(Tr&=jr,Tr!==0?Ze=La(Tr):Ue||(Ue=jr&~Te,Ue!==0&&(Ze=La(Ue))))):(jr=qe&~er,jr!==0?Ze=La(jr):Tr!==0?Ze=La(Tr):Ue||(Ue=qe&~Te,Ue!==0&&(Ze=La(Ue)))),Ze===0?0:Re!==0&&Re!==Ze&&(Re&er)===0&&(er=Ze&-Ze,Ue=Re&-Re,er>=Ue||er===32&&(Ue&4194048)!==0)?Re:Ze}function _n(Te,Re){return(Te.pendingLanes&~(Te.suspendedLanes&~Te.pingedLanes)&Re)===0}function hn(Te,Re){switch(Te){case 1:case 2:case 4:case 8:case 64:return Re+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return Re+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Fn(){var Te=ka;return ka<<=1,(ka&62914560)===0&&(ka=4194304),Te}function Tn(Te){for(var Re=[],Ue=0;31>Ue;Ue++)Re.push(Te);return Re}function sn(Te,Re){Te.pendingLanes|=Re,Re!==268435456&&(Te.suspendedLanes=0,Te.pingedLanes=0,Te.warmLanes=0)}function Gi(Te,Re,Ue,qe,Ze,er){var Tr=Te.pendingLanes;Te.pendingLanes=Ue,Te.suspendedLanes=0,Te.pingedLanes=0,Te.warmLanes=0,Te.expiredLanes&=Ue,Te.entangledLanes&=Ue,Te.errorRecoveryDisabledLanes&=Ue,Te.shellSuspendCounter=0;var jr=Te.entanglements,ea=Te.expirationTimes,Ea=Te.hiddenUpdates;for(Ue=Tr&~Ue;0<Ue;){var Pa=31-ia(Ue),Ua=1<<Pa;jr[Pa]=0,ea[Pa]=-1;var Ta=Ea[Pa];if(Ta!==null)for(Ea[Pa]=null,Pa=0;Pa<Ta.length;Pa++){var Ra=Ta[Pa];Ra!==null&&(Ra.lane&=-536870913)}Ue&=~Ua}qe!==0&&Yi(Te,qe,0),er!==0&&Ze===0&&Te.tag!==0&&(Te.suspendedLanes|=er&~(Tr&~Re))}function Yi(Te,Re,Ue){Te.pendingLanes|=Re,Te.suspendedLanes&=~Re;var qe=31-ia(Re);Te.entangledLanes|=Re,Te.entanglements[qe]=Te.entanglements[qe]|1073741824|Ue&261930}function Si(Te,Re){var Ue=Te.entangledLanes|=Re;for(Te=Te.entanglements;Ue;){var qe=31-ia(Ue),Ze=1<<qe;Ze&Re|Te[qe]&Re&&(Te[qe]|=Re),Ue&=~Ze}}function bi(Te,Re){var Ue=Re&-Re;return Ue=(Ue&42)!==0?1:Ln(Ue),(Ue&(Te.suspendedLanes|Re))!==0?0:Ue}function Ln(Te){switch(Te){case 2:Te=1;break;case 8:Te=4;break;case 32:Te=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:Te=128;break;case 268435456:Te=134217728;break;default:Te=0}return Te}function $n(Te){return Te&=-Te,2<Te?8<Te?(Te&134217727)!==0?32:268435456:8:2}function Or(){var Te=Ar.p;return Te!==0?Te:(Te=window.event,Te===void 0?32:Hp(Te.type))}function Yr(Te,Re){var Ue=Ar.p;try{return Ar.p=Te,Re()}finally{Ar.p=Ue}}var zr=Math.random().toString(36).slice(2),Xr="__reactFiber$"+zr,Wr="__reactProps$"+zr,$r="__reactContainer$"+zr,ga="__reactEvents$"+zr,Fa="__reactListeners$"+zr,ya="__reactHandles$"+zr,wa="__reactResources$"+zr,Sa="__reactMarker$"+zr;function Va(Te){delete Te[Xr],delete Te[Wr],delete Te[ga],delete Te[Fa],delete Te[ya]}function Ja(Te){var Re=Te[Xr];if(Re)return Re;for(var Ue=Te.parentNode;Ue;){if(Re=Ue[$r]||Ue[Xr]){if(Ue=Re.alternate,Re.child!==null||Ue!==null&&Ue.child!==null)for(Te=Tp(Te);Te!==null;){if(Ue=Te[Xr])return Ue;Te=Tp(Te)}return Re}Te=Ue,Ue=Te.parentNode}return null}function an(Te){if(Te=Te[Xr]||Te[$r]){var Re=Te.tag;if(Re===5||Re===6||Re===13||Re===31||Re===26||Re===27||Re===3)return Te}return null}function Za(Te){var Re=Te.tag;if(Re===5||Re===26||Re===27||Re===6)return Te.stateNode;throw Error(n(33))}function tn(Te){var Re=Te[wa];return Re||(Re=Te[wa]={hoistableStyles:new Map,hoistableScripts:new Map}),Re}function dn(Te){Te[Sa]=!0}var ii=new Set,Un={};function ci(Te,Re){vs(Te,Re),vs(Te+"Capture",Re)}function vs(Te,Re){for(Un[Te]=Re,Te=0;Te<Re.length;Te++)ii.add(Re[Te])}var to=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),ro={},Fs={};function nl(Te){return ta.call(Fs,Te)?!0:ta.call(ro,Te)?!1:to.test(Te)?Fs[Te]=!0:(ro[Te]=!0,!1)}function Ai(Te,Re,Ue){if(nl(Re))if(Ue===null)Te.removeAttribute(Re);else{switch(typeof Ue){case"undefined":case"function":case"symbol":Te.removeAttribute(Re);return;case"boolean":var qe=Re.toLowerCase().slice(0,5);if(qe!=="data-"&&qe!=="aria-"){Te.removeAttribute(Re);return}}Te.setAttribute(Re,""+Ue)}}function Lo(Te,Re,Ue){if(Ue===null)Te.removeAttribute(Re);else{switch(typeof Ue){case"undefined":case"function":case"symbol":case"boolean":Te.removeAttribute(Re);return}Te.setAttribute(Re,""+Ue)}}function ao(Te,Re,Ue,qe){if(qe===null)Te.removeAttribute(Ue);else{switch(typeof qe){case"undefined":case"function":case"symbol":case"boolean":Te.removeAttribute(Ue);return}Te.setAttributeNS(Re,Ue,""+qe)}}function ei(Te){switch(typeof Te){case"bigint":case"boolean":case"number":case"string":case"undefined":return Te;case"object":return Te;default:return""}}function Fc(Te){var Re=Te.type;return(Te=Te.nodeName)&&Te.toLowerCase()==="input"&&(Re==="checkbox"||Re==="radio")}function mo(Te,Re,Ue){var qe=Object.getOwnPropertyDescriptor(Te.constructor.prototype,Re);if(!Te.hasOwnProperty(Re)&&typeof qe<"u"&&typeof qe.get=="function"&&typeof qe.set=="function"){var Ze=qe.get,er=qe.set;return Object.defineProperty(Te,Re,{configurable:!0,get:function(){return Ze.call(this)},set:function(Tr){Ue=""+Tr,er.call(this,Tr)}}),Object.defineProperty(Te,Re,{enumerable:qe.enumerable}),{getValue:function(){return Ue},setValue:function(Tr){Ue=""+Tr},stopTracking:function(){Te._valueTracker=null,delete Te[Re]}}}}function il(Te){if(!Te._valueTracker){var Re=Fc(Te)?"checked":"value";Te._valueTracker=mo(Te,Re,""+Te[Re])}}function Lc(Te){if(!Te)return!1;var Re=Te._valueTracker;if(!Re)return!0;var Ue=Re.getValue(),qe="";return Te&&(qe=Fc(Te)?Te.checked?"true":"false":Te.value),Te=qe,Te!==Ue?(Re.setValue(Te),!0):!1}function ys(Te){if(Te=Te||(typeof document<"u"?document:void 0),typeof Te>"u")return null;try{return Te.activeElement||Te.body}catch{return Te.body}}var Ki=/[\n"\\]/g;function ji(Te){return Te.replace(Ki,function(Re){return"\\"+Re.charCodeAt(0).toString(16)+" "})}function $l(Te,Re,Ue,qe,Ze,er,Tr,jr){Te.name="",Tr!=null&&typeof Tr!="function"&&typeof Tr!="symbol"&&typeof Tr!="boolean"?Te.type=Tr:Te.removeAttribute("type"),Re!=null?Tr==="number"?(Re===0&&Te.value===""||Te.value!=Re)&&(Te.value=""+ei(Re)):Te.value!==""+ei(Re)&&(Te.value=""+ei(Re)):Tr!=="submit"&&Tr!=="reset"||Te.removeAttribute("value"),Re!=null?Dc(Te,Tr,ei(Re)):Ue!=null?Dc(Te,Tr,ei(Ue)):qe!=null&&Te.removeAttribute("value"),Ze==null&&er!=null&&(Te.defaultChecked=!!er),Ze!=null&&(Te.checked=Ze&&typeof Ze!="function"&&typeof Ze!="symbol"),jr!=null&&typeof jr!="function"&&typeof jr!="symbol"&&typeof jr!="boolean"?Te.name=""+ei(jr):Te.removeAttribute("name")}function iu(Te,Re,Ue,qe,Ze,er,Tr,jr){if(er!=null&&typeof er!="function"&&typeof er!="symbol"&&typeof er!="boolean"&&(Te.type=er),Re!=null||Ue!=null){if(!(er!=="submit"&&er!=="reset"||Re!=null)){il(Te);return}Ue=Ue!=null?""+ei(Ue):"",Re=Re!=null?""+ei(Re):Ue,jr||Re===Te.value||(Te.value=Re),Te.defaultValue=Re}qe=qe??Ze,qe=typeof qe!="function"&&typeof qe!="symbol"&&!!qe,Te.checked=jr?Te.checked:!!qe,Te.defaultChecked=!!qe,Tr!=null&&typeof Tr!="function"&&typeof Tr!="symbol"&&typeof Tr!="boolean"&&(Te.name=Tr),il(Te)}function Dc(Te,Re,Ue){Re==="number"&&ys(Te.ownerDocument)===Te||Te.defaultValue===""+Ue||(Te.defaultValue=""+Ue)}function ws(Te,Re,Ue,qe){if(Te=Te.options,Re){Re={};for(var Ze=0;Ze<Ue.length;Ze++)Re["$"+Ue[Ze]]=!0;for(Ue=0;Ue<Te.length;Ue++)Ze=Re.hasOwnProperty("$"+Te[Ue].value),Te[Ue].selected!==Ze&&(Te[Ue].selected=Ze),Ze&&qe&&(Te[Ue].defaultSelected=!0)}else{for(Ue=""+ei(Ue),Re=null,Ze=0;Ze<Te.length;Ze++){if(Te[Ze].value===Ue){Te[Ze].selected=!0,qe&&(Te[Ze].defaultSelected=!0);return}Re!==null||Te[Ze].disabled||(Re=Te[Ze])}Re!==null&&(Re.selected=!0)}}function Mc(Te,Re,Ue){if(Re!=null&&(Re=""+ei(Re),Re!==Te.value&&(Te.value=Re),Ue==null)){Te.defaultValue!==Re&&(Te.defaultValue=Re);return}Te.defaultValue=Ue!=null?""+ei(Ue):""}function Oc(Te,Re,Ue,qe){if(Re==null){if(qe!=null){if(Ue!=null)throw Error(n(92));if(Hr(qe)){if(1<qe.length)throw Error(n(93));qe=qe[0]}Ue=qe}Ue==null&&(Ue=""),Re=Ue}Ue=ei(Re),Te.defaultValue=Ue,qe=Te.textContent,qe===Ue&&qe!==""&&qe!==null&&(Te.value=qe),il(Te)}function no(Te,Re){if(Re){var Ue=Te.firstChild;if(Ue&&Ue===Te.lastChild&&Ue.nodeType===3){Ue.nodeValue=Re;return}}Te.textContent=Re}var Al=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function su(Te,Re,Ue){var qe=Re.indexOf("--")===0;Ue==null||typeof Ue=="boolean"||Ue===""?qe?Te.setProperty(Re,""):Re==="float"?Te.cssFloat="":Te[Re]="":qe?Te.setProperty(Re,Ue):typeof Ue!="number"||Ue===0||Al.has(Re)?Re==="float"?Te.cssFloat=Ue:Te[Re]=(""+Ue).trim():Te[Re]=Ue+"px"}function ou(Te,Re,Ue){if(Re!=null&&typeof Re!="object")throw Error(n(62));if(Te=Te.style,Ue!=null){for(var qe in Ue)!Ue.hasOwnProperty(qe)||Re!=null&&Re.hasOwnProperty(qe)||(qe.indexOf("--")===0?Te.setProperty(qe,""):qe==="float"?Te.cssFloat="":Te[qe]="");for(var Ze in Re)qe=Re[Ze],Re.hasOwnProperty(Ze)&&Ue[Ze]!==qe&&su(Te,Ze,qe)}else for(var er in Re)Re.hasOwnProperty(er)&&su(Te,er,Re[er])}function Pc(Te){if(Te.indexOf("-")===-1)return!1;switch(Te){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ic=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),lu=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Cs(Te){return lu.test(""+Te)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":Te}function io(){}var Do=null;function El(Te){return Te=Te.target||Te.srcElement||window,Te.correspondingUseElement&&(Te=Te.correspondingUseElement),Te.nodeType===3?Te.parentNode:Te}var sl=null,kn=null;function cu(Te){var Re=an(Te);if(Re&&(Te=Re.stateNode)){var Ue=Te[Wr]||null;e:switch(Te=Re.stateNode,Re.type){case"input":if($l(Te,Ue.value,Ue.defaultValue,Ue.defaultValue,Ue.checked,Ue.defaultChecked,Ue.type,Ue.name),Re=Ue.name,Ue.type==="radio"&&Re!=null){for(Ue=Te;Ue.parentNode;)Ue=Ue.parentNode;for(Ue=Ue.querySelectorAll('input[name="'+ji(""+Re)+'"][type="radio"]'),Re=0;Re<Ue.length;Re++){var qe=Ue[Re];if(qe!==Te&&qe.form===Te.form){var Ze=qe[Wr]||null;if(!Ze)throw Error(n(90));$l(qe,Ze.value,Ze.defaultValue,Ze.defaultValue,Ze.checked,Ze.defaultChecked,Ze.type,Ze.name)}}for(Re=0;Re<Ue.length;Re++)qe=Ue[Re],qe.form===Te.form&&Lc(qe)}break e;case"textarea":Mc(Te,Ue.value,Ue.defaultValue);break e;case"select":Re=Ue.value,Re!=null&&ws(Te,!!Ue.multiple,Re,!1)}}}var Bc=!1;function uu(Te,Re,Ue){if(Bc)return Te(Re,Ue);Bc=!0;try{var qe=Te(Re);return qe}finally{if(Bc=!1,(sl!==null||kn!==null)&&(eh(),sl&&(Re=sl,Te=kn,kn=sl=null,cu(Re),Te)))for(Re=0;Re<Te.length;Re++)cu(Te[Re])}}function Ls(Te,Re){var Ue=Te.stateNode;if(Ue===null)return null;var qe=Ue[Wr]||null;if(qe===null)return null;Ue=qe[Re];e:switch(Re){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(qe=!qe.disabled)||(Te=Te.type,qe=!(Te==="button"||Te==="input"||Te==="select"||Te==="textarea")),Te=!qe;break e;default:Te=!1}if(Te)return null;if(Ue&&typeof Ue!="function")throw Error(n(231,Re,typeof Ue));return Ue}var ns=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),jc=!1;if(ns)try{var Tl={};Object.defineProperty(Tl,"passive",{get:function(){jc=!0}}),window.addEventListener("test",Tl,Tl),window.removeEventListener("test",Tl,Tl)}catch{jc=!1}var Ds=null,kl=null,_o=null;function fu(){if(_o)return _o;var Te,Re=kl,Ue=Re.length,qe,Ze="value"in Ds?Ds.value:Ds.textContent,er=Ze.length;for(Te=0;Te<Ue&&Re[Te]===Ze[Te];Te++);var Tr=Ue-Te;for(qe=1;qe<=Tr&&Re[Ue-qe]===Ze[er-qe];qe++);return _o=Ze.slice(Te,1<qe?1-qe:void 0)}function Bs(Te){var Re=Te.keyCode;return"charCode"in Te?(Te=Te.charCode,Te===0&&Re===13&&(Te=13)):Te=Re,Te===10&&(Te=13),32<=Te||Te===13?Te:0}function Zl(){return!0}function Jl(){return!1}function Qi(Te){function Re(Ue,qe,Ze,er,Tr){this._reactName=Ue,this._targetInst=Ze,this.type=qe,this.nativeEvent=er,this.target=Tr,this.currentTarget=null;for(var jr in Te)Te.hasOwnProperty(jr)&&(Ue=Te[jr],this[jr]=Ue?Ue(er):er[jr]);return this.isDefaultPrevented=(er.defaultPrevented!=null?er.defaultPrevented:er.returnValue===!1)?Zl:Jl,this.isPropagationStopped=Jl,this}return He(Re.prototype,{preventDefault:function(){this.defaultPrevented=!0;var Ue=this.nativeEvent;Ue&&(Ue.preventDefault?Ue.preventDefault():typeof Ue.returnValue!="unknown"&&(Ue.returnValue=!1),this.isDefaultPrevented=Zl)},stopPropagation:function(){var Ue=this.nativeEvent;Ue&&(Ue.stopPropagation?Ue.stopPropagation():typeof Ue.cancelBubble!="unknown"&&(Ue.cancelBubble=!0),this.isPropagationStopped=Zl)},persist:function(){},isPersistent:Zl}),Re}var xo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(Te){return Te.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},js=Qi(xo),Mo=He({},xo,{view:0,detail:0}),Ql=Qi(Mo),Cl,Oo,Po,Rl=He({},Mo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Nn,button:0,buttons:0,relatedTarget:function(Te){return Te.relatedTarget===void 0?Te.fromElement===Te.srcElement?Te.toElement:Te.fromElement:Te.relatedTarget},movementX:function(Te){return"movementX"in Te?Te.movementX:(Te!==Po&&(Po&&Te.type==="mousemove"?(Cl=Te.screenX-Po.screenX,Oo=Te.screenY-Po.screenY):Oo=Cl=0,Po=Te),Cl)},movementY:function(Te){return"movementY"in Te?Te.movementY:Oo}}),Uc=Qi(Rl),Io=He({},Rl,{dataTransfer:0}),Bo=Qi(Io),hu=He({},Mo,{relatedTarget:0}),jo=Qi(hu),du=He({},xo,{animationName:0,elapsedTime:0,pseudoElement:0}),cr=Qi(du),Lr=He({},xo,{clipboardData:function(Te){return"clipboardData"in Te?Te.clipboardData:window.clipboardData}}),Kr=Qi(Lr),ra=He({},xo,{data:0}),fa=Qi(ra),Ia={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qa={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},gn={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function wn(Te){var Re=this.nativeEvent;return Re.getModifierState?Re.getModifierState(Te):(Te=gn[Te])?!!Re[Te]:!1}function Nn(){return wn}var Mn=He({},Mo,{key:function(Te){if(Te.key){var Re=Ia[Te.key]||Te.key;if(Re!=="Unidentified")return Re}return Te.type==="keypress"?(Te=Bs(Te),Te===13?"Enter":String.fromCharCode(Te)):Te.type==="keydown"||Te.type==="keyup"?qa[Te.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Nn,charCode:function(Te){return Te.type==="keypress"?Bs(Te):0},keyCode:function(Te){return Te.type==="keydown"||Te.type==="keyup"?Te.keyCode:0},which:function(Te){return Te.type==="keypress"?Bs(Te):Te.type==="keydown"||Te.type==="keyup"?Te.keyCode:0}}),Gn=Qi(Mn),Ei=He({},Rl,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Mi=Qi(Ei),di=He({},Mo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Nn}),$i=Qi(di),Ui=He({},xo,{propertyName:0,elapsedTime:0,pseudoElement:0}),is=Qi(Ui),Uo=He({},Rl,{deltaX:function(Te){return"deltaX"in Te?Te.deltaX:"wheelDeltaX"in Te?-Te.wheelDeltaX:0},deltaY:function(Te){return"deltaY"in Te?Te.deltaY:"wheelDeltaY"in Te?-Te.wheelDeltaY:"wheelDelta"in Te?-Te.wheelDelta:0},deltaZ:0,deltaMode:0}),so=Qi(Uo),zo=He({},xo,{newState:0,oldState:0}),zc=Qi(zo),ec=[9,13,27,32],vo=ns&&"CompositionEvent"in window,oo=null;ns&&"documentMode"in document&&(oo=document.documentMode);var Nl=ns&&"TextEvent"in window&&!oo,Ho=ns&&(!vo||oo&&8<oo&&11>=oo),es=" ",ol=!1;function ll(Te,Re){switch(Te){case"keyup":return ec.indexOf(Re.keyCode)!==-1;case"keydown":return Re.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function tc(Te){return Te=Te.detail,typeof Te=="object"&&"data"in Te?Te.data:null}var yo=!1;function bs(Te,Re){switch(Te){case"compositionend":return tc(Re);case"keypress":return Re.which!==32?null:(ol=!0,es);case"textInput":return Te=Re.data,Te===es&&ol?null:Te;default:return null}}function Xo(Te,Re){if(yo)return Te==="compositionend"||!vo&&ll(Te,Re)?(Te=fu(),_o=kl=Ds=null,yo=!1,Te):null;switch(Te){case"paste":return null;case"keypress":if(!(Re.ctrlKey||Re.altKey||Re.metaKey)||Re.ctrlKey&&Re.altKey){if(Re.char&&1<Re.char.length)return Re.char;if(Re.which)return String.fromCharCode(Re.which)}return null;case"compositionend":return Ho&&Re.locale!=="ko"?null:Re.data;default:return null}}var rc={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Hc(Te){var Re=Te&&Te.nodeName&&Te.nodeName.toLowerCase();return Re==="input"?!!rc[Te.type]:Re==="textarea"}function Ms(Te,Re,Ue,qe){sl?kn?kn.push(qe):kn=[qe]:sl=qe,Re=oh(Re,"onChange"),0<Re.length&&(Ue=new js("onChange","change",null,Ue,qe),Te.push({event:Ue,listeners:Re}))}var lo=null,qo=null;function Xc(Te){hp(Te,0)}function co(Te){var Re=Za(Te);if(Lc(Re))return Te}function cl(Te,Re){if(Te==="change")return Re}var Rs=!1;if(ns){var Ss;if(ns){var wo="oninput"in document;if(!wo){var bo=document.createElement("div");bo.setAttribute("oninput","return;"),wo=typeof bo.oninput=="function"}Ss=wo}else Ss=!1;Rs=Ss&&(!document.documentMode||9<document.documentMode)}function Wo(){lo&&(lo.detachEvent("onpropertychange",ac),qo=lo=null)}function ac(Te){if(Te.propertyName==="value"&&co(qo)){var Re=[];Ms(Re,qo,Te,El(Te)),uu(Xc,Re)}}function nc(Te,Re,Ue){Te==="focusin"?(Wo(),lo=Re,qo=Ue,lo.attachEvent("onpropertychange",ac)):Te==="focusout"&&Wo()}function Oi(Te){if(Te==="selectionchange"||Te==="keyup"||Te==="keydown")return co(qo)}function pu(Te,Re){if(Te==="click")return co(Re)}function So(Te,Re){if(Te==="input"||Te==="change")return co(Re)}function Ao(Te,Re){return Te===Re&&(Te!==0||1/Te===1/Re)||Te!==Te&&Re!==Re}var ss=typeof Object.is=="function"?Object.is:Ao;function Vo(Te,Re){if(ss(Te,Re))return!0;if(typeof Te!="object"||Te===null||typeof Re!="object"||Re===null)return!1;var Ue=Object.keys(Te),qe=Object.keys(Re);if(Ue.length!==qe.length)return!1;for(qe=0;qe<Ue.length;qe++){var Ze=Ue[qe];if(!ta.call(Re,Ze)||!ss(Te[Ze],Re[Ze]))return!1}return!0}function ic(Te){for(;Te&&Te.firstChild;)Te=Te.firstChild;return Te}function sc(Te,Re){var Ue=ic(Te);Te=0;for(var qe;Ue;){if(Ue.nodeType===3){if(qe=Te+Ue.textContent.length,Te<=Re&&qe>=Re)return{node:Ue,offset:Re-Te};Te=qe}e:{for(;Ue;){if(Ue.nextSibling){Ue=Ue.nextSibling;break e}Ue=Ue.parentNode}Ue=void 0}Ue=ic(Ue)}}function Go(Te,Re){return Te&&Re?Te===Re?!0:Te&&Te.nodeType===3?!1:Re&&Re.nodeType===3?Go(Te,Re.parentNode):"contains"in Te?Te.contains(Re):Te.compareDocumentPosition?!!(Te.compareDocumentPosition(Re)&16):!1:!1}function Yo(Te){Te=Te!=null&&Te.ownerDocument!=null&&Te.ownerDocument.defaultView!=null?Te.ownerDocument.defaultView:window;for(var Re=ys(Te.document);Re instanceof Te.HTMLIFrameElement;){try{var Ue=typeof Re.contentWindow.location.href=="string"}catch{Ue=!1}if(Ue)Te=Re.contentWindow;else break;Re=ys(Te.document)}return Re}function Eo(Te){var Re=Te&&Te.nodeName&&Te.nodeName.toLowerCase();return Re&&(Re==="input"&&(Te.type==="text"||Te.type==="search"||Te.type==="tel"||Te.type==="url"||Te.type==="password")||Re==="textarea"||Te.contentEditable==="true")}var Fl=ns&&"documentMode"in document&&11>=document.documentMode,Os=null,Ko=null,ds=null,Us=!1;function ti(Te,Re,Ue){var qe=Ue.window===Ue?Ue.document:Ue.nodeType===9?Ue:Ue.ownerDocument;Us||Os==null||Os!==ys(qe)||(qe=Os,"selectionStart"in qe&&Eo(qe)?qe={start:qe.selectionStart,end:qe.selectionEnd}:(qe=(qe.ownerDocument&&qe.ownerDocument.defaultView||window).getSelection(),qe={anchorNode:qe.anchorNode,anchorOffset:qe.anchorOffset,focusNode:qe.focusNode,focusOffset:qe.focusOffset}),ds&&Vo(ds,qe)||(ds=qe,qe=oh(Ko,"onSelect"),0<qe.length&&(Re=new js("onSelect","select",null,Re,Ue),Te.push({event:Re,listeners:qe}),Re.target=Os)))}function Yn(Te,Re){var Ue={};return Ue[Te.toLowerCase()]=Re.toLowerCase(),Ue["Webkit"+Te]="webkit"+Re,Ue["Moz"+Te]="moz"+Re,Ue}var pi={animationend:Yn("Animation","AnimationEnd"),animationiteration:Yn("Animation","AnimationIteration"),animationstart:Yn("Animation","AnimationStart"),transitionrun:Yn("Transition","TransitionRun"),transitionstart:Yn("Transition","TransitionStart"),transitioncancel:Yn("Transition","TransitionCancel"),transitionend:Yn("Transition","TransitionEnd")},Pi={},To={};ns&&(To=document.createElement("div").style,"AnimationEvent"in window||(delete pi.animationend.animation,delete pi.animationiteration.animation,delete pi.animationstart.animation),"TransitionEvent"in window||delete pi.transitionend.transition);function uo(Te){if(Pi[Te])return Pi[Te];if(!pi[Te])return Te;var Re=pi[Te],Ue;for(Ue in Re)if(Re.hasOwnProperty(Ue)&&Ue in To)return Pi[Te]=Re[Ue];return Te}var Ll=uo("animationend"),qc=uo("animationiteration"),Yu=uo("animationstart"),Nf=uo("transitionrun"),Ff=uo("transitionstart"),Lf=uo("transitioncancel"),Ku=uo("transitionend"),$u=new Map,Dl="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Dl.push("scrollEnd");function zs(Te,Re){$u.set(Te,Re),ci(Re,[Te])}var Wc=typeof reportError=="function"?reportError:function(Te){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Re=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Te=="object"&&Te!==null&&typeof Te.message=="string"?String(Te.message):String(Te),error:Te});if(!window.dispatchEvent(Re))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Te);return}console.error(Te)},Ps=[],Ml=0,gu=0;function Vc(){for(var Te=Ml,Re=gu=Ml=0;Re<Te;){var Ue=Ps[Re];Ps[Re++]=null;var qe=Ps[Re];Ps[Re++]=null;var Ze=Ps[Re];Ps[Re++]=null;var er=Ps[Re];if(Ps[Re++]=null,qe!==null&&Ze!==null){var Tr=qe.pending;Tr===null?Ze.next=Ze:(Ze.next=Tr.next,Tr.next=Ze),qe.pending=Ze}er!==0&&Yc(Ue,Ze,er)}}function Gc(Te,Re,Ue,qe){Ps[Ml++]=Te,Ps[Ml++]=Re,Ps[Ml++]=Ue,Ps[Ml++]=qe,gu|=qe,Te.lanes|=qe,Te=Te.alternate,Te!==null&&(Te.lanes|=qe)}function mu(Te,Re,Ue,qe){return Gc(Te,Re,Ue,qe),ps(Te)}function $o(Te,Re){return Gc(Te,null,null,Re),ps(Te)}function Yc(Te,Re,Ue){Te.lanes|=Ue;var qe=Te.alternate;qe!==null&&(qe.lanes|=Ue);for(var Ze=!1,er=Te.return;er!==null;)er.childLanes|=Ue,qe=er.alternate,qe!==null&&(qe.childLanes|=Ue),er.tag===22&&(Te=er.stateNode,Te===null||Te._visibility&1||(Ze=!0)),Te=er,er=er.return;return Te.tag===3?(er=Te.stateNode,Ze&&Re!==null&&(Ze=31-ia(Ue),Te=er.hiddenUpdates,qe=Te[Ze],qe===null?Te[Ze]=[Re]:qe.push(Re),Re.lane=Ue|536870912),er):null}function ps(Te){if(50<vf)throw vf=0,a0=null,Error(n(185));for(var Re=Te.return;Re!==null;)Te=Re,Re=Te.return;return Te.tag===3?Te.stateNode:null}var os={};function _u(Te,Re,Ue,qe){this.tag=Te,this.key=Ue,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=Re,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=qe,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gs(Te,Re,Ue,qe){return new _u(Te,Re,Ue,qe)}function xu(Te){return Te=Te.prototype,!(!Te||!Te.isReactComponent)}function Hs(Te,Re){var Ue=Te.alternate;return Ue===null?(Ue=gs(Te.tag,Re,Te.key,Te.mode),Ue.elementType=Te.elementType,Ue.type=Te.type,Ue.stateNode=Te.stateNode,Ue.alternate=Te,Te.alternate=Ue):(Ue.pendingProps=Re,Ue.type=Te.type,Ue.flags=0,Ue.subtreeFlags=0,Ue.deletions=null),Ue.flags=Te.flags&65011712,Ue.childLanes=Te.childLanes,Ue.lanes=Te.lanes,Ue.child=Te.child,Ue.memoizedProps=Te.memoizedProps,Ue.memoizedState=Te.memoizedState,Ue.updateQueue=Te.updateQueue,Re=Te.dependencies,Ue.dependencies=Re===null?null:{lanes:Re.lanes,firstContext:Re.firstContext},Ue.sibling=Te.sibling,Ue.index=Te.index,Ue.ref=Te.ref,Ue.refCleanup=Te.refCleanup,Ue}function Kc(Te,Re){Te.flags&=65011714;var Ue=Te.alternate;return Ue===null?(Te.childLanes=0,Te.lanes=Re,Te.child=null,Te.subtreeFlags=0,Te.memoizedProps=null,Te.memoizedState=null,Te.updateQueue=null,Te.dependencies=null,Te.stateNode=null):(Te.childLanes=Ue.childLanes,Te.lanes=Ue.lanes,Te.child=Ue.child,Te.subtreeFlags=0,Te.deletions=null,Te.memoizedProps=Ue.memoizedProps,Te.memoizedState=Ue.memoizedState,Te.updateQueue=Ue.updateQueue,Te.type=Ue.type,Re=Ue.dependencies,Te.dependencies=Re===null?null:{lanes:Re.lanes,firstContext:Re.firstContext}),Te}function oc(Te,Re,Ue,qe,Ze,er){var Tr=0;if(qe=Te,typeof Te=="function")xu(Te)&&(Tr=1);else if(typeof Te=="string")Tr=q1(Te,Ue,or.current)?26:Te==="html"||Te==="head"||Te==="body"?27:5;else e:switch(Te){case fr:return Te=gs(31,Ue,Re,Ze),Te.elementType=fr,Te.lanes=er,Te;case Ge:return ul(Ue.children,Ze,er,Re);case $e:Tr=8,Ze|=24;break;case Ke:return Te=gs(12,Ue,Re,Ze|2),Te.elementType=Ke,Te.lanes=er,Te;case ar:return Te=gs(13,Ue,Re,Ze),Te.elementType=ar,Te.lanes=er,Te;case hr:return Te=gs(19,Ue,Re,Ze),Te.elementType=hr,Te.lanes=er,Te;default:if(typeof Te=="object"&&Te!==null)switch(Te.$$typeof){case tr:Tr=10;break e;case rr:Tr=9;break e;case sr:Tr=11;break e;case pr:Tr=14;break e;case yr:Tr=16,qe=null;break e}Tr=29,Ue=Error(n(130,Te===null?"null":typeof Te,"")),qe=null}return Re=gs(Tr,Ue,Re,Ze),Re.elementType=Te,Re.type=qe,Re.lanes=er,Re}function ul(Te,Re,Ue,qe){return Te=gs(7,Te,qe,Re),Te.lanes=Ue,Te}function $c(Te,Re,Ue){return Te=gs(6,Te,null,Re),Te.lanes=Ue,Te}function vu(Te){var Re=gs(18,null,null,0);return Re.stateNode=Te,Re}function cc(Te,Re,Ue){return Re=gs(4,Te.children!==null?Te.children:[],Te.key,Re),Re.lanes=Ue,Re.stateNode={containerInfo:Te.containerInfo,pendingChildren:null,implementation:Te.implementation},Re}var yu=new WeakMap;function Xs(Te,Re){if(typeof Te=="object"&&Te!==null){var Ue=yu.get(Te);return Ue!==void 0?Ue:(Re={value:Te,source:Re,stack:oa(Re)},yu.set(Te,Re),Re)}return{value:Te,source:Re,stack:oa(Re)}}var uc=[],Ol=0,wu=null,Zc=0,qs=[],Ws=0,hl=null,Vs=1,Gs="";function Is(Te,Re){uc[Ol++]=Zc,uc[Ol++]=wu,wu=Te,Zc=Re}function Df(Te,Re,Ue){qs[Ws++]=Vs,qs[Ws++]=Gs,qs[Ws++]=hl,hl=Te;var qe=Vs;Te=Gs;var Ze=32-ia(qe)-1;qe&=~(1<<Ze),Ue+=1;var er=32-ia(Re)+Ze;if(30<er){var Tr=Ze-Ze%5;er=(qe&(1<<Tr)-1).toString(32),qe>>=Tr,Ze-=Tr,Vs=1<<32-ia(Re)+Ze|Ue<<Ze|qe,Gs=er+Te}else Vs=1<<er|Ue<<Ze|qe,Gs=Te}function Zu(Te){Te.return!==null&&(Is(Te,1),Df(Te,1,0))}function bu(Te){for(;Te===wu;)wu=uc[--Ol],uc[Ol]=null,Zc=uc[--Ol],uc[Ol]=null;for(;Te===hl;)hl=qs[--Ws],qs[Ws]=null,Gs=qs[--Ws],qs[Ws]=null,Vs=qs[--Ws],qs[Ws]=null}function Mf(Te,Re){qs[Ws++]=Vs,qs[Ws++]=Gs,qs[Ws++]=hl,Vs=Re.id,Gs=Re.overflow,hl=Te}var ls=null,vi=null,Hn=!1,As=null,Ni=!1,fo=Error(n(519));function dl(Te){var Re=Error(n(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw fc(Xs(Re,Te)),fo}function Ju(Te){var Re=Te.stateNode,Ue=Te.type,qe=Te.memoizedProps;switch(Re[Xr]=Te,Re[Wr]=qe,Ue){case"dialog":qn("cancel",Re),qn("close",Re);break;case"iframe":case"object":case"embed":qn("load",Re);break;case"video":case"audio":for(Ue=0;Ue<wf.length;Ue++)qn(wf[Ue],Re);break;case"source":qn("error",Re);break;case"img":case"image":case"link":qn("error",Re),qn("load",Re);break;case"details":qn("toggle",Re);break;case"input":qn("invalid",Re),iu(Re,qe.value,qe.defaultValue,qe.checked,qe.defaultChecked,qe.type,qe.name,!0);break;case"select":qn("invalid",Re);break;case"textarea":qn("invalid",Re),Oc(Re,qe.value,qe.defaultValue,qe.children)}Ue=qe.children,typeof Ue!="string"&&typeof Ue!="number"&&typeof Ue!="bigint"||Re.textContent===""+Ue||qe.suppressHydrationWarning===!0||mp(Re.textContent,Ue)?(qe.popover!=null&&(qn("beforetoggle",Re),qn("toggle",Re)),qe.onScroll!=null&&qn("scroll",Re),qe.onScrollEnd!=null&&qn("scrollend",Re),qe.onClick!=null&&(Re.onclick=io),Re=!0):Re=!1,Re||dl(Te,!0)}function Zo(Te){for(ls=Te.return;ls;)switch(ls.tag){case 5:case 31:case 13:Ni=!1;return;case 27:case 3:Ni=!0;return;default:ls=ls.return}}function cs(Te){if(Te!==ls)return!1;if(!Hn)return Zo(Te),Hn=!0,!1;var Re=Te.tag,Ue;if((Ue=Re!==3&&Re!==27)&&((Ue=Re===5)&&(Ue=Te.type,Ue=!(Ue!=="form"&&Ue!=="button")||x0(Te.type,Te.memoizedProps)),Ue=!Ue),Ue&&vi&&dl(Te),Zo(Te),Re===13){if(Te=Te.memoizedState,Te=Te!==null?Te.dehydrated:null,!Te)throw Error(n(317));vi=Ep(Te)}else if(Re===31){if(Te=Te.memoizedState,Te=Te!==null?Te.dehydrated:null,!Te)throw Error(n(317));vi=Ep(Te)}else Re===27?(Re=vi,Ec(Te.type)?(Te=S0,S0=null,vi=Te):vi=Re):vi=ls?No(Te.stateNode.nextSibling):null;return!0}function Pl(){vi=ls=null,Hn=!1}function Qu(){var Te=As;return Te!==null&&(Qs===null?Qs=Te:Qs.push.apply(Qs,Te),As=null),Te}function fc(Te){As===null?As=[Te]:As.push(Te)}var Su=ur(null),pl=null,ko=null;function gl(Te,Re,Ue){nr(Su,Re._currentValue),Re._currentValue=Ue}function Ys(Te){Te._currentValue=Su.current,Je(Su)}function hc(Te,Re,Ue){for(;Te!==null;){var qe=Te.alternate;if((Te.childLanes&Re)!==Re?(Te.childLanes|=Re,qe!==null&&(qe.childLanes|=Re)):qe!==null&&(qe.childLanes&Re)!==Re&&(qe.childLanes|=Re),Te===Ue)break;Te=Te.return}}function Il(Te,Re,Ue,qe){var Ze=Te.child;for(Ze!==null&&(Ze.return=Te);Ze!==null;){var er=Ze.dependencies;if(er!==null){var Tr=Ze.child;er=er.firstContext;e:for(;er!==null;){var jr=er;er=Ze;for(var ea=0;ea<Re.length;ea++)if(jr.context===Re[ea]){er.lanes|=Ue,jr=er.alternate,jr!==null&&(jr.lanes|=Ue),hc(er.return,Ue,Te),qe||(Tr=null);break e}er=jr.next}}else if(Ze.tag===18){if(Tr=Ze.return,Tr===null)throw Error(n(341));Tr.lanes|=Ue,er=Tr.alternate,er!==null&&(er.lanes|=Ue),hc(Tr,Ue,Te),Tr=null}else Tr=Ze.child;if(Tr!==null)Tr.return=Ze;else for(Tr=Ze;Tr!==null;){if(Tr===Te){Tr=null;break}if(Ze=Tr.sibling,Ze!==null){Ze.return=Tr.return,Tr=Ze;break}Tr=Tr.return}Ze=Tr}}function ml(Te,Re,Ue,qe){Te=null;for(var Ze=Re,er=!1;Ze!==null;){if(!er){if((Ze.flags&524288)!==0)er=!0;else if((Ze.flags&262144)!==0)break}if(Ze.tag===10){var Tr=Ze.alternate;if(Tr===null)throw Error(n(387));if(Tr=Tr.memoizedProps,Tr!==null){var jr=Ze.type;ss(Ze.pendingProps.value,Tr.value)||(Te!==null?Te.push(jr):Te=[jr])}}else if(Ze===dr.current){if(Tr=Ze.alternate,Tr===null)throw Error(n(387));Tr.memoizedState.memoizedState!==Ze.memoizedState.memoizedState&&(Te!==null?Te.push(Tf):Te=[Tf])}Ze=Ze.return}Te!==null&&Il(Re,Te,Ue,qe),Re.flags|=262144}function Au(Te){for(Te=Te.firstContext;Te!==null;){if(!ss(Te.context._currentValue,Te.memoizedValue))return!0;Te=Te.next}return!1}function _l(Te){pl=Te,ko=null,Te=Te.dependencies,Te!==null&&(Te.firstContext=null)}function us(Te){return Of(pl,Te)}function Eu(Te,Re){return pl===null&&_l(Te),Of(Te,Re)}function Of(Te,Re){var Ue=Re._currentValue;if(Re={context:Re,memoizedValue:Ue,next:null},ko===null){if(Te===null)throw Error(n(308));ko=Re,Te.dependencies={lanes:0,firstContext:Re},Te.flags|=524288}else ko=ko.next=Re;return Ue}var bh=typeof AbortController<"u"?AbortController:function(){var Te=[],Re=this.signal={aborted:!1,addEventListener:function(Ue,qe){Te.push(qe)}};this.abort=function(){Re.aborted=!0,Te.forEach(function(Ue){return Ue()})}},Sh=e.unstable_scheduleCallback,Ah=e.unstable_NormalPriority,Ii={$$typeof:tr,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function dc(){return{controller:new bh,data:new Map,refCount:0}}function Jc(Te){Te.refCount--,Te.refCount===0&&Sh(Ah,function(){Te.controller.abort()})}var Qc=null,Tu=0,Ye=0,Qe=null;function gr(Te,Re){if(Qc===null){var Ue=Qc=[];Tu=0,Ye=c0(),Qe={status:"pending",value:void 0,then:function(qe){Ue.push(qe)}}}return Tu++,Re.then(Sr,Sr),Re}function Sr(){if(--Tu===0&&Qc!==null){Qe!==null&&(Qe.status="fulfilled");var Te=Qc;Qc=null,Ye=0,Qe=null;for(var Re=0;Re<Te.length;Re++)(0,Te[Re])()}}function Dr(Te,Re){var Ue=[],qe={status:"pending",value:null,reason:null,then:function(Ze){Ue.push(Ze)}};return Te.then(function(){qe.status="fulfilled",qe.value=Re;for(var Ze=0;Ze<Ue.length;Ze++)(0,Ue[Ze])(Re)},function(Ze){for(qe.status="rejected",qe.reason=Ze,Ze=0;Ze<Ue.length;Ze++)(0,Ue[Ze])(void 0)}),qe}var Ir=Nr.S;Nr.S=function(Te,Re){Ud=Ya(),typeof Re=="object"&&Re!==null&&typeof Re.then=="function"&&gr(Te,Re),Ir!==null&&Ir(Te,Re)};var Br=ur(null);function Ur(){var Te=Br.current;return Te!==null?Te:wi.pooledCache}function qr(Te,Re){Re===null?nr(Br,Br.current):nr(Br,Re.pool)}function Gr(){var Te=Ur();return Te===null?null:{parent:Ii._currentValue,pool:Te}}var na=Error(n(460)),ba=Error(n(474)),Vr=Error(n(542)),la={then:function(){}};function da(Te){return Te=Te.status,Te==="fulfilled"||Te==="rejected"}function Ma(Te,Re,Ue){switch(Ue=Te[Ue],Ue===void 0?Te.push(Re):Ue!==Re&&(Re.then(io,io),Re=Ue),Re.status){case"fulfilled":return Re.value;case"rejected":throw Te=Re.reason,Ga(Te),Te;default:if(typeof Re.status=="string")Re.then(io,io);else{if(Te=wi,Te!==null&&100<Te.shellSuspendCounter)throw Error(n(482));Te=Re,Te.status="pending",Te.then(function(qe){if(Re.status==="pending"){var Ze=Re;Ze.status="fulfilled",Ze.value=qe}},function(qe){if(Re.status==="pending"){var Ze=Re;Ze.status="rejected",Ze.reason=qe}})}switch(Re.status){case"fulfilled":return Re.value;case"rejected":throw Te=Re.reason,Ga(Te),Te}throw Da=Re,na}}function ma(Te){try{var Re=Te._init;return Re(Te._payload)}catch(Ue){throw Ue!==null&&typeof Ue=="object"&&typeof Ue.then=="function"?(Da=Ue,na):Ue}}var Da=null;function Ba(){if(Da===null)throw Error(n(459));var Te=Da;return Da=null,Te}function Ga(Te){if(Te===na||Te===Vr)throw Error(n(483))}var Ha=null,xn=0;function cn(Te){var Re=xn;return xn+=1,Ha===null&&(Ha=[]),Ma(Ha,Te,Re)}function Dn(Te,Re){Re=Re.props.ref,Te.ref=Re!==void 0?Re:null}function pn(Te,Re){throw Re.$$typeof===Ve?Error(n(525)):(Te=Object.prototype.toString.call(Re),Error(n(31,Te==="[object Object]"?"object with keys {"+Object.keys(Re).join(", ")+"}":Te)))}function zn(Te){function Re(ha,sa){if(Te){var Aa=ha.deletions;Aa===null?(ha.deletions=[sa],ha.flags|=16):Aa.push(sa)}}function Ue(ha,sa){if(!Te)return null;for(;sa!==null;)Re(ha,sa),sa=sa.sibling;return null}function qe(ha){for(var sa=new Map;ha!==null;)ha.key!==null?sa.set(ha.key,ha):sa.set(ha.index,ha),ha=ha.sibling;return sa}function Ze(ha,sa){return ha=Hs(ha,sa),ha.index=0,ha.sibling=null,ha}function er(ha,sa,Aa){return ha.index=Aa,Te?(Aa=ha.alternate,Aa!==null?(Aa=Aa.index,Aa<sa?(ha.flags|=67108866,sa):Aa):(ha.flags|=67108866,sa)):(ha.flags|=1048576,sa)}function Tr(ha){return Te&&ha.alternate===null&&(ha.flags|=67108866),ha}function jr(ha,sa,Aa,ja){return sa===null||sa.tag!==6?(sa=$c(Aa,ha.mode,ja),sa.return=ha,sa):(sa=Ze(sa,Aa),sa.return=ha,sa)}function ea(ha,sa,Aa,ja){var En=Aa.type;return En===Ge?Pa(ha,sa,Aa.props.children,ja,Aa.key):sa!==null&&(sa.elementType===En||typeof En=="object"&&En!==null&&En.$$typeof===yr&&ma(En)===sa.type)?(sa=Ze(sa,Aa.props),Dn(sa,Aa),sa.return=ha,sa):(sa=oc(Aa.type,Aa.key,Aa.props,null,ha.mode,ja),Dn(sa,Aa),sa.return=ha,sa)}function Ea(ha,sa,Aa,ja){return sa===null||sa.tag!==4||sa.stateNode.containerInfo!==Aa.containerInfo||sa.stateNode.implementation!==Aa.implementation?(sa=cc(Aa,ha.mode,ja),sa.return=ha,sa):(sa=Ze(sa,Aa.children||[]),sa.return=ha,sa)}function Pa(ha,sa,Aa,ja,En){return sa===null||sa.tag!==7?(sa=ul(Aa,ha.mode,ja,En),sa.return=ha,sa):(sa=Ze(sa,Aa),sa.return=ha,sa)}function Ua(ha,sa,Aa){if(typeof sa=="string"&&sa!==""||typeof sa=="number"||typeof sa=="bigint")return sa=$c(""+sa,ha.mode,Aa),sa.return=ha,sa;if(typeof sa=="object"&&sa!==null){switch(sa.$$typeof){case Xe:return Aa=oc(sa.type,sa.key,sa.props,null,ha.mode,Aa),Dn(Aa,sa),Aa.return=ha,Aa;case We:return sa=cc(sa,ha.mode,Aa),sa.return=ha,sa;case yr:return sa=ma(sa),Ua(ha,sa,Aa)}if(Hr(sa)||wr(sa))return sa=ul(sa,ha.mode,Aa,null),sa.return=ha,sa;if(typeof sa.then=="function")return Ua(ha,cn(sa),Aa);if(sa.$$typeof===tr)return Ua(ha,Eu(ha,sa),Aa);pn(ha,sa)}return null}function Ta(ha,sa,Aa,ja){var En=sa!==null?sa.key:null;if(typeof Aa=="string"&&Aa!==""||typeof Aa=="number"||typeof Aa=="bigint")return En!==null?null:jr(ha,sa,""+Aa,ja);if(typeof Aa=="object"&&Aa!==null){switch(Aa.$$typeof){case Xe:return Aa.key===En?ea(ha,sa,Aa,ja):null;case We:return Aa.key===En?Ea(ha,sa,Aa,ja):null;case yr:return Aa=ma(Aa),Ta(ha,sa,Aa,ja)}if(Hr(Aa)||wr(Aa))return En!==null?null:Pa(ha,sa,Aa,ja,null);if(typeof Aa.then=="function")return Ta(ha,sa,cn(Aa),ja);if(Aa.$$typeof===tr)return Ta(ha,sa,Eu(ha,Aa),ja);pn(ha,Aa)}return null}function Ra(ha,sa,Aa,ja,En){if(typeof ja=="string"&&ja!==""||typeof ja=="number"||typeof ja=="bigint")return ha=ha.get(Aa)||null,jr(sa,ha,""+ja,En);if(typeof ja=="object"&&ja!==null){switch(ja.$$typeof){case Xe:return ha=ha.get(ja.key===null?Aa:ja.key)||null,ea(sa,ha,ja,En);case We:return ha=ha.get(ja.key===null?Aa:ja.key)||null,Ea(sa,ha,ja,En);case yr:return ja=ma(ja),Ra(ha,sa,Aa,ja,En)}if(Hr(ja)||wr(ja))return ha=ha.get(Aa)||null,Pa(sa,ha,ja,En,null);if(typeof ja.then=="function")return Ra(ha,sa,Aa,cn(ja),En);if(ja.$$typeof===tr)return Ra(ha,sa,Aa,Eu(sa,ja),En);pn(sa,ja)}return null}function mn(ha,sa,Aa,ja){for(var En=null,ai=null,bn=sa,In=sa=0,Vn=null;bn!==null&&In<Aa.length;In++){bn.index>In?(Vn=bn,bn=null):Vn=bn.sibling;var ni=Ta(ha,bn,Aa[In],ja);if(ni===null){bn===null&&(bn=Vn);break}Te&&bn&&ni.alternate===null&&Re(ha,bn),sa=er(ni,sa,In),ai===null?En=ni:ai.sibling=ni,ai=ni,bn=Vn}if(In===Aa.length)return Ue(ha,bn),Hn&&Is(ha,In),En;if(bn===null){for(;In<Aa.length;In++)bn=Ua(ha,Aa[In],ja),bn!==null&&(sa=er(bn,sa,In),ai===null?En=bn:ai.sibling=bn,ai=bn);return Hn&&Is(ha,In),En}for(bn=qe(bn);In<Aa.length;In++)Vn=Ra(bn,ha,In,Aa[In],ja),Vn!==null&&(Te&&Vn.alternate!==null&&bn.delete(Vn.key===null?In:Vn.key),sa=er(Vn,sa,In),ai===null?En=Vn:ai.sibling=Vn,ai=Vn);return Te&&bn.forEach(function(Nc){return Re(ha,Nc)}),Hn&&Is(ha,In),En}function Rn(ha,sa,Aa,ja){if(Aa==null)throw Error(n(151));for(var En=null,ai=null,bn=sa,In=sa=0,Vn=null,ni=Aa.next();bn!==null&&!ni.done;In++,ni=Aa.next()){bn.index>In?(Vn=bn,bn=null):Vn=bn.sibling;var Nc=Ta(ha,bn,ni.value,ja);if(Nc===null){bn===null&&(bn=Vn);break}Te&&bn&&Nc.alternate===null&&Re(ha,bn),sa=er(Nc,sa,In),ai===null?En=Nc:ai.sibling=Nc,ai=Nc,bn=Vn}if(ni.done)return Ue(ha,bn),Hn&&Is(ha,In),En;if(bn===null){for(;!ni.done;In++,ni=Aa.next())ni=Ua(ha,ni.value,ja),ni!==null&&(sa=er(ni,sa,In),ai===null?En=ni:ai.sibling=ni,ai=ni);return Hn&&Is(ha,In),En}for(bn=qe(bn);!ni.done;In++,ni=Aa.next())ni=Ra(bn,ha,In,ni.value,ja),ni!==null&&(Te&&ni.alternate!==null&&bn.delete(ni.key===null?In:ni.key),sa=er(ni,sa,In),ai===null?En=ni:ai.sibling=ni,ai=ni);return Te&&bn.forEach(function(tg){return Re(ha,tg)}),Hn&&Is(ha,In),En}function xi(ha,sa,Aa,ja){if(typeof Aa=="object"&&Aa!==null&&Aa.type===Ge&&Aa.key===null&&(Aa=Aa.props.children),typeof Aa=="object"&&Aa!==null){switch(Aa.$$typeof){case Xe:e:{for(var En=Aa.key;sa!==null;){if(sa.key===En){if(En=Aa.type,En===Ge){if(sa.tag===7){Ue(ha,sa.sibling),ja=Ze(sa,Aa.props.children),ja.return=ha,ha=ja;break e}}else if(sa.elementType===En||typeof En=="object"&&En!==null&&En.$$typeof===yr&&ma(En)===sa.type){Ue(ha,sa.sibling),ja=Ze(sa,Aa.props),Dn(ja,Aa),ja.return=ha,ha=ja;break e}Ue(ha,sa);break}else Re(ha,sa);sa=sa.sibling}Aa.type===Ge?(ja=ul(Aa.props.children,ha.mode,ja,Aa.key),ja.return=ha,ha=ja):(ja=oc(Aa.type,Aa.key,Aa.props,null,ha.mode,ja),Dn(ja,Aa),ja.return=ha,ha=ja)}return Tr(ha);case We:e:{for(En=Aa.key;sa!==null;){if(sa.key===En)if(sa.tag===4&&sa.stateNode.containerInfo===Aa.containerInfo&&sa.stateNode.implementation===Aa.implementation){Ue(ha,sa.sibling),ja=Ze(sa,Aa.children||[]),ja.return=ha,ha=ja;break e}else{Ue(ha,sa);break}else Re(ha,sa);sa=sa.sibling}ja=cc(Aa,ha.mode,ja),ja.return=ha,ha=ja}return Tr(ha);case yr:return Aa=ma(Aa),xi(ha,sa,Aa,ja)}if(Hr(Aa))return mn(ha,sa,Aa,ja);if(wr(Aa)){if(En=wr(Aa),typeof En!="function")throw Error(n(150));return Aa=En.call(Aa),Rn(ha,sa,Aa,ja)}if(typeof Aa.then=="function")return xi(ha,sa,cn(Aa),ja);if(Aa.$$typeof===tr)return xi(ha,sa,Eu(ha,Aa),ja);pn(ha,Aa)}return typeof Aa=="string"&&Aa!==""||typeof Aa=="number"||typeof Aa=="bigint"?(Aa=""+Aa,sa!==null&&sa.tag===6?(Ue(ha,sa.sibling),ja=Ze(sa,Aa),ja.return=ha,ha=ja):(Ue(ha,sa),ja=$c(Aa,ha.mode,ja),ja.return=ha,ha=ja),Tr(ha)):Ue(ha,sa)}return function(ha,sa,Aa,ja){try{xn=0;var En=xi(ha,sa,Aa,ja);return Ha=null,En}catch(bn){if(bn===na||bn===Vr)throw bn;var ai=gs(29,bn,null,ha.mode);return ai.lanes=ja,ai.return=ha,ai}finally{}}}var yi=zn(!0),On=zn(!1),un=!1;function rn(Te){Te.updateQueue={baseState:Te.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Ti(Te,Re){Te=Te.updateQueue,Re.updateQueue===Te&&(Re.updateQueue={baseState:Te.baseState,firstBaseUpdate:Te.firstBaseUpdate,lastBaseUpdate:Te.lastBaseUpdate,shared:Te.shared,callbacks:null})}function Cn(Te){return{lane:Te,tag:0,payload:null,callback:null,next:null}}function Pn(Te,Re,Ue){var qe=Te.updateQueue;if(qe===null)return null;if(qe=qe.shared,(li&2)!==0){var Ze=qe.pending;return Ze===null?Re.next=Re:(Re.next=Ze.next,Ze.next=Re),qe.pending=Re,Re=ps(Te),Yc(Te,null,Ue),Re}return Gc(Te,qe,Re,Ue),ps(Te)}function si(Te,Re,Ue){if(Re=Re.updateQueue,Re!==null&&(Re=Re.shared,(Ue&4194048)!==0)){var qe=Re.lanes;qe&=Te.pendingLanes,Ue|=qe,Re.lanes=Ue,Si(Te,Ue)}}function Zi(Te,Re){var Ue=Te.updateQueue,qe=Te.alternate;if(qe!==null&&(qe=qe.updateQueue,Ue===qe)){var Ze=null,er=null;if(Ue=Ue.firstBaseUpdate,Ue!==null){do{var Tr={lane:Ue.lane,tag:Ue.tag,payload:Ue.payload,callback:null,next:null};er===null?Ze=er=Tr:er=er.next=Tr,Ue=Ue.next}while(Ue!==null);er===null?Ze=er=Re:er=er.next=Re}else Ze=er=Re;Ue={baseState:qe.baseState,firstBaseUpdate:Ze,lastBaseUpdate:er,shared:qe.shared,callbacks:qe.callbacks},Te.updateQueue=Ue;return}Te=Ue.lastBaseUpdate,Te===null?Ue.firstBaseUpdate=Re:Te.next=Re,Ue.lastBaseUpdate=Re}var fs=!1;function gi(){if(fs){var Te=Qe;if(Te!==null)throw Te}}function zi(Te,Re,Ue,qe){fs=!1;var Ze=Te.updateQueue;un=!1;var er=Ze.firstBaseUpdate,Tr=Ze.lastBaseUpdate,jr=Ze.shared.pending;if(jr!==null){Ze.shared.pending=null;var ea=jr,Ea=ea.next;ea.next=null,Tr===null?er=Ea:Tr.next=Ea,Tr=ea;var Pa=Te.alternate;Pa!==null&&(Pa=Pa.updateQueue,jr=Pa.lastBaseUpdate,jr!==Tr&&(jr===null?Pa.firstBaseUpdate=Ea:jr.next=Ea,Pa.lastBaseUpdate=ea))}if(er!==null){var Ua=Ze.baseState;Tr=0,Pa=Ea=ea=null,jr=er;do{var Ta=jr.lane&-536870913,Ra=Ta!==jr.lane;if(Ra?(Wn&Ta)===Ta:(qe&Ta)===Ta){Ta!==0&&Ta===Ye&&(fs=!0),Pa!==null&&(Pa=Pa.next={lane:0,tag:jr.tag,payload:jr.payload,callback:null,next:null});e:{var mn=Te,Rn=jr;Ta=Re;var xi=Ue;switch(Rn.tag){case 1:if(mn=Rn.payload,typeof mn=="function"){Ua=mn.call(xi,Ua,Ta);break e}Ua=mn;break e;case 3:mn.flags=mn.flags&-65537|128;case 0:if(mn=Rn.payload,Ta=typeof mn=="function"?mn.call(xi,Ua,Ta):mn,Ta==null)break e;Ua=He({},Ua,Ta);break e;case 2:un=!0}}Ta=jr.callback,Ta!==null&&(Te.flags|=64,Ra&&(Te.flags|=8192),Ra=Ze.callbacks,Ra===null?Ze.callbacks=[Ta]:Ra.push(Ta))}else Ra={lane:Ta,tag:jr.tag,payload:jr.payload,callback:jr.callback,next:null},Pa===null?(Ea=Pa=Ra,ea=Ua):Pa=Pa.next=Ra,Tr|=Ta;if(jr=jr.next,jr===null){if(jr=Ze.shared.pending,jr===null)break;Ra=jr,jr=Ra.next,Ra.next=null,Ze.lastBaseUpdate=Ra,Ze.shared.pending=null}}while(!0);Pa===null&&(ea=Ua),Ze.baseState=ea,Ze.firstBaseUpdate=Ea,Ze.lastBaseUpdate=Pa,er===null&&(Ze.shared.lanes=0),yc|=Tr,Te.lanes=Tr,Te.memoizedState=Ua}}function ms(Te,Re){if(typeof Te!="function")throw Error(n(191,Te));Te.call(Re)}function Hi(Te,Re){var Ue=Te.callbacks;if(Ue!==null)for(Te.callbacks=null,Te=0;Te<Ue.length;Te++)ms(Ue[Te],Re)}var jn=ur(null),Zn=ur(0);function ki(Te,Re){Te=Gl,nr(Zn,Te),nr(jn,Re),Gl=Te|Re.baseLanes}function ri(){nr(Zn,Gl),nr(jn,jn.current)}function Ji(){Gl=Zn.current,Je(jn),Je(Zn)}var Ci=ur(null),Jn=null;function Bi(Te){var Re=Te.alternate;nr(Kn,Kn.current&1),nr(Ci,Te),Jn===null&&(Re===null||jn.current!==null||Re.memoizedState!==null)&&(Jn=Te)}function oi(Te){nr(Kn,Kn.current),nr(Ci,Te),Jn===null&&(Jn=Te)}function Xi(Te){Te.tag===22?(nr(Kn,Kn.current),nr(Ci,Te),Jn===null&&(Jn=Te)):qi()}function qi(){nr(Kn,Kn.current),nr(Ci,Ci.current)}function ui(Te){Je(Ci),Jn===Te&&(Jn=null),Je(Kn)}var Kn=ur(0);function _s(Te){for(var Re=Te;Re!==null;){if(Re.tag===13){var Ue=Re.memoizedState;if(Ue!==null&&(Ue=Ue.dehydrated,Ue===null||w0(Ue)||b0(Ue)))return Re}else if(Re.tag===19&&(Re.memoizedProps.revealOrder==="forwards"||Re.memoizedProps.revealOrder==="backwards"||Re.memoizedProps.revealOrder==="unstable_legacy-backwards"||Re.memoizedProps.revealOrder==="together")){if((Re.flags&128)!==0)return Re}else if(Re.child!==null){Re.child.return=Re,Re=Re.child;continue}if(Re===Te)break;for(;Re.sibling===null;){if(Re.return===null||Re.return===Te)return null;Re=Re.return}Re.sibling.return=Re.return,Re=Re.sibling}return null}var Fi=0,Sn=null,An=null,Qn=null,Ns=!1,Ks=!1,Es=!1,Wi=0,xl=0,vl=null,ku=0;function mi(){throw Error(n(321))}function ef(Te,Re){if(Re===null)return!1;for(var Ue=0;Ue<Re.length&&Ue<Te.length;Ue++)if(!ss(Te[Ue],Re[Ue]))return!1;return!0}function tf(Te,Re,Ue,qe,Ze,er){return Fi=er,Sn=Re,Re.memoizedState=null,Re.updateQueue=null,Re.lanes=0,Nr.H=Te===null||Te.memoizedState===null?$0:Lh,Es=!1,er=Ue(qe,Ze),Es=!1,Ks&&(er=Jo(Re,Ue,qe,Ze)),Cu(Te),er}function Cu(Te){Nr.H=uf;var Re=An!==null&&An.next!==null;if(Fi=0,Qn=An=Sn=null,Ns=!1,xl=0,vl=null,Re)throw Error(n(300));Te===null||rs||(Te=Te.dependencies,Te!==null&&Au(Te)&&(rs=!0))}function Jo(Te,Re,Ue,qe){Sn=Te;var Ze=0;do{if(Ks&&(vl=null),xl=0,Ks=!1,25<=Ze)throw Error(n(301));if(Ze+=1,Qn=An=null,Te.updateQueue!=null){var er=Te.updateQueue;er.lastEffect=null,er.events=null,er.stores=null,er.memoCache!=null&&(er.memoCache.index=0)}Nr.H=Z0,er=Re(Ue,qe)}while(Ks);return er}function Eh(){var Te=Nr.H,Re=Te.useState()[0];return Re=typeof Re.then=="function"?yl(Re):Re,Te=Te.useState()[0],(An!==null?An.memoizedState:null)!==Te&&(Sn.flags|=1024),Re}function rf(){var Te=Wi!==0;return Wi=0,Te}function af(Te,Re,Ue){Re.updateQueue=Te.updateQueue,Re.flags&=-2053,Te.lanes&=~Ue}function Ru(Te){if(Ns){for(Te=Te.memoizedState;Te!==null;){var Re=Te.queue;Re!==null&&(Re.pending=null),Te=Te.next}Ns=!1}Fi=0,Qn=An=Sn=null,Ks=!1,xl=Wi=0,vl=null}function ts(){var Te={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Qn===null?Sn.memoizedState=Qn=Te:Qn=Qn.next=Te,Qn}function Li(){if(An===null){var Te=Sn.alternate;Te=Te!==null?Te.memoizedState:null}else Te=An.next;var Re=Qn===null?Sn.memoizedState:Qn.next;if(Re!==null)Qn=Re,An=Te;else{if(Te===null)throw Sn.alternate===null?Error(n(467)):Error(n(310));An=Te,Te={memoizedState:An.memoizedState,baseState:An.baseState,baseQueue:An.baseQueue,queue:An.queue,next:null},Qn===null?Sn.memoizedState=Qn=Te:Qn=Qn.next=Te}return Qn}function eu(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function yl(Te){var Re=xl;return xl+=1,vl===null&&(vl=[]),Te=Ma(vl,Te,Re),Re=Sn,(Qn===null?Re.memoizedState:Qn.next)===null&&(Re=Re.alternate,Nr.H=Re===null||Re.memoizedState===null?$0:Lh),Te}function pc(Te){if(Te!==null&&typeof Te=="object"){if(typeof Te.then=="function")return yl(Te);if(Te.$$typeof===tr)return us(Te)}throw Error(n(438,String(Te)))}function Bl(Te){var Re=null,Ue=Sn.updateQueue;if(Ue!==null&&(Re=Ue.memoCache),Re==null){var qe=Sn.alternate;qe!==null&&(qe=qe.updateQueue,qe!==null&&(qe=qe.memoCache,qe!=null&&(Re={data:qe.data.map(function(Ze){return Ze.slice()}),index:0})))}if(Re==null&&(Re={data:[],index:0}),Ue===null&&(Ue=eu(),Sn.updateQueue=Ue),Ue.memoCache=Re,Ue=Re.data[Re.index],Ue===void 0)for(Ue=Re.data[Re.index]=Array(Te),qe=0;qe<Te;qe++)Ue[qe]=Rr;return Re.index++,Ue}function Co(Te,Re){return typeof Re=="function"?Re(Te):Re}function Nu(Te){var Re=Li();return gc(Re,An,Te)}function gc(Te,Re,Ue){var qe=Te.queue;if(qe===null)throw Error(n(311));qe.lastRenderedReducer=Ue;var Ze=Te.baseQueue,er=qe.pending;if(er!==null){if(Ze!==null){var Tr=Ze.next;Ze.next=er.next,er.next=Tr}Re.baseQueue=Ze=er,qe.pending=null}if(er=Te.baseState,Ze===null)Te.memoizedState=er;else{Re=Ze.next;var jr=Tr=null,ea=null,Ea=Re,Pa=!1;do{var Ua=Ea.lane&-536870913;if(Ua!==Ea.lane?(Wn&Ua)===Ua:(Fi&Ua)===Ua){var Ta=Ea.revertLane;if(Ta===0)ea!==null&&(ea=ea.next={lane:0,revertLane:0,gesture:null,action:Ea.action,hasEagerState:Ea.hasEagerState,eagerState:Ea.eagerState,next:null}),Ua===Ye&&(Pa=!0);else if((Fi&Ta)===Ta){Ea=Ea.next,Ta===Ye&&(Pa=!0);continue}else Ua={lane:0,revertLane:Ea.revertLane,gesture:null,action:Ea.action,hasEagerState:Ea.hasEagerState,eagerState:Ea.eagerState,next:null},ea===null?(jr=ea=Ua,Tr=er):ea=ea.next=Ua,Sn.lanes|=Ta,yc|=Ta;Ua=Ea.action,Es&&Ue(er,Ua),er=Ea.hasEagerState?Ea.eagerState:Ue(er,Ua)}else Ta={lane:Ua,revertLane:Ea.revertLane,gesture:Ea.gesture,action:Ea.action,hasEagerState:Ea.hasEagerState,eagerState:Ea.eagerState,next:null},ea===null?(jr=ea=Ta,Tr=er):ea=ea.next=Ta,Sn.lanes|=Ua,yc|=Ua;Ea=Ea.next}while(Ea!==null&&Ea!==Re);if(ea===null?Tr=er:ea.next=jr,!ss(er,Te.memoizedState)&&(rs=!0,Pa&&(Ue=Qe,Ue!==null)))throw Ue;Te.memoizedState=er,Te.baseState=Tr,Te.baseQueue=ea,qe.lastRenderedState=er}return Ze===null&&(qe.lanes=0),[Te.memoizedState,qe.dispatch]}function Fu(Te){var Re=Li(),Ue=Re.queue;if(Ue===null)throw Error(n(311));Ue.lastRenderedReducer=Te;var qe=Ue.dispatch,Ze=Ue.pending,er=Re.memoizedState;if(Ze!==null){Ue.pending=null;var Tr=Ze=Ze.next;do er=Te(er,Tr.action),Tr=Tr.next;while(Tr!==Ze);ss(er,Re.memoizedState)||(rs=!0),Re.memoizedState=er,Re.baseQueue===null&&(Re.baseState=er),Ue.lastRenderedState=er}return[er,qe]}function Lu(Te,Re,Ue){var qe=Sn,Ze=Li(),er=Hn;if(er){if(Ue===void 0)throw Error(n(407));Ue=Ue()}else Ue=Re();var Tr=!ss((An||Ze).memoizedState,Ue);if(Tr&&(Ze.memoizedState=Ue,rs=!0),Ze=Ze.queue,Th(sf.bind(null,qe,Ze,Te),[Te]),Ze.getSnapshot!==Re||Tr||Qn!==null&&Qn.memoizedState.tag&1){if(qe.flags|=2048,Ul(9,{destroy:void 0},nf.bind(null,qe,Ze,Ue,Re),null),wi===null)throw Error(n(349));er||(Fi&127)!==0||Qo(qe,Re,Ue)}return Ue}function Qo(Te,Re,Ue){Te.flags|=16384,Te={getSnapshot:Re,value:Ue},Re=Sn.updateQueue,Re===null?(Re=eu(),Sn.updateQueue=Re,Re.stores=[Te]):(Ue=Re.stores,Ue===null?Re.stores=[Te]:Ue.push(Te))}function nf(Te,Re,Ue,qe){Re.value=Ue,Re.getSnapshot=qe,Pf(Re)&&of(Te)}function sf(Te,Re,Ue){return Ue(function(){Pf(Re)&&of(Te)})}function Pf(Te){var Re=Te.getSnapshot;Te=Te.value;try{var Ue=Re();return!ss(Te,Ue)}catch{return!0}}function of(Te){var Re=$o(Te,2);Re!==null&&eo(Re,Te,2)}function wl(Te){var Re=ts();if(typeof Te=="function"){var Ue=Te;if(Te=Ue(),Es){aa(!0);try{Ue()}finally{aa(!1)}}}return Re.memoizedState=Re.baseState=Te,Re.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:Te},Re}function If(Te,Re,Ue,qe){return Te.baseState=Ue,gc(Te,An,typeof qe=="function"?qe:Co)}function Bf(Te,Re,Ue,qe,Ze){if(Hf(Te))throw Error(n(485));if(Te=Re.action,Te!==null){var er={payload:Ze,action:Te,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(Tr){er.listeners.push(Tr)}};Nr.T!==null?Ue(!0):er.isTransition=!1,qe(er),Ue=Re.pending,Ue===null?(er.next=Re.pending=er,jf(Re,er)):(er.next=Ue.next,Re.pending=Ue.next=er)}}function jf(Te,Re){var Ue=Re.action,qe=Re.payload,Ze=Te.state;if(Re.isTransition){var er=Nr.T,Tr={};Nr.T=Tr;try{var jr=Ue(Ze,qe),ea=Nr.S;ea!==null&&ea(Tr,jr),lf(Te,Re,jr)}catch(Ea){jl(Te,Re,Ea)}finally{er!==null&&Tr.types!==null&&(er.types=Tr.types),Nr.T=er}}else try{er=Ue(Ze,qe),lf(Te,Re,er)}catch(Ea){jl(Te,Re,Ea)}}function lf(Te,Re,Ue){Ue!==null&&typeof Ue=="object"&&typeof Ue.then=="function"?Ue.then(function(qe){Uf(Te,Re,qe)},function(qe){return jl(Te,Re,qe)}):Uf(Te,Re,Ue)}function Uf(Te,Re,Ue){Re.status="fulfilled",Re.value=Ue,Du(Re),Te.state=Ue,Re=Te.pending,Re!==null&&(Ue=Re.next,Ue===Re?Te.pending=null:(Ue=Ue.next,Re.next=Ue,jf(Te,Ue)))}function jl(Te,Re,Ue){var qe=Te.pending;if(Te.pending=null,qe!==null){qe=qe.next;do Re.status="rejected",Re.reason=Ue,Du(Re),Re=Re.next;while(Re!==qe)}Te.action=null}function Du(Te){Te=Te.listeners;for(var Re=0;Re<Te.length;Re++)(0,Te[Re])()}function tu(Te,Re){return Re}function Ro(Te,Re){if(Hn){var Ue=wi.formState;if(Ue!==null){e:{var qe=Sn;if(Hn){if(vi){t:{for(var Ze=vi,er=Ni;Ze.nodeType!==8;){if(!er){Ze=null;break t}if(Ze=No(Ze.nextSibling),Ze===null){Ze=null;break t}}er=Ze.data,Ze=er==="F!"||er==="F"?Ze:null}if(Ze){vi=No(Ze.nextSibling),qe=Ze.data==="F!";break e}}dl(qe)}qe=!1}qe&&(Re=Ue[0])}}return Ue=ts(),Ue.memoizedState=Ue.baseState=Re,qe={pending:null,lanes:0,dispatch:null,lastRenderedReducer:tu,lastRenderedState:Re},Ue.queue=qe,Ue=G0.bind(null,Sn,qe),qe.dispatch=Ue,qe=wl(!1),er=Fh.bind(null,Sn,!1,qe.queue),qe=ts(),Ze={state:Re,dispatch:null,action:Te,pending:null},qe.queue=Ze,Ue=Bf.bind(null,Sn,Ze,er,Ue),Ze.dispatch=Ue,qe.memoizedState=Te,[Re,Ue,!1]}function el(Te){var Re=Li();return tl(Re,An,Te)}function tl(Te,Re,Ue){if(Re=gc(Te,Re,tu)[0],Te=Nu(Co)[0],typeof Re=="object"&&Re!==null&&typeof Re.then=="function")try{var qe=yl(Re)}catch(Tr){throw Tr===na?Vr:Tr}else qe=Re;Re=Li();var Ze=Re.queue,er=Ze.dispatch;return Ue!==Re.memoizedState&&(Sn.flags|=2048,Ul(9,{destroy:void 0},Mu.bind(null,Ze,Ue),null)),[qe,er,Te]}function Mu(Te,Re){Te.action=Re}function Ou(Te){var Re=Li(),Ue=An;if(Ue!==null)return tl(Re,Ue,Te);Li(),Re=Re.memoizedState,Ue=Li();var qe=Ue.queue.dispatch;return Ue.memoizedState=Te,[Re,qe,!1]}function Ul(Te,Re,Ue,qe){return Te={tag:Te,create:Ue,deps:qe,inst:Re,next:null},Re=Sn.updateQueue,Re===null&&(Re=eu(),Sn.updateQueue=Re),Ue=Re.lastEffect,Ue===null?Re.lastEffect=Te.next=Te:(qe=Ue.next,Ue.next=Te,Te.next=qe,Re.lastEffect=Te),Te}function zf(){return Li().memoizedState}function mc(Te,Re,Ue,qe){var Ze=ts();Sn.flags|=Te,Ze.memoizedState=Ul(1|Re,{destroy:void 0},Ue,qe===void 0?null:qe)}function _c(Te,Re,Ue,qe){var Ze=Li();qe=qe===void 0?null:qe;var er=Ze.memoizedState.inst;An!==null&&qe!==null&&ef(qe,An.memoizedState.deps)?Ze.memoizedState=Ul(Re,er,Ue,qe):(Sn.flags|=Te,Ze.memoizedState=Ul(1|Re,er,Ue,qe))}function D0(Te,Re){mc(8390656,8,Te,Re)}function Th(Te,Re){_c(2048,8,Te,Re)}function Kp(Te){Sn.flags|=4;var Re=Sn.updateQueue;if(Re===null)Re=eu(),Sn.updateQueue=Re,Re.events=[Te];else{var Ue=Re.events;Ue===null?Re.events=[Te]:Ue.push(Te)}}function M0(Te){var Re=Li().memoizedState;return Kp({ref:Re,nextImpl:Te}),function(){if((li&2)!==0)throw Error(n(440));return Re.impl.apply(void 0,arguments)}}function O0(Te,Re){return _c(4,2,Te,Re)}function P0(Te,Re){return _c(4,4,Te,Re)}function I0(Te,Re){if(typeof Re=="function"){Te=Te();var Ue=Re(Te);return function(){typeof Ue=="function"?Ue():Re(null)}}if(Re!=null)return Te=Te(),Re.current=Te,function(){Re.current=null}}function B0(Te,Re,Ue){Ue=Ue!=null?Ue.concat([Te]):null,_c(4,4,I0.bind(null,Re,Te),Ue)}function kh(){}function j0(Te,Re){var Ue=Li();Re=Re===void 0?null:Re;var qe=Ue.memoizedState;return Re!==null&&ef(Re,qe[1])?qe[0]:(Ue.memoizedState=[Te,Re],Te)}function U0(Te,Re){var Ue=Li();Re=Re===void 0?null:Re;var qe=Ue.memoizedState;if(Re!==null&&ef(Re,qe[1]))return qe[0];if(qe=Te(),Es){aa(!0);try{Te()}finally{aa(!1)}}return Ue.memoizedState=[qe,Re],qe}function Ch(Te,Re,Ue){return Ue===void 0||(Fi&1073741824)!==0&&(Wn&261930)===0?Te.memoizedState=Re:(Te.memoizedState=Ue,Te=Hd(),Sn.lanes|=Te,yc|=Te,Ue)}function z0(Te,Re,Ue,qe){return ss(Ue,Re)?Ue:jn.current!==null?(Te=Ch(Te,Ue,qe),ss(Te,Re)||(rs=!0),Te):(Fi&42)===0||(Fi&1073741824)!==0&&(Wn&261930)===0?(rs=!0,Te.memoizedState=Ue):(Te=Hd(),Sn.lanes|=Te,yc|=Te,Re)}function H0(Te,Re,Ue,qe,Ze){var er=Ar.p;Ar.p=er!==0&&8>er?er:8;var Tr=Nr.T,jr={};Nr.T=jr,Fh(Te,!1,Re,Ue);try{var ea=Ze(),Ea=Nr.S;if(Ea!==null&&Ea(jr,ea),ea!==null&&typeof ea=="object"&&typeof ea.then=="function"){var Pa=Dr(ea,qe);cf(Te,Re,Pa,go(Te))}else cf(Te,Re,qe,go(Te))}catch(Ua){cf(Te,Re,{then:function(){},status:"rejected",reason:Ua},go())}finally{Ar.p=er,Tr!==null&&jr.types!==null&&(Tr.types=jr.types),Nr.T=Tr}}function $p(){}function Rh(Te,Re,Ue,qe){if(Te.tag!==5)throw Error(n(476));var Ze=X0(Te).queue;H0(Te,Ze,Re,xr,Ue===null?$p:function(){return q0(Te),Ue(qe)})}function X0(Te){var Re=Te.memoizedState;if(Re!==null)return Re;Re={memoizedState:xr,baseState:xr,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:xr},next:null};var Ue={};return Re.next={memoizedState:Ue,baseState:Ue,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Co,lastRenderedState:Ue},next:null},Te.memoizedState=Re,Te=Te.alternate,Te!==null&&(Te.memoizedState=Re),Re}function q0(Te){var Re=X0(Te);Re.next===null&&(Re=Te.alternate.memoizedState),cf(Te,Re.next.queue,{},go())}function Nh(){return us(Tf)}function W0(){return Li().memoizedState}function V0(){return Li().memoizedState}function Zp(Te){for(var Re=Te.return;Re!==null;){switch(Re.tag){case 24:case 3:var Ue=go();Te=Cn(Ue);var qe=Pn(Re,Te,Ue);qe!==null&&(eo(qe,Re,Ue),si(qe,Re,Ue)),Re={cache:dc()},Te.payload=Re;return}Re=Re.return}}function Jp(Te,Re,Ue){var qe=go();Ue={lane:qe,revertLane:0,gesture:null,action:Ue,hasEagerState:!1,eagerState:null,next:null},Hf(Te)?Y0(Re,Ue):(Ue=mu(Te,Re,Ue,qe),Ue!==null&&(eo(Ue,Te,qe),K0(Ue,Re,qe)))}function G0(Te,Re,Ue){var qe=go();cf(Te,Re,Ue,qe)}function cf(Te,Re,Ue,qe){var Ze={lane:qe,revertLane:0,gesture:null,action:Ue,hasEagerState:!1,eagerState:null,next:null};if(Hf(Te))Y0(Re,Ze);else{var er=Te.alternate;if(Te.lanes===0&&(er===null||er.lanes===0)&&(er=Re.lastRenderedReducer,er!==null))try{var Tr=Re.lastRenderedState,jr=er(Tr,Ue);if(Ze.hasEagerState=!0,Ze.eagerState=jr,ss(jr,Tr))return Gc(Te,Re,Ze,0),wi===null&&Vc(),!1}catch{}finally{}if(Ue=mu(Te,Re,Ze,qe),Ue!==null)return eo(Ue,Te,qe),K0(Ue,Re,qe),!0}return!1}function Fh(Te,Re,Ue,qe){if(qe={lane:2,revertLane:c0(),gesture:null,action:qe,hasEagerState:!1,eagerState:null,next:null},Hf(Te)){if(Re)throw Error(n(479))}else Re=mu(Te,Ue,qe,2),Re!==null&&eo(Re,Te,2)}function Hf(Te){var Re=Te.alternate;return Te===Sn||Re!==null&&Re===Sn}function Y0(Te,Re){Ks=Ns=!0;var Ue=Te.pending;Ue===null?Re.next=Re:(Re.next=Ue.next,Ue.next=Re),Te.pending=Re}function K0(Te,Re,Ue){if((Ue&4194048)!==0){var qe=Re.lanes;qe&=Te.pendingLanes,Ue|=qe,Re.lanes=Ue,Si(Te,Ue)}}var uf={readContext:us,use:pc,useCallback:mi,useContext:mi,useEffect:mi,useImperativeHandle:mi,useLayoutEffect:mi,useInsertionEffect:mi,useMemo:mi,useReducer:mi,useRef:mi,useState:mi,useDebugValue:mi,useDeferredValue:mi,useTransition:mi,useSyncExternalStore:mi,useId:mi,useHostTransitionStatus:mi,useFormState:mi,useActionState:mi,useOptimistic:mi,useMemoCache:mi,useCacheRefresh:mi};uf.useEffectEvent=mi;var $0={readContext:us,use:pc,useCallback:function(Te,Re){return ts().memoizedState=[Te,Re===void 0?null:Re],Te},useContext:us,useEffect:D0,useImperativeHandle:function(Te,Re,Ue){Ue=Ue!=null?Ue.concat([Te]):null,mc(4194308,4,I0.bind(null,Re,Te),Ue)},useLayoutEffect:function(Te,Re){return mc(4194308,4,Te,Re)},useInsertionEffect:function(Te,Re){mc(4,2,Te,Re)},useMemo:function(Te,Re){var Ue=ts();Re=Re===void 0?null:Re;var qe=Te();if(Es){aa(!0);try{Te()}finally{aa(!1)}}return Ue.memoizedState=[qe,Re],qe},useReducer:function(Te,Re,Ue){var qe=ts();if(Ue!==void 0){var Ze=Ue(Re);if(Es){aa(!0);try{Ue(Re)}finally{aa(!1)}}}else Ze=Re;return qe.memoizedState=qe.baseState=Ze,Te={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Te,lastRenderedState:Ze},qe.queue=Te,Te=Te.dispatch=Jp.bind(null,Sn,Te),[qe.memoizedState,Te]},useRef:function(Te){var Re=ts();return Te={current:Te},Re.memoizedState=Te},useState:function(Te){Te=wl(Te);var Re=Te.queue,Ue=G0.bind(null,Sn,Re);return Re.dispatch=Ue,[Te.memoizedState,Ue]},useDebugValue:kh,useDeferredValue:function(Te,Re){var Ue=ts();return Ch(Ue,Te,Re)},useTransition:function(){var Te=wl(!1);return Te=H0.bind(null,Sn,Te.queue,!0,!1),ts().memoizedState=Te,[!1,Te]},useSyncExternalStore:function(Te,Re,Ue){var qe=Sn,Ze=ts();if(Hn){if(Ue===void 0)throw Error(n(407));Ue=Ue()}else{if(Ue=Re(),wi===null)throw Error(n(349));(Wn&127)!==0||Qo(qe,Re,Ue)}Ze.memoizedState=Ue;var er={value:Ue,getSnapshot:Re};return Ze.queue=er,D0(sf.bind(null,qe,er,Te),[Te]),qe.flags|=2048,Ul(9,{destroy:void 0},nf.bind(null,qe,er,Ue,Re),null),Ue},useId:function(){var Te=ts(),Re=wi.identifierPrefix;if(Hn){var Ue=Gs,qe=Vs;Ue=(qe&~(1<<32-ia(qe)-1)).toString(32)+Ue,Re="_"+Re+"R_"+Ue,Ue=Wi++,0<Ue&&(Re+="H"+Ue.toString(32)),Re+="_"}else Ue=ku++,Re="_"+Re+"r_"+Ue.toString(32)+"_";return Te.memoizedState=Re},useHostTransitionStatus:Nh,useFormState:Ro,useActionState:Ro,useOptimistic:function(Te){var Re=ts();Re.memoizedState=Re.baseState=Te;var Ue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return Re.queue=Ue,Re=Fh.bind(null,Sn,!0,Ue),Ue.dispatch=Re,[Te,Re]},useMemoCache:Bl,useCacheRefresh:function(){return ts().memoizedState=Zp.bind(null,Sn)},useEffectEvent:function(Te){var Re=ts(),Ue={impl:Te};return Re.memoizedState=Ue,function(){if((li&2)!==0)throw Error(n(440));return Ue.impl.apply(void 0,arguments)}}},Lh={readContext:us,use:pc,useCallback:j0,useContext:us,useEffect:Th,useImperativeHandle:B0,useInsertionEffect:O0,useLayoutEffect:P0,useMemo:U0,useReducer:Nu,useRef:zf,useState:function(){return Nu(Co)},useDebugValue:kh,useDeferredValue:function(Te,Re){var Ue=Li();return z0(Ue,An.memoizedState,Te,Re)},useTransition:function(){var Te=Nu(Co)[0],Re=Li().memoizedState;return[typeof Te=="boolean"?Te:yl(Te),Re]},useSyncExternalStore:Lu,useId:W0,useHostTransitionStatus:Nh,useFormState:el,useActionState:el,useOptimistic:function(Te,Re){var Ue=Li();return If(Ue,An,Te,Re)},useMemoCache:Bl,useCacheRefresh:V0};Lh.useEffectEvent=M0;var Z0={readContext:us,use:pc,useCallback:j0,useContext:us,useEffect:Th,useImperativeHandle:B0,useInsertionEffect:O0,useLayoutEffect:P0,useMemo:U0,useReducer:Fu,useRef:zf,useState:function(){return Fu(Co)},useDebugValue:kh,useDeferredValue:function(Te,Re){var Ue=Li();return An===null?Ch(Ue,Te,Re):z0(Ue,An.memoizedState,Te,Re)},useTransition:function(){var Te=Fu(Co)[0],Re=Li().memoizedState;return[typeof Te=="boolean"?Te:yl(Te),Re]},useSyncExternalStore:Lu,useId:W0,useHostTransitionStatus:Nh,useFormState:Ou,useActionState:Ou,useOptimistic:function(Te,Re){var Ue=Li();return An!==null?If(Ue,An,Te,Re):(Ue.baseState=Te,[Te,Ue.queue.dispatch])},useMemoCache:Bl,useCacheRefresh:V0};Z0.useEffectEvent=M0;function Dh(Te,Re,Ue,qe){Re=Te.memoizedState,Ue=Ue(qe,Re),Ue=Ue==null?Re:He({},Re,Ue),Te.memoizedState=Ue,Te.lanes===0&&(Te.updateQueue.baseState=Ue)}var Mh={enqueueSetState:function(Te,Re,Ue){Te=Te._reactInternals;var qe=go(),Ze=Cn(qe);Ze.payload=Re,Ue!=null&&(Ze.callback=Ue),Re=Pn(Te,Ze,qe),Re!==null&&(eo(Re,Te,qe),si(Re,Te,qe))},enqueueReplaceState:function(Te,Re,Ue){Te=Te._reactInternals;var qe=go(),Ze=Cn(qe);Ze.tag=1,Ze.payload=Re,Ue!=null&&(Ze.callback=Ue),Re=Pn(Te,Ze,qe),Re!==null&&(eo(Re,Te,qe),si(Re,Te,qe))},enqueueForceUpdate:function(Te,Re){Te=Te._reactInternals;var Ue=go(),qe=Cn(Ue);qe.tag=2,Re!=null&&(qe.callback=Re),Re=Pn(Te,qe,Ue),Re!==null&&(eo(Re,Te,Ue),si(Re,Te,Ue))}};function J0(Te,Re,Ue,qe,Ze,er,Tr){return Te=Te.stateNode,typeof Te.shouldComponentUpdate=="function"?Te.shouldComponentUpdate(qe,er,Tr):Re.prototype&&Re.prototype.isPureReactComponent?!Vo(Ue,qe)||!Vo(Ze,er):!0}function Q0(Te,Re,Ue,qe){Te=Re.state,typeof Re.componentWillReceiveProps=="function"&&Re.componentWillReceiveProps(Ue,qe),typeof Re.UNSAFE_componentWillReceiveProps=="function"&&Re.UNSAFE_componentWillReceiveProps(Ue,qe),Re.state!==Te&&Mh.enqueueReplaceState(Re,Re.state,null)}function ru(Te,Re){var Ue=Re;if("ref"in Re){Ue={};for(var qe in Re)qe!=="ref"&&(Ue[qe]=Re[qe])}if(Te=Te.defaultProps){Ue===Re&&(Ue=He({},Ue));for(var Ze in Te)Ue[Ze]===void 0&&(Ue[Ze]=Te[Ze])}return Ue}function ed(Te){Wc(Te)}function rd(Te){console.error(Te)}function ad(Te){Wc(Te)}function Xf(Te,Re){try{var Ue=Te.onUncaughtError;Ue(Re.value,{componentStack:Re.stack})}catch(qe){setTimeout(function(){throw qe})}}function nd(Te,Re,Ue){try{var qe=Te.onCaughtError;qe(Ue.value,{componentStack:Ue.stack,errorBoundary:Re.tag===1?Re.stateNode:null})}catch(Ze){setTimeout(function(){throw Ze})}}function Oh(Te,Re,Ue){return Ue=Cn(Ue),Ue.tag=3,Ue.payload={element:null},Ue.callback=function(){Xf(Te,Re)},Ue}function id(Te){return Te=Cn(Te),Te.tag=3,Te}function sd(Te,Re,Ue,qe){var Ze=Ue.type.getDerivedStateFromError;if(typeof Ze=="function"){var er=qe.value;Te.payload=function(){return Ze(er)},Te.callback=function(){nd(Re,Ue,qe)}}var Tr=Ue.stateNode;Tr!==null&&typeof Tr.componentDidCatch=="function"&&(Te.callback=function(){nd(Re,Ue,qe),typeof Ze!="function"&&(wc===null?wc=new Set([this]):wc.add(this));var jr=qe.stack;this.componentDidCatch(qe.value,{componentStack:jr!==null?jr:""})})}function Qp(Te,Re,Ue,qe,Ze){if(Ue.flags|=32768,qe!==null&&typeof qe=="object"&&typeof qe.then=="function"){if(Re=Ue.alternate,Re!==null&&ml(Re,Ue,Ze,!0),Ue=Ci.current,Ue!==null){switch(Ue.tag){case 31:case 13:return Jn===null?th():Ue.alternate===null&&Vi===0&&(Vi=3),Ue.flags&=-257,Ue.flags|=65536,Ue.lanes=Ze,qe===la?Ue.flags|=16384:(Re=Ue.updateQueue,Re===null?Ue.updateQueue=new Set([qe]):Re.add(qe),s0(Te,qe,Ze)),!1;case 22:return Ue.flags|=65536,qe===la?Ue.flags|=16384:(Re=Ue.updateQueue,Re===null?(Re={transitions:null,markerInstances:null,retryQueue:new Set([qe])},Ue.updateQueue=Re):(Ue=Re.retryQueue,Ue===null?Re.retryQueue=new Set([qe]):Ue.add(qe)),s0(Te,qe,Ze)),!1}throw Error(n(435,Ue.tag))}return s0(Te,qe,Ze),th(),!1}if(Hn)return Re=Ci.current,Re!==null?((Re.flags&65536)===0&&(Re.flags|=256),Re.flags|=65536,Re.lanes=Ze,qe!==fo&&(Te=Error(n(422),{cause:qe}),fc(Xs(Te,Ue)))):(qe!==fo&&(Re=Error(n(423),{cause:qe}),fc(Xs(Re,Ue))),Te=Te.current.alternate,Te.flags|=65536,Ze&=-Ze,Te.lanes|=Ze,qe=Xs(qe,Ue),Ze=Oh(Te.stateNode,qe,Ze),Zi(Te,Ze),Vi!==4&&(Vi=2)),!1;var er=Error(n(520),{cause:qe});if(er=Xs(er,Ue),xf===null?xf=[er]:xf.push(er),Vi!==4&&(Vi=2),Re===null)return!0;qe=Xs(qe,Ue),Ue=Re;do{switch(Ue.tag){case 3:return Ue.flags|=65536,Te=Ze&-Ze,Ue.lanes|=Te,Te=Oh(Ue.stateNode,qe,Te),Zi(Ue,Te),!1;case 1:if(Re=Ue.type,er=Ue.stateNode,(Ue.flags&128)===0&&(typeof Re.getDerivedStateFromError=="function"||er!==null&&typeof er.componentDidCatch=="function"&&(wc===null||!wc.has(er))))return Ue.flags|=65536,Ze&=-Ze,Ue.lanes|=Ze,Ze=id(Ze),sd(Ze,Te,Ue,qe),Zi(Ue,Ze),!1}Ue=Ue.return}while(Ue!==null);return!1}var Ph=Error(n(461)),rs=!1;function Ts(Te,Re,Ue,qe){Re.child=Te===null?On(Re,null,Ue,qe):yi(Re,Te.child,Ue,qe)}function od(Te,Re,Ue,qe,Ze){Ue=Ue.render;var er=Re.ref;if("ref"in qe){var Tr={};for(var jr in qe)jr!=="ref"&&(Tr[jr]=qe[jr])}else Tr=qe;return _l(Re),qe=tf(Te,Re,Ue,Tr,er,Ze),jr=rf(),Te!==null&&!rs?(af(Te,Re,Ze),zl(Te,Re,Ze)):(Hn&&jr&&Zu(Re),Re.flags|=1,Ts(Te,Re,qe,Ze),Re.child)}function ld(Te,Re,Ue,qe,Ze){if(Te===null){var er=Ue.type;return typeof er=="function"&&!xu(er)&&er.defaultProps===void 0&&Ue.compare===null?(Re.tag=15,Re.type=er,cd(Te,Re,er,qe,Ze)):(Te=oc(Ue.type,null,qe,Re,Re.mode,Ze),Te.ref=Re.ref,Te.return=Re,Re.child=Te)}if(er=Te.child,!qh(Te,Ze)){var Tr=er.memoizedProps;if(Ue=Ue.compare,Ue=Ue!==null?Ue:Vo,Ue(Tr,qe)&&Te.ref===Re.ref)return zl(Te,Re,Ze)}return Re.flags|=1,Te=Hs(er,qe),Te.ref=Re.ref,Te.return=Re,Re.child=Te}function cd(Te,Re,Ue,qe,Ze){if(Te!==null){var er=Te.memoizedProps;if(Vo(er,qe)&&Te.ref===Re.ref)if(rs=!1,Re.pendingProps=qe=er,qh(Te,Ze))(Te.flags&131072)!==0&&(rs=!0);else return Re.lanes=Te.lanes,zl(Te,Re,Ze)}return Ih(Te,Re,Ue,qe,Ze)}function ud(Te,Re,Ue,qe){var Ze=qe.children,er=Te!==null?Te.memoizedState:null;if(Te===null&&Re.stateNode===null&&(Re.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),qe.mode==="hidden"){if((Re.flags&128)!==0){if(er=er!==null?er.baseLanes|Ue:Ue,Te!==null){for(qe=Re.child=Te.child,Ze=0;qe!==null;)Ze=Ze|qe.lanes|qe.childLanes,qe=qe.sibling;qe=Ze&~er}else qe=0,Re.child=null;return fd(Te,Re,er,Ue,qe)}if((Ue&536870912)!==0)Re.memoizedState={baseLanes:0,cachePool:null},Te!==null&&qr(Re,er!==null?er.cachePool:null),er!==null?ki(Re,er):ri(),Xi(Re);else return qe=Re.lanes=536870912,fd(Te,Re,er!==null?er.baseLanes|Ue:Ue,Ue,qe)}else er!==null?(qr(Re,er.cachePool),ki(Re,er),qi(),Re.memoizedState=null):(Te!==null&&qr(Re,null),ri(),qi());return Ts(Te,Re,Ze,Ue),Re.child}function ff(Te,Re){return Te!==null&&Te.tag===22||Re.stateNode!==null||(Re.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),Re.sibling}function fd(Te,Re,Ue,qe,Ze){var er=Ur();return er=er===null?null:{parent:Ii._currentValue,pool:er},Re.memoizedState={baseLanes:Ue,cachePool:er},Te!==null&&qr(Re,null),ri(),Xi(Re),Te!==null&&ml(Te,Re,qe,!0),Re.childLanes=Ze,null}function qf(Te,Re){return Re=Vf({mode:Re.mode,children:Re.children},Te.mode),Re.ref=Te.ref,Te.child=Re,Re.return=Te,Re}function hd(Te,Re,Ue){return yi(Re,Te.child,null,Ue),Te=qf(Re,Re.pendingProps),Te.flags|=2,ui(Re),Re.memoizedState=null,Te}function e1(Te,Re,Ue){var qe=Re.pendingProps,Ze=(Re.flags&128)!==0;if(Re.flags&=-129,Te===null){if(Hn){if(qe.mode==="hidden")return Te=qf(Re,qe),Re.lanes=536870912,ff(null,Te);if(oi(Re),(Te=vi)?(Te=Ap(Te,Ni),Te=Te!==null&&Te.data==="&"?Te:null,Te!==null&&(Re.memoizedState={dehydrated:Te,treeContext:hl!==null?{id:Vs,overflow:Gs}:null,retryLane:536870912,hydrationErrors:null},Ue=vu(Te),Ue.return=Re,Re.child=Ue,ls=Re,vi=null)):Te=null,Te===null)throw dl(Re);return Re.lanes=536870912,null}return qf(Re,qe)}var er=Te.memoizedState;if(er!==null){var Tr=er.dehydrated;if(oi(Re),Ze)if(Re.flags&256)Re.flags&=-257,Re=hd(Te,Re,Ue);else if(Re.memoizedState!==null)Re.child=Te.child,Re.flags|=128,Re=null;else throw Error(n(558));else if(rs||ml(Te,Re,Ue,!1),Ze=(Ue&Te.childLanes)!==0,rs||Ze){if(qe=wi,qe!==null&&(Tr=bi(qe,Ue),Tr!==0&&Tr!==er.retryLane))throw er.retryLane=Tr,$o(Te,Tr),eo(qe,Te,Tr),Ph;th(),Re=hd(Te,Re,Ue)}else Te=er.treeContext,vi=No(Tr.nextSibling),ls=Re,Hn=!0,As=null,Ni=!1,Te!==null&&Mf(Re,Te),Re=qf(Re,qe),Re.flags|=4096;return Re}return Te=Hs(Te.child,{mode:qe.mode,children:qe.children}),Te.ref=Re.ref,Re.child=Te,Te.return=Re,Te}function Wf(Te,Re){var Ue=Re.ref;if(Ue===null)Te!==null&&Te.ref!==null&&(Re.flags|=4194816);else{if(typeof Ue!="function"&&typeof Ue!="object")throw Error(n(284));(Te===null||Te.ref!==Ue)&&(Re.flags|=4194816)}}function Ih(Te,Re,Ue,qe,Ze){return _l(Re),Ue=tf(Te,Re,Ue,qe,void 0,Ze),qe=rf(),Te!==null&&!rs?(af(Te,Re,Ze),zl(Te,Re,Ze)):(Hn&&qe&&Zu(Re),Re.flags|=1,Ts(Te,Re,Ue,Ze),Re.child)}function dd(Te,Re,Ue,qe,Ze,er){return _l(Re),Re.updateQueue=null,Ue=Jo(Re,qe,Ue,Ze),Cu(Te),qe=rf(),Te!==null&&!rs?(af(Te,Re,er),zl(Te,Re,er)):(Hn&&qe&&Zu(Re),Re.flags|=1,Ts(Te,Re,Ue,er),Re.child)}function pd(Te,Re,Ue,qe,Ze){if(_l(Re),Re.stateNode===null){var er=os,Tr=Ue.contextType;typeof Tr=="object"&&Tr!==null&&(er=us(Tr)),er=new Ue(qe,er),Re.memoizedState=er.state!==null&&er.state!==void 0?er.state:null,er.updater=Mh,Re.stateNode=er,er._reactInternals=Re,er=Re.stateNode,er.props=qe,er.state=Re.memoizedState,er.refs={},rn(Re),Tr=Ue.contextType,er.context=typeof Tr=="object"&&Tr!==null?us(Tr):os,er.state=Re.memoizedState,Tr=Ue.getDerivedStateFromProps,typeof Tr=="function"&&(Dh(Re,Ue,Tr,qe),er.state=Re.memoizedState),typeof Ue.getDerivedStateFromProps=="function"||typeof er.getSnapshotBeforeUpdate=="function"||typeof er.UNSAFE_componentWillMount!="function"&&typeof er.componentWillMount!="function"||(Tr=er.state,typeof er.componentWillMount=="function"&&er.componentWillMount(),typeof er.UNSAFE_componentWillMount=="function"&&er.UNSAFE_componentWillMount(),Tr!==er.state&&Mh.enqueueReplaceState(er,er.state,null),zi(Re,qe,er,Ze),gi(),er.state=Re.memoizedState),typeof er.componentDidMount=="function"&&(Re.flags|=4194308),qe=!0}else if(Te===null){er=Re.stateNode;var jr=Re.memoizedProps,ea=ru(Ue,jr);er.props=ea;var Ea=er.context,Pa=Ue.contextType;Tr=os,typeof Pa=="object"&&Pa!==null&&(Tr=us(Pa));var Ua=Ue.getDerivedStateFromProps;Pa=typeof Ua=="function"||typeof er.getSnapshotBeforeUpdate=="function",jr=Re.pendingProps!==jr,Pa||typeof er.UNSAFE_componentWillReceiveProps!="function"&&typeof er.componentWillReceiveProps!="function"||(jr||Ea!==Tr)&&Q0(Re,er,qe,Tr),un=!1;var Ta=Re.memoizedState;er.state=Ta,zi(Re,qe,er,Ze),gi(),Ea=Re.memoizedState,jr||Ta!==Ea||un?(typeof Ua=="function"&&(Dh(Re,Ue,Ua,qe),Ea=Re.memoizedState),(ea=un||J0(Re,Ue,ea,qe,Ta,Ea,Tr))?(Pa||typeof er.UNSAFE_componentWillMount!="function"&&typeof er.componentWillMount!="function"||(typeof er.componentWillMount=="function"&&er.componentWillMount(),typeof er.UNSAFE_componentWillMount=="function"&&er.UNSAFE_componentWillMount()),typeof er.componentDidMount=="function"&&(Re.flags|=4194308)):(typeof er.componentDidMount=="function"&&(Re.flags|=4194308),Re.memoizedProps=qe,Re.memoizedState=Ea),er.props=qe,er.state=Ea,er.context=Tr,qe=ea):(typeof er.componentDidMount=="function"&&(Re.flags|=4194308),qe=!1)}else{er=Re.stateNode,Ti(Te,Re),Tr=Re.memoizedProps,Pa=ru(Ue,Tr),er.props=Pa,Ua=Re.pendingProps,Ta=er.context,Ea=Ue.contextType,ea=os,typeof Ea=="object"&&Ea!==null&&(ea=us(Ea)),jr=Ue.getDerivedStateFromProps,(Ea=typeof jr=="function"||typeof er.getSnapshotBeforeUpdate=="function")||typeof er.UNSAFE_componentWillReceiveProps!="function"&&typeof er.componentWillReceiveProps!="function"||(Tr!==Ua||Ta!==ea)&&Q0(Re,er,qe,ea),un=!1,Ta=Re.memoizedState,er.state=Ta,zi(Re,qe,er,Ze),gi();var Ra=Re.memoizedState;Tr!==Ua||Ta!==Ra||un||Te!==null&&Te.dependencies!==null&&Au(Te.dependencies)?(typeof jr=="function"&&(Dh(Re,Ue,jr,qe),Ra=Re.memoizedState),(Pa=un||J0(Re,Ue,Pa,qe,Ta,Ra,ea)||Te!==null&&Te.dependencies!==null&&Au(Te.dependencies))?(Ea||typeof er.UNSAFE_componentWillUpdate!="function"&&typeof er.componentWillUpdate!="function"||(typeof er.componentWillUpdate=="function"&&er.componentWillUpdate(qe,Ra,ea),typeof er.UNSAFE_componentWillUpdate=="function"&&er.UNSAFE_componentWillUpdate(qe,Ra,ea)),typeof er.componentDidUpdate=="function"&&(Re.flags|=4),typeof er.getSnapshotBeforeUpdate=="function"&&(Re.flags|=1024)):(typeof er.componentDidUpdate!="function"||Tr===Te.memoizedProps&&Ta===Te.memoizedState||(Re.flags|=4),typeof er.getSnapshotBeforeUpdate!="function"||Tr===Te.memoizedProps&&Ta===Te.memoizedState||(Re.flags|=1024),Re.memoizedProps=qe,Re.memoizedState=Ra),er.props=qe,er.state=Ra,er.context=ea,qe=Pa):(typeof er.componentDidUpdate!="function"||Tr===Te.memoizedProps&&Ta===Te.memoizedState||(Re.flags|=4),typeof er.getSnapshotBeforeUpdate!="function"||Tr===Te.memoizedProps&&Ta===Te.memoizedState||(Re.flags|=1024),qe=!1)}return er=qe,Wf(Te,Re),qe=(Re.flags&128)!==0,er||qe?(er=Re.stateNode,Ue=qe&&typeof Ue.getDerivedStateFromError!="function"?null:er.render(),Re.flags|=1,Te!==null&&qe?(Re.child=yi(Re,Te.child,null,Ze),Re.child=yi(Re,null,Ue,Ze)):Ts(Te,Re,Ue,Ze),Re.memoizedState=er.state,Te=Re.child):Te=zl(Te,Re,Ze),Te}function gd(Te,Re,Ue,qe){return Pl(),Re.flags|=256,Ts(Te,Re,Ue,qe),Re.child}var Bh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function jh(Te){return{baseLanes:Te,cachePool:Gr()}}function Uh(Te,Re,Ue){return Te=Te!==null?Te.childLanes&~Ue:0,Re&&(Te|=po),Te}function md(Te,Re,Ue){var qe=Re.pendingProps,Ze=!1,er=(Re.flags&128)!==0,Tr;if((Tr=er)||(Tr=Te!==null&&Te.memoizedState===null?!1:(Kn.current&2)!==0),Tr&&(Ze=!0,Re.flags&=-129),Tr=(Re.flags&32)!==0,Re.flags&=-33,Te===null){if(Hn){if(Ze?Bi(Re):qi(),(Te=vi)?(Te=Ap(Te,Ni),Te=Te!==null&&Te.data!=="&"?Te:null,Te!==null&&(Re.memoizedState={dehydrated:Te,treeContext:hl!==null?{id:Vs,overflow:Gs}:null,retryLane:536870912,hydrationErrors:null},Ue=vu(Te),Ue.return=Re,Re.child=Ue,ls=Re,vi=null)):Te=null,Te===null)throw dl(Re);return b0(Te)?Re.lanes=32:Re.lanes=536870912,null}var jr=qe.children;return qe=qe.fallback,Ze?(qi(),Ze=Re.mode,jr=Vf({mode:"hidden",children:jr},Ze),qe=ul(qe,Ze,Ue,null),jr.return=Re,qe.return=Re,jr.sibling=qe,Re.child=jr,qe=Re.child,qe.memoizedState=jh(Ue),qe.childLanes=Uh(Te,Tr,Ue),Re.memoizedState=Bh,ff(null,qe)):(Bi(Re),zh(Re,jr))}var ea=Te.memoizedState;if(ea!==null&&(jr=ea.dehydrated,jr!==null)){if(er)Re.flags&256?(Bi(Re),Re.flags&=-257,Re=Hh(Te,Re,Ue)):Re.memoizedState!==null?(qi(),Re.child=Te.child,Re.flags|=128,Re=null):(qi(),jr=qe.fallback,Ze=Re.mode,qe=Vf({mode:"visible",children:qe.children},Ze),jr=ul(jr,Ze,Ue,null),jr.flags|=2,qe.return=Re,jr.return=Re,qe.sibling=jr,Re.child=qe,yi(Re,Te.child,null,Ue),qe=Re.child,qe.memoizedState=jh(Ue),qe.childLanes=Uh(Te,Tr,Ue),Re.memoizedState=Bh,Re=ff(null,qe));else if(Bi(Re),b0(jr)){if(Tr=jr.nextSibling&&jr.nextSibling.dataset,Tr)var Ea=Tr.dgst;Tr=Ea,qe=Error(n(419)),qe.stack="",qe.digest=Tr,fc({value:qe,source:null,stack:null}),Re=Hh(Te,Re,Ue)}else if(rs||ml(Te,Re,Ue,!1),Tr=(Ue&Te.childLanes)!==0,rs||Tr){if(Tr=wi,Tr!==null&&(qe=bi(Tr,Ue),qe!==0&&qe!==ea.retryLane))throw ea.retryLane=qe,$o(Te,qe),eo(Tr,Te,qe),Ph;w0(jr)||th(),Re=Hh(Te,Re,Ue)}else w0(jr)?(Re.flags|=192,Re.child=Te.child,Re=null):(Te=ea.treeContext,vi=No(jr.nextSibling),ls=Re,Hn=!0,As=null,Ni=!1,Te!==null&&Mf(Re,Te),Re=zh(Re,qe.children),Re.flags|=4096);return Re}return Ze?(qi(),jr=qe.fallback,Ze=Re.mode,ea=Te.child,Ea=ea.sibling,qe=Hs(ea,{mode:"hidden",children:qe.children}),qe.subtreeFlags=ea.subtreeFlags&65011712,Ea!==null?jr=Hs(Ea,jr):(jr=ul(jr,Ze,Ue,null),jr.flags|=2),jr.return=Re,qe.return=Re,qe.sibling=jr,Re.child=qe,ff(null,qe),qe=Re.child,jr=Te.child.memoizedState,jr===null?jr=jh(Ue):(Ze=jr.cachePool,Ze!==null?(ea=Ii._currentValue,Ze=Ze.parent!==ea?{parent:ea,pool:ea}:Ze):Ze=Gr(),jr={baseLanes:jr.baseLanes|Ue,cachePool:Ze}),qe.memoizedState=jr,qe.childLanes=Uh(Te,Tr,Ue),Re.memoizedState=Bh,ff(Te.child,qe)):(Bi(Re),Ue=Te.child,Te=Ue.sibling,Ue=Hs(Ue,{mode:"visible",children:qe.children}),Ue.return=Re,Ue.sibling=null,Te!==null&&(Tr=Re.deletions,Tr===null?(Re.deletions=[Te],Re.flags|=16):Tr.push(Te)),Re.child=Ue,Re.memoizedState=null,Ue)}function zh(Te,Re){return Re=Vf({mode:"visible",children:Re},Te.mode),Re.return=Te,Te.child=Re}function Vf(Te,Re){return Te=gs(22,Te,null,Re),Te.lanes=0,Te}function Hh(Te,Re,Ue){return yi(Re,Te.child,null,Ue),Te=zh(Re,Re.pendingProps.children),Te.flags|=2,Re.memoizedState=null,Te}function _d(Te,Re,Ue){Te.lanes|=Re;var qe=Te.alternate;qe!==null&&(qe.lanes|=Re),hc(Te.return,Re,Ue)}function Xh(Te,Re,Ue,qe,Ze,er){var Tr=Te.memoizedState;Tr===null?Te.memoizedState={isBackwards:Re,rendering:null,renderingStartTime:0,last:qe,tail:Ue,tailMode:Ze,treeForkCount:er}:(Tr.isBackwards=Re,Tr.rendering=null,Tr.renderingStartTime=0,Tr.last=qe,Tr.tail=Ue,Tr.tailMode=Ze,Tr.treeForkCount=er)}function xd(Te,Re,Ue){var qe=Re.pendingProps,Ze=qe.revealOrder,er=qe.tail;qe=qe.children;var Tr=Kn.current,jr=(Tr&2)!==0;if(jr?(Tr=Tr&1|2,Re.flags|=128):Tr&=1,nr(Kn,Tr),Ts(Te,Re,qe,Ue),qe=Hn?Zc:0,!jr&&Te!==null&&(Te.flags&128)!==0)e:for(Te=Re.child;Te!==null;){if(Te.tag===13)Te.memoizedState!==null&&_d(Te,Ue,Re);else if(Te.tag===19)_d(Te,Ue,Re);else if(Te.child!==null){Te.child.return=Te,Te=Te.child;continue}if(Te===Re)break e;for(;Te.sibling===null;){if(Te.return===null||Te.return===Re)break e;Te=Te.return}Te.sibling.return=Te.return,Te=Te.sibling}switch(Ze){case"forwards":for(Ue=Re.child,Ze=null;Ue!==null;)Te=Ue.alternate,Te!==null&&_s(Te)===null&&(Ze=Ue),Ue=Ue.sibling;Ue=Ze,Ue===null?(Ze=Re.child,Re.child=null):(Ze=Ue.sibling,Ue.sibling=null),Xh(Re,!1,Ze,Ue,er,qe);break;case"backwards":case"unstable_legacy-backwards":for(Ue=null,Ze=Re.child,Re.child=null;Ze!==null;){if(Te=Ze.alternate,Te!==null&&_s(Te)===null){Re.child=Ze;break}Te=Ze.sibling,Ze.sibling=Ue,Ue=Ze,Ze=Te}Xh(Re,!0,Ue,null,er,qe);break;case"together":Xh(Re,!1,null,null,void 0,qe);break;default:Re.memoizedState=null}return Re.child}function zl(Te,Re,Ue){if(Te!==null&&(Re.dependencies=Te.dependencies),yc|=Re.lanes,(Ue&Re.childLanes)===0)if(Te!==null){if(ml(Te,Re,Ue,!1),(Ue&Re.childLanes)===0)return null}else return null;if(Te!==null&&Re.child!==Te.child)throw Error(n(153));if(Re.child!==null){for(Te=Re.child,Ue=Hs(Te,Te.pendingProps),Re.child=Ue,Ue.return=Re;Te.sibling!==null;)Te=Te.sibling,Ue=Ue.sibling=Hs(Te,Te.pendingProps),Ue.return=Re;Ue.sibling=null}return Re.child}function qh(Te,Re){return(Te.lanes&Re)!==0?!0:(Te=Te.dependencies,!!(Te!==null&&Au(Te)))}function t1(Te,Re,Ue){switch(Re.tag){case 3:vr(Re,Re.stateNode.containerInfo),gl(Re,Ii,Te.memoizedState.cache),Pl();break;case 27:case 5:kr(Re);break;case 4:vr(Re,Re.stateNode.containerInfo);break;case 10:gl(Re,Re.type,Re.memoizedProps.value);break;case 31:if(Re.memoizedState!==null)return Re.flags|=128,oi(Re),null;break;case 13:var qe=Re.memoizedState;if(qe!==null)return qe.dehydrated!==null?(Bi(Re),Re.flags|=128,null):(Ue&Re.child.childLanes)!==0?md(Te,Re,Ue):(Bi(Re),Te=zl(Te,Re,Ue),Te!==null?Te.sibling:null);Bi(Re);break;case 19:var Ze=(Te.flags&128)!==0;if(qe=(Ue&Re.childLanes)!==0,qe||(ml(Te,Re,Ue,!1),qe=(Ue&Re.childLanes)!==0),Ze){if(qe)return xd(Te,Re,Ue);Re.flags|=128}if(Ze=Re.memoizedState,Ze!==null&&(Ze.rendering=null,Ze.tail=null,Ze.lastEffect=null),nr(Kn,Kn.current),qe)break;return null;case 22:return Re.lanes=0,ud(Te,Re,Ue,Re.pendingProps);case 24:gl(Re,Ii,Te.memoizedState.cache)}return zl(Te,Re,Ue)}function vd(Te,Re,Ue){if(Te!==null)if(Te.memoizedProps!==Re.pendingProps)rs=!0;else{if(!qh(Te,Ue)&&(Re.flags&128)===0)return rs=!1,t1(Te,Re,Ue);rs=(Te.flags&131072)!==0}else rs=!1,Hn&&(Re.flags&1048576)!==0&&Df(Re,Zc,Re.index);switch(Re.lanes=0,Re.tag){case 16:e:{var qe=Re.pendingProps;if(Te=ma(Re.elementType),Re.type=Te,typeof Te=="function")xu(Te)?(qe=ru(Te,qe),Re.tag=1,Re=pd(null,Re,Te,qe,Ue)):(Re.tag=0,Re=Ih(null,Re,Te,qe,Ue));else{if(Te!=null){var Ze=Te.$$typeof;if(Ze===sr){Re.tag=11,Re=od(null,Re,Te,qe,Ue);break e}else if(Ze===pr){Re.tag=14,Re=ld(null,Re,Te,qe,Ue);break e}}throw Re=Mr(Te)||Te,Error(n(306,Re,""))}}return Re;case 0:return Ih(Te,Re,Re.type,Re.pendingProps,Ue);case 1:return qe=Re.type,Ze=ru(qe,Re.pendingProps),pd(Te,Re,qe,Ze,Ue);case 3:e:{if(vr(Re,Re.stateNode.containerInfo),Te===null)throw Error(n(387));qe=Re.pendingProps;var er=Re.memoizedState;Ze=er.element,Ti(Te,Re),zi(Re,qe,null,Ue);var Tr=Re.memoizedState;if(qe=Tr.cache,gl(Re,Ii,qe),qe!==er.cache&&Il(Re,[Ii],Ue,!0),gi(),qe=Tr.element,er.isDehydrated)if(er={element:qe,isDehydrated:!1,cache:Tr.cache},Re.updateQueue.baseState=er,Re.memoizedState=er,Re.flags&256){Re=gd(Te,Re,qe,Ue);break e}else if(qe!==Ze){Ze=Xs(Error(n(424)),Re),fc(Ze),Re=gd(Te,Re,qe,Ue);break e}else{switch(Te=Re.stateNode.containerInfo,Te.nodeType){case 9:Te=Te.body;break;default:Te=Te.nodeName==="HTML"?Te.ownerDocument.body:Te}for(vi=No(Te.firstChild),ls=Re,Hn=!0,As=null,Ni=!0,Ue=On(Re,null,qe,Ue),Re.child=Ue;Ue;)Ue.flags=Ue.flags&-3|4096,Ue=Ue.sibling}else{if(Pl(),qe===Ze){Re=zl(Te,Re,Ue);break e}Ts(Te,Re,qe,Ue)}Re=Re.child}return Re;case 26:return Wf(Te,Re),Te===null?(Ue=Np(Re.type,null,Re.pendingProps,null))?Re.memoizedState=Ue:Hn||(Ue=Re.type,Te=Re.pendingProps,qe=lh(St.current).createElement(Ue),qe[Xr]=Re,qe[Wr]=Te,ks(qe,Ue,Te),dn(qe),Re.stateNode=qe):Re.memoizedState=Np(Re.type,Te.memoizedProps,Re.pendingProps,Te.memoizedState),null;case 27:return kr(Re),Te===null&&Hn&&(qe=Re.stateNode=kp(Re.type,Re.pendingProps,St.current),ls=Re,Ni=!0,Ze=vi,Ec(Re.type)?(S0=Ze,vi=No(qe.firstChild)):vi=Ze),Ts(Te,Re,Re.pendingProps.children,Ue),Wf(Te,Re),Te===null&&(Re.flags|=4194304),Re.child;case 5:return Te===null&&Hn&&((Ze=qe=vi)&&(qe=F1(qe,Re.type,Re.pendingProps,Ni),qe!==null?(Re.stateNode=qe,ls=Re,vi=No(qe.firstChild),Ni=!1,Ze=!0):Ze=!1),Ze||dl(Re)),kr(Re),Ze=Re.type,er=Re.pendingProps,Tr=Te!==null?Te.memoizedProps:null,qe=er.children,x0(Ze,er)?qe=null:Tr!==null&&x0(Ze,Tr)&&(Re.flags|=32),Re.memoizedState!==null&&(Ze=tf(Te,Re,Eh,null,null,Ue),Tf._currentValue=Ze),Wf(Te,Re),Ts(Te,Re,qe,Ue),Re.child;case 6:return Te===null&&Hn&&((Te=Ue=vi)&&(Ue=L1(Ue,Re.pendingProps,Ni),Ue!==null?(Re.stateNode=Ue,ls=Re,vi=null,Te=!0):Te=!1),Te||dl(Re)),null;case 13:return md(Te,Re,Ue);case 4:return vr(Re,Re.stateNode.containerInfo),qe=Re.pendingProps,Te===null?Re.child=yi(Re,null,qe,Ue):Ts(Te,Re,qe,Ue),Re.child;case 11:return od(Te,Re,Re.type,Re.pendingProps,Ue);case 7:return Ts(Te,Re,Re.pendingProps,Ue),Re.child;case 8:return Ts(Te,Re,Re.pendingProps.children,Ue),Re.child;case 12:return Ts(Te,Re,Re.pendingProps.children,Ue),Re.child;case 10:return qe=Re.pendingProps,gl(Re,Re.type,qe.value),Ts(Te,Re,qe.children,Ue),Re.child;case 9:return Ze=Re.type._context,qe=Re.pendingProps.children,_l(Re),Ze=us(Ze),qe=qe(Ze),Re.flags|=1,Ts(Te,Re,qe,Ue),Re.child;case 14:return ld(Te,Re,Re.type,Re.pendingProps,Ue);case 15:return cd(Te,Re,Re.type,Re.pendingProps,Ue);case 19:return xd(Te,Re,Ue);case 31:return e1(Te,Re,Ue);case 22:return ud(Te,Re,Ue,Re.pendingProps);case 24:return _l(Re),qe=us(Ii),Te===null?(Ze=Ur(),Ze===null&&(Ze=wi,er=dc(),Ze.pooledCache=er,er.refCount++,er!==null&&(Ze.pooledCacheLanes|=Ue),Ze=er),Re.memoizedState={parent:qe,cache:Ze},rn(Re),gl(Re,Ii,Ze)):((Te.lanes&Ue)!==0&&(Ti(Te,Re),zi(Re,null,null,Ue),gi()),Ze=Te.memoizedState,er=Re.memoizedState,Ze.parent!==qe?(Ze={parent:qe,cache:qe},Re.memoizedState=Ze,Re.lanes===0&&(Re.memoizedState=Re.updateQueue.baseState=Ze),gl(Re,Ii,qe)):(qe=er.cache,gl(Re,Ii,qe),qe!==Ze.cache&&Il(Re,[Ii],Ue,!0))),Ts(Te,Re,Re.pendingProps.children,Ue),Re.child;case 29:throw Re.pendingProps}throw Error(n(156,Re.tag))}function Hl(Te){Te.flags|=4}function Wh(Te,Re,Ue,qe,Ze){if((Re=(Te.mode&32)!==0)&&(Re=!1),Re){if(Te.flags|=16777216,(Ze&335544128)===Ze)if(Te.stateNode.complete)Te.flags|=8192;else if(Vd())Te.flags|=8192;else throw Da=la,ba}else Te.flags&=-16777217}function yd(Te,Re){if(Re.type!=="stylesheet"||(Re.state.loading&4)!==0)Te.flags&=-16777217;else if(Te.flags|=16777216,!Op(Re))if(Vd())Te.flags|=8192;else throw Da=la,ba}function Gf(Te,Re){Re!==null&&(Te.flags|=4),Te.flags&16384&&(Re=Te.tag!==22?Fn():536870912,Te.lanes|=Re,ju|=Re)}function hf(Te,Re){if(!Hn)switch(Te.tailMode){case"hidden":Re=Te.tail;for(var Ue=null;Re!==null;)Re.alternate!==null&&(Ue=Re),Re=Re.sibling;Ue===null?Te.tail=null:Ue.sibling=null;break;case"collapsed":Ue=Te.tail;for(var qe=null;Ue!==null;)Ue.alternate!==null&&(qe=Ue),Ue=Ue.sibling;qe===null?Re||Te.tail===null?Te.tail=null:Te.tail.sibling=null:qe.sibling=null}}function Ri(Te){var Re=Te.alternate!==null&&Te.alternate.child===Te.child,Ue=0,qe=0;if(Re)for(var Ze=Te.child;Ze!==null;)Ue|=Ze.lanes|Ze.childLanes,qe|=Ze.subtreeFlags&65011712,qe|=Ze.flags&65011712,Ze.return=Te,Ze=Ze.sibling;else for(Ze=Te.child;Ze!==null;)Ue|=Ze.lanes|Ze.childLanes,qe|=Ze.subtreeFlags,qe|=Ze.flags,Ze.return=Te,Ze=Ze.sibling;return Te.subtreeFlags|=qe,Te.childLanes=Ue,Re}function r1(Te,Re,Ue){var qe=Re.pendingProps;switch(bu(Re),Re.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ri(Re),null;case 1:return Ri(Re),null;case 3:return Ue=Re.stateNode,qe=null,Te!==null&&(qe=Te.memoizedState.cache),Re.memoizedState.cache!==qe&&(Re.flags|=2048),Ys(Ii),br(),Ue.pendingContext&&(Ue.context=Ue.pendingContext,Ue.pendingContext=null),(Te===null||Te.child===null)&&(cs(Re)?Hl(Re):Te===null||Te.memoizedState.isDehydrated&&(Re.flags&256)===0||(Re.flags|=1024,Qu())),Ri(Re),null;case 26:var Ze=Re.type,er=Re.memoizedState;return Te===null?(Hl(Re),er!==null?(Ri(Re),yd(Re,er)):(Ri(Re),Wh(Re,Ze,null,qe,Ue))):er?er!==Te.memoizedState?(Hl(Re),Ri(Re),yd(Re,er)):(Ri(Re),Re.flags&=-16777217):(Te=Te.memoizedProps,Te!==qe&&Hl(Re),Ri(Re),Wh(Re,Ze,Te,qe,Ue)),null;case 27:if(Pr(Re),Ue=St.current,Ze=Re.type,Te!==null&&Re.stateNode!=null)Te.memoizedProps!==qe&&Hl(Re);else{if(!qe){if(Re.stateNode===null)throw Error(n(166));return Ri(Re),null}Te=or.current,cs(Re)?Ju(Re):(Te=kp(Ze,qe,Ue),Re.stateNode=Te,Hl(Re))}return Ri(Re),null;case 5:if(Pr(Re),Ze=Re.type,Te!==null&&Re.stateNode!=null)Te.memoizedProps!==qe&&Hl(Re);else{if(!qe){if(Re.stateNode===null)throw Error(n(166));return Ri(Re),null}if(er=or.current,cs(Re))Ju(Re);else{var Tr=lh(St.current);switch(er){case 1:er=Tr.createElementNS("http://www.w3.org/2000/svg",Ze);break;case 2:er=Tr.createElementNS("http://www.w3.org/1998/Math/MathML",Ze);break;default:switch(Ze){case"svg":er=Tr.createElementNS("http://www.w3.org/2000/svg",Ze);break;case"math":er=Tr.createElementNS("http://www.w3.org/1998/Math/MathML",Ze);break;case"script":er=Tr.createElement("div"),er.innerHTML="<script><\/script>",er=er.removeChild(er.firstChild);break;case"select":er=typeof qe.is=="string"?Tr.createElement("select",{is:qe.is}):Tr.createElement("select"),qe.multiple?er.multiple=!0:qe.size&&(er.size=qe.size);break;default:er=typeof qe.is=="string"?Tr.createElement(Ze,{is:qe.is}):Tr.createElement(Ze)}}er[Xr]=Re,er[Wr]=qe;e:for(Tr=Re.child;Tr!==null;){if(Tr.tag===5||Tr.tag===6)er.appendChild(Tr.stateNode);else if(Tr.tag!==4&&Tr.tag!==27&&Tr.child!==null){Tr.child.return=Tr,Tr=Tr.child;continue}if(Tr===Re)break e;for(;Tr.sibling===null;){if(Tr.return===null||Tr.return===Re)break e;Tr=Tr.return}Tr.sibling.return=Tr.return,Tr=Tr.sibling}Re.stateNode=er;e:switch(ks(er,Ze,qe),Ze){case"button":case"input":case"select":case"textarea":qe=!!qe.autoFocus;break e;case"img":qe=!0;break e;default:qe=!1}qe&&Hl(Re)}}return Ri(Re),Wh(Re,Re.type,Te===null?null:Te.memoizedProps,Re.pendingProps,Ue),null;case 6:if(Te&&Re.stateNode!=null)Te.memoizedProps!==qe&&Hl(Re);else{if(typeof qe!="string"&&Re.stateNode===null)throw Error(n(166));if(Te=St.current,cs(Re)){if(Te=Re.stateNode,Ue=Re.memoizedProps,qe=null,Ze=ls,Ze!==null)switch(Ze.tag){case 27:case 5:qe=Ze.memoizedProps}Te[Xr]=Re,Te=!!(Te.nodeValue===Ue||qe!==null&&qe.suppressHydrationWarning===!0||mp(Te.nodeValue,Ue)),Te||dl(Re,!0)}else Te=lh(Te).createTextNode(qe),Te[Xr]=Re,Re.stateNode=Te}return Ri(Re),null;case 31:if(Ue=Re.memoizedState,Te===null||Te.memoizedState!==null){if(qe=cs(Re),Ue!==null){if(Te===null){if(!qe)throw Error(n(318));if(Te=Re.memoizedState,Te=Te!==null?Te.dehydrated:null,!Te)throw Error(n(557));Te[Xr]=Re}else Pl(),(Re.flags&128)===0&&(Re.memoizedState=null),Re.flags|=4;Ri(Re),Te=!1}else Ue=Qu(),Te!==null&&Te.memoizedState!==null&&(Te.memoizedState.hydrationErrors=Ue),Te=!0;if(!Te)return Re.flags&256?(ui(Re),Re):(ui(Re),null);if((Re.flags&128)!==0)throw Error(n(558))}return Ri(Re),null;case 13:if(qe=Re.memoizedState,Te===null||Te.memoizedState!==null&&Te.memoizedState.dehydrated!==null){if(Ze=cs(Re),qe!==null&&qe.dehydrated!==null){if(Te===null){if(!Ze)throw Error(n(318));if(Ze=Re.memoizedState,Ze=Ze!==null?Ze.dehydrated:null,!Ze)throw Error(n(317));Ze[Xr]=Re}else Pl(),(Re.flags&128)===0&&(Re.memoizedState=null),Re.flags|=4;Ri(Re),Ze=!1}else Ze=Qu(),Te!==null&&Te.memoizedState!==null&&(Te.memoizedState.hydrationErrors=Ze),Ze=!0;if(!Ze)return Re.flags&256?(ui(Re),Re):(ui(Re),null)}return ui(Re),(Re.flags&128)!==0?(Re.lanes=Ue,Re):(Ue=qe!==null,Te=Te!==null&&Te.memoizedState!==null,Ue&&(qe=Re.child,Ze=null,qe.alternate!==null&&qe.alternate.memoizedState!==null&&qe.alternate.memoizedState.cachePool!==null&&(Ze=qe.alternate.memoizedState.cachePool.pool),er=null,qe.memoizedState!==null&&qe.memoizedState.cachePool!==null&&(er=qe.memoizedState.cachePool.pool),er!==Ze&&(qe.flags|=2048)),Ue!==Te&&Ue&&(Re.child.flags|=8192),Gf(Re,Re.updateQueue),Ri(Re),null);case 4:return br(),Te===null&&d0(Re.stateNode.containerInfo),Ri(Re),null;case 10:return Ys(Re.type),Ri(Re),null;case 19:if(Je(Kn),qe=Re.memoizedState,qe===null)return Ri(Re),null;if(Ze=(Re.flags&128)!==0,er=qe.rendering,er===null)if(Ze)hf(qe,!1);else{if(Vi!==0||Te!==null&&(Te.flags&128)!==0)for(Te=Re.child;Te!==null;){if(er=_s(Te),er!==null){for(Re.flags|=128,hf(qe,!1),Te=er.updateQueue,Re.updateQueue=Te,Gf(Re,Te),Re.subtreeFlags=0,Te=Ue,Ue=Re.child;Ue!==null;)Kc(Ue,Te),Ue=Ue.sibling;return nr(Kn,Kn.current&1|2),Hn&&Is(Re,qe.treeForkCount),Re.child}Te=Te.sibling}qe.tail!==null&&Ya()>Jf&&(Re.flags|=128,Ze=!0,hf(qe,!1),Re.lanes=4194304)}else{if(!Ze)if(Te=_s(er),Te!==null){if(Re.flags|=128,Ze=!0,Te=Te.updateQueue,Re.updateQueue=Te,Gf(Re,Te),hf(qe,!0),qe.tail===null&&qe.tailMode==="hidden"&&!er.alternate&&!Hn)return Ri(Re),null}else 2*Ya()-qe.renderingStartTime>Jf&&Ue!==536870912&&(Re.flags|=128,Ze=!0,hf(qe,!1),Re.lanes=4194304);qe.isBackwards?(er.sibling=Re.child,Re.child=er):(Te=qe.last,Te!==null?Te.sibling=er:Re.child=er,qe.last=er)}return qe.tail!==null?(Te=qe.tail,qe.rendering=Te,qe.tail=Te.sibling,qe.renderingStartTime=Ya(),Te.sibling=null,Ue=Kn.current,nr(Kn,Ze?Ue&1|2:Ue&1),Hn&&Is(Re,qe.treeForkCount),Te):(Ri(Re),null);case 22:case 23:return ui(Re),Ji(),qe=Re.memoizedState!==null,Te!==null?Te.memoizedState!==null!==qe&&(Re.flags|=8192):qe&&(Re.flags|=8192),qe?(Ue&536870912)!==0&&(Re.flags&128)===0&&(Ri(Re),Re.subtreeFlags&6&&(Re.flags|=8192)):Ri(Re),Ue=Re.updateQueue,Ue!==null&&Gf(Re,Ue.retryQueue),Ue=null,Te!==null&&Te.memoizedState!==null&&Te.memoizedState.cachePool!==null&&(Ue=Te.memoizedState.cachePool.pool),qe=null,Re.memoizedState!==null&&Re.memoizedState.cachePool!==null&&(qe=Re.memoizedState.cachePool.pool),qe!==Ue&&(Re.flags|=2048),Te!==null&&Je(Br),null;case 24:return Ue=null,Te!==null&&(Ue=Te.memoizedState.cache),Re.memoizedState.cache!==Ue&&(Re.flags|=2048),Ys(Ii),Ri(Re),null;case 25:return null;case 30:return null}throw Error(n(156,Re.tag))}function a1(Te,Re){switch(bu(Re),Re.tag){case 1:return Te=Re.flags,Te&65536?(Re.flags=Te&-65537|128,Re):null;case 3:return Ys(Ii),br(),Te=Re.flags,(Te&65536)!==0&&(Te&128)===0?(Re.flags=Te&-65537|128,Re):null;case 26:case 27:case 5:return Pr(Re),null;case 31:if(Re.memoizedState!==null){if(ui(Re),Re.alternate===null)throw Error(n(340));Pl()}return Te=Re.flags,Te&65536?(Re.flags=Te&-65537|128,Re):null;case 13:if(ui(Re),Te=Re.memoizedState,Te!==null&&Te.dehydrated!==null){if(Re.alternate===null)throw Error(n(340));Pl()}return Te=Re.flags,Te&65536?(Re.flags=Te&-65537|128,Re):null;case 19:return Je(Kn),null;case 4:return br(),null;case 10:return Ys(Re.type),null;case 22:case 23:return ui(Re),Ji(),Te!==null&&Je(Br),Te=Re.flags,Te&65536?(Re.flags=Te&-65537|128,Re):null;case 24:return Ys(Ii),null;case 25:return null;default:return null}}function wd(Te,Re){switch(bu(Re),Re.tag){case 3:Ys(Ii),br();break;case 26:case 27:case 5:Pr(Re);break;case 4:br();break;case 31:Re.memoizedState!==null&&ui(Re);break;case 13:ui(Re);break;case 19:Je(Kn);break;case 10:Ys(Re.type);break;case 22:case 23:ui(Re),Ji(),Te!==null&&Je(Br);break;case 24:Ys(Ii)}}function df(Te,Re){try{var Ue=Re.updateQueue,qe=Ue!==null?Ue.lastEffect:null;if(qe!==null){var Ze=qe.next;Ue=Ze;do{if((Ue.tag&Te)===Te){qe=void 0;var er=Ue.create,Tr=Ue.inst;qe=er(),Tr.destroy=qe}Ue=Ue.next}while(Ue!==Ze)}}catch(jr){hi(Re,Re.return,jr)}}function xc(Te,Re,Ue){try{var qe=Re.updateQueue,Ze=qe!==null?qe.lastEffect:null;if(Ze!==null){var er=Ze.next;qe=er;do{if((qe.tag&Te)===Te){var Tr=qe.inst,jr=Tr.destroy;if(jr!==void 0){Tr.destroy=void 0,Ze=Re;var ea=Ue,Ea=jr;try{Ea()}catch(Pa){hi(Ze,ea,Pa)}}}qe=qe.next}while(qe!==er)}}catch(Pa){hi(Re,Re.return,Pa)}}function bd(Te){var Re=Te.updateQueue;if(Re!==null){var Ue=Te.stateNode;try{Hi(Re,Ue)}catch(qe){hi(Te,Te.return,qe)}}}function Sd(Te,Re,Ue){Ue.props=ru(Te.type,Te.memoizedProps),Ue.state=Te.memoizedState;try{Ue.componentWillUnmount()}catch(qe){hi(Te,Re,qe)}}function pf(Te,Re){try{var Ue=Te.ref;if(Ue!==null){switch(Te.tag){case 26:case 27:case 5:var qe=Te.stateNode;break;case 30:qe=Te.stateNode;break;default:qe=Te.stateNode}typeof Ue=="function"?Te.refCleanup=Ue(qe):Ue.current=qe}}catch(Ze){hi(Te,Re,Ze)}}function bl(Te,Re){var Ue=Te.ref,qe=Te.refCleanup;if(Ue!==null)if(typeof qe=="function")try{qe()}catch(Ze){hi(Te,Re,Ze)}finally{Te.refCleanup=null,Te=Te.alternate,Te!=null&&(Te.refCleanup=null)}else if(typeof Ue=="function")try{Ue(null)}catch(Ze){hi(Te,Re,Ze)}else Ue.current=null}function Ad(Te){var Re=Te.type,Ue=Te.memoizedProps,qe=Te.stateNode;try{e:switch(Re){case"button":case"input":case"select":case"textarea":Ue.autoFocus&&qe.focus();break e;case"img":Ue.src?qe.src=Ue.src:Ue.srcSet&&(qe.srcset=Ue.srcSet)}}catch(Ze){hi(Te,Te.return,Ze)}}function Vh(Te,Re,Ue){try{var qe=Te.stateNode;E1(qe,Te.type,Ue,Re),qe[Wr]=Re}catch(Ze){hi(Te,Te.return,Ze)}}function Ed(Te){return Te.tag===5||Te.tag===3||Te.tag===26||Te.tag===27&&Ec(Te.type)||Te.tag===4}function Gh(Te){e:for(;;){for(;Te.sibling===null;){if(Te.return===null||Ed(Te.return))return null;Te=Te.return}for(Te.sibling.return=Te.return,Te=Te.sibling;Te.tag!==5&&Te.tag!==6&&Te.tag!==18;){if(Te.tag===27&&Ec(Te.type)||Te.flags&2||Te.child===null||Te.tag===4)continue e;Te.child.return=Te,Te=Te.child}if(!(Te.flags&2))return Te.stateNode}}function Yh(Te,Re,Ue){var qe=Te.tag;if(qe===5||qe===6)Te=Te.stateNode,Re?(Ue.nodeType===9?Ue.body:Ue.nodeName==="HTML"?Ue.ownerDocument.body:Ue).insertBefore(Te,Re):(Re=Ue.nodeType===9?Ue.body:Ue.nodeName==="HTML"?Ue.ownerDocument.body:Ue,Re.appendChild(Te),Ue=Ue._reactRootContainer,Ue!=null||Re.onclick!==null||(Re.onclick=io));else if(qe!==4&&(qe===27&&Ec(Te.type)&&(Ue=Te.stateNode,Re=null),Te=Te.child,Te!==null))for(Yh(Te,Re,Ue),Te=Te.sibling;Te!==null;)Yh(Te,Re,Ue),Te=Te.sibling}function Yf(Te,Re,Ue){var qe=Te.tag;if(qe===5||qe===6)Te=Te.stateNode,Re?Ue.insertBefore(Te,Re):Ue.appendChild(Te);else if(qe!==4&&(qe===27&&Ec(Te.type)&&(Ue=Te.stateNode),Te=Te.child,Te!==null))for(Yf(Te,Re,Ue),Te=Te.sibling;Te!==null;)Yf(Te,Re,Ue),Te=Te.sibling}function Td(Te){var Re=Te.stateNode,Ue=Te.memoizedProps;try{for(var qe=Te.type,Ze=Re.attributes;Ze.length;)Re.removeAttributeNode(Ze[0]);ks(Re,qe,Ue),Re[Xr]=Te,Re[Wr]=Ue}catch(er){hi(Te,Te.return,er)}}var Xl=!1,as=!1,Kh=!1,kd=typeof WeakSet=="function"?WeakSet:Set,xs=null;function n1(Te,Re){if(Te=Te.containerInfo,m0=gh,Te=Yo(Te),Eo(Te)){if("selectionStart"in Te)var Ue={start:Te.selectionStart,end:Te.selectionEnd};else e:{Ue=(Ue=Te.ownerDocument)&&Ue.defaultView||window;var qe=Ue.getSelection&&Ue.getSelection();if(qe&&qe.rangeCount!==0){Ue=qe.anchorNode;var Ze=qe.anchorOffset,er=qe.focusNode;qe=qe.focusOffset;try{Ue.nodeType,er.nodeType}catch{Ue=null;break e}var Tr=0,jr=-1,ea=-1,Ea=0,Pa=0,Ua=Te,Ta=null;t:for(;;){for(var Ra;Ua!==Ue||Ze!==0&&Ua.nodeType!==3||(jr=Tr+Ze),Ua!==er||qe!==0&&Ua.nodeType!==3||(ea=Tr+qe),Ua.nodeType===3&&(Tr+=Ua.nodeValue.length),(Ra=Ua.firstChild)!==null;)Ta=Ua,Ua=Ra;for(;;){if(Ua===Te)break t;if(Ta===Ue&&++Ea===Ze&&(jr=Tr),Ta===er&&++Pa===qe&&(ea=Tr),(Ra=Ua.nextSibling)!==null)break;Ua=Ta,Ta=Ua.parentNode}Ua=Ra}Ue=jr===-1||ea===-1?null:{start:jr,end:ea}}else Ue=null}Ue=Ue||{start:0,end:0}}else Ue=null;for(_0={focusedElem:Te,selectionRange:Ue},gh=!1,xs=Re;xs!==null;)if(Re=xs,Te=Re.child,(Re.subtreeFlags&1028)!==0&&Te!==null)Te.return=Re,xs=Te;else for(;xs!==null;){switch(Re=xs,er=Re.alternate,Te=Re.flags,Re.tag){case 0:if((Te&4)!==0&&(Te=Re.updateQueue,Te=Te!==null?Te.events:null,Te!==null))for(Ue=0;Ue<Te.length;Ue++)Ze=Te[Ue],Ze.ref.impl=Ze.nextImpl;break;case 11:case 15:break;case 1:if((Te&1024)!==0&&er!==null){Te=void 0,Ue=Re,Ze=er.memoizedProps,er=er.memoizedState,qe=Ue.stateNode;try{var mn=ru(Ue.type,Ze);Te=qe.getSnapshotBeforeUpdate(mn,er),qe.__reactInternalSnapshotBeforeUpdate=Te}catch(Rn){hi(Ue,Ue.return,Rn)}}break;case 3:if((Te&1024)!==0){if(Te=Re.stateNode.containerInfo,Ue=Te.nodeType,Ue===9)y0(Te);else if(Ue===1)switch(Te.nodeName){case"HEAD":case"HTML":case"BODY":y0(Te);break;default:Te.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((Te&1024)!==0)throw Error(n(163))}if(Te=Re.sibling,Te!==null){Te.return=Re.return,xs=Te;break}xs=Re.return}}function Cd(Te,Re,Ue){var qe=Ue.flags;switch(Ue.tag){case 0:case 11:case 15:Wl(Te,Ue),qe&4&&df(5,Ue);break;case 1:if(Wl(Te,Ue),qe&4)if(Te=Ue.stateNode,Re===null)try{Te.componentDidMount()}catch(Tr){hi(Ue,Ue.return,Tr)}else{var Ze=ru(Ue.type,Re.memoizedProps);Re=Re.memoizedState;try{Te.componentDidUpdate(Ze,Re,Te.__reactInternalSnapshotBeforeUpdate)}catch(Tr){hi(Ue,Ue.return,Tr)}}qe&64&&bd(Ue),qe&512&&pf(Ue,Ue.return);break;case 3:if(Wl(Te,Ue),qe&64&&(Te=Ue.updateQueue,Te!==null)){if(Re=null,Ue.child!==null)switch(Ue.child.tag){case 27:case 5:Re=Ue.child.stateNode;break;case 1:Re=Ue.child.stateNode}try{Hi(Te,Re)}catch(Tr){hi(Ue,Ue.return,Tr)}}break;case 27:Re===null&&qe&4&&Td(Ue);case 26:case 5:Wl(Te,Ue),Re===null&&qe&4&&Ad(Ue),qe&512&&pf(Ue,Ue.return);break;case 12:Wl(Te,Ue);break;case 31:Wl(Te,Ue),qe&4&&Fd(Te,Ue);break;case 13:Wl(Te,Ue),qe&4&&Ld(Te,Ue),qe&64&&(Te=Ue.memoizedState,Te!==null&&(Te=Te.dehydrated,Te!==null&&(Ue=d1.bind(null,Ue),D1(Te,Ue))));break;case 22:if(qe=Ue.memoizedState!==null||Xl,!qe){Re=Re!==null&&Re.memoizedState!==null||as,Ze=Xl;var er=as;Xl=qe,(as=Re)&&!er?Vl(Te,Ue,(Ue.subtreeFlags&8772)!==0):Wl(Te,Ue),Xl=Ze,as=er}break;case 30:break;default:Wl(Te,Ue)}}function Rd(Te){var Re=Te.alternate;Re!==null&&(Te.alternate=null,Rd(Re)),Te.child=null,Te.deletions=null,Te.sibling=null,Te.tag===5&&(Re=Te.stateNode,Re!==null&&Va(Re)),Te.stateNode=null,Te.return=null,Te.dependencies=null,Te.memoizedProps=null,Te.memoizedState=null,Te.pendingProps=null,Te.stateNode=null,Te.updateQueue=null}var Di=null,$s=!1;function ql(Te,Re,Ue){for(Ue=Ue.child;Ue!==null;)Nd(Te,Re,Ue),Ue=Ue.sibling}function Nd(Te,Re,Ue){if(va&&typeof va.onCommitFiberUnmount=="function")try{va.onCommitFiberUnmount(vn,Ue)}catch{}switch(Ue.tag){case 26:as||bl(Ue,Re),ql(Te,Re,Ue),Ue.memoizedState?Ue.memoizedState.count--:Ue.stateNode&&(Ue=Ue.stateNode,Ue.parentNode.removeChild(Ue));break;case 27:as||bl(Ue,Re);var qe=Di,Ze=$s;Ec(Ue.type)&&(Di=Ue.stateNode,$s=!1),ql(Te,Re,Ue),Sf(Ue.stateNode),Di=qe,$s=Ze;break;case 5:as||bl(Ue,Re);case 6:if(qe=Di,Ze=$s,Di=null,ql(Te,Re,Ue),Di=qe,$s=Ze,Di!==null)if($s)try{(Di.nodeType===9?Di.body:Di.nodeName==="HTML"?Di.ownerDocument.body:Di).removeChild(Ue.stateNode)}catch(er){hi(Ue,Re,er)}else try{Di.removeChild(Ue.stateNode)}catch(er){hi(Ue,Re,er)}break;case 18:Di!==null&&($s?(Te=Di,bp(Te.nodeType===9?Te.body:Te.nodeName==="HTML"?Te.ownerDocument.body:Te,Ue.stateNode),Gu(Te)):bp(Di,Ue.stateNode));break;case 4:qe=Di,Ze=$s,Di=Ue.stateNode.containerInfo,$s=!0,ql(Te,Re,Ue),Di=qe,$s=Ze;break;case 0:case 11:case 14:case 15:xc(2,Ue,Re),as||xc(4,Ue,Re),ql(Te,Re,Ue);break;case 1:as||(bl(Ue,Re),qe=Ue.stateNode,typeof qe.componentWillUnmount=="function"&&Sd(Ue,Re,qe)),ql(Te,Re,Ue);break;case 21:ql(Te,Re,Ue);break;case 22:as=(qe=as)||Ue.memoizedState!==null,ql(Te,Re,Ue),as=qe;break;default:ql(Te,Re,Ue)}}function Fd(Te,Re){if(Re.memoizedState===null&&(Te=Re.alternate,Te!==null&&(Te=Te.memoizedState,Te!==null))){Te=Te.dehydrated;try{Gu(Te)}catch(Ue){hi(Re,Re.return,Ue)}}}function Ld(Te,Re){if(Re.memoizedState===null&&(Te=Re.alternate,Te!==null&&(Te=Te.memoizedState,Te!==null&&(Te=Te.dehydrated,Te!==null))))try{Gu(Te)}catch(Ue){hi(Re,Re.return,Ue)}}function i1(Te){switch(Te.tag){case 31:case 13:case 19:var Re=Te.stateNode;return Re===null&&(Re=Te.stateNode=new kd),Re;case 22:return Te=Te.stateNode,Re=Te._retryCache,Re===null&&(Re=Te._retryCache=new kd),Re;default:throw Error(n(435,Te.tag))}}function Kf(Te,Re){var Ue=i1(Te);Re.forEach(function(qe){if(!Ue.has(qe)){Ue.add(qe);var Ze=p1.bind(null,Te,qe);qe.then(Ze,Ze)}})}function Zs(Te,Re){var Ue=Re.deletions;if(Ue!==null)for(var qe=0;qe<Ue.length;qe++){var Ze=Ue[qe],er=Te,Tr=Re,jr=Tr;e:for(;jr!==null;){switch(jr.tag){case 27:if(Ec(jr.type)){Di=jr.stateNode,$s=!1;break e}break;case 5:Di=jr.stateNode,$s=!1;break e;case 3:case 4:Di=jr.stateNode.containerInfo,$s=!0;break e}jr=jr.return}if(Di===null)throw Error(n(160));Nd(er,Tr,Ze),Di=null,$s=!1,er=Ze.alternate,er!==null&&(er.return=null),Ze.return=null}if(Re.subtreeFlags&13886)for(Re=Re.child;Re!==null;)Dd(Re,Te),Re=Re.sibling}var rl=null;function Dd(Te,Re){var Ue=Te.alternate,qe=Te.flags;switch(Te.tag){case 0:case 11:case 14:case 15:Zs(Re,Te),Js(Te),qe&4&&(xc(3,Te,Te.return),df(3,Te),xc(5,Te,Te.return));break;case 1:Zs(Re,Te),Js(Te),qe&512&&(as||Ue===null||bl(Ue,Ue.return)),qe&64&&Xl&&(Te=Te.updateQueue,Te!==null&&(qe=Te.callbacks,qe!==null&&(Ue=Te.shared.hiddenCallbacks,Te.shared.hiddenCallbacks=Ue===null?qe:Ue.concat(qe))));break;case 26:var Ze=rl;if(Zs(Re,Te),Js(Te),qe&512&&(as||Ue===null||bl(Ue,Ue.return)),qe&4){var er=Ue!==null?Ue.memoizedState:null;if(qe=Te.memoizedState,Ue===null)if(qe===null)if(Te.stateNode===null){e:{qe=Te.type,Ue=Te.memoizedProps,Ze=Ze.ownerDocument||Ze;t:switch(qe){case"title":er=Ze.getElementsByTagName("title")[0],(!er||er[Sa]||er[Xr]||er.namespaceURI==="http://www.w3.org/2000/svg"||er.hasAttribute("itemprop"))&&(er=Ze.createElement(qe),Ze.head.insertBefore(er,Ze.querySelector("head > title"))),ks(er,qe,Ue),er[Xr]=Te,dn(er),qe=er;break e;case"link":var Tr=Dp("link","href",Ze).get(qe+(Ue.href||""));if(Tr){for(var jr=0;jr<Tr.length;jr++)if(er=Tr[jr],er.getAttribute("href")===(Ue.href==null||Ue.href===""?null:Ue.href)&&er.getAttribute("rel")===(Ue.rel==null?null:Ue.rel)&&er.getAttribute("title")===(Ue.title==null?null:Ue.title)&&er.getAttribute("crossorigin")===(Ue.crossOrigin==null?null:Ue.crossOrigin)){Tr.splice(jr,1);break t}}er=Ze.createElement(qe),ks(er,qe,Ue),Ze.head.appendChild(er);break;case"meta":if(Tr=Dp("meta","content",Ze).get(qe+(Ue.content||""))){for(jr=0;jr<Tr.length;jr++)if(er=Tr[jr],er.getAttribute("content")===(Ue.content==null?null:""+Ue.content)&&er.getAttribute("name")===(Ue.name==null?null:Ue.name)&&er.getAttribute("property")===(Ue.property==null?null:Ue.property)&&er.getAttribute("http-equiv")===(Ue.httpEquiv==null?null:Ue.httpEquiv)&&er.getAttribute("charset")===(Ue.charSet==null?null:Ue.charSet)){Tr.splice(jr,1);break t}}er=Ze.createElement(qe),ks(er,qe,Ue),Ze.head.appendChild(er);break;default:throw Error(n(468,qe))}er[Xr]=Te,dn(er),qe=er}Te.stateNode=qe}else Mp(Ze,Te.type,Te.stateNode);else Te.stateNode=Lp(Ze,qe,Te.memoizedProps);else er!==qe?(er===null?Ue.stateNode!==null&&(Ue=Ue.stateNode,Ue.parentNode.removeChild(Ue)):er.count--,qe===null?Mp(Ze,Te.type,Te.stateNode):Lp(Ze,qe,Te.memoizedProps)):qe===null&&Te.stateNode!==null&&Vh(Te,Te.memoizedProps,Ue.memoizedProps)}break;case 27:Zs(Re,Te),Js(Te),qe&512&&(as||Ue===null||bl(Ue,Ue.return)),Ue!==null&&qe&4&&Vh(Te,Te.memoizedProps,Ue.memoizedProps);break;case 5:if(Zs(Re,Te),Js(Te),qe&512&&(as||Ue===null||bl(Ue,Ue.return)),Te.flags&32){Ze=Te.stateNode;try{no(Ze,"")}catch(mn){hi(Te,Te.return,mn)}}qe&4&&Te.stateNode!=null&&(Ze=Te.memoizedProps,Vh(Te,Ze,Ue!==null?Ue.memoizedProps:Ze)),qe&1024&&(Kh=!0);break;case 6:if(Zs(Re,Te),Js(Te),qe&4){if(Te.stateNode===null)throw Error(n(162));qe=Te.memoizedProps,Ue=Te.stateNode;try{Ue.nodeValue=qe}catch(mn){hi(Te,Te.return,mn)}}break;case 3:if(fh=null,Ze=rl,rl=ch(Re.containerInfo),Zs(Re,Te),rl=Ze,Js(Te),qe&4&&Ue!==null&&Ue.memoizedState.isDehydrated)try{Gu(Re.containerInfo)}catch(mn){hi(Te,Te.return,mn)}Kh&&(Kh=!1,Md(Te));break;case 4:qe=rl,rl=ch(Te.stateNode.containerInfo),Zs(Re,Te),Js(Te),rl=qe;break;case 12:Zs(Re,Te),Js(Te);break;case 31:Zs(Re,Te),Js(Te),qe&4&&(qe=Te.updateQueue,qe!==null&&(Te.updateQueue=null,Kf(Te,qe)));break;case 13:Zs(Re,Te),Js(Te),Te.child.flags&8192&&Te.memoizedState!==null!=(Ue!==null&&Ue.memoizedState!==null)&&(Zf=Ya()),qe&4&&(qe=Te.updateQueue,qe!==null&&(Te.updateQueue=null,Kf(Te,qe)));break;case 22:Ze=Te.memoizedState!==null;var ea=Ue!==null&&Ue.memoizedState!==null,Ea=Xl,Pa=as;if(Xl=Ea||Ze,as=Pa||ea,Zs(Re,Te),as=Pa,Xl=Ea,Js(Te),qe&8192)e:for(Re=Te.stateNode,Re._visibility=Ze?Re._visibility&-2:Re._visibility|1,Ze&&(Ue===null||ea||Xl||as||au(Te)),Ue=null,Re=Te;;){if(Re.tag===5||Re.tag===26){if(Ue===null){ea=Ue=Re;try{if(er=ea.stateNode,Ze)Tr=er.style,typeof Tr.setProperty=="function"?Tr.setProperty("display","none","important"):Tr.display="none";else{jr=ea.stateNode;var Ua=ea.memoizedProps.style,Ta=Ua!=null&&Ua.hasOwnProperty("display")?Ua.display:null;jr.style.display=Ta==null||typeof Ta=="boolean"?"":(""+Ta).trim()}}catch(mn){hi(ea,ea.return,mn)}}}else if(Re.tag===6){if(Ue===null){ea=Re;try{ea.stateNode.nodeValue=Ze?"":ea.memoizedProps}catch(mn){hi(ea,ea.return,mn)}}}else if(Re.tag===18){if(Ue===null){ea=Re;try{var Ra=ea.stateNode;Ze?Sp(Ra,!0):Sp(ea.stateNode,!1)}catch(mn){hi(ea,ea.return,mn)}}}else if((Re.tag!==22&&Re.tag!==23||Re.memoizedState===null||Re===Te)&&Re.child!==null){Re.child.return=Re,Re=Re.child;continue}if(Re===Te)break e;for(;Re.sibling===null;){if(Re.return===null||Re.return===Te)break e;Ue===Re&&(Ue=null),Re=Re.return}Ue===Re&&(Ue=null),Re.sibling.return=Re.return,Re=Re.sibling}qe&4&&(qe=Te.updateQueue,qe!==null&&(Ue=qe.retryQueue,Ue!==null&&(qe.retryQueue=null,Kf(Te,Ue))));break;case 19:Zs(Re,Te),Js(Te),qe&4&&(qe=Te.updateQueue,qe!==null&&(Te.updateQueue=null,Kf(Te,qe)));break;case 30:break;case 21:break;default:Zs(Re,Te),Js(Te)}}function Js(Te){var Re=Te.flags;if(Re&2){try{for(var Ue,qe=Te.return;qe!==null;){if(Ed(qe)){Ue=qe;break}qe=qe.return}if(Ue==null)throw Error(n(160));switch(Ue.tag){case 27:var Ze=Ue.stateNode,er=Gh(Te);Yf(Te,er,Ze);break;case 5:var Tr=Ue.stateNode;Ue.flags&32&&(no(Tr,""),Ue.flags&=-33);var jr=Gh(Te);Yf(Te,jr,Tr);break;case 3:case 4:var ea=Ue.stateNode.containerInfo,Ea=Gh(Te);Yh(Te,Ea,ea);break;default:throw Error(n(161))}}catch(Pa){hi(Te,Te.return,Pa)}Te.flags&=-3}Re&4096&&(Te.flags&=-4097)}function Md(Te){if(Te.subtreeFlags&1024)for(Te=Te.child;Te!==null;){var Re=Te;Md(Re),Re.tag===5&&Re.flags&1024&&Re.stateNode.reset(),Te=Te.sibling}}function Wl(Te,Re){if(Re.subtreeFlags&8772)for(Re=Re.child;Re!==null;)Cd(Te,Re.alternate,Re),Re=Re.sibling}function au(Te){for(Te=Te.child;Te!==null;){var Re=Te;switch(Re.tag){case 0:case 11:case 14:case 15:xc(4,Re,Re.return),au(Re);break;case 1:bl(Re,Re.return);var Ue=Re.stateNode;typeof Ue.componentWillUnmount=="function"&&Sd(Re,Re.return,Ue),au(Re);break;case 27:Sf(Re.stateNode);case 26:case 5:bl(Re,Re.return),au(Re);break;case 22:Re.memoizedState===null&&au(Re);break;case 30:au(Re);break;default:au(Re)}Te=Te.sibling}}function Vl(Te,Re,Ue){for(Ue=Ue&&(Re.subtreeFlags&8772)!==0,Re=Re.child;Re!==null;){var qe=Re.alternate,Ze=Te,er=Re,Tr=er.flags;switch(er.tag){case 0:case 11:case 15:Vl(Ze,er,Ue),df(4,er);break;case 1:if(Vl(Ze,er,Ue),qe=er,Ze=qe.stateNode,typeof Ze.componentDidMount=="function")try{Ze.componentDidMount()}catch(Ea){hi(qe,qe.return,Ea)}if(qe=er,Ze=qe.updateQueue,Ze!==null){var jr=qe.stateNode;try{var ea=Ze.shared.hiddenCallbacks;if(ea!==null)for(Ze.shared.hiddenCallbacks=null,Ze=0;Ze<ea.length;Ze++)ms(ea[Ze],jr)}catch(Ea){hi(qe,qe.return,Ea)}}Ue&&Tr&64&&bd(er),pf(er,er.return);break;case 27:Td(er);case 26:case 5:Vl(Ze,er,Ue),Ue&&qe===null&&Tr&4&&Ad(er),pf(er,er.return);break;case 12:Vl(Ze,er,Ue);break;case 31:Vl(Ze,er,Ue),Ue&&Tr&4&&Fd(Ze,er);break;case 13:Vl(Ze,er,Ue),Ue&&Tr&4&&Ld(Ze,er);break;case 22:er.memoizedState===null&&Vl(Ze,er,Ue),pf(er,er.return);break;case 30:break;default:Vl(Ze,er,Ue)}Re=Re.sibling}}function $h(Te,Re){var Ue=null;Te!==null&&Te.memoizedState!==null&&Te.memoizedState.cachePool!==null&&(Ue=Te.memoizedState.cachePool.pool),Te=null,Re.memoizedState!==null&&Re.memoizedState.cachePool!==null&&(Te=Re.memoizedState.cachePool.pool),Te!==Ue&&(Te!=null&&Te.refCount++,Ue!=null&&Jc(Ue))}function Zh(Te,Re){Te=null,Re.alternate!==null&&(Te=Re.alternate.memoizedState.cache),Re=Re.memoizedState.cache,Re!==Te&&(Re.refCount++,Te!=null&&Jc(Te))}function al(Te,Re,Ue,qe){if(Re.subtreeFlags&10256)for(Re=Re.child;Re!==null;)Od(Te,Re,Ue,qe),Re=Re.sibling}function Od(Te,Re,Ue,qe){var Ze=Re.flags;switch(Re.tag){case 0:case 11:case 15:al(Te,Re,Ue,qe),Ze&2048&&df(9,Re);break;case 1:al(Te,Re,Ue,qe);break;case 3:al(Te,Re,Ue,qe),Ze&2048&&(Te=null,Re.alternate!==null&&(Te=Re.alternate.memoizedState.cache),Re=Re.memoizedState.cache,Re!==Te&&(Re.refCount++,Te!=null&&Jc(Te)));break;case 12:if(Ze&2048){al(Te,Re,Ue,qe),Te=Re.stateNode;try{var er=Re.memoizedProps,Tr=er.id,jr=er.onPostCommit;typeof jr=="function"&&jr(Tr,Re.alternate===null?"mount":"update",Te.passiveEffectDuration,-0)}catch(ea){hi(Re,Re.return,ea)}}else al(Te,Re,Ue,qe);break;case 31:al(Te,Re,Ue,qe);break;case 13:al(Te,Re,Ue,qe);break;case 23:break;case 22:er=Re.stateNode,Tr=Re.alternate,Re.memoizedState!==null?er._visibility&2?al(Te,Re,Ue,qe):gf(Te,Re):er._visibility&2?al(Te,Re,Ue,qe):(er._visibility|=2,Pu(Te,Re,Ue,qe,(Re.subtreeFlags&10256)!==0||!1)),Ze&2048&&$h(Tr,Re);break;case 24:al(Te,Re,Ue,qe),Ze&2048&&Zh(Re.alternate,Re);break;default:al(Te,Re,Ue,qe)}}function Pu(Te,Re,Ue,qe,Ze){for(Ze=Ze&&((Re.subtreeFlags&10256)!==0||!1),Re=Re.child;Re!==null;){var er=Te,Tr=Re,jr=Ue,ea=qe,Ea=Tr.flags;switch(Tr.tag){case 0:case 11:case 15:Pu(er,Tr,jr,ea,Ze),df(8,Tr);break;case 23:break;case 22:var Pa=Tr.stateNode;Tr.memoizedState!==null?Pa._visibility&2?Pu(er,Tr,jr,ea,Ze):gf(er,Tr):(Pa._visibility|=2,Pu(er,Tr,jr,ea,Ze)),Ze&&Ea&2048&&$h(Tr.alternate,Tr);break;case 24:Pu(er,Tr,jr,ea,Ze),Ze&&Ea&2048&&Zh(Tr.alternate,Tr);break;default:Pu(er,Tr,jr,ea,Ze)}Re=Re.sibling}}function gf(Te,Re){if(Re.subtreeFlags&10256)for(Re=Re.child;Re!==null;){var Ue=Te,qe=Re,Ze=qe.flags;switch(qe.tag){case 22:gf(Ue,qe),Ze&2048&&$h(qe.alternate,qe);break;case 24:gf(Ue,qe),Ze&2048&&Zh(qe.alternate,qe);break;default:gf(Ue,qe)}Re=Re.sibling}}var mf=8192;function Iu(Te,Re,Ue){if(Te.subtreeFlags&mf)for(Te=Te.child;Te!==null;)Pd(Te,Re,Ue),Te=Te.sibling}function Pd(Te,Re,Ue){switch(Te.tag){case 26:Iu(Te,Re,Ue),Te.flags&mf&&Te.memoizedState!==null&&W1(Ue,rl,Te.memoizedState,Te.memoizedProps);break;case 5:Iu(Te,Re,Ue);break;case 3:case 4:var qe=rl;rl=ch(Te.stateNode.containerInfo),Iu(Te,Re,Ue),rl=qe;break;case 22:Te.memoizedState===null&&(qe=Te.alternate,qe!==null&&qe.memoizedState!==null?(qe=mf,mf=16777216,Iu(Te,Re,Ue),mf=qe):Iu(Te,Re,Ue));break;default:Iu(Te,Re,Ue)}}function Id(Te){var Re=Te.alternate;if(Re!==null&&(Te=Re.child,Te!==null)){Re.child=null;do Re=Te.sibling,Te.sibling=null,Te=Re;while(Te!==null)}}function _f(Te){var Re=Te.deletions;if((Te.flags&16)!==0){if(Re!==null)for(var Ue=0;Ue<Re.length;Ue++){var qe=Re[Ue];xs=qe,jd(qe,Te)}Id(Te)}if(Te.subtreeFlags&10256)for(Te=Te.child;Te!==null;)Bd(Te),Te=Te.sibling}function Bd(Te){switch(Te.tag){case 0:case 11:case 15:_f(Te),Te.flags&2048&&xc(9,Te,Te.return);break;case 3:_f(Te);break;case 12:_f(Te);break;case 22:var Re=Te.stateNode;Te.memoizedState!==null&&Re._visibility&2&&(Te.return===null||Te.return.tag!==13)?(Re._visibility&=-3,$f(Te)):_f(Te);break;default:_f(Te)}}function $f(Te){var Re=Te.deletions;if((Te.flags&16)!==0){if(Re!==null)for(var Ue=0;Ue<Re.length;Ue++){var qe=Re[Ue];xs=qe,jd(qe,Te)}Id(Te)}for(Te=Te.child;Te!==null;){switch(Re=Te,Re.tag){case 0:case 11:case 15:xc(8,Re,Re.return),$f(Re);break;case 22:Ue=Re.stateNode,Ue._visibility&2&&(Ue._visibility&=-3,$f(Re));break;default:$f(Re)}Te=Te.sibling}}function jd(Te,Re){for(;xs!==null;){var Ue=xs;switch(Ue.tag){case 0:case 11:case 15:xc(8,Ue,Re);break;case 23:case 22:if(Ue.memoizedState!==null&&Ue.memoizedState.cachePool!==null){var qe=Ue.memoizedState.cachePool.pool;qe!=null&&qe.refCount++}break;case 24:Jc(Ue.memoizedState.cache)}if(qe=Ue.child,qe!==null)qe.return=Ue,xs=qe;else e:for(Ue=Te;xs!==null;){qe=xs;var Ze=qe.sibling,er=qe.return;if(Rd(qe),qe===Ue){xs=null;break e}if(Ze!==null){Ze.return=er,xs=Ze;break e}xs=er}}}var s1={getCacheForType:function(Te){var Re=us(Ii),Ue=Re.data.get(Te);return Ue===void 0&&(Ue=Te(),Re.data.set(Te,Ue)),Ue},cacheSignal:function(){return us(Ii).controller.signal}},o1=typeof WeakMap=="function"?WeakMap:Map,li=0,wi=null,Xn=null,Wn=0,fi=0,ho=null,vc=!1,Bu=!1,Jh=!1,Gl=0,Vi=0,yc=0,nu=0,Qh=0,po=0,ju=0,xf=null,Qs=null,e0=!1,Zf=0,Ud=0,Jf=1/0,Qf=null,wc=null,hs=0,bc=null,Uu=null,Yl=0,t0=0,r0=null,zd=null,vf=0,a0=null;function go(){return(li&2)!==0&&Wn!==0?Wn&-Wn:Nr.T!==null?c0():Or()}function Hd(){if(po===0)if((Wn&536870912)===0||Hn){var Te=$a;$a<<=1,($a&3932160)===0&&($a=262144),po=Te}else po=536870912;return Te=Ci.current,Te!==null&&(Te.flags|=32),po}function eo(Te,Re,Ue){(Te===wi&&(fi===2||fi===9)||Te.cancelPendingCommit!==null)&&(zu(Te,0),Sc(Te,Wn,po,!1)),sn(Te,Ue),((li&2)===0||Te!==wi)&&(Te===wi&&((li&2)===0&&(nu|=Ue),Vi===4&&Sc(Te,Wn,po,!1)),Sl(Te))}function Xd(Te,Re,Ue){if((li&6)!==0)throw Error(n(327));var qe=!Ue&&(Re&127)===0&&(Re&Te.expiredLanes)===0||_n(Te,Re),Ze=qe?u1(Te,Re):i0(Te,Re,!0),er=qe;do{if(Ze===0){Bu&&!qe&&Sc(Te,Re,0,!1);break}else{if(Ue=Te.current.alternate,er&&!l1(Ue)){Ze=i0(Te,Re,!1),er=!1;continue}if(Ze===2){if(er=Re,Te.errorRecoveryDisabledLanes&er)var Tr=0;else Tr=Te.pendingLanes&-536870913,Tr=Tr!==0?Tr:Tr&536870912?536870912:0;if(Tr!==0){Re=Tr;e:{var jr=Te;Ze=xf;var ea=jr.current.memoizedState.isDehydrated;if(ea&&(zu(jr,Tr).flags|=256),Tr=i0(jr,Tr,!1),Tr!==2){if(Jh&&!ea){jr.errorRecoveryDisabledLanes|=er,nu|=er,Ze=4;break e}er=Qs,Qs=Ze,er!==null&&(Qs===null?Qs=er:Qs.push.apply(Qs,er))}Ze=Tr}if(er=!1,Ze!==2)continue}}if(Ze===1){zu(Te,0),Sc(Te,Re,0,!0);break}e:{switch(qe=Te,er=Ze,er){case 0:case 1:throw Error(n(345));case 4:if((Re&4194048)!==Re)break;case 6:Sc(qe,Re,po,!vc);break e;case 2:Qs=null;break;case 3:case 5:break;default:throw Error(n(329))}if((Re&62914560)===Re&&(Ze=Zf+300-Ya(),10<Ze)){if(Sc(qe,Re,po,!vc),Wa(qe,0,!0)!==0)break e;Yl=Re,qe.timeoutHandle=yp(qd.bind(null,qe,Ue,Qs,Qf,e0,Re,po,nu,ju,vc,er,"Throttled",-0,0),Ze);break e}qd(qe,Ue,Qs,Qf,e0,Re,po,nu,ju,vc,er,null,-0,0)}}break}while(!0);Sl(Te)}function qd(Te,Re,Ue,qe,Ze,er,Tr,jr,ea,Ea,Pa,Ua,Ta,Ra){if(Te.timeoutHandle=-1,Ua=Re.subtreeFlags,Ua&8192||(Ua&16785408)===16785408){Ua={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:io},Pd(Re,er,Ua);var mn=(er&62914560)===er?Zf-Ya():(er&4194048)===er?Ud-Ya():0;if(mn=V1(Ua,mn),mn!==null){Yl=er,Te.cancelPendingCommit=mn(Jd.bind(null,Te,Re,er,Ue,qe,Ze,Tr,jr,ea,Pa,Ua,null,Ta,Ra)),Sc(Te,er,Tr,!Ea);return}}Jd(Te,Re,er,Ue,qe,Ze,Tr,jr,ea)}function l1(Te){for(var Re=Te;;){var Ue=Re.tag;if((Ue===0||Ue===11||Ue===15)&&Re.flags&16384&&(Ue=Re.updateQueue,Ue!==null&&(Ue=Ue.stores,Ue!==null)))for(var qe=0;qe<Ue.length;qe++){var Ze=Ue[qe],er=Ze.getSnapshot;Ze=Ze.value;try{if(!ss(er(),Ze))return!1}catch{return!1}}if(Ue=Re.child,Re.subtreeFlags&16384&&Ue!==null)Ue.return=Re,Re=Ue;else{if(Re===Te)break;for(;Re.sibling===null;){if(Re.return===null||Re.return===Te)return!0;Re=Re.return}Re.sibling.return=Re.return,Re=Re.sibling}}return!0}function Sc(Te,Re,Ue,qe){Re&=~Qh,Re&=~nu,Te.suspendedLanes|=Re,Te.pingedLanes&=~Re,qe&&(Te.warmLanes|=Re),qe=Te.expirationTimes;for(var Ze=Re;0<Ze;){var er=31-ia(Ze),Tr=1<<er;qe[er]=-1,Ze&=~Tr}Ue!==0&&Yi(Te,Ue,Re)}function eh(){return(li&6)===0?(yf(0),!1):!0}function n0(){if(Xn!==null){if(fi===0)var Te=Xn.return;else Te=Xn,ko=pl=null,Ru(Te),Ha=null,xn=0,Te=Xn;for(;Te!==null;)wd(Te.alternate,Te),Te=Te.return;Xn=null}}function zu(Te,Re){var Ue=Te.timeoutHandle;Ue!==-1&&(Te.timeoutHandle=-1,C1(Ue)),Ue=Te.cancelPendingCommit,Ue!==null&&(Te.cancelPendingCommit=null,Ue()),Yl=0,n0(),wi=Te,Xn=Ue=Hs(Te.current,null),Wn=Re,fi=0,ho=null,vc=!1,Bu=_n(Te,Re),Jh=!1,ju=po=Qh=nu=yc=Vi=0,Qs=xf=null,e0=!1,(Re&8)!==0&&(Re|=Re&32);var qe=Te.entangledLanes;if(qe!==0)for(Te=Te.entanglements,qe&=Re;0<qe;){var Ze=31-ia(qe),er=1<<Ze;Re|=Te[Ze],qe&=~er}return Gl=Re,Vc(),Ue}function Wd(Te,Re){Sn=null,Nr.H=uf,Re===na||Re===Vr?(Re=Ba(),fi=3):Re===ba?(Re=Ba(),fi=4):fi=Re===Ph?8:Re!==null&&typeof Re=="object"&&typeof Re.then=="function"?6:1,ho=Re,Xn===null&&(Vi=1,Xf(Te,Xs(Re,Te.current)))}function Vd(){var Te=Ci.current;return Te===null?!0:(Wn&4194048)===Wn?Jn===null:(Wn&62914560)===Wn||(Wn&536870912)!==0?Te===Jn:!1}function Gd(){var Te=Nr.H;return Nr.H=uf,Te===null?uf:Te}function Yd(){var Te=Nr.A;return Nr.A=s1,Te}function th(){Vi=4,vc||(Wn&4194048)!==Wn&&Ci.current!==null||(Bu=!0),(yc&134217727)===0&&(nu&134217727)===0||wi===null||Sc(wi,Wn,po,!1)}function i0(Te,Re,Ue){var qe=li;li|=2;var Ze=Gd(),er=Yd();(wi!==Te||Wn!==Re)&&(Qf=null,zu(Te,Re)),Re=!1;var Tr=Vi;e:do try{if(fi!==0&&Xn!==null){var jr=Xn,ea=ho;switch(fi){case 8:n0(),Tr=6;break e;case 3:case 2:case 9:case 6:Ci.current===null&&(Re=!0);var Ea=fi;if(fi=0,ho=null,Hu(Te,jr,ea,Ea),Ue&&Bu){Tr=0;break e}break;default:Ea=fi,fi=0,ho=null,Hu(Te,jr,ea,Ea)}}c1(),Tr=Vi;break}catch(Pa){Wd(Te,Pa)}while(!0);return Re&&Te.shellSuspendCounter++,ko=pl=null,li=qe,Nr.H=Ze,Nr.A=er,Xn===null&&(wi=null,Wn=0,Vc()),Tr}function c1(){for(;Xn!==null;)Kd(Xn)}function u1(Te,Re){var Ue=li;li|=2;var qe=Gd(),Ze=Yd();wi!==Te||Wn!==Re?(Qf=null,Jf=Ya()+500,zu(Te,Re)):Bu=_n(Te,Re);e:do try{if(fi!==0&&Xn!==null){Re=Xn;var er=ho;t:switch(fi){case 1:fi=0,ho=null,Hu(Te,Re,er,1);break;case 2:case 9:if(da(er)){fi=0,ho=null,$d(Re);break}Re=function(){fi!==2&&fi!==9||wi!==Te||(fi=7),Sl(Te)},er.then(Re,Re);break e;case 3:fi=7;break e;case 4:fi=5;break e;case 7:da(er)?(fi=0,ho=null,$d(Re)):(fi=0,ho=null,Hu(Te,Re,er,7));break;case 5:var Tr=null;switch(Xn.tag){case 26:Tr=Xn.memoizedState;case 5:case 27:var jr=Xn;if(Tr?Op(Tr):jr.stateNode.complete){fi=0,ho=null;var ea=jr.sibling;if(ea!==null)Xn=ea;else{var Ea=jr.return;Ea!==null?(Xn=Ea,rh(Ea)):Xn=null}break t}}fi=0,ho=null,Hu(Te,Re,er,5);break;case 6:fi=0,ho=null,Hu(Te,Re,er,6);break;case 8:n0(),Vi=6;break e;default:throw Error(n(462))}}f1();break}catch(Pa){Wd(Te,Pa)}while(!0);return ko=pl=null,Nr.H=qe,Nr.A=Ze,li=Ue,Xn!==null?0:(wi=null,Wn=0,Vc(),Vi)}function f1(){for(;Xn!==null&&!za();)Kd(Xn)}function Kd(Te){var Re=vd(Te.alternate,Te,Gl);Te.memoizedProps=Te.pendingProps,Re===null?rh(Te):Xn=Re}function $d(Te){var Re=Te,Ue=Re.alternate;switch(Re.tag){case 15:case 0:Re=dd(Ue,Re,Re.pendingProps,Re.type,void 0,Wn);break;case 11:Re=dd(Ue,Re,Re.pendingProps,Re.type.render,Re.ref,Wn);break;case 5:Ru(Re);default:wd(Ue,Re),Re=Xn=Kc(Re,Gl),Re=vd(Ue,Re,Gl)}Te.memoizedProps=Te.pendingProps,Re===null?rh(Te):Xn=Re}function Hu(Te,Re,Ue,qe){ko=pl=null,Ru(Re),Ha=null,xn=0;var Ze=Re.return;try{if(Qp(Te,Ze,Re,Ue,Wn)){Vi=1,Xf(Te,Xs(Ue,Te.current)),Xn=null;return}}catch(er){if(Ze!==null)throw Xn=Ze,er;Vi=1,Xf(Te,Xs(Ue,Te.current)),Xn=null;return}Re.flags&32768?(Hn||qe===1?Te=!0:Bu||(Wn&536870912)!==0?Te=!1:(vc=Te=!0,(qe===2||qe===9||qe===3||qe===6)&&(qe=Ci.current,qe!==null&&qe.tag===13&&(qe.flags|=16384))),Zd(Re,Te)):rh(Re)}function rh(Te){var Re=Te;do{if((Re.flags&32768)!==0){Zd(Re,vc);return}Te=Re.return;var Ue=r1(Re.alternate,Re,Gl);if(Ue!==null){Xn=Ue;return}if(Re=Re.sibling,Re!==null){Xn=Re;return}Xn=Re=Te}while(Re!==null);Vi===0&&(Vi=5)}function Zd(Te,Re){do{var Ue=a1(Te.alternate,Te);if(Ue!==null){Ue.flags&=32767,Xn=Ue;return}if(Ue=Te.return,Ue!==null&&(Ue.flags|=32768,Ue.subtreeFlags=0,Ue.deletions=null),!Re&&(Te=Te.sibling,Te!==null)){Xn=Te;return}Xn=Te=Ue}while(Te!==null);Vi=6,Xn=null}function Jd(Te,Re,Ue,qe,Ze,er,Tr,jr,ea){Te.cancelPendingCommit=null;do ah();while(hs!==0);if((li&6)!==0)throw Error(n(327));if(Re!==null){if(Re===Te.current)throw Error(n(177));if(er=Re.lanes|Re.childLanes,er|=gu,Gi(Te,Ue,er,Tr,jr,ea),Te===wi&&(Xn=wi=null,Wn=0),Uu=Re,bc=Te,Yl=Ue,t0=er,r0=Ze,zd=qe,(Re.subtreeFlags&10256)!==0||(Re.flags&10256)!==0?(Te.callbackNode=null,Te.callbackPriority=0,g1(fn,function(){return ap(),null})):(Te.callbackNode=null,Te.callbackPriority=0),qe=(Re.flags&13878)!==0,(Re.subtreeFlags&13878)!==0||qe){qe=Nr.T,Nr.T=null,Ze=Ar.p,Ar.p=2,Tr=li,li|=4;try{n1(Te,Re,Ue)}finally{li=Tr,Ar.p=Ze,Nr.T=qe}}hs=1,Qd(),ep(),tp()}}function Qd(){if(hs===1){hs=0;var Te=bc,Re=Uu,Ue=(Re.flags&13878)!==0;if((Re.subtreeFlags&13878)!==0||Ue){Ue=Nr.T,Nr.T=null;var qe=Ar.p;Ar.p=2;var Ze=li;li|=4;try{Dd(Re,Te);var er=_0,Tr=Yo(Te.containerInfo),jr=er.focusedElem,ea=er.selectionRange;if(Tr!==jr&&jr&&jr.ownerDocument&&Go(jr.ownerDocument.documentElement,jr)){if(ea!==null&&Eo(jr)){var Ea=ea.start,Pa=ea.end;if(Pa===void 0&&(Pa=Ea),"selectionStart"in jr)jr.selectionStart=Ea,jr.selectionEnd=Math.min(Pa,jr.value.length);else{var Ua=jr.ownerDocument||document,Ta=Ua&&Ua.defaultView||window;if(Ta.getSelection){var Ra=Ta.getSelection(),mn=jr.textContent.length,Rn=Math.min(ea.start,mn),xi=ea.end===void 0?Rn:Math.min(ea.end,mn);!Ra.extend&&Rn>xi&&(Tr=xi,xi=Rn,Rn=Tr);var ha=sc(jr,Rn),sa=sc(jr,xi);if(ha&&sa&&(Ra.rangeCount!==1||Ra.anchorNode!==ha.node||Ra.anchorOffset!==ha.offset||Ra.focusNode!==sa.node||Ra.focusOffset!==sa.offset)){var Aa=Ua.createRange();Aa.setStart(ha.node,ha.offset),Ra.removeAllRanges(),Rn>xi?(Ra.addRange(Aa),Ra.extend(sa.node,sa.offset)):(Aa.setEnd(sa.node,sa.offset),Ra.addRange(Aa))}}}}for(Ua=[],Ra=jr;Ra=Ra.parentNode;)Ra.nodeType===1&&Ua.push({element:Ra,left:Ra.scrollLeft,top:Ra.scrollTop});for(typeof jr.focus=="function"&&jr.focus(),jr=0;jr<Ua.length;jr++){var ja=Ua[jr];ja.element.scrollLeft=ja.left,ja.element.scrollTop=ja.top}}gh=!!m0,_0=m0=null}finally{li=Ze,Ar.p=qe,Nr.T=Ue}}Te.current=Re,hs=2}}function ep(){if(hs===2){hs=0;var Te=bc,Re=Uu,Ue=(Re.flags&8772)!==0;if((Re.subtreeFlags&8772)!==0||Ue){Ue=Nr.T,Nr.T=null;var qe=Ar.p;Ar.p=2;var Ze=li;li|=4;try{Cd(Te,Re.alternate,Re)}finally{li=Ze,Ar.p=qe,Nr.T=Ue}}hs=3}}function tp(){if(hs===4||hs===3){hs=0,Xa();var Te=bc,Re=Uu,Ue=Yl,qe=zd;(Re.subtreeFlags&10256)!==0||(Re.flags&10256)!==0?hs=5:(hs=0,Uu=bc=null,rp(Te,Te.pendingLanes));var Ze=Te.pendingLanes;if(Ze===0&&(wc=null),$n(Ue),Re=Re.stateNode,va&&typeof va.onCommitFiberRoot=="function")try{va.onCommitFiberRoot(vn,Re,void 0,(Re.current.flags&128)===128)}catch{}if(qe!==null){Re=Nr.T,Ze=Ar.p,Ar.p=2,Nr.T=null;try{for(var er=Te.onRecoverableError,Tr=0;Tr<qe.length;Tr++){var jr=qe[Tr];er(jr.value,{componentStack:jr.stack})}}finally{Nr.T=Re,Ar.p=Ze}}(Yl&3)!==0&&ah(),Sl(Te),Ze=Te.pendingLanes,(Ue&261930)!==0&&(Ze&42)!==0?Te===a0?vf++:(vf=0,a0=Te):vf=0,yf(0)}}function rp(Te,Re){(Te.pooledCacheLanes&=Re)===0&&(Re=Te.pooledCache,Re!=null&&(Te.pooledCache=null,Jc(Re)))}function ah(){return Qd(),ep(),tp(),ap()}function ap(){if(hs!==5)return!1;var Te=bc,Re=t0;t0=0;var Ue=$n(Yl),qe=Nr.T,Ze=Ar.p;try{Ar.p=32>Ue?32:Ue,Nr.T=null,Ue=r0,r0=null;var er=bc,Tr=Yl;if(hs=0,Uu=bc=null,Yl=0,(li&6)!==0)throw Error(n(331));var jr=li;if(li|=4,Bd(er.current),Od(er,er.current,Tr,Ue),li=jr,yf(0,!1),va&&typeof va.onPostCommitFiberRoot=="function")try{va.onPostCommitFiberRoot(vn,er)}catch{}return!0}finally{Ar.p=Ze,Nr.T=qe,rp(Te,Re)}}function np(Te,Re,Ue){Re=Xs(Ue,Re),Re=Oh(Te.stateNode,Re,2),Te=Pn(Te,Re,2),Te!==null&&(sn(Te,2),Sl(Te))}function hi(Te,Re,Ue){if(Te.tag===3)np(Te,Te,Ue);else for(;Re!==null;){if(Re.tag===3){np(Re,Te,Ue);break}else if(Re.tag===1){var qe=Re.stateNode;if(typeof Re.type.getDerivedStateFromError=="function"||typeof qe.componentDidCatch=="function"&&(wc===null||!wc.has(qe))){Te=Xs(Ue,Te),Ue=id(2),qe=Pn(Re,Ue,2),qe!==null&&(sd(Ue,qe,Re,Te),sn(qe,2),Sl(qe));break}}Re=Re.return}}function s0(Te,Re,Ue){var qe=Te.pingCache;if(qe===null){qe=Te.pingCache=new o1;var Ze=new Set;qe.set(Re,Ze)}else Ze=qe.get(Re),Ze===void 0&&(Ze=new Set,qe.set(Re,Ze));Ze.has(Ue)||(Jh=!0,Ze.add(Ue),Te=h1.bind(null,Te,Re,Ue),Re.then(Te,Te))}function h1(Te,Re,Ue){var qe=Te.pingCache;qe!==null&&qe.delete(Re),Te.pingedLanes|=Te.suspendedLanes&Ue,Te.warmLanes&=~Ue,wi===Te&&(Wn&Ue)===Ue&&(Vi===4||Vi===3&&(Wn&62914560)===Wn&&300>Ya()-Zf?(li&2)===0&&zu(Te,0):Qh|=Ue,ju===Wn&&(ju=0)),Sl(Te)}function ip(Te,Re){Re===0&&(Re=Fn()),Te=$o(Te,Re),Te!==null&&(sn(Te,Re),Sl(Te))}function d1(Te){var Re=Te.memoizedState,Ue=0;Re!==null&&(Ue=Re.retryLane),ip(Te,Ue)}function p1(Te,Re){var Ue=0;switch(Te.tag){case 31:case 13:var qe=Te.stateNode,Ze=Te.memoizedState;Ze!==null&&(Ue=Ze.retryLane);break;case 19:qe=Te.stateNode;break;case 22:qe=Te.stateNode._retryCache;break;default:throw Error(n(314))}qe!==null&&qe.delete(Re),ip(Te,Ue)}function g1(Te,Re){return Na(Te,Re)}var nh=null,Xu=null,o0=!1,ih=!1,l0=!1,Ac=0;function Sl(Te){Te!==Xu&&Te.next===null&&(Xu===null?nh=Xu=Te:Xu=Xu.next=Te),ih=!0,o0||(o0=!0,_1())}function yf(Te,Re){if(!l0&&ih){l0=!0;do for(var Ue=!1,qe=nh;qe!==null;){if(Te!==0){var Ze=qe.pendingLanes;if(Ze===0)var er=0;else{var Tr=qe.suspendedLanes,jr=qe.pingedLanes;er=(1<<31-ia(42|Te)+1)-1,er&=Ze&~(Tr&~jr),er=er&201326741?er&201326741|1:er?er|2:0}er!==0&&(Ue=!0,cp(qe,er))}else er=Wn,er=Wa(qe,qe===wi?er:0,qe.cancelPendingCommit!==null||qe.timeoutHandle!==-1),(er&3)===0||_n(qe,er)||(Ue=!0,cp(qe,er));qe=qe.next}while(Ue);l0=!1}}function m1(){sp()}function sp(){ih=o0=!1;var Te=0;Ac!==0&&k1()&&(Te=Ac);for(var Re=Ya(),Ue=null,qe=nh;qe!==null;){var Ze=qe.next,er=op(qe,Re);er===0?(qe.next=null,Ue===null?nh=Ze:Ue.next=Ze,Ze===null&&(Xu=Ue)):(Ue=qe,(Te!==0||(er&3)!==0)&&(ih=!0)),qe=Ze}hs!==0&&hs!==5||yf(Te),Ac!==0&&(Ac=0)}function op(Te,Re){for(var Ue=Te.suspendedLanes,qe=Te.pingedLanes,Ze=Te.expirationTimes,er=Te.pendingLanes&-62914561;0<er;){var Tr=31-ia(er),jr=1<<Tr,ea=Ze[Tr];ea===-1?((jr&Ue)===0||(jr&qe)!==0)&&(Ze[Tr]=hn(jr,Re)):ea<=Re&&(Te.expiredLanes|=jr),er&=~jr}if(Re=wi,Ue=Wn,Ue=Wa(Te,Te===Re?Ue:0,Te.cancelPendingCommit!==null||Te.timeoutHandle!==-1),qe=Te.callbackNode,Ue===0||Te===Re&&(fi===2||fi===9)||Te.cancelPendingCommit!==null)return qe!==null&&qe!==null&&Ca(qe),Te.callbackNode=null,Te.callbackPriority=0;if((Ue&3)===0||_n(Te,Ue)){if(Re=Ue&-Ue,Re===Te.callbackPriority)return Re;switch(qe!==null&&Ca(qe),$n(Ue)){case 2:case 8:Ue=yn;break;case 32:Ue=fn;break;case 268435456:Ue=Ka;break;default:Ue=fn}return qe=lp.bind(null,Te),Ue=Na(Ue,qe),Te.callbackPriority=Re,Te.callbackNode=Ue,Re}return qe!==null&&qe!==null&&Ca(qe),Te.callbackPriority=2,Te.callbackNode=null,2}function lp(Te,Re){if(hs!==0&&hs!==5)return Te.callbackNode=null,Te.callbackPriority=0,null;var Ue=Te.callbackNode;if(ah()&&Te.callbackNode!==Ue)return null;var qe=Wn;return qe=Wa(Te,Te===wi?qe:0,Te.cancelPendingCommit!==null||Te.timeoutHandle!==-1),qe===0?null:(Xd(Te,qe,Re),op(Te,Ya()),Te.callbackNode!=null&&Te.callbackNode===Ue?lp.bind(null,Te):null)}function cp(Te,Re){if(ah())return null;Xd(Te,Re,!0)}function _1(){R1(function(){(li&6)!==0?Na(on,m1):sp()})}function c0(){if(Ac===0){var Te=Ye;Te===0&&(Te=xa,xa<<=1,(xa&261888)===0&&(xa=256)),Ac=Te}return Ac}function up(Te){return Te==null||typeof Te=="symbol"||typeof Te=="boolean"?null:typeof Te=="function"?Te:Cs(""+Te)}function fp(Te,Re){var Ue=Re.ownerDocument.createElement("input");return Ue.name=Re.name,Ue.value=Re.value,Te.id&&Ue.setAttribute("form",Te.id),Re.parentNode.insertBefore(Ue,Re),Te=new FormData(Te),Ue.parentNode.removeChild(Ue),Te}function x1(Te,Re,Ue,qe,Ze){if(Re==="submit"&&Ue&&Ue.stateNode===Ze){var er=up((Ze[Wr]||null).action),Tr=qe.submitter;Tr&&(Re=(Re=Tr[Wr]||null)?up(Re.formAction):Tr.getAttribute("formAction"),Re!==null&&(er=Re,Tr=null));var jr=new js("action","action",null,qe,Ze);Te.push({event:jr,listeners:[{instance:null,listener:function(){if(qe.defaultPrevented){if(Ac!==0){var ea=Tr?fp(Ze,Tr):new FormData(Ze);Rh(Ue,{pending:!0,data:ea,method:Ze.method,action:er},null,ea)}}else typeof er=="function"&&(jr.preventDefault(),ea=Tr?fp(Ze,Tr):new FormData(Ze),Rh(Ue,{pending:!0,data:ea,method:Ze.method,action:er},er,ea))},currentTarget:Ze}]})}}for(var u0=0;u0<Dl.length;u0++){var f0=Dl[u0],v1=f0.toLowerCase(),y1=f0[0].toUpperCase()+f0.slice(1);zs(v1,"on"+y1)}zs(Ll,"onAnimationEnd"),zs(qc,"onAnimationIteration"),zs(Yu,"onAnimationStart"),zs("dblclick","onDoubleClick"),zs("focusin","onFocus"),zs("focusout","onBlur"),zs(Nf,"onTransitionRun"),zs(Ff,"onTransitionStart"),zs(Lf,"onTransitionCancel"),zs(Ku,"onTransitionEnd"),vs("onMouseEnter",["mouseout","mouseover"]),vs("onMouseLeave",["mouseout","mouseover"]),vs("onPointerEnter",["pointerout","pointerover"]),vs("onPointerLeave",["pointerout","pointerover"]),ci("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),ci("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),ci("onBeforeInput",["compositionend","keypress","textInput","paste"]),ci("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),ci("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),ci("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var wf="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),w1=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(wf));function hp(Te,Re){Re=(Re&4)!==0;for(var Ue=0;Ue<Te.length;Ue++){var qe=Te[Ue],Ze=qe.event;qe=qe.listeners;e:{var er=void 0;if(Re)for(var Tr=qe.length-1;0<=Tr;Tr--){var jr=qe[Tr],ea=jr.instance,Ea=jr.currentTarget;if(jr=jr.listener,ea!==er&&Ze.isPropagationStopped())break e;er=jr,Ze.currentTarget=Ea;try{er(Ze)}catch(Pa){Wc(Pa)}Ze.currentTarget=null,er=ea}else for(Tr=0;Tr<qe.length;Tr++){if(jr=qe[Tr],ea=jr.instance,Ea=jr.currentTarget,jr=jr.listener,ea!==er&&Ze.isPropagationStopped())break e;er=jr,Ze.currentTarget=Ea;try{er(Ze)}catch(Pa){Wc(Pa)}Ze.currentTarget=null,er=ea}}}}function qn(Te,Re){var Ue=Re[ga];Ue===void 0&&(Ue=Re[ga]=new Set);var qe=Te+"__bubble";Ue.has(qe)||(dp(Re,Te,2,!1),Ue.add(qe))}function h0(Te,Re,Ue){var qe=0;Re&&(qe|=4),dp(Ue,Te,qe,Re)}var sh="_reactListening"+Math.random().toString(36).slice(2);function d0(Te){if(!Te[sh]){Te[sh]=!0,ii.forEach(function(Ue){Ue!=="selectionchange"&&(w1.has(Ue)||h0(Ue,!1,Te),h0(Ue,!0,Te))});var Re=Te.nodeType===9?Te:Te.ownerDocument;Re===null||Re[sh]||(Re[sh]=!0,h0("selectionchange",!1,Re))}}function dp(Te,Re,Ue,qe){switch(Hp(Re)){case 2:var Ze=K1;break;case 8:Ze=$1;break;default:Ze=C0}Ue=Ze.bind(null,Re,Ue,Te),Ze=void 0,!jc||Re!=="touchstart"&&Re!=="touchmove"&&Re!=="wheel"||(Ze=!0),qe?Ze!==void 0?Te.addEventListener(Re,Ue,{capture:!0,passive:Ze}):Te.addEventListener(Re,Ue,!0):Ze!==void 0?Te.addEventListener(Re,Ue,{passive:Ze}):Te.addEventListener(Re,Ue,!1)}function p0(Te,Re,Ue,qe,Ze){var er=qe;if((Re&1)===0&&(Re&2)===0&&qe!==null)e:for(;;){if(qe===null)return;var Tr=qe.tag;if(Tr===3||Tr===4){var jr=qe.stateNode.containerInfo;if(jr===Ze)break;if(Tr===4)for(Tr=qe.return;Tr!==null;){var ea=Tr.tag;if((ea===3||ea===4)&&Tr.stateNode.containerInfo===Ze)return;Tr=Tr.return}for(;jr!==null;){if(Tr=Ja(jr),Tr===null)return;if(ea=Tr.tag,ea===5||ea===6||ea===26||ea===27){qe=er=Tr;continue e}jr=jr.parentNode}}qe=qe.return}uu(function(){var Ea=er,Pa=El(Ue),Ua=[];e:{var Ta=$u.get(Te);if(Ta!==void 0){var Ra=js,mn=Te;switch(Te){case"keypress":if(Bs(Ue)===0)break e;case"keydown":case"keyup":Ra=Gn;break;case"focusin":mn="focus",Ra=jo;break;case"focusout":mn="blur",Ra=jo;break;case"beforeblur":case"afterblur":Ra=jo;break;case"click":if(Ue.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Ra=Uc;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Ra=Bo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Ra=$i;break;case Ll:case qc:case Yu:Ra=cr;break;case Ku:Ra=is;break;case"scroll":case"scrollend":Ra=Ql;break;case"wheel":Ra=so;break;case"copy":case"cut":case"paste":Ra=Kr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Ra=Mi;break;case"toggle":case"beforetoggle":Ra=zc}var Rn=(Re&4)!==0,xi=!Rn&&(Te==="scroll"||Te==="scrollend"),ha=Rn?Ta!==null?Ta+"Capture":null:Ta;Rn=[];for(var sa=Ea,Aa;sa!==null;){var ja=sa;if(Aa=ja.stateNode,ja=ja.tag,ja!==5&&ja!==26&&ja!==27||Aa===null||ha===null||(ja=Ls(sa,ha),ja!=null&&Rn.push(bf(sa,ja,Aa))),xi)break;sa=sa.return}0<Rn.length&&(Ta=new Ra(Ta,mn,null,Ue,Pa),Ua.push({event:Ta,listeners:Rn}))}}if((Re&7)===0){e:{if(Ta=Te==="mouseover"||Te==="pointerover",Ra=Te==="mouseout"||Te==="pointerout",Ta&&Ue!==Do&&(mn=Ue.relatedTarget||Ue.fromElement)&&(Ja(mn)||mn[$r]))break e;if((Ra||Ta)&&(Ta=Pa.window===Pa?Pa:(Ta=Pa.ownerDocument)?Ta.defaultView||Ta.parentWindow:window,Ra?(mn=Ue.relatedTarget||Ue.toElement,Ra=Ea,mn=mn?Ja(mn):null,mn!==null&&(xi=Ce(mn),Rn=mn.tag,mn!==xi||Rn!==5&&Rn!==27&&Rn!==6)&&(mn=null)):(Ra=null,mn=Ea),Ra!==mn)){if(Rn=Uc,ja="onMouseLeave",ha="onMouseEnter",sa="mouse",(Te==="pointerout"||Te==="pointerover")&&(Rn=Mi,ja="onPointerLeave",ha="onPointerEnter",sa="pointer"),xi=Ra==null?Ta:Za(Ra),Aa=mn==null?Ta:Za(mn),Ta=new Rn(ja,sa+"leave",Ra,Ue,Pa),Ta.target=xi,Ta.relatedTarget=Aa,ja=null,Ja(Pa)===Ea&&(Rn=new Rn(ha,sa+"enter",mn,Ue,Pa),Rn.target=Aa,Rn.relatedTarget=xi,ja=Rn),xi=ja,Ra&&mn)t:{for(Rn=b1,ha=Ra,sa=mn,Aa=0,ja=ha;ja;ja=Rn(ja))Aa++;ja=0;for(var En=sa;En;En=Rn(En))ja++;for(;0<Aa-ja;)ha=Rn(ha),Aa--;for(;0<ja-Aa;)sa=Rn(sa),ja--;for(;Aa--;){if(ha===sa||sa!==null&&ha===sa.alternate){Rn=ha;break t}ha=Rn(ha),sa=Rn(sa)}Rn=null}else Rn=null;Ra!==null&&pp(Ua,Ta,Ra,Rn,!1),mn!==null&&xi!==null&&pp(Ua,xi,mn,Rn,!0)}}e:{if(Ta=Ea?Za(Ea):window,Ra=Ta.nodeName&&Ta.nodeName.toLowerCase(),Ra==="select"||Ra==="input"&&Ta.type==="file")var ai=cl;else if(Hc(Ta))if(Rs)ai=So;else{ai=Oi;var bn=nc}else Ra=Ta.nodeName,!Ra||Ra.toLowerCase()!=="input"||Ta.type!=="checkbox"&&Ta.type!=="radio"?Ea&&Pc(Ea.elementType)&&(ai=cl):ai=pu;if(ai&&(ai=ai(Te,Ea))){Ms(Ua,ai,Ue,Pa);break e}bn&&bn(Te,Ta,Ea),Te==="focusout"&&Ea&&Ta.type==="number"&&Ea.memoizedProps.value!=null&&Dc(Ta,"number",Ta.value)}switch(bn=Ea?Za(Ea):window,Te){case"focusin":(Hc(bn)||bn.contentEditable==="true")&&(Os=bn,Ko=Ea,ds=null);break;case"focusout":ds=Ko=Os=null;break;case"mousedown":Us=!0;break;case"contextmenu":case"mouseup":case"dragend":Us=!1,ti(Ua,Ue,Pa);break;case"selectionchange":if(Fl)break;case"keydown":case"keyup":ti(Ua,Ue,Pa)}var In;if(vo)e:{switch(Te){case"compositionstart":var Vn="onCompositionStart";break e;case"compositionend":Vn="onCompositionEnd";break e;case"compositionupdate":Vn="onCompositionUpdate";break e}Vn=void 0}else yo?ll(Te,Ue)&&(Vn="onCompositionEnd"):Te==="keydown"&&Ue.keyCode===229&&(Vn="onCompositionStart");Vn&&(Ho&&Ue.locale!=="ko"&&(yo||Vn!=="onCompositionStart"?Vn==="onCompositionEnd"&&yo&&(In=fu()):(Ds=Pa,kl="value"in Ds?Ds.value:Ds.textContent,yo=!0)),bn=oh(Ea,Vn),0<bn.length&&(Vn=new fa(Vn,Te,null,Ue,Pa),Ua.push({event:Vn,listeners:bn}),In?Vn.data=In:(In=tc(Ue),In!==null&&(Vn.data=In)))),(In=Nl?bs(Te,Ue):Xo(Te,Ue))&&(Vn=oh(Ea,"onBeforeInput"),0<Vn.length&&(bn=new fa("onBeforeInput","beforeinput",null,Ue,Pa),Ua.push({event:bn,listeners:Vn}),bn.data=In)),x1(Ua,Te,Ea,Ue,Pa)}hp(Ua,Re)})}function bf(Te,Re,Ue){return{instance:Te,listener:Re,currentTarget:Ue}}function oh(Te,Re){for(var Ue=Re+"Capture",qe=[];Te!==null;){var Ze=Te,er=Ze.stateNode;if(Ze=Ze.tag,Ze!==5&&Ze!==26&&Ze!==27||er===null||(Ze=Ls(Te,Ue),Ze!=null&&qe.unshift(bf(Te,Ze,er)),Ze=Ls(Te,Re),Ze!=null&&qe.push(bf(Te,Ze,er))),Te.tag===3)return qe;Te=Te.return}return[]}function b1(Te){if(Te===null)return null;do Te=Te.return;while(Te&&Te.tag!==5&&Te.tag!==27);return Te||null}function pp(Te,Re,Ue,qe,Ze){for(var er=Re._reactName,Tr=[];Ue!==null&&Ue!==qe;){var jr=Ue,ea=jr.alternate,Ea=jr.stateNode;if(jr=jr.tag,ea!==null&&ea===qe)break;jr!==5&&jr!==26&&jr!==27||Ea===null||(ea=Ea,Ze?(Ea=Ls(Ue,er),Ea!=null&&Tr.unshift(bf(Ue,Ea,ea))):Ze||(Ea=Ls(Ue,er),Ea!=null&&Tr.push(bf(Ue,Ea,ea)))),Ue=Ue.return}Tr.length!==0&&Te.push({event:Re,listeners:Tr})}var S1=/\r\n?/g,A1=/\u0000|\uFFFD/g;function gp(Te){return(typeof Te=="string"?Te:""+Te).replace(S1,`
`).replace(A1,"")}function mp(Te,Re){return Re=gp(Re),gp(Te)===Re}function _i(Te,Re,Ue,qe,Ze,er){switch(Ue){case"children":typeof qe=="string"?Re==="body"||Re==="textarea"&&qe===""||no(Te,qe):(typeof qe=="number"||typeof qe=="bigint")&&Re!=="body"&&no(Te,""+qe);break;case"className":Lo(Te,"class",qe);break;case"tabIndex":Lo(Te,"tabindex",qe);break;case"dir":case"role":case"viewBox":case"width":case"height":Lo(Te,Ue,qe);break;case"style":ou(Te,qe,er);break;case"data":if(Re!=="object"){Lo(Te,"data",qe);break}case"src":case"href":if(qe===""&&(Re!=="a"||Ue!=="href")){Te.removeAttribute(Ue);break}if(qe==null||typeof qe=="function"||typeof qe=="symbol"||typeof qe=="boolean"){Te.removeAttribute(Ue);break}qe=Cs(""+qe),Te.setAttribute(Ue,qe);break;case"action":case"formAction":if(typeof qe=="function"){Te.setAttribute(Ue,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof er=="function"&&(Ue==="formAction"?(Re!=="input"&&_i(Te,Re,"name",Ze.name,Ze,null),_i(Te,Re,"formEncType",Ze.formEncType,Ze,null),_i(Te,Re,"formMethod",Ze.formMethod,Ze,null),_i(Te,Re,"formTarget",Ze.formTarget,Ze,null)):(_i(Te,Re,"encType",Ze.encType,Ze,null),_i(Te,Re,"method",Ze.method,Ze,null),_i(Te,Re,"target",Ze.target,Ze,null)));if(qe==null||typeof qe=="symbol"||typeof qe=="boolean"){Te.removeAttribute(Ue);break}qe=Cs(""+qe),Te.setAttribute(Ue,qe);break;case"onClick":qe!=null&&(Te.onclick=io);break;case"onScroll":qe!=null&&qn("scroll",Te);break;case"onScrollEnd":qe!=null&&qn("scrollend",Te);break;case"dangerouslySetInnerHTML":if(qe!=null){if(typeof qe!="object"||!("__html"in qe))throw Error(n(61));if(Ue=qe.__html,Ue!=null){if(Ze.children!=null)throw Error(n(60));Te.innerHTML=Ue}}break;case"multiple":Te.multiple=qe&&typeof qe!="function"&&typeof qe!="symbol";break;case"muted":Te.muted=qe&&typeof qe!="function"&&typeof qe!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(qe==null||typeof qe=="function"||typeof qe=="boolean"||typeof qe=="symbol"){Te.removeAttribute("xlink:href");break}Ue=Cs(""+qe),Te.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",Ue);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":qe!=null&&typeof qe!="function"&&typeof qe!="symbol"?Te.setAttribute(Ue,""+qe):Te.removeAttribute(Ue);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":qe&&typeof qe!="function"&&typeof qe!="symbol"?Te.setAttribute(Ue,""):Te.removeAttribute(Ue);break;case"capture":case"download":qe===!0?Te.setAttribute(Ue,""):qe!==!1&&qe!=null&&typeof qe!="function"&&typeof qe!="symbol"?Te.setAttribute(Ue,qe):Te.removeAttribute(Ue);break;case"cols":case"rows":case"size":case"span":qe!=null&&typeof qe!="function"&&typeof qe!="symbol"&&!isNaN(qe)&&1<=qe?Te.setAttribute(Ue,qe):Te.removeAttribute(Ue);break;case"rowSpan":case"start":qe==null||typeof qe=="function"||typeof qe=="symbol"||isNaN(qe)?Te.removeAttribute(Ue):Te.setAttribute(Ue,qe);break;case"popover":qn("beforetoggle",Te),qn("toggle",Te),Ai(Te,"popover",qe);break;case"xlinkActuate":ao(Te,"http://www.w3.org/1999/xlink","xlink:actuate",qe);break;case"xlinkArcrole":ao(Te,"http://www.w3.org/1999/xlink","xlink:arcrole",qe);break;case"xlinkRole":ao(Te,"http://www.w3.org/1999/xlink","xlink:role",qe);break;case"xlinkShow":ao(Te,"http://www.w3.org/1999/xlink","xlink:show",qe);break;case"xlinkTitle":ao(Te,"http://www.w3.org/1999/xlink","xlink:title",qe);break;case"xlinkType":ao(Te,"http://www.w3.org/1999/xlink","xlink:type",qe);break;case"xmlBase":ao(Te,"http://www.w3.org/XML/1998/namespace","xml:base",qe);break;case"xmlLang":ao(Te,"http://www.w3.org/XML/1998/namespace","xml:lang",qe);break;case"xmlSpace":ao(Te,"http://www.w3.org/XML/1998/namespace","xml:space",qe);break;case"is":Ai(Te,"is",qe);break;case"innerText":case"textContent":break;default:(!(2<Ue.length)||Ue[0]!=="o"&&Ue[0]!=="O"||Ue[1]!=="n"&&Ue[1]!=="N")&&(Ue=Ic.get(Ue)||Ue,Ai(Te,Ue,qe))}}function g0(Te,Re,Ue,qe,Ze,er){switch(Ue){case"style":ou(Te,qe,er);break;case"dangerouslySetInnerHTML":if(qe!=null){if(typeof qe!="object"||!("__html"in qe))throw Error(n(61));if(Ue=qe.__html,Ue!=null){if(Ze.children!=null)throw Error(n(60));Te.innerHTML=Ue}}break;case"children":typeof qe=="string"?no(Te,qe):(typeof qe=="number"||typeof qe=="bigint")&&no(Te,""+qe);break;case"onScroll":qe!=null&&qn("scroll",Te);break;case"onScrollEnd":qe!=null&&qn("scrollend",Te);break;case"onClick":qe!=null&&(Te.onclick=io);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Un.hasOwnProperty(Ue))e:{if(Ue[0]==="o"&&Ue[1]==="n"&&(Ze=Ue.endsWith("Capture"),Re=Ue.slice(2,Ze?Ue.length-7:void 0),er=Te[Wr]||null,er=er!=null?er[Ue]:null,typeof er=="function"&&Te.removeEventListener(Re,er,Ze),typeof qe=="function")){typeof er!="function"&&er!==null&&(Ue in Te?Te[Ue]=null:Te.hasAttribute(Ue)&&Te.removeAttribute(Ue)),Te.addEventListener(Re,qe,Ze);break e}Ue in Te?Te[Ue]=qe:qe===!0?Te.setAttribute(Ue,""):Ai(Te,Ue,qe)}}}function ks(Te,Re,Ue){switch(Re){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":qn("error",Te),qn("load",Te);var qe=!1,Ze=!1,er;for(er in Ue)if(Ue.hasOwnProperty(er)){var Tr=Ue[er];if(Tr!=null)switch(er){case"src":qe=!0;break;case"srcSet":Ze=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(n(137,Re));default:_i(Te,Re,er,Tr,Ue,null)}}Ze&&_i(Te,Re,"srcSet",Ue.srcSet,Ue,null),qe&&_i(Te,Re,"src",Ue.src,Ue,null);return;case"input":qn("invalid",Te);var jr=er=Tr=Ze=null,ea=null,Ea=null;for(qe in Ue)if(Ue.hasOwnProperty(qe)){var Pa=Ue[qe];if(Pa!=null)switch(qe){case"name":Ze=Pa;break;case"type":Tr=Pa;break;case"checked":ea=Pa;break;case"defaultChecked":Ea=Pa;break;case"value":er=Pa;break;case"defaultValue":jr=Pa;break;case"children":case"dangerouslySetInnerHTML":if(Pa!=null)throw Error(n(137,Re));break;default:_i(Te,Re,qe,Pa,Ue,null)}}iu(Te,er,jr,ea,Ea,Tr,Ze,!1);return;case"select":qn("invalid",Te),qe=Tr=er=null;for(Ze in Ue)if(Ue.hasOwnProperty(Ze)&&(jr=Ue[Ze],jr!=null))switch(Ze){case"value":er=jr;break;case"defaultValue":Tr=jr;break;case"multiple":qe=jr;default:_i(Te,Re,Ze,jr,Ue,null)}Re=er,Ue=Tr,Te.multiple=!!qe,Re!=null?ws(Te,!!qe,Re,!1):Ue!=null&&ws(Te,!!qe,Ue,!0);return;case"textarea":qn("invalid",Te),er=Ze=qe=null;for(Tr in Ue)if(Ue.hasOwnProperty(Tr)&&(jr=Ue[Tr],jr!=null))switch(Tr){case"value":qe=jr;break;case"defaultValue":Ze=jr;break;case"children":er=jr;break;case"dangerouslySetInnerHTML":if(jr!=null)throw Error(n(91));break;default:_i(Te,Re,Tr,jr,Ue,null)}Oc(Te,qe,Ze,er);return;case"option":for(ea in Ue)if(Ue.hasOwnProperty(ea)&&(qe=Ue[ea],qe!=null))switch(ea){case"selected":Te.selected=qe&&typeof qe!="function"&&typeof qe!="symbol";break;default:_i(Te,Re,ea,qe,Ue,null)}return;case"dialog":qn("beforetoggle",Te),qn("toggle",Te),qn("cancel",Te),qn("close",Te);break;case"iframe":case"object":qn("load",Te);break;case"video":case"audio":for(qe=0;qe<wf.length;qe++)qn(wf[qe],Te);break;case"image":qn("error",Te),qn("load",Te);break;case"details":qn("toggle",Te);break;case"embed":case"source":case"link":qn("error",Te),qn("load",Te);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(Ea in Ue)if(Ue.hasOwnProperty(Ea)&&(qe=Ue[Ea],qe!=null))switch(Ea){case"children":case"dangerouslySetInnerHTML":throw Error(n(137,Re));default:_i(Te,Re,Ea,qe,Ue,null)}return;default:if(Pc(Re)){for(Pa in Ue)Ue.hasOwnProperty(Pa)&&(qe=Ue[Pa],qe!==void 0&&g0(Te,Re,Pa,qe,Ue,void 0));return}}for(jr in Ue)Ue.hasOwnProperty(jr)&&(qe=Ue[jr],qe!=null&&_i(Te,Re,jr,qe,Ue,null))}function E1(Te,Re,Ue,qe){switch(Re){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var Ze=null,er=null,Tr=null,jr=null,ea=null,Ea=null,Pa=null;for(Ra in Ue){var Ua=Ue[Ra];if(Ue.hasOwnProperty(Ra)&&Ua!=null)switch(Ra){case"checked":break;case"value":break;case"defaultValue":ea=Ua;default:qe.hasOwnProperty(Ra)||_i(Te,Re,Ra,null,qe,Ua)}}for(var Ta in qe){var Ra=qe[Ta];if(Ua=Ue[Ta],qe.hasOwnProperty(Ta)&&(Ra!=null||Ua!=null))switch(Ta){case"type":er=Ra;break;case"name":Ze=Ra;break;case"checked":Ea=Ra;break;case"defaultChecked":Pa=Ra;break;case"value":Tr=Ra;break;case"defaultValue":jr=Ra;break;case"children":case"dangerouslySetInnerHTML":if(Ra!=null)throw Error(n(137,Re));break;default:Ra!==Ua&&_i(Te,Re,Ta,Ra,qe,Ua)}}$l(Te,Tr,jr,ea,Ea,Pa,er,Ze);return;case"select":Ra=Tr=jr=Ta=null;for(er in Ue)if(ea=Ue[er],Ue.hasOwnProperty(er)&&ea!=null)switch(er){case"value":break;case"multiple":Ra=ea;default:qe.hasOwnProperty(er)||_i(Te,Re,er,null,qe,ea)}for(Ze in qe)if(er=qe[Ze],ea=Ue[Ze],qe.hasOwnProperty(Ze)&&(er!=null||ea!=null))switch(Ze){case"value":Ta=er;break;case"defaultValue":jr=er;break;case"multiple":Tr=er;default:er!==ea&&_i(Te,Re,Ze,er,qe,ea)}Re=jr,Ue=Tr,qe=Ra,Ta!=null?ws(Te,!!Ue,Ta,!1):!!qe!=!!Ue&&(Re!=null?ws(Te,!!Ue,Re,!0):ws(Te,!!Ue,Ue?[]:"",!1));return;case"textarea":Ra=Ta=null;for(jr in Ue)if(Ze=Ue[jr],Ue.hasOwnProperty(jr)&&Ze!=null&&!qe.hasOwnProperty(jr))switch(jr){case"value":break;case"children":break;default:_i(Te,Re,jr,null,qe,Ze)}for(Tr in qe)if(Ze=qe[Tr],er=Ue[Tr],qe.hasOwnProperty(Tr)&&(Ze!=null||er!=null))switch(Tr){case"value":Ta=Ze;break;case"defaultValue":Ra=Ze;break;case"children":break;case"dangerouslySetInnerHTML":if(Ze!=null)throw Error(n(91));break;default:Ze!==er&&_i(Te,Re,Tr,Ze,qe,er)}Mc(Te,Ta,Ra);return;case"option":for(var mn in Ue)if(Ta=Ue[mn],Ue.hasOwnProperty(mn)&&Ta!=null&&!qe.hasOwnProperty(mn))switch(mn){case"selected":Te.selected=!1;break;default:_i(Te,Re,mn,null,qe,Ta)}for(ea in qe)if(Ta=qe[ea],Ra=Ue[ea],qe.hasOwnProperty(ea)&&Ta!==Ra&&(Ta!=null||Ra!=null))switch(ea){case"selected":Te.selected=Ta&&typeof Ta!="function"&&typeof Ta!="symbol";break;default:_i(Te,Re,ea,Ta,qe,Ra)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Rn in Ue)Ta=Ue[Rn],Ue.hasOwnProperty(Rn)&&Ta!=null&&!qe.hasOwnProperty(Rn)&&_i(Te,Re,Rn,null,qe,Ta);for(Ea in qe)if(Ta=qe[Ea],Ra=Ue[Ea],qe.hasOwnProperty(Ea)&&Ta!==Ra&&(Ta!=null||Ra!=null))switch(Ea){case"children":case"dangerouslySetInnerHTML":if(Ta!=null)throw Error(n(137,Re));break;default:_i(Te,Re,Ea,Ta,qe,Ra)}return;default:if(Pc(Re)){for(var xi in Ue)Ta=Ue[xi],Ue.hasOwnProperty(xi)&&Ta!==void 0&&!qe.hasOwnProperty(xi)&&g0(Te,Re,xi,void 0,qe,Ta);for(Pa in qe)Ta=qe[Pa],Ra=Ue[Pa],!qe.hasOwnProperty(Pa)||Ta===Ra||Ta===void 0&&Ra===void 0||g0(Te,Re,Pa,Ta,qe,Ra);return}}for(var ha in Ue)Ta=Ue[ha],Ue.hasOwnProperty(ha)&&Ta!=null&&!qe.hasOwnProperty(ha)&&_i(Te,Re,ha,null,qe,Ta);for(Ua in qe)Ta=qe[Ua],Ra=Ue[Ua],!qe.hasOwnProperty(Ua)||Ta===Ra||Ta==null&&Ra==null||_i(Te,Re,Ua,Ta,qe,Ra)}function _p(Te){switch(Te){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function T1(){if(typeof performance.getEntriesByType=="function"){for(var Te=0,Re=0,Ue=performance.getEntriesByType("resource"),qe=0;qe<Ue.length;qe++){var Ze=Ue[qe],er=Ze.transferSize,Tr=Ze.initiatorType,jr=Ze.duration;if(er&&jr&&_p(Tr)){for(Tr=0,jr=Ze.responseEnd,qe+=1;qe<Ue.length;qe++){var ea=Ue[qe],Ea=ea.startTime;if(Ea>jr)break;var Pa=ea.transferSize,Ua=ea.initiatorType;Pa&&_p(Ua)&&(ea=ea.responseEnd,Tr+=Pa*(ea<jr?1:(jr-Ea)/(ea-Ea)))}if(--qe,Re+=8*(er+Tr)/(Ze.duration/1e3),Te++,10<Te)break}}if(0<Te)return Re/Te/1e6}return navigator.connection&&(Te=navigator.connection.downlink,typeof Te=="number")?Te:5}var m0=null,_0=null;function lh(Te){return Te.nodeType===9?Te:Te.ownerDocument}function xp(Te){switch(Te){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function vp(Te,Re){if(Te===0)switch(Re){case"svg":return 1;case"math":return 2;default:return 0}return Te===1&&Re==="foreignObject"?0:Te}function x0(Te,Re){return Te==="textarea"||Te==="noscript"||typeof Re.children=="string"||typeof Re.children=="number"||typeof Re.children=="bigint"||typeof Re.dangerouslySetInnerHTML=="object"&&Re.dangerouslySetInnerHTML!==null&&Re.dangerouslySetInnerHTML.__html!=null}var v0=null;function k1(){var Te=window.event;return Te&&Te.type==="popstate"?Te===v0?!1:(v0=Te,!0):(v0=null,!1)}var yp=typeof setTimeout=="function"?setTimeout:void 0,C1=typeof clearTimeout=="function"?clearTimeout:void 0,wp=typeof Promise=="function"?Promise:void 0,R1=typeof queueMicrotask=="function"?queueMicrotask:typeof wp<"u"?function(Te){return wp.resolve(null).then(Te).catch(N1)}:yp;function N1(Te){setTimeout(function(){throw Te})}function Ec(Te){return Te==="head"}function bp(Te,Re){var Ue=Re,qe=0;do{var Ze=Ue.nextSibling;if(Te.removeChild(Ue),Ze&&Ze.nodeType===8)if(Ue=Ze.data,Ue==="/$"||Ue==="/&"){if(qe===0){Te.removeChild(Ze),Gu(Re);return}qe--}else if(Ue==="$"||Ue==="$?"||Ue==="$~"||Ue==="$!"||Ue==="&")qe++;else if(Ue==="html")Sf(Te.ownerDocument.documentElement);else if(Ue==="head"){Ue=Te.ownerDocument.head,Sf(Ue);for(var er=Ue.firstChild;er;){var Tr=er.nextSibling,jr=er.nodeName;er[Sa]||jr==="SCRIPT"||jr==="STYLE"||jr==="LINK"&&er.rel.toLowerCase()==="stylesheet"||Ue.removeChild(er),er=Tr}}else Ue==="body"&&Sf(Te.ownerDocument.body);Ue=Ze}while(Ue);Gu(Re)}function Sp(Te,Re){var Ue=Te;Te=0;do{var qe=Ue.nextSibling;if(Ue.nodeType===1?Re?(Ue._stashedDisplay=Ue.style.display,Ue.style.display="none"):(Ue.style.display=Ue._stashedDisplay||"",Ue.getAttribute("style")===""&&Ue.removeAttribute("style")):Ue.nodeType===3&&(Re?(Ue._stashedText=Ue.nodeValue,Ue.nodeValue=""):Ue.nodeValue=Ue._stashedText||""),qe&&qe.nodeType===8)if(Ue=qe.data,Ue==="/$"){if(Te===0)break;Te--}else Ue!=="$"&&Ue!=="$?"&&Ue!=="$~"&&Ue!=="$!"||Te++;Ue=qe}while(Ue)}function y0(Te){var Re=Te.firstChild;for(Re&&Re.nodeType===10&&(Re=Re.nextSibling);Re;){var Ue=Re;switch(Re=Re.nextSibling,Ue.nodeName){case"HTML":case"HEAD":case"BODY":y0(Ue),Va(Ue);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(Ue.rel.toLowerCase()==="stylesheet")continue}Te.removeChild(Ue)}}function F1(Te,Re,Ue,qe){for(;Te.nodeType===1;){var Ze=Ue;if(Te.nodeName.toLowerCase()!==Re.toLowerCase()){if(!qe&&(Te.nodeName!=="INPUT"||Te.type!=="hidden"))break}else if(qe){if(!Te[Sa])switch(Re){case"meta":if(!Te.hasAttribute("itemprop"))break;return Te;case"link":if(er=Te.getAttribute("rel"),er==="stylesheet"&&Te.hasAttribute("data-precedence"))break;if(er!==Ze.rel||Te.getAttribute("href")!==(Ze.href==null||Ze.href===""?null:Ze.href)||Te.getAttribute("crossorigin")!==(Ze.crossOrigin==null?null:Ze.crossOrigin)||Te.getAttribute("title")!==(Ze.title==null?null:Ze.title))break;return Te;case"style":if(Te.hasAttribute("data-precedence"))break;return Te;case"script":if(er=Te.getAttribute("src"),(er!==(Ze.src==null?null:Ze.src)||Te.getAttribute("type")!==(Ze.type==null?null:Ze.type)||Te.getAttribute("crossorigin")!==(Ze.crossOrigin==null?null:Ze.crossOrigin))&&er&&Te.hasAttribute("async")&&!Te.hasAttribute("itemprop"))break;return Te;default:return Te}}else if(Re==="input"&&Te.type==="hidden"){var er=Ze.name==null?null:""+Ze.name;if(Ze.type==="hidden"&&Te.getAttribute("name")===er)return Te}else return Te;if(Te=No(Te.nextSibling),Te===null)break}return null}function L1(Te,Re,Ue){if(Re==="")return null;for(;Te.nodeType!==3;)if((Te.nodeType!==1||Te.nodeName!=="INPUT"||Te.type!=="hidden")&&!Ue||(Te=No(Te.nextSibling),Te===null))return null;return Te}function Ap(Te,Re){for(;Te.nodeType!==8;)if((Te.nodeType!==1||Te.nodeName!=="INPUT"||Te.type!=="hidden")&&!Re||(Te=No(Te.nextSibling),Te===null))return null;return Te}function w0(Te){return Te.data==="$?"||Te.data==="$~"}function b0(Te){return Te.data==="$!"||Te.data==="$?"&&Te.ownerDocument.readyState!=="loading"}function D1(Te,Re){var Ue=Te.ownerDocument;if(Te.data==="$~")Te._reactRetry=Re;else if(Te.data!=="$?"||Ue.readyState!=="loading")Re();else{var qe=function(){Re(),Ue.removeEventListener("DOMContentLoaded",qe)};Ue.addEventListener("DOMContentLoaded",qe),Te._reactRetry=qe}}function No(Te){for(;Te!=null;Te=Te.nextSibling){var Re=Te.nodeType;if(Re===1||Re===3)break;if(Re===8){if(Re=Te.data,Re==="$"||Re==="$!"||Re==="$?"||Re==="$~"||Re==="&"||Re==="F!"||Re==="F")break;if(Re==="/$"||Re==="/&")return null}}return Te}var S0=null;function Ep(Te){Te=Te.nextSibling;for(var Re=0;Te;){if(Te.nodeType===8){var Ue=Te.data;if(Ue==="/$"||Ue==="/&"){if(Re===0)return No(Te.nextSibling);Re--}else Ue!=="$"&&Ue!=="$!"&&Ue!=="$?"&&Ue!=="$~"&&Ue!=="&"||Re++}Te=Te.nextSibling}return null}function Tp(Te){Te=Te.previousSibling;for(var Re=0;Te;){if(Te.nodeType===8){var Ue=Te.data;if(Ue==="$"||Ue==="$!"||Ue==="$?"||Ue==="$~"||Ue==="&"){if(Re===0)return Te;Re--}else Ue!=="/$"&&Ue!=="/&"||Re++}Te=Te.previousSibling}return null}function kp(Te,Re,Ue){switch(Re=lh(Ue),Te){case"html":if(Te=Re.documentElement,!Te)throw Error(n(452));return Te;case"head":if(Te=Re.head,!Te)throw Error(n(453));return Te;case"body":if(Te=Re.body,!Te)throw Error(n(454));return Te;default:throw Error(n(451))}}function Sf(Te){for(var Re=Te.attributes;Re.length;)Te.removeAttributeNode(Re[0]);Va(Te)}var Fo=new Map,Cp=new Set;function ch(Te){return typeof Te.getRootNode=="function"?Te.getRootNode():Te.nodeType===9?Te:Te.ownerDocument}var Kl=Ar.d;Ar.d={f:M1,r:O1,D:P1,C:I1,L:B1,m:j1,X:z1,S:U1,M:H1};function M1(){var Te=Kl.f(),Re=eh();return Te||Re}function O1(Te){var Re=an(Te);Re!==null&&Re.tag===5&&Re.type==="form"?q0(Re):Kl.r(Te)}var qu=typeof document>"u"?null:document;function Rp(Te,Re,Ue){var qe=qu;if(qe&&typeof Re=="string"&&Re){var Ze=ji(Re);Ze='link[rel="'+Te+'"][href="'+Ze+'"]',typeof Ue=="string"&&(Ze+='[crossorigin="'+Ue+'"]'),Cp.has(Ze)||(Cp.add(Ze),Te={rel:Te,crossOrigin:Ue,href:Re},qe.querySelector(Ze)===null&&(Re=qe.createElement("link"),ks(Re,"link",Te),dn(Re),qe.head.appendChild(Re)))}}function P1(Te){Kl.D(Te),Rp("dns-prefetch",Te,null)}function I1(Te,Re){Kl.C(Te,Re),Rp("preconnect",Te,Re)}function B1(Te,Re,Ue){Kl.L(Te,Re,Ue);var qe=qu;if(qe&&Te&&Re){var Ze='link[rel="preload"][as="'+ji(Re)+'"]';Re==="image"&&Ue&&Ue.imageSrcSet?(Ze+='[imagesrcset="'+ji(Ue.imageSrcSet)+'"]',typeof Ue.imageSizes=="string"&&(Ze+='[imagesizes="'+ji(Ue.imageSizes)+'"]')):Ze+='[href="'+ji(Te)+'"]';var er=Ze;switch(Re){case"style":er=Wu(Te);break;case"script":er=Vu(Te)}Fo.has(er)||(Te=He({rel:"preload",href:Re==="image"&&Ue&&Ue.imageSrcSet?void 0:Te,as:Re},Ue),Fo.set(er,Te),qe.querySelector(Ze)!==null||Re==="style"&&qe.querySelector(Af(er))||Re==="script"&&qe.querySelector(Ef(er))||(Re=qe.createElement("link"),ks(Re,"link",Te),dn(Re),qe.head.appendChild(Re)))}}function j1(Te,Re){Kl.m(Te,Re);var Ue=qu;if(Ue&&Te){var qe=Re&&typeof Re.as=="string"?Re.as:"script",Ze='link[rel="modulepreload"][as="'+ji(qe)+'"][href="'+ji(Te)+'"]',er=Ze;switch(qe){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":er=Vu(Te)}if(!Fo.has(er)&&(Te=He({rel:"modulepreload",href:Te},Re),Fo.set(er,Te),Ue.querySelector(Ze)===null)){switch(qe){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(Ue.querySelector(Ef(er)))return}qe=Ue.createElement("link"),ks(qe,"link",Te),dn(qe),Ue.head.appendChild(qe)}}}function U1(Te,Re,Ue){Kl.S(Te,Re,Ue);var qe=qu;if(qe&&Te){var Ze=tn(qe).hoistableStyles,er=Wu(Te);Re=Re||"default";var Tr=Ze.get(er);if(!Tr){var jr={loading:0,preload:null};if(Tr=qe.querySelector(Af(er)))jr.loading=5;else{Te=He({rel:"stylesheet",href:Te,"data-precedence":Re},Ue),(Ue=Fo.get(er))&&A0(Te,Ue);var ea=Tr=qe.createElement("link");dn(ea),ks(ea,"link",Te),ea._p=new Promise(function(Ea,Pa){ea.onload=Ea,ea.onerror=Pa}),ea.addEventListener("load",function(){jr.loading|=1}),ea.addEventListener("error",function(){jr.loading|=2}),jr.loading|=4,uh(Tr,Re,qe)}Tr={type:"stylesheet",instance:Tr,count:1,state:jr},Ze.set(er,Tr)}}}function z1(Te,Re){Kl.X(Te,Re);var Ue=qu;if(Ue&&Te){var qe=tn(Ue).hoistableScripts,Ze=Vu(Te),er=qe.get(Ze);er||(er=Ue.querySelector(Ef(Ze)),er||(Te=He({src:Te,async:!0},Re),(Re=Fo.get(Ze))&&E0(Te,Re),er=Ue.createElement("script"),dn(er),ks(er,"link",Te),Ue.head.appendChild(er)),er={type:"script",instance:er,count:1,state:null},qe.set(Ze,er))}}function H1(Te,Re){Kl.M(Te,Re);var Ue=qu;if(Ue&&Te){var qe=tn(Ue).hoistableScripts,Ze=Vu(Te),er=qe.get(Ze);er||(er=Ue.querySelector(Ef(Ze)),er||(Te=He({src:Te,async:!0,type:"module"},Re),(Re=Fo.get(Ze))&&E0(Te,Re),er=Ue.createElement("script"),dn(er),ks(er,"link",Te),Ue.head.appendChild(er)),er={type:"script",instance:er,count:1,state:null},qe.set(Ze,er))}}function Np(Te,Re,Ue,qe){var Ze=(Ze=St.current)?ch(Ze):null;if(!Ze)throw Error(n(446));switch(Te){case"meta":case"title":return null;case"style":return typeof Ue.precedence=="string"&&typeof Ue.href=="string"?(Re=Wu(Ue.href),Ue=tn(Ze).hoistableStyles,qe=Ue.get(Re),qe||(qe={type:"style",instance:null,count:0,state:null},Ue.set(Re,qe)),qe):{type:"void",instance:null,count:0,state:null};case"link":if(Ue.rel==="stylesheet"&&typeof Ue.href=="string"&&typeof Ue.precedence=="string"){Te=Wu(Ue.href);var er=tn(Ze).hoistableStyles,Tr=er.get(Te);if(Tr||(Ze=Ze.ownerDocument||Ze,Tr={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},er.set(Te,Tr),(er=Ze.querySelector(Af(Te)))&&!er._p&&(Tr.instance=er,Tr.state.loading=5),Fo.has(Te)||(Ue={rel:"preload",as:"style",href:Ue.href,crossOrigin:Ue.crossOrigin,integrity:Ue.integrity,media:Ue.media,hrefLang:Ue.hrefLang,referrerPolicy:Ue.referrerPolicy},Fo.set(Te,Ue),er||X1(Ze,Te,Ue,Tr.state))),Re&&qe===null)throw Error(n(528,""));return Tr}if(Re&&qe!==null)throw Error(n(529,""));return null;case"script":return Re=Ue.async,Ue=Ue.src,typeof Ue=="string"&&Re&&typeof Re!="function"&&typeof Re!="symbol"?(Re=Vu(Ue),Ue=tn(Ze).hoistableScripts,qe=Ue.get(Re),qe||(qe={type:"script",instance:null,count:0,state:null},Ue.set(Re,qe)),qe):{type:"void",instance:null,count:0,state:null};default:throw Error(n(444,Te))}}function Wu(Te){return'href="'+ji(Te)+'"'}function Af(Te){return'link[rel="stylesheet"]['+Te+"]"}function Fp(Te){return He({},Te,{"data-precedence":Te.precedence,precedence:null})}function X1(Te,Re,Ue,qe){Te.querySelector('link[rel="preload"][as="style"]['+Re+"]")?qe.loading=1:(Re=Te.createElement("link"),qe.preload=Re,Re.addEventListener("load",function(){return qe.loading|=1}),Re.addEventListener("error",function(){return qe.loading|=2}),ks(Re,"link",Ue),dn(Re),Te.head.appendChild(Re))}function Vu(Te){return'[src="'+ji(Te)+'"]'}function Ef(Te){return"script[async]"+Te}function Lp(Te,Re,Ue){if(Re.count++,Re.instance===null)switch(Re.type){case"style":var qe=Te.querySelector('style[data-href~="'+ji(Ue.href)+'"]');if(qe)return Re.instance=qe,dn(qe),qe;var Ze=He({},Ue,{"data-href":Ue.href,"data-precedence":Ue.precedence,href:null,precedence:null});return qe=(Te.ownerDocument||Te).createElement("style"),dn(qe),ks(qe,"style",Ze),uh(qe,Ue.precedence,Te),Re.instance=qe;case"stylesheet":Ze=Wu(Ue.href);var er=Te.querySelector(Af(Ze));if(er)return Re.state.loading|=4,Re.instance=er,dn(er),er;qe=Fp(Ue),(Ze=Fo.get(Ze))&&A0(qe,Ze),er=(Te.ownerDocument||Te).createElement("link"),dn(er);var Tr=er;return Tr._p=new Promise(function(jr,ea){Tr.onload=jr,Tr.onerror=ea}),ks(er,"link",qe),Re.state.loading|=4,uh(er,Ue.precedence,Te),Re.instance=er;case"script":return er=Vu(Ue.src),(Ze=Te.querySelector(Ef(er)))?(Re.instance=Ze,dn(Ze),Ze):(qe=Ue,(Ze=Fo.get(er))&&(qe=He({},Ue),E0(qe,Ze)),Te=Te.ownerDocument||Te,Ze=Te.createElement("script"),dn(Ze),ks(Ze,"link",qe),Te.head.appendChild(Ze),Re.instance=Ze);case"void":return null;default:throw Error(n(443,Re.type))}else Re.type==="stylesheet"&&(Re.state.loading&4)===0&&(qe=Re.instance,Re.state.loading|=4,uh(qe,Ue.precedence,Te));return Re.instance}function uh(Te,Re,Ue){for(var qe=Ue.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),Ze=qe.length?qe[qe.length-1]:null,er=Ze,Tr=0;Tr<qe.length;Tr++){var jr=qe[Tr];if(jr.dataset.precedence===Re)er=jr;else if(er!==Ze)break}er?er.parentNode.insertBefore(Te,er.nextSibling):(Re=Ue.nodeType===9?Ue.head:Ue,Re.insertBefore(Te,Re.firstChild))}function A0(Te,Re){Te.crossOrigin==null&&(Te.crossOrigin=Re.crossOrigin),Te.referrerPolicy==null&&(Te.referrerPolicy=Re.referrerPolicy),Te.title==null&&(Te.title=Re.title)}function E0(Te,Re){Te.crossOrigin==null&&(Te.crossOrigin=Re.crossOrigin),Te.referrerPolicy==null&&(Te.referrerPolicy=Re.referrerPolicy),Te.integrity==null&&(Te.integrity=Re.integrity)}var fh=null;function Dp(Te,Re,Ue){if(fh===null){var qe=new Map,Ze=fh=new Map;Ze.set(Ue,qe)}else Ze=fh,qe=Ze.get(Ue),qe||(qe=new Map,Ze.set(Ue,qe));if(qe.has(Te))return qe;for(qe.set(Te,null),Ue=Ue.getElementsByTagName(Te),Ze=0;Ze<Ue.length;Ze++){var er=Ue[Ze];if(!(er[Sa]||er[Xr]||Te==="link"&&er.getAttribute("rel")==="stylesheet")&&er.namespaceURI!=="http://www.w3.org/2000/svg"){var Tr=er.getAttribute(Re)||"";Tr=Te+Tr;var jr=qe.get(Tr);jr?jr.push(er):qe.set(Tr,[er])}}return qe}function Mp(Te,Re,Ue){Te=Te.ownerDocument||Te,Te.head.insertBefore(Ue,Re==="title"?Te.querySelector("head > title"):null)}function q1(Te,Re,Ue){if(Ue===1||Re.itemProp!=null)return!1;switch(Te){case"meta":case"title":return!0;case"style":if(typeof Re.precedence!="string"||typeof Re.href!="string"||Re.href==="")break;return!0;case"link":if(typeof Re.rel!="string"||typeof Re.href!="string"||Re.href===""||Re.onLoad||Re.onError)break;switch(Re.rel){case"stylesheet":return Te=Re.disabled,typeof Re.precedence=="string"&&Te==null;default:return!0}case"script":if(Re.async&&typeof Re.async!="function"&&typeof Re.async!="symbol"&&!Re.onLoad&&!Re.onError&&Re.src&&typeof Re.src=="string")return!0}return!1}function Op(Te){return!(Te.type==="stylesheet"&&(Te.state.loading&3)===0)}function W1(Te,Re,Ue,qe){if(Ue.type==="stylesheet"&&(typeof qe.media!="string"||matchMedia(qe.media).matches!==!1)&&(Ue.state.loading&4)===0){if(Ue.instance===null){var Ze=Wu(qe.href),er=Re.querySelector(Af(Ze));if(er){Re=er._p,Re!==null&&typeof Re=="object"&&typeof Re.then=="function"&&(Te.count++,Te=hh.bind(Te),Re.then(Te,Te)),Ue.state.loading|=4,Ue.instance=er,dn(er);return}er=Re.ownerDocument||Re,qe=Fp(qe),(Ze=Fo.get(Ze))&&A0(qe,Ze),er=er.createElement("link"),dn(er);var Tr=er;Tr._p=new Promise(function(jr,ea){Tr.onload=jr,Tr.onerror=ea}),ks(er,"link",qe),Ue.instance=er}Te.stylesheets===null&&(Te.stylesheets=new Map),Te.stylesheets.set(Ue,Re),(Re=Ue.state.preload)&&(Ue.state.loading&3)===0&&(Te.count++,Ue=hh.bind(Te),Re.addEventListener("load",Ue),Re.addEventListener("error",Ue))}}var T0=0;function V1(Te,Re){return Te.stylesheets&&Te.count===0&&ph(Te,Te.stylesheets),0<Te.count||0<Te.imgCount?function(Ue){var qe=setTimeout(function(){if(Te.stylesheets&&ph(Te,Te.stylesheets),Te.unsuspend){var er=Te.unsuspend;Te.unsuspend=null,er()}},6e4+Re);0<Te.imgBytes&&T0===0&&(T0=62500*T1());var Ze=setTimeout(function(){if(Te.waitingForImages=!1,Te.count===0&&(Te.stylesheets&&ph(Te,Te.stylesheets),Te.unsuspend)){var er=Te.unsuspend;Te.unsuspend=null,er()}},(Te.imgBytes>T0?50:800)+Re);return Te.unsuspend=Ue,function(){Te.unsuspend=null,clearTimeout(qe),clearTimeout(Ze)}}:null}function hh(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)ph(this,this.stylesheets);else if(this.unsuspend){var Te=this.unsuspend;this.unsuspend=null,Te()}}}var dh=null;function ph(Te,Re){Te.stylesheets=null,Te.unsuspend!==null&&(Te.count++,dh=new Map,Re.forEach(G1,Te),dh=null,hh.call(Te))}function G1(Te,Re){if(!(Re.state.loading&4)){var Ue=dh.get(Te);if(Ue)var qe=Ue.get(null);else{Ue=new Map,dh.set(Te,Ue);for(var Ze=Te.querySelectorAll("link[data-precedence],style[data-precedence]"),er=0;er<Ze.length;er++){var Tr=Ze[er];(Tr.nodeName==="LINK"||Tr.getAttribute("media")!=="not all")&&(Ue.set(Tr.dataset.precedence,Tr),qe=Tr)}qe&&Ue.set(null,qe)}Ze=Re.instance,Tr=Ze.getAttribute("data-precedence"),er=Ue.get(Tr)||qe,er===qe&&Ue.set(null,Ze),Ue.set(Tr,Ze),this.count++,qe=hh.bind(this),Ze.addEventListener("load",qe),Ze.addEventListener("error",qe),er?er.parentNode.insertBefore(Ze,er.nextSibling):(Te=Te.nodeType===9?Te.head:Te,Te.insertBefore(Ze,Te.firstChild)),Re.state.loading|=4}}var Tf={$$typeof:tr,Provider:null,Consumer:null,_currentValue:xr,_currentValue2:xr,_threadCount:0};function Y1(Te,Re,Ue,qe,Ze,er,Tr,jr,ea){this.tag=1,this.containerInfo=Te,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Tn(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Tn(0),this.hiddenUpdates=Tn(null),this.identifierPrefix=qe,this.onUncaughtError=Ze,this.onCaughtError=er,this.onRecoverableError=Tr,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ea,this.incompleteTransitions=new Map}function Pp(Te,Re,Ue,qe,Ze,er,Tr,jr,ea,Ea,Pa,Ua){return Te=new Y1(Te,Re,Ue,Tr,ea,Ea,Pa,Ua,jr),Re=1,er===!0&&(Re|=24),er=gs(3,null,null,Re),Te.current=er,er.stateNode=Te,Re=dc(),Re.refCount++,Te.pooledCache=Re,Re.refCount++,er.memoizedState={element:qe,isDehydrated:Ue,cache:Re},rn(er),Te}function Ip(Te){return Te?(Te=os,Te):os}function Bp(Te,Re,Ue,qe,Ze,er){Ze=Ip(Ze),qe.context===null?qe.context=Ze:qe.pendingContext=Ze,qe=Cn(Re),qe.payload={element:Ue},er=er===void 0?null:er,er!==null&&(qe.callback=er),Ue=Pn(Te,qe,Re),Ue!==null&&(eo(Ue,Te,Re),si(Ue,Te,Re))}function jp(Te,Re){if(Te=Te.memoizedState,Te!==null&&Te.dehydrated!==null){var Ue=Te.retryLane;Te.retryLane=Ue!==0&&Ue<Re?Ue:Re}}function k0(Te,Re){jp(Te,Re),(Te=Te.alternate)&&jp(Te,Re)}function Up(Te){if(Te.tag===13||Te.tag===31){var Re=$o(Te,67108864);Re!==null&&eo(Re,Te,67108864),k0(Te,67108864)}}function zp(Te){if(Te.tag===13||Te.tag===31){var Re=go();Re=Ln(Re);var Ue=$o(Te,Re);Ue!==null&&eo(Ue,Te,Re),k0(Te,Re)}}var gh=!0;function K1(Te,Re,Ue,qe){var Ze=Nr.T;Nr.T=null;var er=Ar.p;try{Ar.p=2,C0(Te,Re,Ue,qe)}finally{Ar.p=er,Nr.T=Ze}}function $1(Te,Re,Ue,qe){var Ze=Nr.T;Nr.T=null;var er=Ar.p;try{Ar.p=8,C0(Te,Re,Ue,qe)}finally{Ar.p=er,Nr.T=Ze}}function C0(Te,Re,Ue,qe){if(gh){var Ze=R0(qe);if(Ze===null)p0(Te,Re,qe,mh,Ue),Xp(Te,qe);else if(J1(Ze,Te,Re,Ue,qe))qe.stopPropagation();else if(Xp(Te,qe),Re&4&&-1<Z1.indexOf(Te)){for(;Ze!==null;){var er=an(Ze);if(er!==null)switch(er.tag){case 3:if(er=er.stateNode,er.current.memoizedState.isDehydrated){var Tr=La(er.pendingLanes);if(Tr!==0){var jr=er;for(jr.pendingLanes|=2,jr.entangledLanes|=2;Tr;){var ea=1<<31-ia(Tr);jr.entanglements[1]|=ea,Tr&=~ea}Sl(er),(li&6)===0&&(Jf=Ya()+500,yf(0))}}break;case 31:case 13:jr=$o(er,2),jr!==null&&eo(jr,er,2),eh(),k0(er,2)}if(er=R0(qe),er===null&&p0(Te,Re,qe,mh,Ue),er===Ze)break;Ze=er}Ze!==null&&qe.stopPropagation()}else p0(Te,Re,qe,null,Ue)}}function R0(Te){return Te=El(Te),N0(Te)}var mh=null;function N0(Te){if(mh=null,Te=Ja(Te),Te!==null){var Re=Ce(Te);if(Re===null)Te=null;else{var Ue=Re.tag;if(Ue===13){if(Te=De(Re),Te!==null)return Te;Te=null}else if(Ue===31){if(Te=Me(Re),Te!==null)return Te;Te=null}else if(Ue===3){if(Re.stateNode.current.memoizedState.isDehydrated)return Re.tag===3?Re.stateNode.containerInfo:null;Te=null}else Re!==Te&&(Te=null)}}return mh=Te,null}function Hp(Te){switch(Te){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(nn()){case on:return 2;case yn:return 8;case fn:case Qa:return 32;case Ka:return 268435456;default:return 32}default:return 32}}var F0=!1,Tc=null,kc=null,Cc=null,kf=new Map,Cf=new Map,Rc=[],Z1="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function Xp(Te,Re){switch(Te){case"focusin":case"focusout":Tc=null;break;case"dragenter":case"dragleave":kc=null;break;case"mouseover":case"mouseout":Cc=null;break;case"pointerover":case"pointerout":kf.delete(Re.pointerId);break;case"gotpointercapture":case"lostpointercapture":Cf.delete(Re.pointerId)}}function Rf(Te,Re,Ue,qe,Ze,er){return Te===null||Te.nativeEvent!==er?(Te={blockedOn:Re,domEventName:Ue,eventSystemFlags:qe,nativeEvent:er,targetContainers:[Ze]},Re!==null&&(Re=an(Re),Re!==null&&Up(Re)),Te):(Te.eventSystemFlags|=qe,Re=Te.targetContainers,Ze!==null&&Re.indexOf(Ze)===-1&&Re.push(Ze),Te)}function J1(Te,Re,Ue,qe,Ze){switch(Re){case"focusin":return Tc=Rf(Tc,Te,Re,Ue,qe,Ze),!0;case"dragenter":return kc=Rf(kc,Te,Re,Ue,qe,Ze),!0;case"mouseover":return Cc=Rf(Cc,Te,Re,Ue,qe,Ze),!0;case"pointerover":var er=Ze.pointerId;return kf.set(er,Rf(kf.get(er)||null,Te,Re,Ue,qe,Ze)),!0;case"gotpointercapture":return er=Ze.pointerId,Cf.set(er,Rf(Cf.get(er)||null,Te,Re,Ue,qe,Ze)),!0}return!1}function qp(Te){var Re=Ja(Te.target);if(Re!==null){var Ue=Ce(Re);if(Ue!==null){if(Re=Ue.tag,Re===13){if(Re=De(Ue),Re!==null){Te.blockedOn=Re,Yr(Te.priority,function(){zp(Ue)});return}}else if(Re===31){if(Re=Me(Ue),Re!==null){Te.blockedOn=Re,Yr(Te.priority,function(){zp(Ue)});return}}else if(Re===3&&Ue.stateNode.current.memoizedState.isDehydrated){Te.blockedOn=Ue.tag===3?Ue.stateNode.containerInfo:null;return}}}Te.blockedOn=null}function _h(Te){if(Te.blockedOn!==null)return!1;for(var Re=Te.targetContainers;0<Re.length;){var Ue=R0(Te.nativeEvent);if(Ue===null){Ue=Te.nativeEvent;var qe=new Ue.constructor(Ue.type,Ue);Do=qe,Ue.target.dispatchEvent(qe),Do=null}else return Re=an(Ue),Re!==null&&Up(Re),Te.blockedOn=Ue,!1;Re.shift()}return!0}function Wp(Te,Re,Ue){_h(Te)&&Ue.delete(Re)}function Q1(){F0=!1,Tc!==null&&_h(Tc)&&(Tc=null),kc!==null&&_h(kc)&&(kc=null),Cc!==null&&_h(Cc)&&(Cc=null),kf.forEach(Wp),Cf.forEach(Wp)}function xh(Te,Re){Te.blockedOn===Re&&(Te.blockedOn=null,F0||(F0=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,Q1)))}var vh=null;function Vp(Te){vh!==Te&&(vh=Te,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){vh===Te&&(vh=null);for(var Re=0;Re<Te.length;Re+=3){var Ue=Te[Re],qe=Te[Re+1],Ze=Te[Re+2];if(typeof qe!="function"){if(N0(qe||Ue)===null)continue;break}var er=an(Ue);er!==null&&(Te.splice(Re,3),Re-=3,Rh(er,{pending:!0,data:Ze,method:Ue.method,action:qe},qe,Ze))}}))}function Gu(Te){function Re(ea){return xh(ea,Te)}Tc!==null&&xh(Tc,Te),kc!==null&&xh(kc,Te),Cc!==null&&xh(Cc,Te),kf.forEach(Re),Cf.forEach(Re);for(var Ue=0;Ue<Rc.length;Ue++){var qe=Rc[Ue];qe.blockedOn===Te&&(qe.blockedOn=null)}for(;0<Rc.length&&(Ue=Rc[0],Ue.blockedOn===null);)qp(Ue),Ue.blockedOn===null&&Rc.shift();if(Ue=(Te.ownerDocument||Te).$$reactFormReplay,Ue!=null)for(qe=0;qe<Ue.length;qe+=3){var Ze=Ue[qe],er=Ue[qe+1],Tr=Ze[Wr]||null;if(typeof er=="function")Tr||Vp(Ue);else if(Tr){var jr=null;if(er&&er.hasAttribute("formAction")){if(Ze=er,Tr=er[Wr]||null)jr=Tr.formAction;else if(N0(Ze)!==null)continue}else jr=Tr.action;typeof jr=="function"?Ue[qe+1]=jr:(Ue.splice(qe,3),qe-=3),Vp(Ue)}}}function Gp(){function Te(er){er.canIntercept&&er.info==="react-transition"&&er.intercept({handler:function(){return new Promise(function(Tr){return Ze=Tr})},focusReset:"manual",scroll:"manual"})}function Re(){Ze!==null&&(Ze(),Ze=null),qe||setTimeout(Ue,20)}function Ue(){if(!qe&&!navigation.transition){var er=navigation.currentEntry;er&&er.url!=null&&navigation.navigate(er.url,{state:er.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var qe=!1,Ze=null;return navigation.addEventListener("navigate",Te),navigation.addEventListener("navigatesuccess",Re),navigation.addEventListener("navigateerror",Re),setTimeout(Ue,100),function(){qe=!0,navigation.removeEventListener("navigate",Te),navigation.removeEventListener("navigatesuccess",Re),navigation.removeEventListener("navigateerror",Re),Ze!==null&&(Ze(),Ze=null)}}}function L0(Te){this._internalRoot=Te}yh.prototype.render=L0.prototype.render=function(Te){var Re=this._internalRoot;if(Re===null)throw Error(n(409));var Ue=Re.current,qe=go();Bp(Ue,qe,Te,Re,null,null)},yh.prototype.unmount=L0.prototype.unmount=function(){var Te=this._internalRoot;if(Te!==null){this._internalRoot=null;var Re=Te.containerInfo;Bp(Te.current,2,null,Te,null,null),eh(),Re[$r]=null}};function yh(Te){this._internalRoot=Te}yh.prototype.unstable_scheduleHydration=function(Te){if(Te){var Re=Or();Te={blockedOn:null,target:Te,priority:Re};for(var Ue=0;Ue<Rc.length&&Re!==0&&Re<Rc[Ue].priority;Ue++);Rc.splice(Ue,0,Te),Ue===0&&qp(Te)}};var Yp=t.version;if(Yp!=="19.2.4")throw Error(n(527,Yp,"19.2.4"));Ar.findDOMNode=function(Te){var Re=Te._reactInternals;if(Re===void 0)throw typeof Te.render=="function"?Error(n(188)):(Te=Object.keys(Te).join(","),Error(n(268,Te)));return Te=Oe(Re),Te=Te!==null?Be(Te):null,Te=Te===null?null:Te.stateNode,Te};var eg={bundleType:0,version:"19.2.4",rendererPackageName:"react-dom",currentDispatcherRef:Nr,reconcilerVersion:"19.2.4"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var wh=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!wh.isDisabled&&wh.supportsFiber)try{vn=wh.inject(eg),va=wh}catch{}}return reactDomClient_production.createRoot=function(Te,Re){if(!Ee(Te))throw Error(n(299));var Ue=!1,qe="",Ze=ed,er=rd,Tr=ad;return Re!=null&&(Re.unstable_strictMode===!0&&(Ue=!0),Re.identifierPrefix!==void 0&&(qe=Re.identifierPrefix),Re.onUncaughtError!==void 0&&(Ze=Re.onUncaughtError),Re.onCaughtError!==void 0&&(er=Re.onCaughtError),Re.onRecoverableError!==void 0&&(Tr=Re.onRecoverableError)),Re=Pp(Te,1,!1,null,null,Ue,qe,null,Ze,er,Tr,Gp),Te[$r]=Re.current,d0(Te),new L0(Re)},reactDomClient_production.hydrateRoot=function(Te,Re,Ue){if(!Ee(Te))throw Error(n(299));var qe=!1,Ze="",er=ed,Tr=rd,jr=ad,ea=null;return Ue!=null&&(Ue.unstable_strictMode===!0&&(qe=!0),Ue.identifierPrefix!==void 0&&(Ze=Ue.identifierPrefix),Ue.onUncaughtError!==void 0&&(er=Ue.onUncaughtError),Ue.onCaughtError!==void 0&&(Tr=Ue.onCaughtError),Ue.onRecoverableError!==void 0&&(jr=Ue.onRecoverableError),Ue.formState!==void 0&&(ea=Ue.formState)),Re=Pp(Te,1,!0,Re,Ue??null,qe,Ze,ea,er,Tr,jr,Gp),Re.context=Ip(null),Ue=Re.current,qe=go(),qe=Ln(qe),Ze=Cn(qe),Ze.callback=null,Pn(Ue,Ze,qe),Ue=qe,Re.current.lanes=Ue,sn(Re,Ue),Sl(Re),Te[$r]=Re.current,d0(Te),new yh(Re)},reactDomClient_production.version="19.2.4",reactDomClient_production}var hasRequiredClient;function requireClient(){if(hasRequiredClient)return client.exports;hasRequiredClient=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),client.exports=requireReactDomClient_production(),client.exports}var clientExports=requireClient();const ReactDOM=getDefaultExportFromCjs(clientExports);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mergeClasses=(...e)=>e.filter((t,r,n)=>!!t&&t.trim()!==""&&n.indexOf(t)===r).join(" ").trim();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const toKebabCase=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase();/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const toCamelCase=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,r,n)=>n?n.toUpperCase():r.toLowerCase());/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const toPascalCase=e=>{const t=toCamelCase(e);return t.charAt(0).toUpperCase()+t.slice(1)};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hasA11yProp=e=>{for(const t in e)if(t.startsWith("aria-")||t==="role"||t==="title")return!0;return!1};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Icon=reactExports.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:r=2,absoluteStrokeWidth:n,className:Ee="",children:Ce,iconNode:De,...Me},ze)=>reactExports.createElement("svg",{ref:ze,...defaultAttributes,width:t,height:t,stroke:e,strokeWidth:n?Number(r)*24/Number(t):r,className:mergeClasses("lucide",Ee),...!Ce&&!hasA11yProp(Me)&&{"aria-hidden":"true"},...Me},[...De.map(([Oe,Be])=>reactExports.createElement(Oe,Be)),...Array.isArray(Ce)?Ce:[Ce]]));/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const createLucideIcon=(e,t)=>{const r=reactExports.forwardRef(({className:n,...Ee},Ce)=>reactExports.createElement(Icon,{ref:Ce,iconNode:t,className:mergeClasses(`lucide-${toKebabCase(toPascalCase(e))}`,`lucide-${e}`,n),...Ee}));return r.displayName=toPascalCase(e),r};/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$x=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]],BookOpen=createLucideIcon("book-open",__iconNode$x);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$w=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],CalendarDays=createLucideIcon("calendar-days",__iconNode$w);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$v=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],CircleAlert=createLucideIcon("circle-alert",__iconNode$v);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$u=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],CircleCheckBig=createLucideIcon("circle-check-big",__iconNode$u);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$t=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],CircleCheck=createLucideIcon("circle-check",__iconNode$t);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$s=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],CircleQuestionMark=createLucideIcon("circle-question-mark",__iconNode$s);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$r=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]],CircleUser=createLucideIcon("circle-user",__iconNode$r);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$q=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]],ClipboardList=createLucideIcon("clipboard-list",__iconNode$q);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$p=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]],FileSpreadsheet=createLucideIcon("file-spreadsheet",__iconNode$p);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$o=[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]],FolderOpen=createLucideIcon("folder-open",__iconNode$o);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$n=[["path",{d:"M12.83 2.18a2 2 0 0 0-1.66 0L2.6 6.08a1 1 0 0 0 0 1.83l8.58 3.91a2 2 0 0 0 1.66 0l8.58-3.9a1 1 0 0 0 0-1.83z",key:"zw3jo"}],["path",{d:"M2 12a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 12",key:"1wduqc"}],["path",{d:"M2 17a1 1 0 0 0 .58.91l8.6 3.91a2 2 0 0 0 1.65 0l8.58-3.9A1 1 0 0 0 22 17",key:"kqbvx6"}]],Layers=createLucideIcon("layers",__iconNode$n);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$m=[["path",{d:"M22 17a2 2 0 0 1-2 2H6.828a2 2 0 0 0-1.414.586l-2.202 2.202A.71.71 0 0 1 2 21.286V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z",key:"18887p"}]],MessageSquare=createLucideIcon("message-square",__iconNode$m);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$l=[["path",{d:"M12 22a1 1 0 0 1 0-20 10 9 0 0 1 10 9 5 5 0 0 1-5 5h-2.25a1.75 1.75 0 0 0-1.4 2.8l.3.4a1.75 1.75 0 0 1-1.4 2.8z",key:"e79jfc"}],["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}]],Palette=createLucideIcon("palette",__iconNode$l);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$k=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M9 21V9",key:"1oto5p"}]],PanelsTopLeft=createLucideIcon("panels-top-left",__iconNode$k);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$j=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Plus=createLucideIcon("plus",__iconNode$j);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$i=[["path",{d:"M12 2v10",key:"mnfbl"}],["path",{d:"M18.4 6.6a9 9 0 1 1-12.77.04",key:"obofu9"}]],Power=createLucideIcon("power",__iconNode$i);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$h=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],Printer=createLucideIcon("printer",__iconNode$h);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$g=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],RefreshCw=createLucideIcon("refresh-cw",__iconNode$g);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$f=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],RotateCcw=createLucideIcon("rotate-ccw",__iconNode$f);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$e=[["path",{d:"M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8",key:"1p45f6"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}]],RotateCw=createLucideIcon("rotate-cw",__iconNode$e);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$d=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Save=createLucideIcon("save",__iconNode$d);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$c=[["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M18 5v16",key:"1ethyx"}],["path",{d:"m4 6 7.106-3.79a2 2 0 0 1 1.788 0L20 6",key:"zywc2d"}],["path",{d:"m6 11-3.52 2.147a1 1 0 0 0-.48.854V19a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-5a1 1 0 0 0-.48-.853L18 11",key:"1d4ql0"}],["path",{d:"M6 5v16",key:"1sn0nx"}],["circle",{cx:"12",cy:"9",r:"2",key:"1092wv"}]],School=createLucideIcon("school",__iconNode$c);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$b=[["path",{d:"M14 17H5",key:"gfn3mx"}],["path",{d:"M19 7h-9",key:"6i9tg"}],["circle",{cx:"17",cy:"17",r:"3",key:"18b49y"}],["circle",{cx:"7",cy:"7",r:"3",key:"dfmy0x"}]],Settings2=createLucideIcon("settings-2",__iconNode$b);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$a=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],ShieldCheck=createLucideIcon("shield-check",__iconNode$a);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$9=[["path",{d:"m18 14 4 4-4 4",key:"10pe0f"}],["path",{d:"m18 2 4 4-4 4",key:"pucp1d"}],["path",{d:"M2 18h1.973a4 4 0 0 0 3.3-1.7l5.454-8.6a4 4 0 0 1 3.3-1.7H22",key:"1ailkh"}],["path",{d:"M2 6h1.972a4 4 0 0 1 3.6 2.2",key:"km57vx"}],["path",{d:"M22 18h-6.041a4 4 0 0 1-3.3-1.8l-.359-.45",key:"os18l9"}]],Shuffle=createLucideIcon("shuffle",__iconNode$9);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$8=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],Star=createLucideIcon("star",__iconNode$8);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$7=[["circle",{cx:"9",cy:"12",r:"3",key:"u3jwor"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],ToggleLeft=createLucideIcon("toggle-left",__iconNode$7);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$6=[["circle",{cx:"15",cy:"12",r:"3",key:"1afu0r"}],["rect",{width:"20",height:"14",x:"2",y:"5",rx:"7",key:"g7kal2"}]],ToggleRight=createLucideIcon("toggle-right",__iconNode$6);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$5=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Trash2=createLucideIcon("trash-2",__iconNode$5);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$4=[["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],Trash=createLucideIcon("trash",__iconNode$4);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$3=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],TriangleAlert=createLucideIcon("triangle-alert",__iconNode$3);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$2=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],UserCheck=createLucideIcon("user-check",__iconNode$2);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode$1=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],X$1=createLucideIcon("x",__iconNode$1);/**
 * @license lucide-react v0.563.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const __iconNode=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Zap=createLucideIcon("zap",__iconNode);function commonjsRequire(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var pdf$1={exports:{}};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$5=getAugmentedNamespace(__viteBrowserExternal$1);var hasRequiredPdf;function requirePdf(){return hasRequiredPdf||(hasRequiredPdf=1,(function(module,exports$1){(function(t,r){module.exports=t.pdfjsLib=r()})(globalThis,()=>(()=>{var __webpack_modules__=[,((e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VerbosityLevel=t.Util=t.UnknownErrorException=t.UnexpectedResponseException=t.TextRenderingMode=t.RenderingIntentFlag=t.PromiseCapability=t.PermissionFlag=t.PasswordResponses=t.PasswordException=t.PageActionEventType=t.OPS=t.MissingPDFException=t.MAX_IMAGE_SIZE_TO_CACHE=t.LINE_FACTOR=t.LINE_DESCENT_FACTOR=t.InvalidPDFException=t.ImageKind=t.IDENTITY_MATRIX=t.FormatError=t.FeatureTest=t.FONT_IDENTITY_MATRIX=t.DocumentActionEventType=t.CMapCompressionType=t.BaseException=t.BASELINE_FACTOR=t.AnnotationType=t.AnnotationReplyType=t.AnnotationPrefix=t.AnnotationMode=t.AnnotationFlag=t.AnnotationFieldFlag=t.AnnotationEditorType=t.AnnotationEditorPrefix=t.AnnotationEditorParamsType=t.AnnotationBorderStyleType=t.AnnotationActionEventType=t.AbortException=void 0,t.assert=ir,t.bytesToString=Pr,t.createValidAbsoluteUrl=ur,t.getModificationDate=yn,t.getUuid=Bn,t.getVerbosityLevel=Hr,t.info=Nr,t.isArrayBuffer=nn,t.isArrayEqual=on,t.isNodeJS=void 0,t.normalizeUnicode=en,t.objectFromMap=Cr,t.objectSize=ua,t.setVerbosityLevel=Mr,t.shadow=Je,t.string32=Zr,t.stringToBytes=Er,t.stringToPDFString=za,t.stringToUTF8String=Xa,t.unreachable=xr,t.utf8StringToString=Ya,t.warn=Ar;const r=typeof process=="object"&&process+""=="[object process]"&&!process.versions.nw&&!(process.versions.electron&&process.type&&process.type!=="browser");t.isNodeJS=r;const n=[1,0,0,1,0,0];t.IDENTITY_MATRIX=n;const Ee=[.001,0,0,.001,0,0];t.FONT_IDENTITY_MATRIX=Ee;const Ce=1e7;t.MAX_IMAGE_SIZE_TO_CACHE=Ce;const De=1.35;t.LINE_FACTOR=De;const Me=.35;t.LINE_DESCENT_FACTOR=Me;const ze=Me/De;t.BASELINE_FACTOR=ze;const Oe={ANY:1,DISPLAY:2,PRINT:4,SAVE:8,ANNOTATIONS_FORMS:16,ANNOTATIONS_STORAGE:32,ANNOTATIONS_DISABLE:64,OPLIST:256};t.RenderingIntentFlag=Oe;const Be={DISABLE:0,ENABLE:1,ENABLE_FORMS:2,ENABLE_STORAGE:3};t.AnnotationMode=Be;const He="pdfjs_internal_editor_";t.AnnotationEditorPrefix=He;const Ve={DISABLE:-1,NONE:0,FREETEXT:3,STAMP:13,INK:15};t.AnnotationEditorType=Ve;const Xe={RESIZE:1,CREATE:2,FREETEXT_SIZE:11,FREETEXT_COLOR:12,FREETEXT_OPACITY:13,INK_COLOR:21,INK_THICKNESS:22,INK_OPACITY:23};t.AnnotationEditorParamsType=Xe;const We={PRINT:4,MODIFY_CONTENTS:8,COPY:16,MODIFY_ANNOTATIONS:32,FILL_INTERACTIVE_FORMS:256,COPY_FOR_ACCESSIBILITY:512,ASSEMBLE:1024,PRINT_HIGH_QUALITY:2048};t.PermissionFlag=We;const Ge={FILL:0,STROKE:1,FILL_STROKE:2,INVISIBLE:3,FILL_ADD_TO_PATH:4,STROKE_ADD_TO_PATH:5,FILL_STROKE_ADD_TO_PATH:6,ADD_TO_PATH:7,FILL_STROKE_MASK:3,ADD_TO_PATH_FLAG:4};t.TextRenderingMode=Ge;const $e={GRAYSCALE_1BPP:1,RGB_24BPP:2,RGBA_32BPP:3};t.ImageKind=$e;const Ke={TEXT:1,LINK:2,FREETEXT:3,LINE:4,SQUARE:5,CIRCLE:6,POLYGON:7,POLYLINE:8,HIGHLIGHT:9,UNDERLINE:10,SQUIGGLY:11,STRIKEOUT:12,STAMP:13,CARET:14,INK:15,POPUP:16,FILEATTACHMENT:17,SOUND:18,MOVIE:19,WIDGET:20,SCREEN:21,PRINTERMARK:22,TRAPNET:23,WATERMARK:24,THREED:25,REDACT:26};t.AnnotationType=Ke;const rr={GROUP:"Group",REPLY:"R"};t.AnnotationReplyType=rr;const tr={INVISIBLE:1,HIDDEN:2,PRINT:4,NOZOOM:8,NOROTATE:16,NOVIEW:32,READONLY:64,LOCKED:128,TOGGLENOVIEW:256,LOCKEDCONTENTS:512};t.AnnotationFlag=tr;const sr={READONLY:1,REQUIRED:2,NOEXPORT:4,MULTILINE:4096,PASSWORD:8192,NOTOGGLETOOFF:16384,RADIO:32768,PUSHBUTTON:65536,COMBO:131072,EDIT:262144,SORT:524288,FILESELECT:1048576,MULTISELECT:2097152,DONOTSPELLCHECK:4194304,DONOTSCROLL:8388608,COMB:16777216,RICHTEXT:33554432,RADIOSINUNISON:33554432,COMMITONSELCHANGE:67108864};t.AnnotationFieldFlag=sr;const ar={SOLID:1,DASHED:2,BEVELED:3,INSET:4,UNDERLINE:5};t.AnnotationBorderStyleType=ar;const hr={E:"Mouse Enter",X:"Mouse Exit",D:"Mouse Down",U:"Mouse Up",Fo:"Focus",Bl:"Blur",PO:"PageOpen",PC:"PageClose",PV:"PageVisible",PI:"PageInvisible",K:"Keystroke",F:"Format",V:"Validate",C:"Calculate"};t.AnnotationActionEventType=hr;const pr={WC:"WillClose",WS:"WillSave",DS:"DidSave",WP:"WillPrint",DP:"DidPrint"};t.DocumentActionEventType=pr;const yr={O:"PageOpen",C:"PageClose"};t.PageActionEventType=yr;const fr={ERRORS:0,WARNINGS:1,INFOS:5};t.VerbosityLevel=fr;const Rr={NONE:0,BINARY:1};t.CMapCompressionType=Rr;const mr={dependency:1,setLineWidth:2,setLineCap:3,setLineJoin:4,setMiterLimit:5,setDash:6,setRenderingIntent:7,setFlatness:8,setGState:9,save:10,restore:11,transform:12,moveTo:13,lineTo:14,curveTo:15,curveTo2:16,curveTo3:17,closePath:18,rectangle:19,stroke:20,closeStroke:21,fill:22,eoFill:23,fillStroke:24,eoFillStroke:25,closeFillStroke:26,closeEOFillStroke:27,endPath:28,clip:29,eoClip:30,beginText:31,endText:32,setCharSpacing:33,setWordSpacing:34,setHScale:35,setLeading:36,setFont:37,setTextRenderingMode:38,setTextRise:39,moveText:40,setLeadingMoveText:41,setTextMatrix:42,nextLine:43,showText:44,showSpacedText:45,nextLineShowText:46,nextLineSetSpacingShowText:47,setCharWidth:48,setCharWidthAndBounds:49,setStrokeColorSpace:50,setFillColorSpace:51,setStrokeColor:52,setStrokeColorN:53,setFillColor:54,setFillColorN:55,setStrokeGray:56,setFillGray:57,setStrokeRGBColor:58,setFillRGBColor:59,setStrokeCMYKColor:60,setFillCMYKColor:61,shadingFill:62,beginInlineImage:63,beginImageData:64,endInlineImage:65,paintXObject:66,markPoint:67,markPointProps:68,beginMarkedContent:69,beginMarkedContentProps:70,endMarkedContent:71,beginCompat:72,endCompat:73,paintFormXObjectBegin:74,paintFormXObjectEnd:75,beginGroup:76,endGroup:77,beginAnnotation:80,endAnnotation:81,paintImageMaskXObject:83,paintImageMaskXObjectGroup:84,paintImageXObject:85,paintInlineImageXObject:86,paintInlineImageXObjectGroup:87,paintImageXObjectRepeat:88,paintImageMaskXObjectRepeat:89,paintSolidColorImageMask:90,constructPath:91};t.OPS=mr;const wr={NEED_PASSWORD:1,INCORRECT_PASSWORD:2};t.PasswordResponses=wr;let Fr=fr.WARNINGS;function Mr(va){Number.isInteger(va)&&(Fr=va)}function Hr(){return Fr}function Nr(va){Fr>=fr.INFOS&&console.log(`Info: ${va}`)}function Ar(va){Fr>=fr.WARNINGS&&console.log(`Warning: ${va}`)}function xr(va){throw new Error(va)}function ir(va,aa){va||xr(aa)}function _r(va){switch(va?.protocol){case"http:":case"https:":case"ftp:":case"mailto:":case"tel:":return!0;default:return!1}}function ur(va,aa=null,ia=null){if(!va)return null;try{if(ia&&typeof va=="string"&&(ia.addDefaultProtocol&&va.startsWith("www.")&&va.match(/\./g)?.length>=2&&(va=`http://${va}`),ia.tryConvertEncoding))try{va=Xa(va)}catch{}const Oa=aa?new URL(va,aa):new URL(va);if(_r(Oa))return Oa}catch{}return null}function Je(va,aa,ia,Oa=!1){return Object.defineProperty(va,aa,{value:ia,enumerable:!Oa,configurable:!0,writable:!1}),ia}const nr=(function(){function aa(ia,Oa){this.constructor===aa&&xr("Cannot initialize BaseException."),this.message=ia,this.name=Oa}return aa.prototype=new Error,aa.constructor=aa,aa})();t.BaseException=nr;class or extends nr{constructor(aa,ia){super(aa,"PasswordException"),this.code=ia}}t.PasswordException=or;class lr extends nr{constructor(aa,ia){super(aa,"UnknownErrorException"),this.details=ia}}t.UnknownErrorException=lr;class St extends nr{constructor(aa){super(aa,"InvalidPDFException")}}t.InvalidPDFException=St;class dr extends nr{constructor(aa){super(aa,"MissingPDFException")}}t.MissingPDFException=dr;class vr extends nr{constructor(aa,ia){super(aa,"UnexpectedResponseException"),this.status=ia}}t.UnexpectedResponseException=vr;class br extends nr{constructor(aa){super(aa,"FormatError")}}t.FormatError=br;class kr extends nr{constructor(aa){super(aa,"AbortException")}}t.AbortException=kr;function Pr(va){(typeof va!="object"||va?.length===void 0)&&xr("Invalid argument for bytesToString");const aa=va.length,ia=8192;if(aa<ia)return String.fromCharCode.apply(null,va);const Oa=[];for(let ca=0;ca<aa;ca+=ia){const pa=Math.min(ca+ia,aa),xa=va.subarray(ca,pa);Oa.push(String.fromCharCode.apply(null,xa))}return Oa.join("")}function Er(va){typeof va!="string"&&xr("Invalid argument for stringToBytes");const aa=va.length,ia=new Uint8Array(aa);for(let Oa=0;Oa<aa;++Oa)ia[Oa]=va.charCodeAt(Oa)&255;return ia}function Zr(va){return String.fromCharCode(va>>24&255,va>>16&255,va>>8&255,va&255)}function ua(va){return Object.keys(va).length}function Cr(va){const aa=Object.create(null);for(const[ia,Oa]of va)aa[ia]=Oa;return aa}function Jr(){const va=new Uint8Array(4);return va[0]=1,new Uint32Array(va.buffer,0,1)[0]===1}function Qr(){try{return new Function(""),!0}catch{return!1}}class oa{static get isLittleEndian(){return Je(this,"isLittleEndian",Jr())}static get isEvalSupported(){return Je(this,"isEvalSupported",Qr())}static get isOffscreenCanvasSupported(){return Je(this,"isOffscreenCanvasSupported",typeof OffscreenCanvas<"u")}static get platform(){return typeof navigator>"u"?Je(this,"platform",{isWin:!1,isMac:!1}):Je(this,"platform",{isWin:navigator.platform.includes("Win"),isMac:navigator.platform.includes("Mac")})}static get isCSSRoundSupported(){return Je(this,"isCSSRoundSupported",globalThis.CSS?.supports?.("width: round(1.5px, 1px)"))}}t.FeatureTest=oa;const ta=[...Array(256).keys()].map(va=>va.toString(16).padStart(2,"0"));class Na{static makeHexColor(aa,ia,Oa){return`#${ta[aa]}${ta[ia]}${ta[Oa]}`}static scaleMinMax(aa,ia){let Oa;aa[0]?(aa[0]<0&&(Oa=ia[0],ia[0]=ia[1],ia[1]=Oa),ia[0]*=aa[0],ia[1]*=aa[0],aa[3]<0&&(Oa=ia[2],ia[2]=ia[3],ia[3]=Oa),ia[2]*=aa[3],ia[3]*=aa[3]):(Oa=ia[0],ia[0]=ia[2],ia[2]=Oa,Oa=ia[1],ia[1]=ia[3],ia[3]=Oa,aa[1]<0&&(Oa=ia[2],ia[2]=ia[3],ia[3]=Oa),ia[2]*=aa[1],ia[3]*=aa[1],aa[2]<0&&(Oa=ia[0],ia[0]=ia[1],ia[1]=Oa),ia[0]*=aa[2],ia[1]*=aa[2]),ia[0]+=aa[4],ia[1]+=aa[4],ia[2]+=aa[5],ia[3]+=aa[5]}static transform(aa,ia){return[aa[0]*ia[0]+aa[2]*ia[1],aa[1]*ia[0]+aa[3]*ia[1],aa[0]*ia[2]+aa[2]*ia[3],aa[1]*ia[2]+aa[3]*ia[3],aa[0]*ia[4]+aa[2]*ia[5]+aa[4],aa[1]*ia[4]+aa[3]*ia[5]+aa[5]]}static applyTransform(aa,ia){const Oa=aa[0]*ia[0]+aa[1]*ia[2]+ia[4],ca=aa[0]*ia[1]+aa[1]*ia[3]+ia[5];return[Oa,ca]}static applyInverseTransform(aa,ia){const Oa=ia[0]*ia[3]-ia[1]*ia[2],ca=(aa[0]*ia[3]-aa[1]*ia[2]+ia[2]*ia[5]-ia[4]*ia[3])/Oa,pa=(-aa[0]*ia[1]+aa[1]*ia[0]+ia[4]*ia[1]-ia[5]*ia[0])/Oa;return[ca,pa]}static getAxialAlignedBoundingBox(aa,ia){const Oa=this.applyTransform(aa,ia),ca=this.applyTransform(aa.slice(2,4),ia),pa=this.applyTransform([aa[0],aa[3]],ia),xa=this.applyTransform([aa[2],aa[1]],ia);return[Math.min(Oa[0],ca[0],pa[0],xa[0]),Math.min(Oa[1],ca[1],pa[1],xa[1]),Math.max(Oa[0],ca[0],pa[0],xa[0]),Math.max(Oa[1],ca[1],pa[1],xa[1])]}static inverseTransform(aa){const ia=aa[0]*aa[3]-aa[1]*aa[2];return[aa[3]/ia,-aa[1]/ia,-aa[2]/ia,aa[0]/ia,(aa[2]*aa[5]-aa[4]*aa[3])/ia,(aa[4]*aa[1]-aa[5]*aa[0])/ia]}static singularValueDecompose2dScale(aa){const ia=[aa[0],aa[2],aa[1],aa[3]],Oa=aa[0]*ia[0]+aa[1]*ia[2],ca=aa[0]*ia[1]+aa[1]*ia[3],pa=aa[2]*ia[0]+aa[3]*ia[2],xa=aa[2]*ia[1]+aa[3]*ia[3],$a=(Oa+xa)/2,ka=Math.sqrt((Oa+xa)**2-4*(Oa*xa-pa*ca))/2,La=$a+ka||1,Wa=$a-ka||1;return[Math.sqrt(La),Math.sqrt(Wa)]}static normalizeRect(aa){const ia=aa.slice(0);return aa[0]>aa[2]&&(ia[0]=aa[2],ia[2]=aa[0]),aa[1]>aa[3]&&(ia[1]=aa[3],ia[3]=aa[1]),ia}static intersect(aa,ia){const Oa=Math.max(Math.min(aa[0],aa[2]),Math.min(ia[0],ia[2])),ca=Math.min(Math.max(aa[0],aa[2]),Math.max(ia[0],ia[2]));if(Oa>ca)return null;const pa=Math.max(Math.min(aa[1],aa[3]),Math.min(ia[1],ia[3])),xa=Math.min(Math.max(aa[1],aa[3]),Math.max(ia[1],ia[3]));return pa>xa?null:[Oa,pa,ca,xa]}static bezierBoundingBox(aa,ia,Oa,ca,pa,xa,$a,ka){const La=[],Wa=[[],[]];let _n,hn,Fn,Tn,sn,Gi,Yi,Si;for(let Or=0;Or<2;++Or){if(Or===0?(hn=6*aa-12*Oa+6*pa,_n=-3*aa+9*Oa-9*pa+3*$a,Fn=3*Oa-3*aa):(hn=6*ia-12*ca+6*xa,_n=-3*ia+9*ca-9*xa+3*ka,Fn=3*ca-3*ia),Math.abs(_n)<1e-12){if(Math.abs(hn)<1e-12)continue;Tn=-Fn/hn,0<Tn&&Tn<1&&La.push(Tn);continue}Yi=hn*hn-4*Fn*_n,Si=Math.sqrt(Yi),!(Yi<0)&&(sn=(-hn+Si)/(2*_n),0<sn&&sn<1&&La.push(sn),Gi=(-hn-Si)/(2*_n),0<Gi&&Gi<1&&La.push(Gi))}let bi=La.length,Ln;const $n=bi;for(;bi--;)Tn=La[bi],Ln=1-Tn,Wa[0][bi]=Ln*Ln*Ln*aa+3*Ln*Ln*Tn*Oa+3*Ln*Tn*Tn*pa+Tn*Tn*Tn*$a,Wa[1][bi]=Ln*Ln*Ln*ia+3*Ln*Ln*Tn*ca+3*Ln*Tn*Tn*xa+Tn*Tn*Tn*ka;return Wa[0][$n]=aa,Wa[1][$n]=ia,Wa[0][$n+1]=$a,Wa[1][$n+1]=ka,Wa[0].length=Wa[1].length=$n+2,[Math.min(...Wa[0]),Math.min(...Wa[1]),Math.max(...Wa[0]),Math.max(...Wa[1])]}}t.Util=Na;const Ca=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,728,711,710,729,733,731,730,732,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8226,8224,8225,8230,8212,8211,402,8260,8249,8250,8722,8240,8222,8220,8221,8216,8217,8218,8482,64257,64258,321,338,352,376,381,305,322,339,353,382,0,8364];function za(va){if(va[0]>=""){let ia;if(va[0]===""&&va[1]===""?ia="utf-16be":va[0]===""&&va[1]===""?ia="utf-16le":va[0]===""&&va[1]===""&&va[2]===""&&(ia="utf-8"),ia)try{const Oa=new TextDecoder(ia,{fatal:!0}),ca=Er(va);return Oa.decode(ca)}catch(Oa){Ar(`stringToPDFString: "${Oa}".`)}}const aa=[];for(let ia=0,Oa=va.length;ia<Oa;ia++){const ca=Ca[va.charCodeAt(ia)];aa.push(ca?String.fromCharCode(ca):va.charAt(ia))}return aa.join("")}function Xa(va){return decodeURIComponent(escape(va))}function Ya(va){return unescape(encodeURIComponent(va))}function nn(va){return typeof va=="object"&&va?.byteLength!==void 0}function on(va,aa){if(va.length!==aa.length)return!1;for(let ia=0,Oa=va.length;ia<Oa;ia++)if(va[ia]!==aa[ia])return!1;return!0}function yn(va=new Date){return[va.getUTCFullYear().toString(),(va.getUTCMonth()+1).toString().padStart(2,"0"),va.getUTCDate().toString().padStart(2,"0"),va.getUTCHours().toString().padStart(2,"0"),va.getUTCMinutes().toString().padStart(2,"0"),va.getUTCSeconds().toString().padStart(2,"0")].join("")}class fn{#e=!1;constructor(){this.promise=new Promise((aa,ia)=>{this.resolve=Oa=>{this.#e=!0,aa(Oa)},this.reject=Oa=>{this.#e=!0,ia(Oa)}})}get settled(){return this.#e}}t.PromiseCapability=fn;let Qa=null,Ka=null;function en(va){return Qa||(Qa=/([\u00a0\u00b5\u037e\u0eb3\u2000-\u200a\u202f\u2126\ufb00-\ufb04\ufb06\ufb20-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufba1\ufba4-\ufba9\ufbae-\ufbb1\ufbd3-\ufbdc\ufbde-\ufbe7\ufbea-\ufbf8\ufbfc-\ufbfd\ufc00-\ufc5d\ufc64-\ufcf1\ufcf5-\ufd3d\ufd88\ufdf4\ufdfa-\ufdfb\ufe71\ufe77\ufe79\ufe7b\ufe7d]+)|(\ufb05+)/gu,Ka=new Map([["","t"]])),va.replaceAll(Qa,(aa,ia,Oa)=>ia?ia.normalize("NFKC"):Ka.get(Oa))}function Bn(){if(typeof crypto<"u"&&typeof crypto?.randomUUID=="function")return crypto.randomUUID();const va=new Uint8Array(32);if(typeof crypto<"u"&&typeof crypto?.getRandomValues=="function")crypto.getRandomValues(va);else for(let aa=0;aa<32;aa++)va[aa]=Math.floor(Math.random()*255);return Pr(va)}const vn="pdfjs_internal_id_";t.AnnotationPrefix=vn}),((__unused_webpack_module,exports$1,__w_pdfjs_require__)=>{Object.defineProperty(exports$1,"__esModule",{value:!0}),exports$1.RenderTask=exports$1.PDFWorkerUtil=exports$1.PDFWorker=exports$1.PDFPageProxy=exports$1.PDFDocumentProxy=exports$1.PDFDocumentLoadingTask=exports$1.PDFDataRangeTransport=exports$1.LoopbackPort=exports$1.DefaultStandardFontDataFactory=exports$1.DefaultFilterFactory=exports$1.DefaultCanvasFactory=exports$1.DefaultCMapReaderFactory=void 0,Object.defineProperty(exports$1,"SVGGraphics",{enumerable:!0,get:function(){return _displaySvg.SVGGraphics}}),exports$1.build=void 0,exports$1.getDocument=getDocument,exports$1.version=void 0;var _util=__w_pdfjs_require__(1),_annotation_storage=__w_pdfjs_require__(3),_display_utils=__w_pdfjs_require__(6),_font_loader=__w_pdfjs_require__(9),_displayNode_utils=__w_pdfjs_require__(10),_canvas=__w_pdfjs_require__(11),_worker_options=__w_pdfjs_require__(14),_message_handler=__w_pdfjs_require__(15),_metadata=__w_pdfjs_require__(16),_optional_content_config=__w_pdfjs_require__(17),_transport_stream=__w_pdfjs_require__(18),_displayFetch_stream=__w_pdfjs_require__(19),_displayNetwork=__w_pdfjs_require__(22),_displayNode_stream=__w_pdfjs_require__(23),_displaySvg=__w_pdfjs_require__(24),_xfa_text=__w_pdfjs_require__(25);const DEFAULT_RANGE_CHUNK_SIZE=65536,RENDERING_CANCELLED_TIMEOUT=100,DELAYED_CLEANUP_TIMEOUT=5e3,DefaultCanvasFactory=_util.isNodeJS?_displayNode_utils.NodeCanvasFactory:_display_utils.DOMCanvasFactory;exports$1.DefaultCanvasFactory=DefaultCanvasFactory;const DefaultCMapReaderFactory=_util.isNodeJS?_displayNode_utils.NodeCMapReaderFactory:_display_utils.DOMCMapReaderFactory;exports$1.DefaultCMapReaderFactory=DefaultCMapReaderFactory;const DefaultFilterFactory=_util.isNodeJS?_displayNode_utils.NodeFilterFactory:_display_utils.DOMFilterFactory;exports$1.DefaultFilterFactory=DefaultFilterFactory;const DefaultStandardFontDataFactory=_util.isNodeJS?_displayNode_utils.NodeStandardFontDataFactory:_display_utils.DOMStandardFontDataFactory;exports$1.DefaultStandardFontDataFactory=DefaultStandardFontDataFactory;function getDocument(e){if(typeof e=="string"||e instanceof URL?e={url:e}:(0,_util.isArrayBuffer)(e)&&(e={data:e}),typeof e!="object")throw new Error("Invalid parameter in getDocument, need parameter object.");if(!e.url&&!e.data&&!e.range)throw new Error("Invalid parameter object: need either .data, .range or .url");const t=new PDFDocumentLoadingTask,{docId:r}=t,n=e.url?getUrlProp(e.url):null,Ee=e.data?getDataProp(e.data):null,Ce=e.httpHeaders||null,De=e.withCredentials===!0,Me=e.password??null,ze=e.range instanceof PDFDataRangeTransport?e.range:null,Oe=Number.isInteger(e.rangeChunkSize)&&e.rangeChunkSize>0?e.rangeChunkSize:DEFAULT_RANGE_CHUNK_SIZE;let Be=e.worker instanceof PDFWorker?e.worker:null;const He=e.verbosity,Ve=typeof e.docBaseUrl=="string"&&!(0,_display_utils.isDataScheme)(e.docBaseUrl)?e.docBaseUrl:null,Xe=typeof e.cMapUrl=="string"?e.cMapUrl:null,We=e.cMapPacked!==!1,Ge=e.CMapReaderFactory||DefaultCMapReaderFactory,$e=typeof e.standardFontDataUrl=="string"?e.standardFontDataUrl:null,Ke=e.StandardFontDataFactory||DefaultStandardFontDataFactory,rr=e.stopAtErrors!==!0,tr=Number.isInteger(e.maxImageSize)&&e.maxImageSize>-1?e.maxImageSize:-1,sr=e.isEvalSupported!==!1,ar=typeof e.isOffscreenCanvasSupported=="boolean"?e.isOffscreenCanvasSupported:!_util.isNodeJS,hr=Number.isInteger(e.canvasMaxAreaInBytes)?e.canvasMaxAreaInBytes:-1,pr=typeof e.disableFontFace=="boolean"?e.disableFontFace:_util.isNodeJS,yr=e.fontExtraProperties===!0,fr=e.enableXfa===!0,Rr=e.ownerDocument||globalThis.document,mr=e.disableRange===!0,wr=e.disableStream===!0,Fr=e.disableAutoFetch===!0,Mr=e.pdfBug===!0,Hr=ze?ze.length:e.length??NaN,Nr=typeof e.useSystemFonts=="boolean"?e.useSystemFonts:!_util.isNodeJS&&!pr,Ar=typeof e.useWorkerFetch=="boolean"?e.useWorkerFetch:Ge===_display_utils.DOMCMapReaderFactory&&Ke===_display_utils.DOMStandardFontDataFactory&&Xe&&$e&&(0,_display_utils.isValidFetchUrl)(Xe,document.baseURI)&&(0,_display_utils.isValidFetchUrl)($e,document.baseURI),xr=e.canvasFactory||new DefaultCanvasFactory({ownerDocument:Rr}),ir=e.filterFactory||new DefaultFilterFactory({docId:r,ownerDocument:Rr}),_r=null;(0,_util.setVerbosityLevel)(He);const ur={canvasFactory:xr,filterFactory:ir};if(Ar||(ur.cMapReaderFactory=new Ge({baseUrl:Xe,isCompressed:We}),ur.standardFontDataFactory=new Ke({baseUrl:$e})),!Be){const or={verbosity:He,port:_worker_options.GlobalWorkerOptions.workerPort};Be=or.port?PDFWorker.fromPort(or):new PDFWorker(or),t._worker=Be}const Je={docId:r,apiVersion:"3.11.174",data:Ee,password:Me,disableAutoFetch:Fr,rangeChunkSize:Oe,length:Hr,docBaseUrl:Ve,enableXfa:fr,evaluatorOptions:{maxImageSize:tr,disableFontFace:pr,ignoreErrors:rr,isEvalSupported:sr,isOffscreenCanvasSupported:ar,canvasMaxAreaInBytes:hr,fontExtraProperties:yr,useSystemFonts:Nr,cMapUrl:Ar?Xe:null,standardFontDataUrl:Ar?$e:null}},nr={ignoreErrors:rr,isEvalSupported:sr,disableFontFace:pr,fontExtraProperties:yr,enableXfa:fr,ownerDocument:Rr,disableAutoFetch:Fr,pdfBug:Mr,styleElement:_r};return Be.promise.then(function(){if(t.destroyed)throw new Error("Loading aborted");const or=_fetchDocument(Be,Je),lr=new Promise(function(St){let dr;ze?dr=new _transport_stream.PDFDataTransportStream({length:Hr,initialData:ze.initialData,progressiveDone:ze.progressiveDone,contentDispositionFilename:ze.contentDispositionFilename,disableRange:mr,disableStream:wr},ze):Ee||(dr=(br=>_util.isNodeJS?new _displayNode_stream.PDFNodeStream(br):(0,_display_utils.isValidFetchUrl)(br.url)?new _displayFetch_stream.PDFFetchStream(br):new _displayNetwork.PDFNetworkStream(br))({url:n,length:Hr,httpHeaders:Ce,withCredentials:De,rangeChunkSize:Oe,disableRange:mr,disableStream:wr})),St(dr)});return Promise.all([or,lr]).then(function([St,dr]){if(t.destroyed)throw new Error("Loading aborted");const vr=new _message_handler.MessageHandler(r,St,Be.port),br=new WorkerTransport(vr,t,dr,nr,ur);t._transport=br,vr.send("Ready",null)})}).catch(t._capability.reject),t}async function _fetchDocument(e,t){if(e.destroyed)throw new Error("Worker was destroyed");const r=await e.messageHandler.sendWithPromise("GetDocRequest",t,t.data?[t.data.buffer]:null);if(e.destroyed)throw new Error("Worker was destroyed");return r}function getUrlProp(e){if(e instanceof URL)return e.href;try{return new URL(e,window.location).href}catch{if(_util.isNodeJS&&typeof e=="string")return e}throw new Error("Invalid PDF url data: either string or URL-object is expected in the url property.")}function getDataProp(e){if(_util.isNodeJS&&typeof Buffer<"u"&&e instanceof Buffer)throw new Error("Please provide binary data as `Uint8Array`, rather than `Buffer`.");if(e instanceof Uint8Array&&e.byteLength===e.buffer.byteLength)return e;if(typeof e=="string")return(0,_util.stringToBytes)(e);if(typeof e=="object"&&!isNaN(e?.length)||(0,_util.isArrayBuffer)(e))return new Uint8Array(e);throw new Error("Invalid PDF binary data: either TypedArray, string, or array-like object is expected in the data property.")}class PDFDocumentLoadingTask{static#e=0;constructor(){this._capability=new _util.PromiseCapability,this._transport=null,this._worker=null,this.docId=`d${PDFDocumentLoadingTask.#e++}`,this.destroyed=!1,this.onPassword=null,this.onProgress=null}get promise(){return this._capability.promise}async destroy(){this.destroyed=!0;try{this._worker?.port&&(this._worker._pendingDestroy=!0),await this._transport?.destroy()}catch(t){throw this._worker?.port&&delete this._worker._pendingDestroy,t}this._transport=null,this._worker&&(this._worker.destroy(),this._worker=null)}}exports$1.PDFDocumentLoadingTask=PDFDocumentLoadingTask;class PDFDataRangeTransport{constructor(t,r,n=!1,Ee=null){this.length=t,this.initialData=r,this.progressiveDone=n,this.contentDispositionFilename=Ee,this._rangeListeners=[],this._progressListeners=[],this._progressiveReadListeners=[],this._progressiveDoneListeners=[],this._readyCapability=new _util.PromiseCapability}addRangeListener(t){this._rangeListeners.push(t)}addProgressListener(t){this._progressListeners.push(t)}addProgressiveReadListener(t){this._progressiveReadListeners.push(t)}addProgressiveDoneListener(t){this._progressiveDoneListeners.push(t)}onDataRange(t,r){for(const n of this._rangeListeners)n(t,r)}onDataProgress(t,r){this._readyCapability.promise.then(()=>{for(const n of this._progressListeners)n(t,r)})}onDataProgressiveRead(t){this._readyCapability.promise.then(()=>{for(const r of this._progressiveReadListeners)r(t)})}onDataProgressiveDone(){this._readyCapability.promise.then(()=>{for(const t of this._progressiveDoneListeners)t()})}transportReady(){this._readyCapability.resolve()}requestDataRange(t,r){(0,_util.unreachable)("Abstract method PDFDataRangeTransport.requestDataRange")}abort(){}}exports$1.PDFDataRangeTransport=PDFDataRangeTransport;class PDFDocumentProxy{constructor(t,r){this._pdfInfo=t,this._transport=r,Object.defineProperty(this,"getJavaScript",{value:()=>((0,_display_utils.deprecated)("`PDFDocumentProxy.getJavaScript`, please use `PDFDocumentProxy.getJSActions` instead."),this.getJSActions().then(n=>{if(!n)return n;const Ee=[];for(const Ce in n)Ee.push(...n[Ce]);return Ee}))})}get annotationStorage(){return this._transport.annotationStorage}get filterFactory(){return this._transport.filterFactory}get numPages(){return this._pdfInfo.numPages}get fingerprints(){return this._pdfInfo.fingerprints}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}get allXfaHtml(){return this._transport._htmlForXfa}getPage(t){return this._transport.getPage(t)}getPageIndex(t){return this._transport.getPageIndex(t)}getDestinations(){return this._transport.getDestinations()}getDestination(t){return this._transport.getDestination(t)}getPageLabels(){return this._transport.getPageLabels()}getPageLayout(){return this._transport.getPageLayout()}getPageMode(){return this._transport.getPageMode()}getViewerPreferences(){return this._transport.getViewerPreferences()}getOpenAction(){return this._transport.getOpenAction()}getAttachments(){return this._transport.getAttachments()}getJSActions(){return this._transport.getDocJSActions()}getOutline(){return this._transport.getOutline()}getOptionalContentConfig(){return this._transport.getOptionalContentConfig()}getPermissions(){return this._transport.getPermissions()}getMetadata(){return this._transport.getMetadata()}getMarkInfo(){return this._transport.getMarkInfo()}getData(){return this._transport.getData()}saveDocument(){return this._transport.saveDocument()}getDownloadInfo(){return this._transport.downloadInfoCapability.promise}cleanup(t=!1){return this._transport.startCleanup(t||this.isPureXfa)}destroy(){return this.loadingTask.destroy()}get loadingParams(){return this._transport.loadingParams}get loadingTask(){return this._transport.loadingTask}getFieldObjects(){return this._transport.getFieldObjects()}hasJSActions(){return this._transport.hasJSActions()}getCalculationOrderIds(){return this._transport.getCalculationOrderIds()}}exports$1.PDFDocumentProxy=PDFDocumentProxy;class PDFPageProxy{#e=null;#t=!1;constructor(t,r,n,Ee=!1){this._pageIndex=t,this._pageInfo=r,this._transport=n,this._stats=Ee?new _display_utils.StatTimer:null,this._pdfBug=Ee,this.commonObjs=n.commonObjs,this.objs=new PDFObjects,this._maybeCleanupAfterRender=!1,this._intentStates=new Map,this.destroyed=!1}get pageNumber(){return this._pageIndex+1}get rotate(){return this._pageInfo.rotate}get ref(){return this._pageInfo.ref}get userUnit(){return this._pageInfo.userUnit}get view(){return this._pageInfo.view}getViewport({scale:t,rotation:r=this.rotate,offsetX:n=0,offsetY:Ee=0,dontFlip:Ce=!1}={}){return new _display_utils.PageViewport({viewBox:this.view,scale:t,rotation:r,offsetX:n,offsetY:Ee,dontFlip:Ce})}getAnnotations({intent:t="display"}={}){const r=this._transport.getRenderingIntent(t);return this._transport.getAnnotations(this._pageIndex,r.renderingIntent)}getJSActions(){return this._transport.getPageJSActions(this._pageIndex)}get filterFactory(){return this._transport.filterFactory}get isPureXfa(){return(0,_util.shadow)(this,"isPureXfa",!!this._transport._htmlForXfa)}async getXfa(){return this._transport._htmlForXfa?.children[this._pageIndex]||null}render({canvasContext:t,viewport:r,intent:n="display",annotationMode:Ee=_util.AnnotationMode.ENABLE,transform:Ce=null,background:De=null,optionalContentConfigPromise:Me=null,annotationCanvasMap:ze=null,pageColors:Oe=null,printAnnotationStorage:Be=null}){this._stats?.time("Overall");const He=this._transport.getRenderingIntent(n,Ee,Be);this.#t=!1,this.#a(),Me||(Me=this._transport.getOptionalContentConfig());let Ve=this._intentStates.get(He.cacheKey);Ve||(Ve=Object.create(null),this._intentStates.set(He.cacheKey,Ve)),Ve.streamReaderCancelTimeout&&(clearTimeout(Ve.streamReaderCancelTimeout),Ve.streamReaderCancelTimeout=null);const Xe=!!(He.renderingIntent&_util.RenderingIntentFlag.PRINT);Ve.displayReadyCapability||(Ve.displayReadyCapability=new _util.PromiseCapability,Ve.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(He));const We=Ke=>{Ve.renderTasks.delete(Ge),(this._maybeCleanupAfterRender||Xe)&&(this.#t=!0),this.#r(!Xe),Ke?(Ge.capability.reject(Ke),this._abortOperatorList({intentState:Ve,reason:Ke instanceof Error?Ke:new Error(Ke)})):Ge.capability.resolve(),this._stats?.timeEnd("Rendering"),this._stats?.timeEnd("Overall")},Ge=new InternalRenderTask({callback:We,params:{canvasContext:t,viewport:r,transform:Ce,background:De},objs:this.objs,commonObjs:this.commonObjs,annotationCanvasMap:ze,operatorList:Ve.operatorList,pageIndex:this._pageIndex,canvasFactory:this._transport.canvasFactory,filterFactory:this._transport.filterFactory,useRequestAnimationFrame:!Xe,pdfBug:this._pdfBug,pageColors:Oe});(Ve.renderTasks||=new Set).add(Ge);const $e=Ge.task;return Promise.all([Ve.displayReadyCapability.promise,Me]).then(([Ke,rr])=>{if(this.destroyed){We();return}this._stats?.time("Rendering"),Ge.initializeGraphics({transparency:Ke,optionalContentConfig:rr}),Ge.operatorListChanged()}).catch(We),$e}getOperatorList({intent:t="display",annotationMode:r=_util.AnnotationMode.ENABLE,printAnnotationStorage:n=null}={}){function Ee(){De.operatorList.lastChunk&&(De.opListReadCapability.resolve(De.operatorList),De.renderTasks.delete(Me))}const Ce=this._transport.getRenderingIntent(t,r,n,!0);let De=this._intentStates.get(Ce.cacheKey);De||(De=Object.create(null),this._intentStates.set(Ce.cacheKey,De));let Me;return De.opListReadCapability||(Me=Object.create(null),Me.operatorListChanged=Ee,De.opListReadCapability=new _util.PromiseCapability,(De.renderTasks||=new Set).add(Me),De.operatorList={fnArray:[],argsArray:[],lastChunk:!1,separateAnnots:null},this._stats?.time("Page Request"),this._pumpOperatorList(Ce)),De.opListReadCapability.promise}streamTextContent({includeMarkedContent:t=!1,disableNormalization:r=!1}={}){return this._transport.messageHandler.sendWithStream("GetTextContent",{pageIndex:this._pageIndex,includeMarkedContent:t===!0,disableNormalization:r===!0},{highWaterMark:100,size(Ee){return Ee.items.length}})}getTextContent(t={}){if(this._transport._htmlForXfa)return this.getXfa().then(n=>_xfa_text.XfaText.textContent(n));const r=this.streamTextContent(t);return new Promise(function(n,Ee){function Ce(){De.read().then(function({value:ze,done:Oe}){if(Oe){n(Me);return}Object.assign(Me.styles,ze.styles),Me.items.push(...ze.items),Ce()},Ee)}const De=r.getReader(),Me={items:[],styles:Object.create(null)};Ce()})}getStructTree(){return this._transport.getStructTree(this._pageIndex)}_destroy(){this.destroyed=!0;const t=[];for(const r of this._intentStates.values())if(this._abortOperatorList({intentState:r,reason:new Error("Page was destroyed."),force:!0}),!r.opListReadCapability)for(const n of r.renderTasks)t.push(n.completed),n.cancel();return this.objs.clear(),this.#t=!1,this.#a(),Promise.all(t)}cleanup(t=!1){this.#t=!0;const r=this.#r(!1);return t&&r&&(this._stats&&=new _display_utils.StatTimer),r}#r(t=!1){if(this.#a(),!this.#t||this.destroyed)return!1;if(t)return this.#e=setTimeout(()=>{this.#e=null,this.#r(!1)},DELAYED_CLEANUP_TIMEOUT),!1;for(const{renderTasks:r,operatorList:n}of this._intentStates.values())if(r.size>0||!n.lastChunk)return!1;return this._intentStates.clear(),this.objs.clear(),this.#t=!1,!0}#a(){this.#e&&(clearTimeout(this.#e),this.#e=null)}_startRenderPage(t,r){const n=this._intentStates.get(r);n&&(this._stats?.timeEnd("Page Request"),n.displayReadyCapability?.resolve(t))}_renderPageChunk(t,r){for(let n=0,Ee=t.length;n<Ee;n++)r.operatorList.fnArray.push(t.fnArray[n]),r.operatorList.argsArray.push(t.argsArray[n]);r.operatorList.lastChunk=t.lastChunk,r.operatorList.separateAnnots=t.separateAnnots;for(const n of r.renderTasks)n.operatorListChanged();t.lastChunk&&this.#r(!0)}_pumpOperatorList({renderingIntent:t,cacheKey:r,annotationStorageSerializable:n}){const{map:Ee,transfers:Ce}=n,Me=this._transport.messageHandler.sendWithStream("GetOperatorList",{pageIndex:this._pageIndex,intent:t,cacheKey:r,annotationStorage:Ee},Ce).getReader(),ze=this._intentStates.get(r);ze.streamReader=Me;const Oe=()=>{Me.read().then(({value:Be,done:He})=>{if(He){ze.streamReader=null;return}this._transport.destroyed||(this._renderPageChunk(Be,ze),Oe())},Be=>{if(ze.streamReader=null,!this._transport.destroyed){if(ze.operatorList){ze.operatorList.lastChunk=!0;for(const He of ze.renderTasks)He.operatorListChanged();this.#r(!0)}if(ze.displayReadyCapability)ze.displayReadyCapability.reject(Be);else if(ze.opListReadCapability)ze.opListReadCapability.reject(Be);else throw Be}})};Oe()}_abortOperatorList({intentState:t,reason:r,force:n=!1}){if(t.streamReader){if(t.streamReaderCancelTimeout&&(clearTimeout(t.streamReaderCancelTimeout),t.streamReaderCancelTimeout=null),!n){if(t.renderTasks.size>0)return;if(r instanceof _display_utils.RenderingCancelledException){let Ee=RENDERING_CANCELLED_TIMEOUT;r.extraDelay>0&&r.extraDelay<1e3&&(Ee+=r.extraDelay),t.streamReaderCancelTimeout=setTimeout(()=>{t.streamReaderCancelTimeout=null,this._abortOperatorList({intentState:t,reason:r,force:!0})},Ee);return}}if(t.streamReader.cancel(new _util.AbortException(r.message)).catch(()=>{}),t.streamReader=null,!this._transport.destroyed){for(const[Ee,Ce]of this._intentStates)if(Ce===t){this._intentStates.delete(Ee);break}this.cleanup()}}}get stats(){return this._stats}}exports$1.PDFPageProxy=PDFPageProxy;class LoopbackPort{#e=new Set;#t=Promise.resolve();postMessage(t,r){const n={data:structuredClone(t,r?{transfer:r}:null)};this.#t.then(()=>{for(const Ee of this.#e)Ee.call(this,n)})}addEventListener(t,r){this.#e.add(r)}removeEventListener(t,r){this.#e.delete(r)}terminate(){this.#e.clear()}}exports$1.LoopbackPort=LoopbackPort;const PDFWorkerUtil={isWorkerDisabled:!1,fallbackWorkerSrc:null,fakeWorkerId:0};exports$1.PDFWorkerUtil=PDFWorkerUtil;{if(_util.isNodeJS&&typeof commonjsRequire=="function")PDFWorkerUtil.isWorkerDisabled=!0,PDFWorkerUtil.fallbackWorkerSrc="./pdf.worker.js";else if(typeof document=="object"){const e=document?.currentScript?.src;e&&(PDFWorkerUtil.fallbackWorkerSrc=e.replace(/(\.(?:min\.)?js)(\?.*)?$/i,".worker$1$2"))}PDFWorkerUtil.isSameOrigin=function(e,t){let r;try{if(r=new URL(e),!r.origin||r.origin==="null")return!1}catch{return!1}const n=new URL(t,r);return r.origin===n.origin},PDFWorkerUtil.createCDNWrapper=function(e){const t=`importScripts("${e}");`;return URL.createObjectURL(new Blob([t]))}}class PDFWorker{static#workerPorts;constructor({name:e=null,port:t=null,verbosity:r=(0,_util.getVerbosityLevel)()}={}){if(this.name=e,this.destroyed=!1,this.verbosity=r,this._readyCapability=new _util.PromiseCapability,this._port=null,this._webWorker=null,this._messageHandler=null,t){if(PDFWorker.#workerPorts?.has(t))throw new Error("Cannot use more than one PDFWorker per port.");(PDFWorker.#workerPorts||=new WeakMap).set(t,this),this._initializeFromPort(t);return}this._initialize()}get promise(){return this._readyCapability.promise}get port(){return this._port}get messageHandler(){return this._messageHandler}_initializeFromPort(e){this._port=e,this._messageHandler=new _message_handler.MessageHandler("main","worker",e),this._messageHandler.on("ready",function(){}),this._readyCapability.resolve(),this._messageHandler.send("configure",{verbosity:this.verbosity})}_initialize(){if(!PDFWorkerUtil.isWorkerDisabled&&!PDFWorker._mainThreadWorkerMessageHandler){let{workerSrc:e}=PDFWorker;try{PDFWorkerUtil.isSameOrigin(window.location.href,e)||(e=PDFWorkerUtil.createCDNWrapper(new URL(e,window.location).href));const t=new Worker(e),r=new _message_handler.MessageHandler("main","worker",t),n=()=>{t.removeEventListener("error",Ee),r.destroy(),t.terminate(),this.destroyed?this._readyCapability.reject(new Error("Worker was destroyed")):this._setupFakeWorker()},Ee=()=>{this._webWorker||n()};t.addEventListener("error",Ee),r.on("test",De=>{if(t.removeEventListener("error",Ee),this.destroyed){n();return}De?(this._messageHandler=r,this._port=t,this._webWorker=t,this._readyCapability.resolve(),r.send("configure",{verbosity:this.verbosity})):(this._setupFakeWorker(),r.destroy(),t.terminate())}),r.on("ready",De=>{if(t.removeEventListener("error",Ee),this.destroyed){n();return}try{Ce()}catch{this._setupFakeWorker()}});const Ce=()=>{const De=new Uint8Array;r.send("test",De,[De.buffer])};Ce();return}catch{(0,_util.info)("The worker has been disabled.")}}this._setupFakeWorker()}_setupFakeWorker(){PDFWorkerUtil.isWorkerDisabled||((0,_util.warn)("Setting up fake worker."),PDFWorkerUtil.isWorkerDisabled=!0),PDFWorker._setupFakeWorkerGlobal.then(e=>{if(this.destroyed){this._readyCapability.reject(new Error("Worker was destroyed"));return}const t=new LoopbackPort;this._port=t;const r=`fake${PDFWorkerUtil.fakeWorkerId++}`,n=new _message_handler.MessageHandler(r+"_worker",r,t);e.setup(n,t);const Ee=new _message_handler.MessageHandler(r,r+"_worker",t);this._messageHandler=Ee,this._readyCapability.resolve(),Ee.send("configure",{verbosity:this.verbosity})}).catch(e=>{this._readyCapability.reject(new Error(`Setting up fake worker failed: "${e.message}".`))})}destroy(){this.destroyed=!0,this._webWorker&&(this._webWorker.terminate(),this._webWorker=null),PDFWorker.#workerPorts?.delete(this._port),this._port=null,this._messageHandler&&(this._messageHandler.destroy(),this._messageHandler=null)}static fromPort(e){if(!e?.port)throw new Error("PDFWorker.fromPort - invalid method signature.");const t=this.#workerPorts?.get(e.port);if(t){if(t._pendingDestroy)throw new Error("PDFWorker.fromPort - the worker is being destroyed.\nPlease remember to await `PDFDocumentLoadingTask.destroy()`-calls.");return t}return new PDFWorker(e)}static get workerSrc(){if(_worker_options.GlobalWorkerOptions.workerSrc)return _worker_options.GlobalWorkerOptions.workerSrc;if(PDFWorkerUtil.fallbackWorkerSrc!==null)return _util.isNodeJS||(0,_display_utils.deprecated)('No "GlobalWorkerOptions.workerSrc" specified.'),PDFWorkerUtil.fallbackWorkerSrc;throw new Error('No "GlobalWorkerOptions.workerSrc" specified.')}static get _mainThreadWorkerMessageHandler(){try{return globalThis.pdfjsWorker?.WorkerMessageHandler||null}catch{return null}}static get _setupFakeWorkerGlobal(){const loader=async()=>{const mainWorkerMessageHandler=this._mainThreadWorkerMessageHandler;if(mainWorkerMessageHandler)return mainWorkerMessageHandler;if(_util.isNodeJS&&typeof commonjsRequire=="function"){const worker=eval("require")(this.workerSrc);return worker.WorkerMessageHandler}return await(0,_display_utils.loadScript)(this.workerSrc),window.pdfjsWorker.WorkerMessageHandler};return(0,_util.shadow)(this,"_setupFakeWorkerGlobal",loader())}}exports$1.PDFWorker=PDFWorker;class WorkerTransport{#e=new Map;#t=new Map;#r=new Map;#a=null;constructor(t,r,n,Ee,Ce){this.messageHandler=t,this.loadingTask=r,this.commonObjs=new PDFObjects,this.fontLoader=new _font_loader.FontLoader({ownerDocument:Ee.ownerDocument,styleElement:Ee.styleElement}),this._params=Ee,this.canvasFactory=Ce.canvasFactory,this.filterFactory=Ce.filterFactory,this.cMapReaderFactory=Ce.cMapReaderFactory,this.standardFontDataFactory=Ce.standardFontDataFactory,this.destroyed=!1,this.destroyCapability=null,this._networkStream=n,this._fullReader=null,this._lastProgress=null,this.downloadInfoCapability=new _util.PromiseCapability,this.setupMessageHandler()}#o(t,r=null){const n=this.#e.get(t);if(n)return n;const Ee=this.messageHandler.sendWithPromise(t,r);return this.#e.set(t,Ee),Ee}get annotationStorage(){return(0,_util.shadow)(this,"annotationStorage",new _annotation_storage.AnnotationStorage)}getRenderingIntent(t,r=_util.AnnotationMode.ENABLE,n=null,Ee=!1){let Ce=_util.RenderingIntentFlag.DISPLAY,De=_annotation_storage.SerializableEmpty;switch(t){case"any":Ce=_util.RenderingIntentFlag.ANY;break;case"display":break;case"print":Ce=_util.RenderingIntentFlag.PRINT;break;default:(0,_util.warn)(`getRenderingIntent - invalid intent: ${t}`)}switch(r){case _util.AnnotationMode.DISABLE:Ce+=_util.RenderingIntentFlag.ANNOTATIONS_DISABLE;break;case _util.AnnotationMode.ENABLE:break;case _util.AnnotationMode.ENABLE_FORMS:Ce+=_util.RenderingIntentFlag.ANNOTATIONS_FORMS;break;case _util.AnnotationMode.ENABLE_STORAGE:Ce+=_util.RenderingIntentFlag.ANNOTATIONS_STORAGE,De=(Ce&_util.RenderingIntentFlag.PRINT&&n instanceof _annotation_storage.PrintAnnotationStorage?n:this.annotationStorage).serializable;break;default:(0,_util.warn)(`getRenderingIntent - invalid annotationMode: ${r}`)}return Ee&&(Ce+=_util.RenderingIntentFlag.OPLIST),{renderingIntent:Ce,cacheKey:`${Ce}_${De.hash}`,annotationStorageSerializable:De}}destroy(){if(this.destroyCapability)return this.destroyCapability.promise;this.destroyed=!0,this.destroyCapability=new _util.PromiseCapability,this.#a?.reject(new Error("Worker was destroyed during onPassword callback"));const t=[];for(const n of this.#t.values())t.push(n._destroy());this.#t.clear(),this.#r.clear(),this.hasOwnProperty("annotationStorage")&&this.annotationStorage.resetModified();const r=this.messageHandler.sendWithPromise("Terminate",null);return t.push(r),Promise.all(t).then(()=>{this.commonObjs.clear(),this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(),this._networkStream?.cancelAllRequests(new _util.AbortException("Worker was terminated.")),this.messageHandler&&(this.messageHandler.destroy(),this.messageHandler=null),this.destroyCapability.resolve()},this.destroyCapability.reject),this.destroyCapability.promise}setupMessageHandler(){const{messageHandler:t,loadingTask:r}=this;t.on("GetReader",(n,Ee)=>{(0,_util.assert)(this._networkStream,"GetReader - no `IPDFStream` instance available."),this._fullReader=this._networkStream.getFullReader(),this._fullReader.onProgress=Ce=>{this._lastProgress={loaded:Ce.loaded,total:Ce.total}},Ee.onPull=()=>{this._fullReader.read().then(function({value:Ce,done:De}){if(De){Ee.close();return}(0,_util.assert)(Ce instanceof ArrayBuffer,"GetReader - expected an ArrayBuffer."),Ee.enqueue(new Uint8Array(Ce),1,[Ce])}).catch(Ce=>{Ee.error(Ce)})},Ee.onCancel=Ce=>{this._fullReader.cancel(Ce),Ee.ready.catch(De=>{if(!this.destroyed)throw De})}}),t.on("ReaderHeadersReady",n=>{const Ee=new _util.PromiseCapability,Ce=this._fullReader;return Ce.headersReady.then(()=>{(!Ce.isStreamingSupported||!Ce.isRangeSupported)&&(this._lastProgress&&r.onProgress?.(this._lastProgress),Ce.onProgress=De=>{r.onProgress?.({loaded:De.loaded,total:De.total})}),Ee.resolve({isStreamingSupported:Ce.isStreamingSupported,isRangeSupported:Ce.isRangeSupported,contentLength:Ce.contentLength})},Ee.reject),Ee.promise}),t.on("GetRangeReader",(n,Ee)=>{(0,_util.assert)(this._networkStream,"GetRangeReader - no `IPDFStream` instance available.");const Ce=this._networkStream.getRangeReader(n.begin,n.end);if(!Ce){Ee.close();return}Ee.onPull=()=>{Ce.read().then(function({value:De,done:Me}){if(Me){Ee.close();return}(0,_util.assert)(De instanceof ArrayBuffer,"GetRangeReader - expected an ArrayBuffer."),Ee.enqueue(new Uint8Array(De),1,[De])}).catch(De=>{Ee.error(De)})},Ee.onCancel=De=>{Ce.cancel(De),Ee.ready.catch(Me=>{if(!this.destroyed)throw Me})}}),t.on("GetDoc",({pdfInfo:n})=>{this._numPages=n.numPages,this._htmlForXfa=n.htmlForXfa,delete n.htmlForXfa,r._capability.resolve(new PDFDocumentProxy(n,this))}),t.on("DocException",function(n){let Ee;switch(n.name){case"PasswordException":Ee=new _util.PasswordException(n.message,n.code);break;case"InvalidPDFException":Ee=new _util.InvalidPDFException(n.message);break;case"MissingPDFException":Ee=new _util.MissingPDFException(n.message);break;case"UnexpectedResponseException":Ee=new _util.UnexpectedResponseException(n.message,n.status);break;case"UnknownErrorException":Ee=new _util.UnknownErrorException(n.message,n.details);break;default:(0,_util.unreachable)("DocException - expected a valid Error.")}r._capability.reject(Ee)}),t.on("PasswordRequest",n=>{if(this.#a=new _util.PromiseCapability,r.onPassword){const Ee=Ce=>{Ce instanceof Error?this.#a.reject(Ce):this.#a.resolve({password:Ce})};try{r.onPassword(Ee,n.code)}catch(Ce){this.#a.reject(Ce)}}else this.#a.reject(new _util.PasswordException(n.message,n.code));return this.#a.promise}),t.on("DataLoaded",n=>{r.onProgress?.({loaded:n.length,total:n.length}),this.downloadInfoCapability.resolve(n)}),t.on("StartRenderPage",n=>{if(this.destroyed)return;this.#t.get(n.pageIndex)._startRenderPage(n.transparency,n.cacheKey)}),t.on("commonobj",([n,Ee,Ce])=>{if(!this.destroyed&&!this.commonObjs.has(n))switch(Ee){case"Font":const De=this._params;if("error"in Ce){const Oe=Ce.error;(0,_util.warn)(`Error during font loading: ${Oe}`),this.commonObjs.resolve(n,Oe);break}const Me=De.pdfBug&&globalThis.FontInspector?.enabled?(Oe,Be)=>globalThis.FontInspector.fontAdded(Oe,Be):null,ze=new _font_loader.FontFaceObject(Ce,{isEvalSupported:De.isEvalSupported,disableFontFace:De.disableFontFace,ignoreErrors:De.ignoreErrors,inspectFont:Me});this.fontLoader.bind(ze).catch(Oe=>t.sendWithPromise("FontFallback",{id:n})).finally(()=>{!De.fontExtraProperties&&ze.data&&(ze.data=null),this.commonObjs.resolve(n,ze)});break;case"FontPath":case"Image":case"Pattern":this.commonObjs.resolve(n,Ce);break;default:throw new Error(`Got unknown common object type ${Ee}`)}}),t.on("obj",([n,Ee,Ce,De])=>{if(this.destroyed)return;const Me=this.#t.get(Ee);if(!Me.objs.has(n))switch(Ce){case"Image":if(Me.objs.resolve(n,De),De){let ze;if(De.bitmap){const{width:Oe,height:Be}=De;ze=Oe*Be*4}else ze=De.data?.length||0;ze>_util.MAX_IMAGE_SIZE_TO_CACHE&&(Me._maybeCleanupAfterRender=!0)}break;case"Pattern":Me.objs.resolve(n,De);break;default:throw new Error(`Got unknown object type ${Ce}`)}}),t.on("DocProgress",n=>{this.destroyed||r.onProgress?.({loaded:n.loaded,total:n.total})}),t.on("FetchBuiltInCMap",n=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.cMapReaderFactory?this.cMapReaderFactory.fetch(n):Promise.reject(new Error("CMapReaderFactory not initialized, see the `useWorkerFetch` parameter."))),t.on("FetchStandardFontData",n=>this.destroyed?Promise.reject(new Error("Worker was destroyed.")):this.standardFontDataFactory?this.standardFontDataFactory.fetch(n):Promise.reject(new Error("StandardFontDataFactory not initialized, see the `useWorkerFetch` parameter.")))}getData(){return this.messageHandler.sendWithPromise("GetData",null)}saveDocument(){this.annotationStorage.size<=0&&(0,_util.warn)("saveDocument called while `annotationStorage` is empty, please use the getData-method instead.");const{map:t,transfers:r}=this.annotationStorage.serializable;return this.messageHandler.sendWithPromise("SaveDocument",{isPureXfa:!!this._htmlForXfa,numPages:this._numPages,annotationStorage:t,filename:this._fullReader?.filename??null},r).finally(()=>{this.annotationStorage.resetModified()})}getPage(t){if(!Number.isInteger(t)||t<=0||t>this._numPages)return Promise.reject(new Error("Invalid page request."));const r=t-1,n=this.#r.get(r);if(n)return n;const Ee=this.messageHandler.sendWithPromise("GetPage",{pageIndex:r}).then(Ce=>{if(this.destroyed)throw new Error("Transport destroyed");const De=new PDFPageProxy(r,Ce,this,this._params.pdfBug);return this.#t.set(r,De),De});return this.#r.set(r,Ee),Ee}getPageIndex(t){return typeof t!="object"||t===null||!Number.isInteger(t.num)||t.num<0||!Number.isInteger(t.gen)||t.gen<0?Promise.reject(new Error("Invalid pageIndex request.")):this.messageHandler.sendWithPromise("GetPageIndex",{num:t.num,gen:t.gen})}getAnnotations(t,r){return this.messageHandler.sendWithPromise("GetAnnotations",{pageIndex:t,intent:r})}getFieldObjects(){return this.#o("GetFieldObjects")}hasJSActions(){return this.#o("HasJSActions")}getCalculationOrderIds(){return this.messageHandler.sendWithPromise("GetCalculationOrderIds",null)}getDestinations(){return this.messageHandler.sendWithPromise("GetDestinations",null)}getDestination(t){return typeof t!="string"?Promise.reject(new Error("Invalid destination request.")):this.messageHandler.sendWithPromise("GetDestination",{id:t})}getPageLabels(){return this.messageHandler.sendWithPromise("GetPageLabels",null)}getPageLayout(){return this.messageHandler.sendWithPromise("GetPageLayout",null)}getPageMode(){return this.messageHandler.sendWithPromise("GetPageMode",null)}getViewerPreferences(){return this.messageHandler.sendWithPromise("GetViewerPreferences",null)}getOpenAction(){return this.messageHandler.sendWithPromise("GetOpenAction",null)}getAttachments(){return this.messageHandler.sendWithPromise("GetAttachments",null)}getDocJSActions(){return this.#o("GetDocJSActions")}getPageJSActions(t){return this.messageHandler.sendWithPromise("GetPageJSActions",{pageIndex:t})}getStructTree(t){return this.messageHandler.sendWithPromise("GetStructTree",{pageIndex:t})}getOutline(){return this.messageHandler.sendWithPromise("GetOutline",null)}getOptionalContentConfig(){return this.messageHandler.sendWithPromise("GetOptionalContentConfig",null).then(t=>new _optional_content_config.OptionalContentConfig(t))}getPermissions(){return this.messageHandler.sendWithPromise("GetPermissions",null)}getMetadata(){const t="GetMetadata",r=this.#e.get(t);if(r)return r;const n=this.messageHandler.sendWithPromise(t,null).then(Ee=>({info:Ee[0],metadata:Ee[1]?new _metadata.Metadata(Ee[1]):null,contentDispositionFilename:this._fullReader?.filename??null,contentLength:this._fullReader?.contentLength??null}));return this.#e.set(t,n),n}getMarkInfo(){return this.messageHandler.sendWithPromise("GetMarkInfo",null)}async startCleanup(t=!1){if(!this.destroyed){await this.messageHandler.sendWithPromise("Cleanup",null);for(const r of this.#t.values())if(!r.cleanup())throw new Error(`startCleanup: Page ${r.pageNumber} is currently rendering.`);this.commonObjs.clear(),t||this.fontLoader.clear(),this.#e.clear(),this.filterFactory.destroy(!0)}}get loadingParams(){const{disableAutoFetch:t,enableXfa:r}=this._params;return(0,_util.shadow)(this,"loadingParams",{disableAutoFetch:t,enableXfa:r})}}class PDFObjects{#e=Object.create(null);#t(t){return this.#e[t]||={capability:new _util.PromiseCapability,data:null}}get(t,r=null){if(r){const Ee=this.#t(t);return Ee.capability.promise.then(()=>r(Ee.data)),null}const n=this.#e[t];if(!n?.capability.settled)throw new Error(`Requesting object that isn't resolved yet ${t}.`);return n.data}has(t){return this.#e[t]?.capability.settled||!1}resolve(t,r=null){const n=this.#t(t);n.data=r,n.capability.resolve()}clear(){for(const t in this.#e){const{data:r}=this.#e[t];r?.bitmap?.close()}this.#e=Object.create(null)}}class RenderTask{#e=null;constructor(t){this.#e=t,this.onContinue=null}get promise(){return this.#e.capability.promise}cancel(t=0){this.#e.cancel(null,t)}get separateAnnots(){const{separateAnnots:t}=this.#e.operatorList;if(!t)return!1;const{annotationCanvasMap:r}=this.#e;return t.form||t.canvas&&r?.size>0}}exports$1.RenderTask=RenderTask;class InternalRenderTask{static#e=new WeakSet;constructor({callback:t,params:r,objs:n,commonObjs:Ee,annotationCanvasMap:Ce,operatorList:De,pageIndex:Me,canvasFactory:ze,filterFactory:Oe,useRequestAnimationFrame:Be=!1,pdfBug:He=!1,pageColors:Ve=null}){this.callback=t,this.params=r,this.objs=n,this.commonObjs=Ee,this.annotationCanvasMap=Ce,this.operatorListIdx=null,this.operatorList=De,this._pageIndex=Me,this.canvasFactory=ze,this.filterFactory=Oe,this._pdfBug=He,this.pageColors=Ve,this.running=!1,this.graphicsReadyCallback=null,this.graphicsReady=!1,this._useRequestAnimationFrame=Be===!0&&typeof window<"u",this.cancelled=!1,this.capability=new _util.PromiseCapability,this.task=new RenderTask(this),this._cancelBound=this.cancel.bind(this),this._continueBound=this._continue.bind(this),this._scheduleNextBound=this._scheduleNext.bind(this),this._nextBound=this._next.bind(this),this._canvas=r.canvasContext.canvas}get completed(){return this.capability.promise.catch(function(){})}initializeGraphics({transparency:t=!1,optionalContentConfig:r}){if(this.cancelled)return;if(this._canvas){if(InternalRenderTask.#e.has(this._canvas))throw new Error("Cannot use the same canvas during multiple render() operations. Use different canvas or ensure previous operations were cancelled or completed.");InternalRenderTask.#e.add(this._canvas)}this._pdfBug&&globalThis.StepperManager?.enabled&&(this.stepper=globalThis.StepperManager.create(this._pageIndex),this.stepper.init(this.operatorList),this.stepper.nextBreakPoint=this.stepper.getNextBreakPoint());const{canvasContext:n,viewport:Ee,transform:Ce,background:De}=this.params;this.gfx=new _canvas.CanvasGraphics(n,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:r},this.annotationCanvasMap,this.pageColors),this.gfx.beginDrawing({transform:Ce,viewport:Ee,transparency:t,background:De}),this.operatorListIdx=0,this.graphicsReady=!0,this.graphicsReadyCallback?.()}cancel(t=null,r=0){this.running=!1,this.cancelled=!0,this.gfx?.endDrawing(),InternalRenderTask.#e.delete(this._canvas),this.callback(t||new _display_utils.RenderingCancelledException(`Rendering cancelled, page ${this._pageIndex+1}`,r))}operatorListChanged(){if(!this.graphicsReady){this.graphicsReadyCallback||=this._continueBound;return}this.stepper?.updateOperatorList(this.operatorList),!this.running&&this._continue()}_continue(){this.running=!0,!this.cancelled&&(this.task.onContinue?this.task.onContinue(this._scheduleNextBound):this._scheduleNext())}_scheduleNext(){this._useRequestAnimationFrame?window.requestAnimationFrame(()=>{this._nextBound().catch(this._cancelBound)}):Promise.resolve().then(this._nextBound).catch(this._cancelBound)}async _next(){this.cancelled||(this.operatorListIdx=this.gfx.executeOperatorList(this.operatorList,this.operatorListIdx,this._continueBound,this.stepper),this.operatorListIdx===this.operatorList.argsArray.length&&(this.running=!1,this.operatorList.lastChunk&&(this.gfx.endDrawing(),InternalRenderTask.#e.delete(this._canvas),this.callback())))}}const version="3.11.174";exports$1.version=version;const build="ce8716743";exports$1.build=build}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SerializableEmpty=t.PrintAnnotationStorage=t.AnnotationStorage=void 0;var n=r(1),Ee=r(4),Ce=r(8);const De=Object.freeze({map:null,hash:"",transfers:void 0});t.SerializableEmpty=De;class Me{#e=!1;#t=new Map;constructor(){this.onSetModified=null,this.onResetModified=null,this.onAnnotationEditor=null}getValue(Be,He){const Ve=this.#t.get(Be);return Ve===void 0?He:Object.assign(He,Ve)}getRawValue(Be){return this.#t.get(Be)}remove(Be){if(this.#t.delete(Be),this.#t.size===0&&this.resetModified(),typeof this.onAnnotationEditor=="function"){for(const He of this.#t.values())if(He instanceof Ee.AnnotationEditor)return;this.onAnnotationEditor(null)}}setValue(Be,He){const Ve=this.#t.get(Be);let Xe=!1;if(Ve!==void 0)for(const[We,Ge]of Object.entries(He))Ve[We]!==Ge&&(Xe=!0,Ve[We]=Ge);else Xe=!0,this.#t.set(Be,He);Xe&&this.#r(),He instanceof Ee.AnnotationEditor&&typeof this.onAnnotationEditor=="function"&&this.onAnnotationEditor(He.constructor._type)}has(Be){return this.#t.has(Be)}getAll(){return this.#t.size>0?(0,n.objectFromMap)(this.#t):null}setAll(Be){for(const[He,Ve]of Object.entries(Be))this.setValue(He,Ve)}get size(){return this.#t.size}#r(){this.#e||(this.#e=!0,typeof this.onSetModified=="function"&&this.onSetModified())}resetModified(){this.#e&&(this.#e=!1,typeof this.onResetModified=="function"&&this.onResetModified())}get print(){return new ze(this)}get serializable(){if(this.#t.size===0)return De;const Be=new Map,He=new Ce.MurmurHash3_64,Ve=[],Xe=Object.create(null);let We=!1;for(const[Ge,$e]of this.#t){const Ke=$e instanceof Ee.AnnotationEditor?$e.serialize(!1,Xe):$e;Ke&&(Be.set(Ge,Ke),He.update(`${Ge}:${JSON.stringify(Ke)}`),We||=!!Ke.bitmap)}if(We)for(const Ge of Be.values())Ge.bitmap&&Ve.push(Ge.bitmap);return Be.size>0?{map:Be,hash:He.hexdigest(),transfers:Ve}:De}}t.AnnotationStorage=Me;class ze extends Me{#e;constructor(Be){super();const{map:He,hash:Ve,transfers:Xe}=Be.serializable,We=structuredClone(He,Xe?{transfer:Xe}:null);this.#e={map:We,hash:Ve,transfers:Xe}}get print(){(0,n.unreachable)("Should not call PrintAnnotationStorage.print")}get serializable(){return this.#e}}t.PrintAnnotationStorage=ze}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditor=void 0;var n=r(5),Ee=r(1),Ce=r(6);class De{#e="";#t=!1;#r=null;#a=null;#o=null;#s=!1;#i=null;#l=this.focusin.bind(this);#c=this.focusout.bind(this);#n=!1;#d=!1;#f=!1;_initialOptions=Object.create(null);_uiManager=null;_focusEventsAllowed=!0;_l10nPromise=null;#h=!1;#p=De._zIndex++;static _borderLineWidth=-1;static _colorManager=new n.ColorManager;static _zIndex=1;static SMALL_EDITOR_SIZE=0;constructor(Oe){this.constructor===De&&(0,Ee.unreachable)("Cannot initialize AnnotationEditor."),this.parent=Oe.parent,this.id=Oe.id,this.width=this.height=null,this.pageIndex=Oe.parent.pageIndex,this.name=Oe.name,this.div=null,this._uiManager=Oe.uiManager,this.annotationElementId=null,this._willKeepAspectRatio=!1,this._initialOptions.isCentered=Oe.isCentered,this._structTreeParentId=null;const{rotation:Be,rawDims:{pageWidth:He,pageHeight:Ve,pageX:Xe,pageY:We}}=this.parent.viewport;this.rotation=Be,this.pageRotation=(360+Be-this._uiManager.viewParameters.rotation)%360,this.pageDimensions=[He,Ve],this.pageTranslation=[Xe,We];const[Ge,$e]=this.parentDimensions;this.x=Oe.x/Ge,this.y=Oe.y/$e,this.isAttachedToDOM=!1,this.deleted=!1}get editorType(){return Object.getPrototypeOf(this).constructor._type}static get _defaultLineColor(){return(0,Ee.shadow)(this,"_defaultLineColor",this._colorManager.getHexCode("CanvasText"))}static deleteAnnotationElement(Oe){const Be=new Me({id:Oe.parent.getNextId(),parent:Oe.parent,uiManager:Oe._uiManager});Be.annotationElementId=Oe.annotationElementId,Be.deleted=!0,Be._uiManager.addToAnnotationStorage(Be)}static initialize(Oe,Be=null){if(De._l10nPromise||=new Map(["editor_alt_text_button_label","editor_alt_text_edit_button_label","editor_alt_text_decorative_tooltip"].map(Ve=>[Ve,Oe.get(Ve)])),Be?.strings)for(const Ve of Be.strings)De._l10nPromise.set(Ve,Oe.get(Ve));if(De._borderLineWidth!==-1)return;const He=getComputedStyle(document.documentElement);De._borderLineWidth=parseFloat(He.getPropertyValue("--outline-width"))||0}static updateDefaultParams(Oe,Be){}static get defaultPropertiesToUpdate(){return[]}static isHandlingMimeForPasting(Oe){return!1}static paste(Oe,Be){(0,Ee.unreachable)("Not implemented")}get propertiesToUpdate(){return[]}get _isDraggable(){return this.#h}set _isDraggable(Oe){this.#h=Oe,this.div?.classList.toggle("draggable",Oe)}center(){const[Oe,Be]=this.pageDimensions;switch(this.parentRotation){case 90:this.x-=this.height*Be/(Oe*2),this.y+=this.width*Oe/(Be*2);break;case 180:this.x+=this.width/2,this.y+=this.height/2;break;case 270:this.x+=this.height*Be/(Oe*2),this.y-=this.width*Oe/(Be*2);break;default:this.x-=this.width/2,this.y-=this.height/2;break}this.fixAndSetPosition()}addCommands(Oe){this._uiManager.addCommands(Oe)}get currentLayer(){return this._uiManager.currentLayer}setInBackground(){this.div.style.zIndex=0}setInForeground(){this.div.style.zIndex=this.#p}setParent(Oe){Oe!==null&&(this.pageIndex=Oe.pageIndex,this.pageDimensions=Oe.pageDimensions),this.parent=Oe}focusin(Oe){this._focusEventsAllowed&&(this.#n?this.#n=!1:this.parent.setSelected(this))}focusout(Oe){!this._focusEventsAllowed||!this.isAttachedToDOM||Oe.relatedTarget?.closest(`#${this.id}`)||(Oe.preventDefault(),this.parent?.isMultipleSelection||this.commitOrRemove())}commitOrRemove(){this.isEmpty()?this.remove():this.commit()}commit(){this.addToAnnotationStorage()}addToAnnotationStorage(){this._uiManager.addToAnnotationStorage(this)}setAt(Oe,Be,He,Ve){const[Xe,We]=this.parentDimensions;[He,Ve]=this.screenToPageTranslation(He,Ve),this.x=(Oe+He)/Xe,this.y=(Be+Ve)/We,this.fixAndSetPosition()}#_([Oe,Be],He,Ve){[He,Ve]=this.screenToPageTranslation(He,Ve),this.x+=He/Oe,this.y+=Ve/Be,this.fixAndSetPosition()}translate(Oe,Be){this.#_(this.parentDimensions,Oe,Be)}translateInPage(Oe,Be){this.#_(this.pageDimensions,Oe,Be),this.div.scrollIntoView({block:"nearest"})}drag(Oe,Be){const[He,Ve]=this.parentDimensions;if(this.x+=Oe/He,this.y+=Be/Ve,this.parent&&(this.x<0||this.x>1||this.y<0||this.y>1)){const{x:Ke,y:rr}=this.div.getBoundingClientRect();this.parent.findNewParent(this,Ke,rr)&&(this.x-=Math.floor(this.x),this.y-=Math.floor(this.y))}let{x:Xe,y:We}=this;const[Ge,$e]=this.#m();Xe+=Ge,We+=$e,this.div.style.left=`${(100*Xe).toFixed(2)}%`,this.div.style.top=`${(100*We).toFixed(2)}%`,this.div.scrollIntoView({block:"nearest"})}#m(){const[Oe,Be]=this.parentDimensions,{_borderLineWidth:He}=De,Ve=He/Oe,Xe=He/Be;switch(this.rotation){case 90:return[-Ve,Xe];case 180:return[Ve,Xe];case 270:return[Ve,-Xe];default:return[-Ve,-Xe]}}fixAndSetPosition(){const[Oe,Be]=this.pageDimensions;let{x:He,y:Ve,width:Xe,height:We}=this;switch(Xe*=Oe,We*=Be,He*=Oe,Ve*=Be,this.rotation){case 0:He=Math.max(0,Math.min(Oe-Xe,He)),Ve=Math.max(0,Math.min(Be-We,Ve));break;case 90:He=Math.max(0,Math.min(Oe-We,He)),Ve=Math.min(Be,Math.max(Xe,Ve));break;case 180:He=Math.min(Oe,Math.max(Xe,He)),Ve=Math.min(Be,Math.max(We,Ve));break;case 270:He=Math.min(Oe,Math.max(We,He)),Ve=Math.max(0,Math.min(Be-Xe,Ve));break}this.x=He/=Oe,this.y=Ve/=Be;const[Ge,$e]=this.#m();He+=Ge,Ve+=$e;const{style:Ke}=this.div;Ke.left=`${(100*He).toFixed(2)}%`,Ke.top=`${(100*Ve).toFixed(2)}%`,this.moveInDOM()}static#g(Oe,Be,He){switch(He){case 90:return[Be,-Oe];case 180:return[-Oe,-Be];case 270:return[-Be,Oe];default:return[Oe,Be]}}screenToPageTranslation(Oe,Be){return De.#g(Oe,Be,this.parentRotation)}pageTranslationToScreen(Oe,Be){return De.#g(Oe,Be,360-this.parentRotation)}#u(Oe){switch(Oe){case 90:{const[Be,He]=this.pageDimensions;return[0,-Be/He,He/Be,0]}case 180:return[-1,0,0,-1];case 270:{const[Be,He]=this.pageDimensions;return[0,Be/He,-He/Be,0]}default:return[1,0,0,1]}}get parentScale(){return this._uiManager.viewParameters.realScale}get parentRotation(){return(this._uiManager.viewParameters.rotation+this.pageRotation)%360}get parentDimensions(){const{parentScale:Oe,pageDimensions:[Be,He]}=this,Ve=Be*Oe,Xe=He*Oe;return Ee.FeatureTest.isCSSRoundSupported?[Math.round(Ve),Math.round(Xe)]:[Ve,Xe]}setDims(Oe,Be){const[He,Ve]=this.parentDimensions;this.div.style.width=`${(100*Oe/He).toFixed(2)}%`,this.#s||(this.div.style.height=`${(100*Be/Ve).toFixed(2)}%`),this.#r?.classList.toggle("small",Oe<De.SMALL_EDITOR_SIZE||Be<De.SMALL_EDITOR_SIZE)}fixDims(){const{style:Oe}=this.div,{height:Be,width:He}=Oe,Ve=He.endsWith("%"),Xe=!this.#s&&Be.endsWith("%");if(Ve&&Xe)return;const[We,Ge]=this.parentDimensions;Ve||(Oe.width=`${(100*parseFloat(He)/We).toFixed(2)}%`),!this.#s&&!Xe&&(Oe.height=`${(100*parseFloat(Be)/Ge).toFixed(2)}%`)}getInitialTranslation(){return[0,0]}#x(){if(this.#i)return;this.#i=document.createElement("div"),this.#i.classList.add("resizers");const Oe=["topLeft","topRight","bottomRight","bottomLeft"];this._willKeepAspectRatio||Oe.push("topMiddle","middleRight","bottomMiddle","middleLeft");for(const Be of Oe){const He=document.createElement("div");this.#i.append(He),He.classList.add("resizer",Be),He.addEventListener("pointerdown",this.#S.bind(this,Be)),He.addEventListener("contextmenu",Ce.noContextMenu)}this.div.prepend(this.#i)}#S(Oe,Be){Be.preventDefault();const{isMac:He}=Ee.FeatureTest.platform;if(Be.button!==0||Be.ctrlKey&&He)return;const Ve=this.#b.bind(this,Oe),Xe=this._isDraggable;this._isDraggable=!1;const We={passive:!0,capture:!0};window.addEventListener("pointermove",Ve,We);const Ge=this.x,$e=this.y,Ke=this.width,rr=this.height,tr=this.parent.div.style.cursor,sr=this.div.style.cursor;this.div.style.cursor=this.parent.div.style.cursor=window.getComputedStyle(Be.target).cursor;const ar=()=>{this._isDraggable=Xe,window.removeEventListener("pointerup",ar),window.removeEventListener("blur",ar),window.removeEventListener("pointermove",Ve,We),this.parent.div.style.cursor=tr,this.div.style.cursor=sr;const hr=this.x,pr=this.y,yr=this.width,fr=this.height;hr===Ge&&pr===$e&&yr===Ke&&fr===rr||this.addCommands({cmd:()=>{this.width=yr,this.height=fr,this.x=hr,this.y=pr;const[Rr,mr]=this.parentDimensions;this.setDims(Rr*yr,mr*fr),this.fixAndSetPosition()},undo:()=>{this.width=Ke,this.height=rr,this.x=Ge,this.y=$e;const[Rr,mr]=this.parentDimensions;this.setDims(Rr*Ke,mr*rr),this.fixAndSetPosition()},mustExec:!0})};window.addEventListener("pointerup",ar),window.addEventListener("blur",ar)}#b(Oe,Be){const[He,Ve]=this.parentDimensions,Xe=this.x,We=this.y,Ge=this.width,$e=this.height,Ke=De.MIN_SIZE/He,rr=De.MIN_SIZE/Ve,tr=lr=>Math.round(lr*1e4)/1e4,sr=this.#u(this.rotation),ar=(lr,St)=>[sr[0]*lr+sr[2]*St,sr[1]*lr+sr[3]*St],hr=this.#u(360-this.rotation),pr=(lr,St)=>[hr[0]*lr+hr[2]*St,hr[1]*lr+hr[3]*St];let yr,fr,Rr=!1,mr=!1;switch(Oe){case"topLeft":Rr=!0,yr=(lr,St)=>[0,0],fr=(lr,St)=>[lr,St];break;case"topMiddle":yr=(lr,St)=>[lr/2,0],fr=(lr,St)=>[lr/2,St];break;case"topRight":Rr=!0,yr=(lr,St)=>[lr,0],fr=(lr,St)=>[0,St];break;case"middleRight":mr=!0,yr=(lr,St)=>[lr,St/2],fr=(lr,St)=>[0,St/2];break;case"bottomRight":Rr=!0,yr=(lr,St)=>[lr,St],fr=(lr,St)=>[0,0];break;case"bottomMiddle":yr=(lr,St)=>[lr/2,St],fr=(lr,St)=>[lr/2,0];break;case"bottomLeft":Rr=!0,yr=(lr,St)=>[0,St],fr=(lr,St)=>[lr,0];break;case"middleLeft":mr=!0,yr=(lr,St)=>[0,St/2],fr=(lr,St)=>[lr,St/2];break}const wr=yr(Ge,$e),Fr=fr(Ge,$e);let Mr=ar(...Fr);const Hr=tr(Xe+Mr[0]),Nr=tr(We+Mr[1]);let Ar=1,xr=1,[ir,_r]=this.screenToPageTranslation(Be.movementX,Be.movementY);if([ir,_r]=pr(ir/He,_r/Ve),Rr){const lr=Math.hypot(Ge,$e);Ar=xr=Math.max(Math.min(Math.hypot(Fr[0]-wr[0]-ir,Fr[1]-wr[1]-_r)/lr,1/Ge,1/$e),Ke/Ge,rr/$e)}else mr?Ar=Math.max(Ke,Math.min(1,Math.abs(Fr[0]-wr[0]-ir)))/Ge:xr=Math.max(rr,Math.min(1,Math.abs(Fr[1]-wr[1]-_r)))/$e;const ur=tr(Ge*Ar),Je=tr($e*xr);Mr=ar(...fr(ur,Je));const nr=Hr-Mr[0],or=Nr-Mr[1];this.width=ur,this.height=Je,this.x=nr,this.y=or,this.setDims(He*ur,Ve*Je),this.fixAndSetPosition()}async addAltTextButton(){if(this.#r)return;const Oe=this.#r=document.createElement("button");Oe.className="altText";const Be=await De._l10nPromise.get("editor_alt_text_button_label");Oe.textContent=Be,Oe.setAttribute("aria-label",Be),Oe.tabIndex="0",Oe.addEventListener("contextmenu",Ce.noContextMenu),Oe.addEventListener("pointerdown",He=>He.stopPropagation()),Oe.addEventListener("click",He=>{He.preventDefault(),this._uiManager.editAltText(this)},{capture:!0}),Oe.addEventListener("keydown",He=>{He.target===Oe&&He.key==="Enter"&&(He.preventDefault(),this._uiManager.editAltText(this))}),this.#T(),this.div.append(Oe),De.SMALL_EDITOR_SIZE||(De.SMALL_EDITOR_SIZE=Math.min(128,Math.round(Oe.getBoundingClientRect().width*1.4)))}async#T(){const Oe=this.#r;if(!Oe)return;if(!this.#e&&!this.#t){Oe.classList.remove("done"),this.#a?.remove();return}De._l10nPromise.get("editor_alt_text_edit_button_label").then(He=>{Oe.setAttribute("aria-label",He)});let Be=this.#a;if(!Be){this.#a=Be=document.createElement("span"),Be.className="tooltip",Be.setAttribute("role","tooltip");const He=Be.id=`alt-text-tooltip-${this.id}`;Oe.setAttribute("aria-describedby",He);const Ve=100;Oe.addEventListener("mouseenter",()=>{this.#o=setTimeout(()=>{this.#o=null,this.#a.classList.add("show"),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"alt_text_tooltip"}}})},Ve)}),Oe.addEventListener("mouseleave",()=>{clearTimeout(this.#o),this.#o=null,this.#a?.classList.remove("show")})}Oe.classList.add("done"),Be.innerText=this.#t?await De._l10nPromise.get("editor_alt_text_decorative_tooltip"):this.#e,Be.parentNode||Oe.append(Be)}getClientDimensions(){return this.div.getBoundingClientRect()}get altTextData(){return{altText:this.#e,decorative:this.#t}}set altTextData({altText:Oe,decorative:Be}){this.#e===Oe&&this.#t===Be||(this.#e=Oe,this.#t=Be,this.#T())}render(){this.div=document.createElement("div"),this.div.setAttribute("data-editor-rotation",(360-this.rotation)%360),this.div.className=this.name,this.div.setAttribute("id",this.id),this.div.setAttribute("tabIndex",0),this.setInForeground(),this.div.addEventListener("focusin",this.#l),this.div.addEventListener("focusout",this.#c);const[Oe,Be]=this.parentDimensions;this.parentRotation%180!==0&&(this.div.style.maxWidth=`${(100*Be/Oe).toFixed(2)}%`,this.div.style.maxHeight=`${(100*Oe/Be).toFixed(2)}%`);const[He,Ve]=this.getInitialTranslation();return this.translate(He,Ve),(0,n.bindEvents)(this,this.div,["pointerdown"]),this.div}pointerdown(Oe){const{isMac:Be}=Ee.FeatureTest.platform;if(Oe.button!==0||Oe.ctrlKey&&Be){Oe.preventDefault();return}this.#n=!0,this.#C(Oe)}#C(Oe){if(!this._isDraggable)return;const Be=this._uiManager.isSelected(this);this._uiManager.setUpDragSession();let He,Ve;Be&&(He={passive:!0,capture:!0},Ve=We=>{const[Ge,$e]=this.screenToPageTranslation(We.movementX,We.movementY);this._uiManager.dragSelectedEditors(Ge,$e)},window.addEventListener("pointermove",Ve,He));const Xe=()=>{if(window.removeEventListener("pointerup",Xe),window.removeEventListener("blur",Xe),Be&&window.removeEventListener("pointermove",Ve,He),this.#n=!1,!this._uiManager.endDragSession()){const{isMac:We}=Ee.FeatureTest.platform;Oe.ctrlKey&&!We||Oe.shiftKey||Oe.metaKey&&We?this.parent.toggleSelected(this):this.parent.setSelected(this)}};window.addEventListener("pointerup",Xe),window.addEventListener("blur",Xe)}moveInDOM(){this.parent?.moveEditorInDOM(this)}_setParentAndPosition(Oe,Be,He){Oe.changeParent(this),this.x=Be,this.y=He,this.fixAndSetPosition()}getRect(Oe,Be){const He=this.parentScale,[Ve,Xe]=this.pageDimensions,[We,Ge]=this.pageTranslation,$e=Oe/He,Ke=Be/He,rr=this.x*Ve,tr=this.y*Xe,sr=this.width*Ve,ar=this.height*Xe;switch(this.rotation){case 0:return[rr+$e+We,Xe-tr-Ke-ar+Ge,rr+$e+sr+We,Xe-tr-Ke+Ge];case 90:return[rr+Ke+We,Xe-tr+$e+Ge,rr+Ke+ar+We,Xe-tr+$e+sr+Ge];case 180:return[rr-$e-sr+We,Xe-tr+Ke+Ge,rr-$e+We,Xe-tr+Ke+ar+Ge];case 270:return[rr-Ke-ar+We,Xe-tr-$e-sr+Ge,rr-Ke+We,Xe-tr-$e+Ge];default:throw new Error("Invalid rotation")}}getRectInCurrentCoords(Oe,Be){const[He,Ve,Xe,We]=Oe,Ge=Xe-He,$e=We-Ve;switch(this.rotation){case 0:return[He,Be-We,Ge,$e];case 90:return[He,Be-Ve,$e,Ge];case 180:return[Xe,Be-Ve,Ge,$e];case 270:return[Xe,Be-We,$e,Ge];default:throw new Error("Invalid rotation")}}onceAdded(){}isEmpty(){return!1}enableEditMode(){this.#f=!0}disableEditMode(){this.#f=!1}isInEditMode(){return this.#f}shouldGetKeyboardEvents(){return!1}needsToBeRebuilt(){return this.div&&!this.isAttachedToDOM}rebuild(){this.div?.addEventListener("focusin",this.#l),this.div?.addEventListener("focusout",this.#c)}serialize(Oe=!1,Be=null){(0,Ee.unreachable)("An editor must be serializable")}static deserialize(Oe,Be,He){const Ve=new this.prototype.constructor({parent:Be,id:Be.getNextId(),uiManager:He});Ve.rotation=Oe.rotation;const[Xe,We]=Ve.pageDimensions,[Ge,$e,Ke,rr]=Ve.getRectInCurrentCoords(Oe.rect,We);return Ve.x=Ge/Xe,Ve.y=$e/We,Ve.width=Ke/Xe,Ve.height=rr/We,Ve}remove(){this.div.removeEventListener("focusin",this.#l),this.div.removeEventListener("focusout",this.#c),this.isEmpty()||this.commit(),this.parent?this.parent.remove(this):this._uiManager.removeEditor(this),this.#r?.remove(),this.#r=null,this.#a=null}get isResizable(){return!1}makeResizable(){this.isResizable&&(this.#x(),this.#i.classList.remove("hidden"))}select(){this.makeResizable(),this.div?.classList.add("selectedEditor")}unselect(){this.#i?.classList.add("hidden"),this.div?.classList.remove("selectedEditor"),this.div?.contains(document.activeElement)&&this._uiManager.currentLayer.div.focus()}updateParams(Oe,Be){}disableEditing(){this.#r&&(this.#r.hidden=!0)}enableEditing(){this.#r&&(this.#r.hidden=!1)}enterInEditMode(){}get contentDiv(){return this.div}get isEditing(){return this.#d}set isEditing(Oe){this.#d=Oe,this.parent&&(Oe?(this.parent.setSelected(this),this.parent.setActiveEditor(this)):this.parent.setActiveEditor(null))}setAspectRatio(Oe,Be){this.#s=!0;const He=Oe/Be,{style:Ve}=this.div;Ve.aspectRatio=He,Ve.height="auto"}static get MIN_SIZE(){return 16}}t.AnnotationEditor=De;class Me extends De{constructor(Oe){super(Oe),this.annotationElementId=Oe.annotationElementId,this.deleted=!0}serialize(){return{id:this.annotationElementId,deleted:!0,pageIndex:this.pageIndex}}}}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.KeyboardManager=t.CommandManager=t.ColorManager=t.AnnotationEditorUIManager=void 0,t.bindEvents=Ce,t.opacityToHex=De;var n=r(1),Ee=r(6);function Ce(Xe,We,Ge){for(const $e of Ge)We.addEventListener($e,Xe[$e].bind(Xe))}function De(Xe){return Math.round(Math.min(255,Math.max(1,255*Xe))).toString(16).padStart(2,"0")}class Me{#e=0;getId(){return`${n.AnnotationEditorPrefix}${this.#e++}`}}class ze{#e=(0,n.getUuid)();#t=0;#r=null;static get _isSVGFittingCanvas(){const We='data:image/svg+xml;charset=UTF-8,<svg viewBox="0 0 1 1" width="1" height="1" xmlns="http://www.w3.org/2000/svg"><rect width="1" height="1" style="fill:red;"/></svg>',$e=new OffscreenCanvas(1,3).getContext("2d"),Ke=new Image;Ke.src=We;const rr=Ke.decode().then(()=>($e.drawImage(Ke,0,0,1,1,0,0,1,3),new Uint32Array($e.getImageData(0,0,1,1).data.buffer)[0]===0));return(0,n.shadow)(this,"_isSVGFittingCanvas",rr)}async#a(We,Ge){this.#r||=new Map;let $e=this.#r.get(We);if($e===null)return null;if($e?.bitmap)return $e.refCounter+=1,$e;try{$e||={bitmap:null,id:`image_${this.#e}_${this.#t++}`,refCounter:0,isSvg:!1};let Ke;if(typeof Ge=="string"){$e.url=Ge;const rr=await fetch(Ge);if(!rr.ok)throw new Error(rr.statusText);Ke=await rr.blob()}else Ke=$e.file=Ge;if(Ke.type==="image/svg+xml"){const rr=ze._isSVGFittingCanvas,tr=new FileReader,sr=new Image,ar=new Promise((hr,pr)=>{sr.onload=()=>{$e.bitmap=sr,$e.isSvg=!0,hr()},tr.onload=async()=>{const yr=$e.svgUrl=tr.result;sr.src=await rr?`${yr}#svgView(preserveAspectRatio(none))`:yr},sr.onerror=tr.onerror=pr});tr.readAsDataURL(Ke),await ar}else $e.bitmap=await createImageBitmap(Ke);$e.refCounter=1}catch(Ke){console.error(Ke),$e=null}return this.#r.set(We,$e),$e&&this.#r.set($e.id,$e),$e}async getFromFile(We){const{lastModified:Ge,name:$e,size:Ke,type:rr}=We;return this.#a(`${Ge}_${$e}_${Ke}_${rr}`,We)}async getFromUrl(We){return this.#a(We,We)}async getFromId(We){this.#r||=new Map;const Ge=this.#r.get(We);return Ge?Ge.bitmap?(Ge.refCounter+=1,Ge):Ge.file?this.getFromFile(Ge.file):this.getFromUrl(Ge.url):null}getSvgUrl(We){const Ge=this.#r.get(We);return Ge?.isSvg?Ge.svgUrl:null}deleteId(We){this.#r||=new Map;const Ge=this.#r.get(We);Ge&&(Ge.refCounter-=1,Ge.refCounter===0&&(Ge.bitmap=null))}isValidId(We){return We.startsWith(`image_${this.#e}_`)}}class Oe{#e=[];#t=!1;#r;#a=-1;constructor(We=128){this.#r=We}add({cmd:We,undo:Ge,mustExec:$e,type:Ke=NaN,overwriteIfSameType:rr=!1,keepUndo:tr=!1}){if($e&&We(),this.#t)return;const sr={cmd:We,undo:Ge,type:Ke};if(this.#a===-1){this.#e.length>0&&(this.#e.length=0),this.#a=0,this.#e.push(sr);return}if(rr&&this.#e[this.#a].type===Ke){tr&&(sr.undo=this.#e[this.#a].undo),this.#e[this.#a]=sr;return}const ar=this.#a+1;ar===this.#r?this.#e.splice(0,1):(this.#a=ar,ar<this.#e.length&&this.#e.splice(ar)),this.#e.push(sr)}undo(){this.#a!==-1&&(this.#t=!0,this.#e[this.#a].undo(),this.#t=!1,this.#a-=1)}redo(){this.#a<this.#e.length-1&&(this.#a+=1,this.#t=!0,this.#e[this.#a].cmd(),this.#t=!1)}hasSomethingToUndo(){return this.#a!==-1}hasSomethingToRedo(){return this.#a<this.#e.length-1}destroy(){this.#e=null}}t.CommandManager=Oe;class Be{constructor(We){this.buffer=[],this.callbacks=new Map,this.allKeys=new Set;const{isMac:Ge}=n.FeatureTest.platform;for(const[$e,Ke,rr={}]of We)for(const tr of $e){const sr=tr.startsWith("mac+");Ge&&sr?(this.callbacks.set(tr.slice(4),{callback:Ke,options:rr}),this.allKeys.add(tr.split("+").at(-1))):!Ge&&!sr&&(this.callbacks.set(tr,{callback:Ke,options:rr}),this.allKeys.add(tr.split("+").at(-1)))}}#e(We){We.altKey&&this.buffer.push("alt"),We.ctrlKey&&this.buffer.push("ctrl"),We.metaKey&&this.buffer.push("meta"),We.shiftKey&&this.buffer.push("shift"),this.buffer.push(We.key);const Ge=this.buffer.join("+");return this.buffer.length=0,Ge}exec(We,Ge){if(!this.allKeys.has(Ge.key))return;const $e=this.callbacks.get(this.#e(Ge));if(!$e)return;const{callback:Ke,options:{bubbles:rr=!1,args:tr=[],checker:sr=null}}=$e;sr&&!sr(We,Ge)||(Ke.bind(We,...tr)(),rr||(Ge.stopPropagation(),Ge.preventDefault()))}}t.KeyboardManager=Be;class He{static _colorsMapping=new Map([["CanvasText",[0,0,0]],["Canvas",[255,255,255]]]);get _colors(){const We=new Map([["CanvasText",null],["Canvas",null]]);return(0,Ee.getColorValues)(We),(0,n.shadow)(this,"_colors",We)}convert(We){const Ge=(0,Ee.getRGB)(We);if(!window.matchMedia("(forced-colors: active)").matches)return Ge;for(const[$e,Ke]of this._colors)if(Ke.every((rr,tr)=>rr===Ge[tr]))return He._colorsMapping.get($e);return Ge}getHexCode(We){const Ge=this._colors.get(We);return Ge?n.Util.makeHexColor(...Ge):We}}t.ColorManager=He;class Ve{#e=null;#t=new Map;#r=new Map;#a=null;#o=null;#s=new Oe;#i=0;#l=new Set;#c=null;#n=null;#d=new Set;#f=null;#h=new Me;#p=!1;#_=!1;#m=null;#g=n.AnnotationEditorType.NONE;#u=new Set;#x=null;#S=this.blur.bind(this);#b=this.focus.bind(this);#T=this.copy.bind(this);#C=this.cut.bind(this);#M=this.paste.bind(this);#O=this.keydown.bind(this);#P=this.onEditingAction.bind(this);#v=this.onPageChanging.bind(this);#D=this.onScaleChanging.bind(this);#R=this.onRotationChanging.bind(this);#N={isEditing:!1,isEmpty:!0,hasSomethingToUndo:!1,hasSomethingToRedo:!1,hasSelectedEditor:!1};#y=[0,0];#k=null;#A=null;#I=null;static TRANSLATE_SMALL=1;static TRANSLATE_BIG=10;static get _keyboardManager(){const We=Ve.prototype,Ge=rr=>{const{activeElement:tr}=document;return tr&&rr.#A.contains(tr)&&rr.hasSomethingToControl()},$e=this.TRANSLATE_SMALL,Ke=this.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new Be([[["ctrl+a","mac+meta+a"],We.selectAll],[["ctrl+z","mac+meta+z"],We.undo],[["ctrl+y","ctrl+shift+z","mac+meta+shift+z","ctrl+shift+Z","mac+meta+shift+Z"],We.redo],[["Backspace","alt+Backspace","ctrl+Backspace","shift+Backspace","mac+Backspace","mac+alt+Backspace","mac+ctrl+Backspace","Delete","ctrl+Delete","shift+Delete","mac+Delete"],We.delete],[["Escape","mac+Escape"],We.unselectAll],[["ArrowLeft","mac+ArrowLeft"],We.translateSelectedEditors,{args:[-$e,0],checker:Ge}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],We.translateSelectedEditors,{args:[-Ke,0],checker:Ge}],[["ArrowRight","mac+ArrowRight"],We.translateSelectedEditors,{args:[$e,0],checker:Ge}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],We.translateSelectedEditors,{args:[Ke,0],checker:Ge}],[["ArrowUp","mac+ArrowUp"],We.translateSelectedEditors,{args:[0,-$e],checker:Ge}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],We.translateSelectedEditors,{args:[0,-Ke],checker:Ge}],[["ArrowDown","mac+ArrowDown"],We.translateSelectedEditors,{args:[0,$e],checker:Ge}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],We.translateSelectedEditors,{args:[0,Ke],checker:Ge}]]))}constructor(We,Ge,$e,Ke,rr,tr){this.#A=We,this.#I=Ge,this.#a=$e,this._eventBus=Ke,this._eventBus._on("editingaction",this.#P),this._eventBus._on("pagechanging",this.#v),this._eventBus._on("scalechanging",this.#D),this._eventBus._on("rotationchanging",this.#R),this.#o=rr.annotationStorage,this.#f=rr.filterFactory,this.#x=tr,this.viewParameters={realScale:Ee.PixelsPerInch.PDF_TO_CSS_UNITS,rotation:0}}destroy(){this.#F(),this.#j(),this._eventBus._off("editingaction",this.#P),this._eventBus._off("pagechanging",this.#v),this._eventBus._off("scalechanging",this.#D),this._eventBus._off("rotationchanging",this.#R);for(const We of this.#r.values())We.destroy();this.#r.clear(),this.#t.clear(),this.#d.clear(),this.#e=null,this.#u.clear(),this.#s.destroy(),this.#a.destroy()}get hcmFilter(){return(0,n.shadow)(this,"hcmFilter",this.#x?this.#f.addHCMFilter(this.#x.foreground,this.#x.background):"none")}get direction(){return(0,n.shadow)(this,"direction",getComputedStyle(this.#A).direction)}editAltText(We){this.#a?.editAltText(this,We)}onPageChanging({pageNumber:We}){this.#i=We-1}focusMainContainer(){this.#A.focus()}findParent(We,Ge){for(const $e of this.#r.values()){const{x:Ke,y:rr,width:tr,height:sr}=$e.div.getBoundingClientRect();if(We>=Ke&&We<=Ke+tr&&Ge>=rr&&Ge<=rr+sr)return $e}return null}disableUserSelect(We=!1){this.#I.classList.toggle("noUserSelect",We)}addShouldRescale(We){this.#d.add(We)}removeShouldRescale(We){this.#d.delete(We)}onScaleChanging({scale:We}){this.commitOrRemove(),this.viewParameters.realScale=We*Ee.PixelsPerInch.PDF_TO_CSS_UNITS;for(const Ge of this.#d)Ge.onScaleChanging()}onRotationChanging({pagesRotation:We}){this.commitOrRemove(),this.viewParameters.rotation=We}addToAnnotationStorage(We){!We.isEmpty()&&this.#o&&!this.#o.has(We.id)&&this.#o.setValue(We.id,We)}#B(){window.addEventListener("focus",this.#b),window.addEventListener("blur",this.#S)}#j(){window.removeEventListener("focus",this.#b),window.removeEventListener("blur",this.#S)}blur(){if(!this.hasSelection)return;const{activeElement:We}=document;for(const Ge of this.#u)if(Ge.div.contains(We)){this.#m=[Ge,We],Ge._focusEventsAllowed=!1;break}}focus(){if(!this.#m)return;const[We,Ge]=this.#m;this.#m=null,Ge.addEventListener("focusin",()=>{We._focusEventsAllowed=!0},{once:!0}),Ge.focus()}#U(){window.addEventListener("keydown",this.#O,{capture:!0})}#F(){window.removeEventListener("keydown",this.#O,{capture:!0})}#L(){document.addEventListener("copy",this.#T),document.addEventListener("cut",this.#C),document.addEventListener("paste",this.#M)}#E(){document.removeEventListener("copy",this.#T),document.removeEventListener("cut",this.#C),document.removeEventListener("paste",this.#M)}addEditListeners(){this.#U(),this.#L()}removeEditListeners(){this.#F(),this.#E()}copy(We){if(We.preventDefault(),this.#e?.commitOrRemove(),!this.hasSelection)return;const Ge=[];for(const $e of this.#u){const Ke=$e.serialize(!0);Ke&&Ge.push(Ke)}Ge.length!==0&&We.clipboardData.setData("application/pdfjs",JSON.stringify(Ge))}cut(We){this.copy(We),this.delete()}paste(We){We.preventDefault();const{clipboardData:Ge}=We;for(const rr of Ge.items)for(const tr of this.#n)if(tr.isHandlingMimeForPasting(rr.type)){tr.paste(rr,this.currentLayer);return}let $e=Ge.getData("application/pdfjs");if(!$e)return;try{$e=JSON.parse($e)}catch(rr){(0,n.warn)(`paste: "${rr.message}".`);return}if(!Array.isArray($e))return;this.unselectAll();const Ke=this.currentLayer;try{const rr=[];for(const ar of $e){const hr=Ke.deserialize(ar);if(!hr)return;rr.push(hr)}const tr=()=>{for(const ar of rr)this.#X(ar);this.#q(rr)},sr=()=>{for(const ar of rr)ar.remove()};this.addCommands({cmd:tr,undo:sr,mustExec:!0})}catch(rr){(0,n.warn)(`paste: "${rr.message}".`)}}keydown(We){this.getActive()?.shouldGetKeyboardEvents()||Ve._keyboardManager.exec(this,We)}onEditingAction(We){["undo","redo","delete","selectAll"].includes(We.name)&&this[We.name]()}#w(We){Object.entries(We).some(([$e,Ke])=>this.#N[$e]!==Ke)&&this._eventBus.dispatch("annotationeditorstateschanged",{source:this,details:Object.assign(this.#N,We)})}#z(We){this._eventBus.dispatch("annotationeditorparamschanged",{source:this,details:We})}setEditingState(We){We?(this.#B(),this.#U(),this.#L(),this.#w({isEditing:this.#g!==n.AnnotationEditorType.NONE,isEmpty:this.#H(),hasSomethingToUndo:this.#s.hasSomethingToUndo(),hasSomethingToRedo:this.#s.hasSomethingToRedo(),hasSelectedEditor:!1})):(this.#j(),this.#F(),this.#E(),this.#w({isEditing:!1}),this.disableUserSelect(!1))}registerEditorTypes(We){if(!this.#n){this.#n=We;for(const Ge of this.#n)this.#z(Ge.defaultPropertiesToUpdate)}}getId(){return this.#h.getId()}get currentLayer(){return this.#r.get(this.#i)}getLayer(We){return this.#r.get(We)}get currentPageIndex(){return this.#i}addLayer(We){this.#r.set(We.pageIndex,We),this.#p?We.enable():We.disable()}removeLayer(We){this.#r.delete(We.pageIndex)}updateMode(We,Ge=null){if(this.#g!==We){if(this.#g=We,We===n.AnnotationEditorType.NONE){this.setEditingState(!1),this.#V();return}this.setEditingState(!0),this.#W(),this.unselectAll();for(const $e of this.#r.values())$e.updateMode(We);if(Ge){for(const $e of this.#t.values())if($e.annotationElementId===Ge){this.setSelected($e),$e.enterInEditMode();break}}}}updateToolbar(We){We!==this.#g&&this._eventBus.dispatch("switchannotationeditormode",{source:this,mode:We})}updateParams(We,Ge){if(this.#n){if(We===n.AnnotationEditorParamsType.CREATE){this.currentLayer.addNewEditor(We);return}for(const $e of this.#u)$e.updateParams(We,Ge);for(const $e of this.#n)$e.updateDefaultParams(We,Ge)}}enableWaiting(We=!1){if(this.#_!==We){this.#_=We;for(const Ge of this.#r.values())We?Ge.disableClick():Ge.enableClick(),Ge.div.classList.toggle("waiting",We)}}#W(){if(!this.#p){this.#p=!0;for(const We of this.#r.values())We.enable()}}#V(){if(this.unselectAll(),this.#p){this.#p=!1;for(const We of this.#r.values())We.disable()}}getEditors(We){const Ge=[];for(const $e of this.#t.values())$e.pageIndex===We&&Ge.push($e);return Ge}getEditor(We){return this.#t.get(We)}addEditor(We){this.#t.set(We.id,We)}removeEditor(We){this.#t.delete(We.id),this.unselect(We),(!We.annotationElementId||!this.#l.has(We.annotationElementId))&&this.#o?.remove(We.id)}addDeletedAnnotationElement(We){this.#l.add(We.annotationElementId),We.deleted=!0}isDeletedAnnotationElement(We){return this.#l.has(We)}removeDeletedAnnotationElement(We){this.#l.delete(We.annotationElementId),We.deleted=!1}#X(We){const Ge=this.#r.get(We.pageIndex);Ge?Ge.addOrRebuild(We):this.addEditor(We)}setActiveEditor(We){this.#e!==We&&(this.#e=We,We&&this.#z(We.propertiesToUpdate))}toggleSelected(We){if(this.#u.has(We)){this.#u.delete(We),We.unselect(),this.#w({hasSelectedEditor:this.hasSelection});return}this.#u.add(We),We.select(),this.#z(We.propertiesToUpdate),this.#w({hasSelectedEditor:!0})}setSelected(We){for(const Ge of this.#u)Ge!==We&&Ge.unselect();this.#u.clear(),this.#u.add(We),We.select(),this.#z(We.propertiesToUpdate),this.#w({hasSelectedEditor:!0})}isSelected(We){return this.#u.has(We)}unselect(We){We.unselect(),this.#u.delete(We),this.#w({hasSelectedEditor:this.hasSelection})}get hasSelection(){return this.#u.size!==0}undo(){this.#s.undo(),this.#w({hasSomethingToUndo:this.#s.hasSomethingToUndo(),hasSomethingToRedo:!0,isEmpty:this.#H()})}redo(){this.#s.redo(),this.#w({hasSomethingToUndo:!0,hasSomethingToRedo:this.#s.hasSomethingToRedo(),isEmpty:this.#H()})}addCommands(We){this.#s.add(We),this.#w({hasSomethingToUndo:!0,hasSomethingToRedo:!1,isEmpty:this.#H()})}#H(){if(this.#t.size===0)return!0;if(this.#t.size===1)for(const We of this.#t.values())return We.isEmpty();return!1}delete(){if(this.commitOrRemove(),!this.hasSelection)return;const We=[...this.#u],Ge=()=>{for(const Ke of We)Ke.remove()},$e=()=>{for(const Ke of We)this.#X(Ke)};this.addCommands({cmd:Ge,undo:$e,mustExec:!0})}commitOrRemove(){this.#e?.commitOrRemove()}hasSomethingToControl(){return this.#e||this.hasSelection}#q(We){this.#u.clear();for(const Ge of We)Ge.isEmpty()||(this.#u.add(Ge),Ge.select());this.#w({hasSelectedEditor:!0})}selectAll(){for(const We of this.#u)We.commit();this.#q(this.#t.values())}unselectAll(){if(this.#e){this.#e.commitOrRemove();return}if(this.hasSelection){for(const We of this.#u)We.unselect();this.#u.clear(),this.#w({hasSelectedEditor:!1})}}translateSelectedEditors(We,Ge,$e=!1){if($e||this.commitOrRemove(),!this.hasSelection)return;this.#y[0]+=We,this.#y[1]+=Ge;const[Ke,rr]=this.#y,tr=[...this.#u],sr=1e3;this.#k&&clearTimeout(this.#k),this.#k=setTimeout(()=>{this.#k=null,this.#y[0]=this.#y[1]=0,this.addCommands({cmd:()=>{for(const ar of tr)this.#t.has(ar.id)&&ar.translateInPage(Ke,rr)},undo:()=>{for(const ar of tr)this.#t.has(ar.id)&&ar.translateInPage(-Ke,-rr)},mustExec:!1})},sr);for(const ar of tr)ar.translateInPage(We,Ge)}setUpDragSession(){if(this.hasSelection){this.disableUserSelect(!0),this.#c=new Map;for(const We of this.#u)this.#c.set(We,{savedX:We.x,savedY:We.y,savedPageIndex:We.pageIndex,newX:0,newY:0,newPageIndex:-1})}}endDragSession(){if(!this.#c)return!1;this.disableUserSelect(!1);const We=this.#c;this.#c=null;let Ge=!1;for(const[{x:Ke,y:rr,pageIndex:tr},sr]of We)sr.newX=Ke,sr.newY=rr,sr.newPageIndex=tr,Ge||=Ke!==sr.savedX||rr!==sr.savedY||tr!==sr.savedPageIndex;if(!Ge)return!1;const $e=(Ke,rr,tr,sr)=>{if(this.#t.has(Ke.id)){const ar=this.#r.get(sr);ar?Ke._setParentAndPosition(ar,rr,tr):(Ke.pageIndex=sr,Ke.x=rr,Ke.y=tr)}};return this.addCommands({cmd:()=>{for(const[Ke,{newX:rr,newY:tr,newPageIndex:sr}]of We)$e(Ke,rr,tr,sr)},undo:()=>{for(const[Ke,{savedX:rr,savedY:tr,savedPageIndex:sr}]of We)$e(Ke,rr,tr,sr)},mustExec:!0}),!0}dragSelectedEditors(We,Ge){if(this.#c)for(const $e of this.#c.keys())$e.drag(We,Ge)}rebuild(We){if(We.parent===null){const Ge=this.getLayer(We.pageIndex);Ge?(Ge.changeParent(We),Ge.addOrRebuild(We)):(this.addEditor(We),this.addToAnnotationStorage(We),We.rebuild())}else We.parent.addOrRebuild(We)}isActive(We){return this.#e===We}getActive(){return this.#e}getMode(){return this.#g}get imageManager(){return(0,n.shadow)(this,"imageManager",new ze)}}t.AnnotationEditorUIManager=Ve}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StatTimer=t.RenderingCancelledException=t.PixelsPerInch=t.PageViewport=t.PDFDateString=t.DOMStandardFontDataFactory=t.DOMSVGFactory=t.DOMFilterFactory=t.DOMCanvasFactory=t.DOMCMapReaderFactory=void 0,t.deprecated=pr,t.getColorValues=wr,t.getCurrentTransform=Fr,t.getCurrentTransformInverse=Mr,t.getFilenameFromUrl=Ke,t.getPdfFilenameFromUrl=rr,t.getRGB=mr,t.getXfaPageViewport=Rr,t.isDataScheme=Ge,t.isPdfFile=$e,t.isValidFetchUrl=sr,t.loadScript=hr,t.noContextMenu=ar,t.setLayerDimensions=Hr;var n=r(7),Ee=r(1);const Ce="http://www.w3.org/2000/svg";class De{static CSS=96;static PDF=72;static PDF_TO_CSS_UNITS=this.CSS/this.PDF}t.PixelsPerInch=De;class Me extends n.BaseFilterFactory{#e;#t;#r;#a;#o;#s;#i;#l;#c;#n;#d=0;constructor({docId:Ar,ownerDocument:xr=globalThis.document}={}){super(),this.#r=Ar,this.#a=xr}get#f(){return this.#e||=new Map}get#h(){if(!this.#t){const Ar=this.#a.createElement("div"),{style:xr}=Ar;xr.visibility="hidden",xr.contain="strict",xr.width=xr.height=0,xr.position="absolute",xr.top=xr.left=0,xr.zIndex=-1;const ir=this.#a.createElementNS(Ce,"svg");ir.setAttribute("width",0),ir.setAttribute("height",0),this.#t=this.#a.createElementNS(Ce,"defs"),Ar.append(ir),ir.append(this.#t),this.#a.body.append(Ar)}return this.#t}addFilter(Ar){if(!Ar)return"none";let xr=this.#f.get(Ar);if(xr)return xr;let ir,_r,ur,Je;if(Ar.length===1){const St=Ar[0],dr=new Array(256);for(let vr=0;vr<256;vr++)dr[vr]=St[vr]/255;Je=ir=_r=ur=dr.join(",")}else{const[St,dr,vr]=Ar,br=new Array(256),kr=new Array(256),Pr=new Array(256);for(let Er=0;Er<256;Er++)br[Er]=St[Er]/255,kr[Er]=dr[Er]/255,Pr[Er]=vr[Er]/255;ir=br.join(","),_r=kr.join(","),ur=Pr.join(","),Je=`${ir}${_r}${ur}`}if(xr=this.#f.get(Je),xr)return this.#f.set(Ar,xr),xr;const nr=`g_${this.#r}_transfer_map_${this.#d++}`,or=`url(#${nr})`;this.#f.set(Ar,or),this.#f.set(Je,or);const lr=this.#_(nr);return this.#g(ir,_r,ur,lr),or}addHCMFilter(Ar,xr){const ir=`${Ar}-${xr}`;if(this.#s===ir)return this.#i;if(this.#s=ir,this.#i="none",this.#o?.remove(),!Ar||!xr)return this.#i;const _r=this.#u(Ar);Ar=Ee.Util.makeHexColor(..._r);const ur=this.#u(xr);if(xr=Ee.Util.makeHexColor(...ur),this.#h.style.color="",Ar==="#000000"&&xr==="#ffffff"||Ar===xr)return this.#i;const Je=new Array(256);for(let dr=0;dr<=255;dr++){const vr=dr/255;Je[dr]=vr<=.03928?vr/12.92:((vr+.055)/1.055)**2.4}const nr=Je.join(","),or=`g_${this.#r}_hcm_filter`,lr=this.#l=this.#_(or);this.#g(nr,nr,nr,lr),this.#p(lr);const St=(dr,vr)=>{const br=_r[dr]/255,kr=ur[dr]/255,Pr=new Array(vr+1);for(let Er=0;Er<=vr;Er++)Pr[Er]=br+Er/vr*(kr-br);return Pr.join(",")};return this.#g(St(0,5),St(1,5),St(2,5),lr),this.#i=`url(#${or})`,this.#i}addHighlightHCMFilter(Ar,xr,ir,_r){const ur=`${Ar}-${xr}-${ir}-${_r}`;if(this.#c===ur)return this.#n;if(this.#c=ur,this.#n="none",this.#l?.remove(),!Ar||!xr)return this.#n;const[Je,nr]=[Ar,xr].map(this.#u.bind(this));let or=Math.round(.2126*Je[0]+.7152*Je[1]+.0722*Je[2]),lr=Math.round(.2126*nr[0]+.7152*nr[1]+.0722*nr[2]),[St,dr]=[ir,_r].map(this.#u.bind(this));lr<or&&([or,lr,St,dr]=[lr,or,dr,St]),this.#h.style.color="";const vr=(Pr,Er,Zr)=>{const ua=new Array(256),Cr=(lr-or)/Zr,Jr=Pr/255,Qr=(Er-Pr)/(255*Zr);let oa=0;for(let ta=0;ta<=Zr;ta++){const Na=Math.round(or+ta*Cr),Ca=Jr+ta*Qr;for(let za=oa;za<=Na;za++)ua[za]=Ca;oa=Na+1}for(let ta=oa;ta<256;ta++)ua[ta]=ua[oa-1];return ua.join(",")},br=`g_${this.#r}_hcm_highlight_filter`,kr=this.#l=this.#_(br);return this.#p(kr),this.#g(vr(St[0],dr[0],5),vr(St[1],dr[1],5),vr(St[2],dr[2],5),kr),this.#n=`url(#${br})`,this.#n}destroy(Ar=!1){Ar&&(this.#i||this.#n)||(this.#t&&(this.#t.parentNode.parentNode.remove(),this.#t=null),this.#e&&(this.#e.clear(),this.#e=null),this.#d=0)}#p(Ar){const xr=this.#a.createElementNS(Ce,"feColorMatrix");xr.setAttribute("type","matrix"),xr.setAttribute("values","0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0.2126 0.7152 0.0722 0 0 0 0 0 1 0"),Ar.append(xr)}#_(Ar){const xr=this.#a.createElementNS(Ce,"filter");return xr.setAttribute("color-interpolation-filters","sRGB"),xr.setAttribute("id",Ar),this.#h.append(xr),xr}#m(Ar,xr,ir){const _r=this.#a.createElementNS(Ce,xr);_r.setAttribute("type","discrete"),_r.setAttribute("tableValues",ir),Ar.append(_r)}#g(Ar,xr,ir,_r){const ur=this.#a.createElementNS(Ce,"feComponentTransfer");_r.append(ur),this.#m(ur,"feFuncR",Ar),this.#m(ur,"feFuncG",xr),this.#m(ur,"feFuncB",ir)}#u(Ar){return this.#h.style.color=Ar,mr(getComputedStyle(this.#h).getPropertyValue("color"))}}t.DOMFilterFactory=Me;class ze extends n.BaseCanvasFactory{constructor({ownerDocument:Ar=globalThis.document}={}){super(),this._document=Ar}_createCanvas(Ar,xr){const ir=this._document.createElement("canvas");return ir.width=Ar,ir.height=xr,ir}}t.DOMCanvasFactory=ze;async function Oe(Nr,Ar=!1){if(sr(Nr,document.baseURI)){const xr=await fetch(Nr);if(!xr.ok)throw new Error(xr.statusText);return Ar?new Uint8Array(await xr.arrayBuffer()):(0,Ee.stringToBytes)(await xr.text())}return new Promise((xr,ir)=>{const _r=new XMLHttpRequest;_r.open("GET",Nr,!0),Ar&&(_r.responseType="arraybuffer"),_r.onreadystatechange=()=>{if(_r.readyState===XMLHttpRequest.DONE){if(_r.status===200||_r.status===0){let ur;if(Ar&&_r.response?ur=new Uint8Array(_r.response):!Ar&&_r.responseText&&(ur=(0,Ee.stringToBytes)(_r.responseText)),ur){xr(ur);return}}ir(new Error(_r.statusText))}},_r.send(null)})}class Be extends n.BaseCMapReaderFactory{_fetchData(Ar,xr){return Oe(Ar,this.isCompressed).then(ir=>({cMapData:ir,compressionType:xr}))}}t.DOMCMapReaderFactory=Be;class He extends n.BaseStandardFontDataFactory{_fetchData(Ar){return Oe(Ar,!0)}}t.DOMStandardFontDataFactory=He;class Ve extends n.BaseSVGFactory{_createSVG(Ar){return document.createElementNS(Ce,Ar)}}t.DOMSVGFactory=Ve;class Xe{constructor({viewBox:Ar,scale:xr,rotation:ir,offsetX:_r=0,offsetY:ur=0,dontFlip:Je=!1}){this.viewBox=Ar,this.scale=xr,this.rotation=ir,this.offsetX=_r,this.offsetY=ur;const nr=(Ar[2]+Ar[0])/2,or=(Ar[3]+Ar[1])/2;let lr,St,dr,vr;switch(ir%=360,ir<0&&(ir+=360),ir){case 180:lr=-1,St=0,dr=0,vr=1;break;case 90:lr=0,St=1,dr=1,vr=0;break;case 270:lr=0,St=-1,dr=-1,vr=0;break;case 0:lr=1,St=0,dr=0,vr=-1;break;default:throw new Error("PageViewport: Invalid rotation, must be a multiple of 90 degrees.")}Je&&(dr=-dr,vr=-vr);let br,kr,Pr,Er;lr===0?(br=Math.abs(or-Ar[1])*xr+_r,kr=Math.abs(nr-Ar[0])*xr+ur,Pr=(Ar[3]-Ar[1])*xr,Er=(Ar[2]-Ar[0])*xr):(br=Math.abs(nr-Ar[0])*xr+_r,kr=Math.abs(or-Ar[1])*xr+ur,Pr=(Ar[2]-Ar[0])*xr,Er=(Ar[3]-Ar[1])*xr),this.transform=[lr*xr,St*xr,dr*xr,vr*xr,br-lr*xr*nr-dr*xr*or,kr-St*xr*nr-vr*xr*or],this.width=Pr,this.height=Er}get rawDims(){const{viewBox:Ar}=this;return(0,Ee.shadow)(this,"rawDims",{pageWidth:Ar[2]-Ar[0],pageHeight:Ar[3]-Ar[1],pageX:Ar[0],pageY:Ar[1]})}clone({scale:Ar=this.scale,rotation:xr=this.rotation,offsetX:ir=this.offsetX,offsetY:_r=this.offsetY,dontFlip:ur=!1}={}){return new Xe({viewBox:this.viewBox.slice(),scale:Ar,rotation:xr,offsetX:ir,offsetY:_r,dontFlip:ur})}convertToViewportPoint(Ar,xr){return Ee.Util.applyTransform([Ar,xr],this.transform)}convertToViewportRectangle(Ar){const xr=Ee.Util.applyTransform([Ar[0],Ar[1]],this.transform),ir=Ee.Util.applyTransform([Ar[2],Ar[3]],this.transform);return[xr[0],xr[1],ir[0],ir[1]]}convertToPdfPoint(Ar,xr){return Ee.Util.applyInverseTransform([Ar,xr],this.transform)}}t.PageViewport=Xe;class We extends Ee.BaseException{constructor(Ar,xr=0){super(Ar,"RenderingCancelledException"),this.extraDelay=xr}}t.RenderingCancelledException=We;function Ge(Nr){const Ar=Nr.length;let xr=0;for(;xr<Ar&&Nr[xr].trim()==="";)xr++;return Nr.substring(xr,xr+5).toLowerCase()==="data:"}function $e(Nr){return typeof Nr=="string"&&/\.pdf$/i.test(Nr)}function Ke(Nr,Ar=!1){return Ar||([Nr]=Nr.split(/[#?]/,1)),Nr.substring(Nr.lastIndexOf("/")+1)}function rr(Nr,Ar="document.pdf"){if(typeof Nr!="string")return Ar;if(Ge(Nr))return(0,Ee.warn)('getPdfFilenameFromUrl: ignore "data:"-URL for performance reasons.'),Ar;const xr=/^(?:(?:[^:]+:)?\/\/[^/]+)?([^?#]*)(\?[^#]*)?(#.*)?$/,ir=/[^/?#=]+\.pdf\b(?!.*\.pdf\b)/i,_r=xr.exec(Nr);let ur=ir.exec(_r[1])||ir.exec(_r[2])||ir.exec(_r[3]);if(ur&&(ur=ur[0],ur.includes("%")))try{ur=ir.exec(decodeURIComponent(ur))[0]}catch{}return ur||Ar}class tr{started=Object.create(null);times=[];time(Ar){Ar in this.started&&(0,Ee.warn)(`Timer is already running for ${Ar}`),this.started[Ar]=Date.now()}timeEnd(Ar){Ar in this.started||(0,Ee.warn)(`Timer has not been started for ${Ar}`),this.times.push({name:Ar,start:this.started[Ar],end:Date.now()}),delete this.started[Ar]}toString(){const Ar=[];let xr=0;for(const{name:ir}of this.times)xr=Math.max(ir.length,xr);for(const{name:ir,start:_r,end:ur}of this.times)Ar.push(`${ir.padEnd(xr)} ${ur-_r}ms
`);return Ar.join("")}}t.StatTimer=tr;function sr(Nr,Ar){try{const{protocol:xr}=Ar?new URL(Nr,Ar):new URL(Nr);return xr==="http:"||xr==="https:"}catch{return!1}}function ar(Nr){Nr.preventDefault()}function hr(Nr,Ar=!1){return new Promise((xr,ir)=>{const _r=document.createElement("script");_r.src=Nr,_r.onload=function(ur){Ar&&_r.remove(),xr(ur)},_r.onerror=function(){ir(new Error(`Cannot load script at: ${_r.src}`))},(document.head||document.documentElement).append(_r)})}function pr(Nr){console.log("Deprecated API usage: "+Nr)}let yr;class fr{static toDateObject(Ar){if(!Ar||typeof Ar!="string")return null;yr||=new RegExp("^D:(\\d{4})(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?(\\d{2})?([Z|+|-])?(\\d{2})?'?(\\d{2})?'?");const xr=yr.exec(Ar);if(!xr)return null;const ir=parseInt(xr[1],10);let _r=parseInt(xr[2],10);_r=_r>=1&&_r<=12?_r-1:0;let ur=parseInt(xr[3],10);ur=ur>=1&&ur<=31?ur:1;let Je=parseInt(xr[4],10);Je=Je>=0&&Je<=23?Je:0;let nr=parseInt(xr[5],10);nr=nr>=0&&nr<=59?nr:0;let or=parseInt(xr[6],10);or=or>=0&&or<=59?or:0;const lr=xr[7]||"Z";let St=parseInt(xr[8],10);St=St>=0&&St<=23?St:0;let dr=parseInt(xr[9],10)||0;return dr=dr>=0&&dr<=59?dr:0,lr==="-"?(Je+=St,nr+=dr):lr==="+"&&(Je-=St,nr-=dr),new Date(Date.UTC(ir,_r,ur,Je,nr,or))}}t.PDFDateString=fr;function Rr(Nr,{scale:Ar=1,rotation:xr=0}){const{width:ir,height:_r}=Nr.attributes.style,ur=[0,0,parseInt(ir),parseInt(_r)];return new Xe({viewBox:ur,scale:Ar,rotation:xr})}function mr(Nr){if(Nr.startsWith("#")){const Ar=parseInt(Nr.slice(1),16);return[(Ar&16711680)>>16,(Ar&65280)>>8,Ar&255]}return Nr.startsWith("rgb(")?Nr.slice(4,-1).split(",").map(Ar=>parseInt(Ar)):Nr.startsWith("rgba(")?Nr.slice(5,-1).split(",").map(Ar=>parseInt(Ar)).slice(0,3):((0,Ee.warn)(`Not a valid color format: "${Nr}"`),[0,0,0])}function wr(Nr){const Ar=document.createElement("span");Ar.style.visibility="hidden",document.body.append(Ar);for(const xr of Nr.keys()){Ar.style.color=xr;const ir=window.getComputedStyle(Ar).color;Nr.set(xr,mr(ir))}Ar.remove()}function Fr(Nr){const{a:Ar,b:xr,c:ir,d:_r,e:ur,f:Je}=Nr.getTransform();return[Ar,xr,ir,_r,ur,Je]}function Mr(Nr){const{a:Ar,b:xr,c:ir,d:_r,e:ur,f:Je}=Nr.getTransform().invertSelf();return[Ar,xr,ir,_r,ur,Je]}function Hr(Nr,Ar,xr=!1,ir=!0){if(Ar instanceof Xe){const{pageWidth:_r,pageHeight:ur}=Ar.rawDims,{style:Je}=Nr,nr=Ee.FeatureTest.isCSSRoundSupported,or=`var(--scale-factor) * ${_r}px`,lr=`var(--scale-factor) * ${ur}px`,St=nr?`round(${or}, 1px)`:`calc(${or})`,dr=nr?`round(${lr}, 1px)`:`calc(${lr})`;!xr||Ar.rotation%180===0?(Je.width=St,Je.height=dr):(Je.width=dr,Je.height=St)}ir&&Nr.setAttribute("data-main-rotation",Ar.rotation)}}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaseStandardFontDataFactory=t.BaseSVGFactory=t.BaseFilterFactory=t.BaseCanvasFactory=t.BaseCMapReaderFactory=void 0;var n=r(1);class Ee{constructor(){this.constructor===Ee&&(0,n.unreachable)("Cannot initialize BaseFilterFactory.")}addFilter(Be){return"none"}addHCMFilter(Be,He){return"none"}addHighlightHCMFilter(Be,He,Ve,Xe){return"none"}destroy(Be=!1){}}t.BaseFilterFactory=Ee;class Ce{constructor(){this.constructor===Ce&&(0,n.unreachable)("Cannot initialize BaseCanvasFactory.")}create(Be,He){if(Be<=0||He<=0)throw new Error("Invalid canvas size");const Ve=this._createCanvas(Be,He);return{canvas:Ve,context:Ve.getContext("2d")}}reset(Be,He,Ve){if(!Be.canvas)throw new Error("Canvas is not specified");if(He<=0||Ve<=0)throw new Error("Invalid canvas size");Be.canvas.width=He,Be.canvas.height=Ve}destroy(Be){if(!Be.canvas)throw new Error("Canvas is not specified");Be.canvas.width=0,Be.canvas.height=0,Be.canvas=null,Be.context=null}_createCanvas(Be,He){(0,n.unreachable)("Abstract method `_createCanvas` called.")}}t.BaseCanvasFactory=Ce;class De{constructor({baseUrl:Be=null,isCompressed:He=!0}){this.constructor===De&&(0,n.unreachable)("Cannot initialize BaseCMapReaderFactory."),this.baseUrl=Be,this.isCompressed=He}async fetch({name:Be}){if(!this.baseUrl)throw new Error('The CMap "baseUrl" parameter must be specified, ensure that the "cMapUrl" and "cMapPacked" API parameters are provided.');if(!Be)throw new Error("CMap name must be specified.");const He=this.baseUrl+Be+(this.isCompressed?".bcmap":""),Ve=this.isCompressed?n.CMapCompressionType.BINARY:n.CMapCompressionType.NONE;return this._fetchData(He,Ve).catch(Xe=>{throw new Error(`Unable to load ${this.isCompressed?"binary ":""}CMap at: ${He}`)})}_fetchData(Be,He){(0,n.unreachable)("Abstract method `_fetchData` called.")}}t.BaseCMapReaderFactory=De;class Me{constructor({baseUrl:Be=null}){this.constructor===Me&&(0,n.unreachable)("Cannot initialize BaseStandardFontDataFactory."),this.baseUrl=Be}async fetch({filename:Be}){if(!this.baseUrl)throw new Error('The standard font "baseUrl" parameter must be specified, ensure that the "standardFontDataUrl" API parameter is provided.');if(!Be)throw new Error("Font filename must be specified.");const He=`${this.baseUrl}${Be}`;return this._fetchData(He).catch(Ve=>{throw new Error(`Unable to load font data at: ${He}`)})}_fetchData(Be){(0,n.unreachable)("Abstract method `_fetchData` called.")}}t.BaseStandardFontDataFactory=Me;class ze{constructor(){this.constructor===ze&&(0,n.unreachable)("Cannot initialize BaseSVGFactory.")}create(Be,He,Ve=!1){if(Be<=0||He<=0)throw new Error("Invalid SVG dimensions");const Xe=this._createSVG("svg:svg");return Xe.setAttribute("version","1.1"),Ve||(Xe.setAttribute("width",`${Be}px`),Xe.setAttribute("height",`${He}px`)),Xe.setAttribute("preserveAspectRatio","none"),Xe.setAttribute("viewBox",`0 0 ${Be} ${He}`),Xe}createElement(Be){if(typeof Be!="string")throw new Error("Invalid SVG element type");return this._createSVG(Be)}_createSVG(Be){(0,n.unreachable)("Abstract method `_createSVG` called.")}}t.BaseSVGFactory=ze}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MurmurHash3_64=void 0;var n=r(1);const Ee=3285377520,Ce=4294901760,De=65535;class Me{constructor(Oe){this.h1=Oe?Oe&4294967295:Ee,this.h2=Oe?Oe&4294967295:Ee}update(Oe){let Be,He;if(typeof Oe=="string"){Be=new Uint8Array(Oe.length*2),He=0;for(let pr=0,yr=Oe.length;pr<yr;pr++){const fr=Oe.charCodeAt(pr);fr<=255?Be[He++]=fr:(Be[He++]=fr>>>8,Be[He++]=fr&255)}}else if((0,n.isArrayBuffer)(Oe))Be=Oe.slice(),He=Be.byteLength;else throw new Error("Wrong data format in MurmurHash3_64_update. Input must be a string or array.");const Ve=He>>2,Xe=He-Ve*4,We=new Uint32Array(Be.buffer,0,Ve);let Ge=0,$e=0,Ke=this.h1,rr=this.h2;const tr=3432918353,sr=461845907,ar=tr&De,hr=sr&De;for(let pr=0;pr<Ve;pr++)pr&1?(Ge=We[pr],Ge=Ge*tr&Ce|Ge*ar&De,Ge=Ge<<15|Ge>>>17,Ge=Ge*sr&Ce|Ge*hr&De,Ke^=Ge,Ke=Ke<<13|Ke>>>19,Ke=Ke*5+3864292196):($e=We[pr],$e=$e*tr&Ce|$e*ar&De,$e=$e<<15|$e>>>17,$e=$e*sr&Ce|$e*hr&De,rr^=$e,rr=rr<<13|rr>>>19,rr=rr*5+3864292196);switch(Ge=0,Xe){case 3:Ge^=Be[Ve*4+2]<<16;case 2:Ge^=Be[Ve*4+1]<<8;case 1:Ge^=Be[Ve*4],Ge=Ge*tr&Ce|Ge*ar&De,Ge=Ge<<15|Ge>>>17,Ge=Ge*sr&Ce|Ge*hr&De,Ve&1?Ke^=Ge:rr^=Ge}this.h1=Ke,this.h2=rr}hexdigest(){let Oe=this.h1,Be=this.h2;return Oe^=Be>>>1,Oe=Oe*3981806797&Ce|Oe*36045&De,Be=Be*4283543511&Ce|((Be<<16|Oe>>>16)*2950163797&Ce)>>>16,Oe^=Be>>>1,Oe=Oe*444984403&Ce|Oe*60499&De,Be=Be*3301882366&Ce|((Be<<16|Oe>>>16)*3120437893&Ce)>>>16,Oe^=Be>>>1,(Oe>>>0).toString(16).padStart(8,"0")+(Be>>>0).toString(16).padStart(8,"0")}}t.MurmurHash3_64=Me}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FontLoader=t.FontFaceObject=void 0;var n=r(1);class Ee{#e=new Set;constructor({ownerDocument:Me=globalThis.document,styleElement:ze=null}){this._document=Me,this.nativeFontFaces=new Set,this.styleElement=null,this.loadingRequests=[],this.loadTestFontId=0}addNativeFontFace(Me){this.nativeFontFaces.add(Me),this._document.fonts.add(Me)}removeNativeFontFace(Me){this.nativeFontFaces.delete(Me),this._document.fonts.delete(Me)}insertRule(Me){this.styleElement||(this.styleElement=this._document.createElement("style"),this._document.documentElement.getElementsByTagName("head")[0].append(this.styleElement));const ze=this.styleElement.sheet;ze.insertRule(Me,ze.cssRules.length)}clear(){for(const Me of this.nativeFontFaces)this._document.fonts.delete(Me);this.nativeFontFaces.clear(),this.#e.clear(),this.styleElement&&(this.styleElement.remove(),this.styleElement=null)}async loadSystemFont(Me){if(!(!Me||this.#e.has(Me.loadedName))){if((0,n.assert)(!this.disableFontFace,"loadSystemFont shouldn't be called when `disableFontFace` is set."),this.isFontLoadingAPISupported){const{loadedName:ze,src:Oe,style:Be}=Me,He=new FontFace(ze,Oe,Be);this.addNativeFontFace(He);try{await He.load(),this.#e.add(ze)}catch{(0,n.warn)(`Cannot load system font: ${Me.baseFontName}, installing it could help to improve PDF rendering.`),this.removeNativeFontFace(He)}return}(0,n.unreachable)("Not implemented: loadSystemFont without the Font Loading API.")}}async bind(Me){if(Me.attached||Me.missingFile&&!Me.systemFontInfo)return;if(Me.attached=!0,Me.systemFontInfo){await this.loadSystemFont(Me.systemFontInfo);return}if(this.isFontLoadingAPISupported){const Oe=Me.createNativeFontFace();if(Oe){this.addNativeFontFace(Oe);try{await Oe.loaded}catch(Be){throw(0,n.warn)(`Failed to load font '${Oe.family}': '${Be}'.`),Me.disableFontFace=!0,Be}}return}const ze=Me.createFontFaceRule();if(ze){if(this.insertRule(ze),this.isSyncFontLoadingSupported)return;await new Promise(Oe=>{const Be=this._queueLoadingCallback(Oe);this._prepareFontLoadEvent(Me,Be)})}}get isFontLoadingAPISupported(){const Me=!!this._document?.fonts;return(0,n.shadow)(this,"isFontLoadingAPISupported",Me)}get isSyncFontLoadingSupported(){let Me=!1;return(n.isNodeJS||typeof navigator<"u"&&/Mozilla\/5.0.*?rv:\d+.*? Gecko/.test(navigator.userAgent))&&(Me=!0),(0,n.shadow)(this,"isSyncFontLoadingSupported",Me)}_queueLoadingCallback(Me){function ze(){for((0,n.assert)(!Be.done,"completeRequest() cannot be called twice."),Be.done=!0;Oe.length>0&&Oe[0].done;){const He=Oe.shift();setTimeout(He.callback,0)}}const{loadingRequests:Oe}=this,Be={done:!1,complete:ze,callback:Me};return Oe.push(Be),Be}get _loadTestFont(){const Me=atob("T1RUTwALAIAAAwAwQ0ZGIDHtZg4AAAOYAAAAgUZGVE1lkzZwAAAEHAAAABxHREVGABQAFQAABDgAAAAeT1MvMlYNYwkAAAEgAAAAYGNtYXABDQLUAAACNAAAAUJoZWFk/xVFDQAAALwAAAA2aGhlYQdkA+oAAAD0AAAAJGhtdHgD6AAAAAAEWAAAAAZtYXhwAAJQAAAAARgAAAAGbmFtZVjmdH4AAAGAAAAAsXBvc3T/hgAzAAADeAAAACAAAQAAAAEAALZRFsRfDzz1AAsD6AAAAADOBOTLAAAAAM4KHDwAAAAAA+gDIQAAAAgAAgAAAAAAAAABAAADIQAAAFoD6AAAAAAD6AABAAAAAAAAAAAAAAAAAAAAAQAAUAAAAgAAAAQD6AH0AAUAAAKKArwAAACMAooCvAAAAeAAMQECAAACAAYJAAAAAAAAAAAAAQAAAAAAAAAAAAAAAFBmRWQAwAAuAC4DIP84AFoDIQAAAAAAAQAAAAAAAAAAACAAIAABAAAADgCuAAEAAAAAAAAAAQAAAAEAAAAAAAEAAQAAAAEAAAAAAAIAAQAAAAEAAAAAAAMAAQAAAAEAAAAAAAQAAQAAAAEAAAAAAAUAAQAAAAEAAAAAAAYAAQAAAAMAAQQJAAAAAgABAAMAAQQJAAEAAgABAAMAAQQJAAIAAgABAAMAAQQJAAMAAgABAAMAAQQJAAQAAgABAAMAAQQJAAUAAgABAAMAAQQJAAYAAgABWABYAAAAAAAAAwAAAAMAAAAcAAEAAAAAADwAAwABAAAAHAAEACAAAAAEAAQAAQAAAC7//wAAAC7////TAAEAAAAAAAABBgAAAQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMAAAAAAAD/gwAyAAAAAQAAAAAAAAAAAAAAAAAAAAABAAQEAAEBAQJYAAEBASH4DwD4GwHEAvgcA/gXBIwMAYuL+nz5tQXkD5j3CBLnEQACAQEBIVhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYAAABAQAADwACAQEEE/t3Dov6fAH6fAT+fPp8+nwHDosMCvm1Cvm1DAz6fBQAAAAAAAABAAAAAMmJbzEAAAAAzgTjFQAAAADOBOQpAAEAAAAAAAAADAAUAAQAAAABAAAAAgABAAAAAAAAAAAD6AAAAAAAAA==");return(0,n.shadow)(this,"_loadTestFont",Me)}_prepareFontLoadEvent(Me,ze){function Oe(Rr,mr){return Rr.charCodeAt(mr)<<24|Rr.charCodeAt(mr+1)<<16|Rr.charCodeAt(mr+2)<<8|Rr.charCodeAt(mr+3)&255}function Be(Rr,mr,wr,Fr){const Mr=Rr.substring(0,mr),Hr=Rr.substring(mr+wr);return Mr+Fr+Hr}let He,Ve;const Xe=this._document.createElement("canvas");Xe.width=1,Xe.height=1;const We=Xe.getContext("2d");let Ge=0;function $e(Rr,mr){if(++Ge>30){(0,n.warn)("Load test font never loaded."),mr();return}if(We.font="30px "+Rr,We.fillText(".",0,20),We.getImageData(0,0,1,1).data[3]>0){mr();return}setTimeout($e.bind(null,Rr,mr))}const Ke=`lt${Date.now()}${this.loadTestFontId++}`;let rr=this._loadTestFont;rr=Be(rr,976,Ke.length,Ke);const sr=16,ar=1482184792;let hr=Oe(rr,sr);for(He=0,Ve=Ke.length-3;He<Ve;He+=4)hr=hr-ar+Oe(Ke,He)|0;He<Ke.length&&(hr=hr-ar+Oe(Ke+"XXX",He)|0),rr=Be(rr,sr,4,(0,n.string32)(hr));const pr=`url(data:font/opentype;base64,${btoa(rr)});`,yr=`@font-face {font-family:"${Ke}";src:${pr}}`;this.insertRule(yr);const fr=this._document.createElement("div");fr.style.visibility="hidden",fr.style.width=fr.style.height="10px",fr.style.position="absolute",fr.style.top=fr.style.left="0px";for(const Rr of[Me.loadedName,Ke]){const mr=this._document.createElement("span");mr.textContent="Hi",mr.style.fontFamily=Rr,fr.append(mr)}this._document.body.append(fr),$e(Ke,()=>{fr.remove(),ze.complete()})}}t.FontLoader=Ee;class Ce{constructor(Me,{isEvalSupported:ze=!0,disableFontFace:Oe=!1,ignoreErrors:Be=!1,inspectFont:He=null}){this.compiledGlyphs=Object.create(null);for(const Ve in Me)this[Ve]=Me[Ve];this.isEvalSupported=ze!==!1,this.disableFontFace=Oe===!0,this.ignoreErrors=Be===!0,this._inspectFont=He}createNativeFontFace(){if(!this.data||this.disableFontFace)return null;let Me;if(!this.cssFontInfo)Me=new FontFace(this.loadedName,this.data,{});else{const ze={weight:this.cssFontInfo.fontWeight};this.cssFontInfo.italicAngle&&(ze.style=`oblique ${this.cssFontInfo.italicAngle}deg`),Me=new FontFace(this.cssFontInfo.fontFamily,this.data,ze)}return this._inspectFont?.(this),Me}createFontFaceRule(){if(!this.data||this.disableFontFace)return null;const Me=(0,n.bytesToString)(this.data),ze=`url(data:${this.mimetype};base64,${btoa(Me)});`;let Oe;if(!this.cssFontInfo)Oe=`@font-face {font-family:"${this.loadedName}";src:${ze}}`;else{let Be=`font-weight: ${this.cssFontInfo.fontWeight};`;this.cssFontInfo.italicAngle&&(Be+=`font-style: oblique ${this.cssFontInfo.italicAngle}deg;`),Oe=`@font-face {font-family:"${this.cssFontInfo.fontFamily}";${Be}src:${ze}}`}return this._inspectFont?.(this,ze),Oe}getPathGenerator(Me,ze){if(this.compiledGlyphs[ze]!==void 0)return this.compiledGlyphs[ze];let Oe;try{Oe=Me.get(this.loadedName+"_path_"+ze)}catch(Be){if(!this.ignoreErrors)throw Be;return(0,n.warn)(`getPathGenerator - ignoring character: "${Be}".`),this.compiledGlyphs[ze]=function(He,Ve){}}if(this.isEvalSupported&&n.FeatureTest.isEvalSupported){const Be=[];for(const He of Oe){const Ve=He.args!==void 0?He.args.join(","):"";Be.push("c.",He.cmd,"(",Ve,`);
`)}return this.compiledGlyphs[ze]=new Function("c","size",Be.join(""))}return this.compiledGlyphs[ze]=function(Be,He){for(const Ve of Oe)Ve.cmd==="scale"&&(Ve.args=[He,-He]),Be[Ve.cmd].apply(Be,Ve.args)}}}t.FontFaceObject=Ce}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NodeStandardFontDataFactory=t.NodeFilterFactory=t.NodeCanvasFactory=t.NodeCMapReaderFactory=void 0;var n=r(7);r(1);const Ee=function(Oe){return new Promise((Be,He)=>{require$$5.readFile(Oe,(Xe,We)=>{if(Xe||!We){He(new Error(Xe));return}Be(new Uint8Array(We))})})};class Ce extends n.BaseFilterFactory{}t.NodeFilterFactory=Ce;class De extends n.BaseCanvasFactory{_createCanvas(Be,He){return require$$5.createCanvas(Be,He)}}t.NodeCanvasFactory=De;class Me extends n.BaseCMapReaderFactory{_fetchData(Be,He){return Ee(Be).then(Ve=>({cMapData:Ve,compressionType:He}))}}t.NodeCMapReaderFactory=Me;class ze extends n.BaseStandardFontDataFactory{_fetchData(Be){return Ee(Be)}}t.NodeStandardFontDataFactory=ze}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.CanvasGraphics=void 0;var n=r(1),Ee=r(6),Ce=r(12),De=r(13);const Me=16,ze=100,Oe=4096,Be=15,He=10,Ve=1e3,Xe=16;function We(xr,ir){if(xr._removeMirroring)throw new Error("Context is already forwarding operations.");xr.__originalSave=xr.save,xr.__originalRestore=xr.restore,xr.__originalRotate=xr.rotate,xr.__originalScale=xr.scale,xr.__originalTranslate=xr.translate,xr.__originalTransform=xr.transform,xr.__originalSetTransform=xr.setTransform,xr.__originalResetTransform=xr.resetTransform,xr.__originalClip=xr.clip,xr.__originalMoveTo=xr.moveTo,xr.__originalLineTo=xr.lineTo,xr.__originalBezierCurveTo=xr.bezierCurveTo,xr.__originalRect=xr.rect,xr.__originalClosePath=xr.closePath,xr.__originalBeginPath=xr.beginPath,xr._removeMirroring=()=>{xr.save=xr.__originalSave,xr.restore=xr.__originalRestore,xr.rotate=xr.__originalRotate,xr.scale=xr.__originalScale,xr.translate=xr.__originalTranslate,xr.transform=xr.__originalTransform,xr.setTransform=xr.__originalSetTransform,xr.resetTransform=xr.__originalResetTransform,xr.clip=xr.__originalClip,xr.moveTo=xr.__originalMoveTo,xr.lineTo=xr.__originalLineTo,xr.bezierCurveTo=xr.__originalBezierCurveTo,xr.rect=xr.__originalRect,xr.closePath=xr.__originalClosePath,xr.beginPath=xr.__originalBeginPath,delete xr._removeMirroring},xr.save=function(){ir.save(),this.__originalSave()},xr.restore=function(){ir.restore(),this.__originalRestore()},xr.translate=function(ur,Je){ir.translate(ur,Je),this.__originalTranslate(ur,Je)},xr.scale=function(ur,Je){ir.scale(ur,Je),this.__originalScale(ur,Je)},xr.transform=function(ur,Je,nr,or,lr,St){ir.transform(ur,Je,nr,or,lr,St),this.__originalTransform(ur,Je,nr,or,lr,St)},xr.setTransform=function(ur,Je,nr,or,lr,St){ir.setTransform(ur,Je,nr,or,lr,St),this.__originalSetTransform(ur,Je,nr,or,lr,St)},xr.resetTransform=function(){ir.resetTransform(),this.__originalResetTransform()},xr.rotate=function(ur){ir.rotate(ur),this.__originalRotate(ur)},xr.clip=function(ur){ir.clip(ur),this.__originalClip(ur)},xr.moveTo=function(_r,ur){ir.moveTo(_r,ur),this.__originalMoveTo(_r,ur)},xr.lineTo=function(_r,ur){ir.lineTo(_r,ur),this.__originalLineTo(_r,ur)},xr.bezierCurveTo=function(_r,ur,Je,nr,or,lr){ir.bezierCurveTo(_r,ur,Je,nr,or,lr),this.__originalBezierCurveTo(_r,ur,Je,nr,or,lr)},xr.rect=function(_r,ur,Je,nr){ir.rect(_r,ur,Je,nr),this.__originalRect(_r,ur,Je,nr)},xr.closePath=function(){ir.closePath(),this.__originalClosePath()},xr.beginPath=function(){ir.beginPath(),this.__originalBeginPath()}}class Ge{constructor(ir){this.canvasFactory=ir,this.cache=Object.create(null)}getCanvas(ir,_r,ur){let Je;return this.cache[ir]!==void 0?(Je=this.cache[ir],this.canvasFactory.reset(Je,_r,ur)):(Je=this.canvasFactory.create(_r,ur),this.cache[ir]=Je),Je}delete(ir){delete this.cache[ir]}clear(){for(const ir in this.cache){const _r=this.cache[ir];this.canvasFactory.destroy(_r),delete this.cache[ir]}}}function $e(xr,ir,_r,ur,Je,nr,or,lr,St,dr){const[vr,br,kr,Pr,Er,Zr]=(0,Ee.getCurrentTransform)(xr);if(br===0&&kr===0){const Jr=or*vr+Er,Qr=Math.round(Jr),oa=lr*Pr+Zr,ta=Math.round(oa),Na=(or+St)*vr+Er,Ca=Math.abs(Math.round(Na)-Qr)||1,za=(lr+dr)*Pr+Zr,Xa=Math.abs(Math.round(za)-ta)||1;return xr.setTransform(Math.sign(vr),0,0,Math.sign(Pr),Qr,ta),xr.drawImage(ir,_r,ur,Je,nr,0,0,Ca,Xa),xr.setTransform(vr,br,kr,Pr,Er,Zr),[Ca,Xa]}if(vr===0&&Pr===0){const Jr=lr*kr+Er,Qr=Math.round(Jr),oa=or*br+Zr,ta=Math.round(oa),Na=(lr+dr)*kr+Er,Ca=Math.abs(Math.round(Na)-Qr)||1,za=(or+St)*br+Zr,Xa=Math.abs(Math.round(za)-ta)||1;return xr.setTransform(0,Math.sign(br),Math.sign(kr),0,Qr,ta),xr.drawImage(ir,_r,ur,Je,nr,0,0,Xa,Ca),xr.setTransform(vr,br,kr,Pr,Er,Zr),[Xa,Ca]}xr.drawImage(ir,_r,ur,Je,nr,or,lr,St,dr);const ua=Math.hypot(vr,br),Cr=Math.hypot(kr,Pr);return[ua*St,Cr*dr]}function Ke(xr){const{width:ir,height:_r}=xr;if(ir>Ve||_r>Ve)return null;const ur=1e3,Je=new Uint8Array([0,2,4,0,1,0,5,4,8,10,0,8,0,2,1,0]),nr=ir+1;let or=new Uint8Array(nr*(_r+1)),lr,St,dr;const vr=ir+7&-8;let br=new Uint8Array(vr*_r),kr=0;for(const Cr of xr.data){let Jr=128;for(;Jr>0;)br[kr++]=Cr&Jr?0:255,Jr>>=1}let Pr=0;for(kr=0,br[kr]!==0&&(or[0]=1,++Pr),St=1;St<ir;St++)br[kr]!==br[kr+1]&&(or[St]=br[kr]?2:1,++Pr),kr++;for(br[kr]!==0&&(or[St]=2,++Pr),lr=1;lr<_r;lr++){kr=lr*vr,dr=lr*nr,br[kr-vr]!==br[kr]&&(or[dr]=br[kr]?1:8,++Pr);let Cr=(br[kr]?4:0)+(br[kr-vr]?8:0);for(St=1;St<ir;St++)Cr=(Cr>>2)+(br[kr+1]?4:0)+(br[kr-vr+1]?8:0),Je[Cr]&&(or[dr+St]=Je[Cr],++Pr),kr++;if(br[kr-vr]!==br[kr]&&(or[dr+St]=br[kr]?2:4,++Pr),Pr>ur)return null}for(kr=vr*(_r-1),dr=lr*nr,br[kr]!==0&&(or[dr]=8,++Pr),St=1;St<ir;St++)br[kr]!==br[kr+1]&&(or[dr+St]=br[kr]?4:8,++Pr),kr++;if(br[kr]!==0&&(or[dr+St]=4,++Pr),Pr>ur)return null;const Er=new Int32Array([0,nr,-1,0,-nr,0,0,0,1]),Zr=new Path2D;for(lr=0;Pr&&lr<=_r;lr++){let Cr=lr*nr;const Jr=Cr+ir;for(;Cr<Jr&&!or[Cr];)Cr++;if(Cr===Jr)continue;Zr.moveTo(Cr%nr,lr);const Qr=Cr;let oa=or[Cr];do{const ta=Er[oa];do Cr+=ta;while(!or[Cr]);const Na=or[Cr];Na!==5&&Na!==10?(oa=Na,or[Cr]=0):(oa=Na&51*oa>>4,or[Cr]&=oa>>2|oa<<2),Zr.lineTo(Cr%nr,Cr/nr|0),or[Cr]||--Pr}while(Qr!==Cr);--lr}return br=null,or=null,function(Cr){Cr.save(),Cr.scale(1/ir,-1/_r),Cr.translate(0,-_r),Cr.fill(Zr),Cr.beginPath(),Cr.restore()}}class rr{constructor(ir,_r){this.alphaIsShape=!1,this.fontSize=0,this.fontSizeScale=1,this.textMatrix=n.IDENTITY_MATRIX,this.textMatrixScale=1,this.fontMatrix=n.FONT_IDENTITY_MATRIX,this.leading=0,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRenderingMode=n.TextRenderingMode.FILL,this.textRise=0,this.fillColor="#000000",this.strokeColor="#000000",this.patternFill=!1,this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.activeSMask=null,this.transferMaps="none",this.startNewPathAndClipBox([0,0,ir,_r])}clone(){const ir=Object.create(this);return ir.clipBox=this.clipBox.slice(),ir}setCurrentPoint(ir,_r){this.x=ir,this.y=_r}updatePathMinMax(ir,_r,ur){[_r,ur]=n.Util.applyTransform([_r,ur],ir),this.minX=Math.min(this.minX,_r),this.minY=Math.min(this.minY,ur),this.maxX=Math.max(this.maxX,_r),this.maxY=Math.max(this.maxY,ur)}updateRectMinMax(ir,_r){const ur=n.Util.applyTransform(_r,ir),Je=n.Util.applyTransform(_r.slice(2),ir);this.minX=Math.min(this.minX,ur[0],Je[0]),this.minY=Math.min(this.minY,ur[1],Je[1]),this.maxX=Math.max(this.maxX,ur[0],Je[0]),this.maxY=Math.max(this.maxY,ur[1],Je[1])}updateScalingPathMinMax(ir,_r){n.Util.scaleMinMax(ir,_r),this.minX=Math.min(this.minX,_r[0]),this.maxX=Math.max(this.maxX,_r[1]),this.minY=Math.min(this.minY,_r[2]),this.maxY=Math.max(this.maxY,_r[3])}updateCurvePathMinMax(ir,_r,ur,Je,nr,or,lr,St,dr,vr){const br=n.Util.bezierBoundingBox(_r,ur,Je,nr,or,lr,St,dr);if(vr){vr[0]=Math.min(vr[0],br[0],br[2]),vr[1]=Math.max(vr[1],br[0],br[2]),vr[2]=Math.min(vr[2],br[1],br[3]),vr[3]=Math.max(vr[3],br[1],br[3]);return}this.updateRectMinMax(ir,br)}getPathBoundingBox(ir=Ce.PathType.FILL,_r=null){const ur=[this.minX,this.minY,this.maxX,this.maxY];if(ir===Ce.PathType.STROKE){_r||(0,n.unreachable)("Stroke bounding box must include transform.");const Je=n.Util.singularValueDecompose2dScale(_r),nr=Je[0]*this.lineWidth/2,or=Je[1]*this.lineWidth/2;ur[0]-=nr,ur[1]-=or,ur[2]+=nr,ur[3]+=or}return ur}updateClipFromPath(){const ir=n.Util.intersect(this.clipBox,this.getPathBoundingBox());this.startNewPathAndClipBox(ir||[0,0,0,0])}isEmptyClip(){return this.minX===1/0}startNewPathAndClipBox(ir){this.clipBox=ir,this.minX=1/0,this.minY=1/0,this.maxX=0,this.maxY=0}getClippedPathBoundingBox(ir=Ce.PathType.FILL,_r=null){return n.Util.intersect(this.clipBox,this.getPathBoundingBox(ir,_r))}}function tr(xr,ir){if(typeof ImageData<"u"&&ir instanceof ImageData){xr.putImageData(ir,0,0);return}const _r=ir.height,ur=ir.width,Je=_r%Xe,nr=(_r-Je)/Xe,or=Je===0?nr:nr+1,lr=xr.createImageData(ur,Xe);let St=0,dr;const vr=ir.data,br=lr.data;let kr,Pr,Er,Zr;if(ir.kind===n.ImageKind.GRAYSCALE_1BPP){const ua=vr.byteLength,Cr=new Uint32Array(br.buffer,0,br.byteLength>>2),Jr=Cr.length,Qr=ur+7>>3,oa=4294967295,ta=n.FeatureTest.isLittleEndian?4278190080:255;for(kr=0;kr<or;kr++){for(Er=kr<nr?Xe:Je,dr=0,Pr=0;Pr<Er;Pr++){const Na=ua-St;let Ca=0;const za=Na>Qr?ur:Na*8-7,Xa=za&-8;let Ya=0,nn=0;for(;Ca<Xa;Ca+=8)nn=vr[St++],Cr[dr++]=nn&128?oa:ta,Cr[dr++]=nn&64?oa:ta,Cr[dr++]=nn&32?oa:ta,Cr[dr++]=nn&16?oa:ta,Cr[dr++]=nn&8?oa:ta,Cr[dr++]=nn&4?oa:ta,Cr[dr++]=nn&2?oa:ta,Cr[dr++]=nn&1?oa:ta;for(;Ca<za;Ca++)Ya===0&&(nn=vr[St++],Ya=128),Cr[dr++]=nn&Ya?oa:ta,Ya>>=1}for(;dr<Jr;)Cr[dr++]=0;xr.putImageData(lr,0,kr*Xe)}}else if(ir.kind===n.ImageKind.RGBA_32BPP){for(Pr=0,Zr=ur*Xe*4,kr=0;kr<nr;kr++)br.set(vr.subarray(St,St+Zr)),St+=Zr,xr.putImageData(lr,0,Pr),Pr+=Xe;kr<or&&(Zr=ur*Je*4,br.set(vr.subarray(St,St+Zr)),xr.putImageData(lr,0,Pr))}else if(ir.kind===n.ImageKind.RGB_24BPP)for(Er=Xe,Zr=ur*Er,kr=0;kr<or;kr++){for(kr>=nr&&(Er=Je,Zr=ur*Er),dr=0,Pr=Zr;Pr--;)br[dr++]=vr[St++],br[dr++]=vr[St++],br[dr++]=vr[St++],br[dr++]=255;xr.putImageData(lr,0,kr*Xe)}else throw new Error(`bad image kind: ${ir.kind}`)}function sr(xr,ir){if(ir.bitmap){xr.drawImage(ir.bitmap,0,0);return}const _r=ir.height,ur=ir.width,Je=_r%Xe,nr=(_r-Je)/Xe,or=Je===0?nr:nr+1,lr=xr.createImageData(ur,Xe);let St=0;const dr=ir.data,vr=lr.data;for(let br=0;br<or;br++){const kr=br<nr?Xe:Je;({srcPos:St}=(0,De.convertBlackAndWhiteToRGBA)({src:dr,srcPos:St,dest:vr,width:ur,height:kr,nonBlackColor:0})),xr.putImageData(lr,0,br*Xe)}}function ar(xr,ir){const _r=["strokeStyle","fillStyle","fillRule","globalAlpha","lineWidth","lineCap","lineJoin","miterLimit","globalCompositeOperation","font","filter"];for(const ur of _r)xr[ur]!==void 0&&(ir[ur]=xr[ur]);xr.setLineDash!==void 0&&(ir.setLineDash(xr.getLineDash()),ir.lineDashOffset=xr.lineDashOffset)}function hr(xr){if(xr.strokeStyle=xr.fillStyle="#000000",xr.fillRule="nonzero",xr.globalAlpha=1,xr.lineWidth=1,xr.lineCap="butt",xr.lineJoin="miter",xr.miterLimit=10,xr.globalCompositeOperation="source-over",xr.font="10px sans-serif",xr.setLineDash!==void 0&&(xr.setLineDash([]),xr.lineDashOffset=0),!n.isNodeJS){const{filter:ir}=xr;ir!=="none"&&ir!==""&&(xr.filter="none")}}function pr(xr,ir,_r,ur){const Je=xr.length;for(let nr=3;nr<Je;nr+=4){const or=xr[nr];if(or===0)xr[nr-3]=ir,xr[nr-2]=_r,xr[nr-1]=ur;else if(or<255){const lr=255-or;xr[nr-3]=xr[nr-3]*or+ir*lr>>8,xr[nr-2]=xr[nr-2]*or+_r*lr>>8,xr[nr-1]=xr[nr-1]*or+ur*lr>>8}}}function yr(xr,ir,_r){const ur=xr.length,Je=1/255;for(let nr=3;nr<ur;nr+=4){const or=_r?_r[xr[nr]]:xr[nr];ir[nr]=ir[nr]*or*Je|0}}function fr(xr,ir,_r){const ur=xr.length;for(let Je=3;Je<ur;Je+=4){const nr=xr[Je-3]*77+xr[Je-2]*152+xr[Je-1]*28;ir[Je]=_r?ir[Je]*_r[nr>>8]>>8:ir[Je]*nr>>16}}function Rr(xr,ir,_r,ur,Je,nr,or,lr,St,dr,vr){const br=!!nr,kr=br?nr[0]:0,Pr=br?nr[1]:0,Er=br?nr[2]:0,Zr=Je==="Luminosity"?fr:yr,Cr=Math.min(ur,Math.ceil(1048576/_r));for(let Jr=0;Jr<ur;Jr+=Cr){const Qr=Math.min(Cr,ur-Jr),oa=xr.getImageData(lr-dr,Jr+(St-vr),_r,Qr),ta=ir.getImageData(lr,Jr+St,_r,Qr);br&&pr(oa.data,kr,Pr,Er),Zr(oa.data,ta.data,or),ir.putImageData(ta,lr,Jr+St)}}function mr(xr,ir,_r,ur){const Je=ur[0],nr=ur[1],or=ur[2]-Je,lr=ur[3]-nr;or===0||lr===0||(Rr(ir.context,_r,or,lr,ir.subtype,ir.backdrop,ir.transferMap,Je,nr,ir.offsetX,ir.offsetY),xr.save(),xr.globalAlpha=1,xr.globalCompositeOperation="source-over",xr.setTransform(1,0,0,1,0,0),xr.drawImage(_r.canvas,0,0),xr.restore())}function wr(xr,ir){const _r=n.Util.singularValueDecompose2dScale(xr);_r[0]=Math.fround(_r[0]),_r[1]=Math.fround(_r[1]);const ur=Math.fround((globalThis.devicePixelRatio||1)*Ee.PixelsPerInch.PDF_TO_CSS_UNITS);return ir!==void 0?ir:_r[0]<=ur||_r[1]<=ur}const Fr=["butt","round","square"],Mr=["miter","round","bevel"],Hr={},Nr={};class Ar{constructor(ir,_r,ur,Je,nr,{optionalContentConfig:or,markedContentStack:lr=null},St,dr){this.ctx=ir,this.current=new rr(this.ctx.canvas.width,this.ctx.canvas.height),this.stateStack=[],this.pendingClip=null,this.pendingEOFill=!1,this.res=null,this.xobjs=null,this.commonObjs=_r,this.objs=ur,this.canvasFactory=Je,this.filterFactory=nr,this.groupStack=[],this.processingType3=null,this.baseTransform=null,this.baseTransformStack=[],this.groupLevel=0,this.smaskStack=[],this.smaskCounter=0,this.tempSMask=null,this.suspendedCtx=null,this.contentVisible=!0,this.markedContentStack=lr||[],this.optionalContentConfig=or,this.cachedCanvases=new Ge(this.canvasFactory),this.cachedPatterns=new Map,this.annotationCanvasMap=St,this.viewportScale=1,this.outputScaleX=1,this.outputScaleY=1,this.pageColors=dr,this._cachedScaleForStroking=[-1,0],this._cachedGetSinglePixelWidth=null,this._cachedBitmapsMap=new Map}getObject(ir,_r=null){return typeof ir=="string"?ir.startsWith("g_")?this.commonObjs.get(ir):this.objs.get(ir):_r}beginDrawing({transform:ir,viewport:_r,transparency:ur=!1,background:Je=null}){const nr=this.ctx.canvas.width,or=this.ctx.canvas.height,lr=this.ctx.fillStyle;if(this.ctx.fillStyle=Je||"#ffffff",this.ctx.fillRect(0,0,nr,or),this.ctx.fillStyle=lr,ur){const St=this.cachedCanvases.getCanvas("transparent",nr,or);this.compositeCtx=this.ctx,this.transparentCanvas=St.canvas,this.ctx=St.context,this.ctx.save(),this.ctx.transform(...(0,Ee.getCurrentTransform)(this.compositeCtx))}this.ctx.save(),hr(this.ctx),ir&&(this.ctx.transform(...ir),this.outputScaleX=ir[0],this.outputScaleY=ir[0]),this.ctx.transform(..._r.transform),this.viewportScale=_r.scale,this.baseTransform=(0,Ee.getCurrentTransform)(this.ctx)}executeOperatorList(ir,_r,ur,Je){const nr=ir.argsArray,or=ir.fnArray;let lr=_r||0;const St=nr.length;if(St===lr)return lr;const dr=St-lr>He&&typeof ur=="function",vr=dr?Date.now()+Be:0;let br=0;const kr=this.commonObjs,Pr=this.objs;let Er;for(;;){if(Je!==void 0&&lr===Je.nextBreakPoint)return Je.breakIt(lr,ur),lr;if(Er=or[lr],Er!==n.OPS.dependency)this[Er].apply(this,nr[lr]);else for(const Zr of nr[lr]){const ua=Zr.startsWith("g_")?kr:Pr;if(!ua.has(Zr))return ua.get(Zr,ur),lr}if(lr++,lr===St)return lr;if(dr&&++br>He){if(Date.now()>vr)return ur(),lr;br=0}}}#e(){for(;this.stateStack.length||this.inSMaskMode;)this.restore();this.ctx.restore(),this.transparentCanvas&&(this.ctx=this.compositeCtx,this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.drawImage(this.transparentCanvas,0,0),this.ctx.restore(),this.transparentCanvas=null)}endDrawing(){this.#e(),this.cachedCanvases.clear(),this.cachedPatterns.clear();for(const ir of this._cachedBitmapsMap.values()){for(const _r of ir.values())typeof HTMLCanvasElement<"u"&&_r instanceof HTMLCanvasElement&&(_r.width=_r.height=0);ir.clear()}this._cachedBitmapsMap.clear(),this.#t()}#t(){if(this.pageColors){const ir=this.filterFactory.addHCMFilter(this.pageColors.foreground,this.pageColors.background);if(ir!=="none"){const _r=this.ctx.filter;this.ctx.filter=ir,this.ctx.drawImage(this.ctx.canvas,0,0),this.ctx.filter=_r}}}_scaleImage(ir,_r){const ur=ir.width,Je=ir.height;let nr=Math.max(Math.hypot(_r[0],_r[1]),1),or=Math.max(Math.hypot(_r[2],_r[3]),1),lr=ur,St=Je,dr="prescale1",vr,br;for(;nr>2&&lr>1||or>2&&St>1;){let kr=lr,Pr=St;nr>2&&lr>1&&(kr=lr>=16384?Math.floor(lr/2)-1||1:Math.ceil(lr/2),nr/=lr/kr),or>2&&St>1&&(Pr=St>=16384?Math.floor(St/2)-1||1:Math.ceil(St)/2,or/=St/Pr),vr=this.cachedCanvases.getCanvas(dr,kr,Pr),br=vr.context,br.clearRect(0,0,kr,Pr),br.drawImage(ir,0,0,lr,St,0,0,kr,Pr),ir=vr.canvas,lr=kr,St=Pr,dr=dr==="prescale1"?"prescale2":"prescale1"}return{img:ir,paintWidth:lr,paintHeight:St}}_createMaskCanvas(ir){const _r=this.ctx,{width:ur,height:Je}=ir,nr=this.current.fillColor,or=this.current.patternFill,lr=(0,Ee.getCurrentTransform)(_r);let St,dr,vr,br;if((ir.bitmap||ir.data)&&ir.count>1){const Ca=ir.bitmap||ir.data.buffer;dr=JSON.stringify(or?lr:[lr.slice(0,4),nr]),St=this._cachedBitmapsMap.get(Ca),St||(St=new Map,this._cachedBitmapsMap.set(Ca,St));const za=St.get(dr);if(za&&!or){const Xa=Math.round(Math.min(lr[0],lr[2])+lr[4]),Ya=Math.round(Math.min(lr[1],lr[3])+lr[5]);return{canvas:za,offsetX:Xa,offsetY:Ya}}vr=za}vr||(br=this.cachedCanvases.getCanvas("maskCanvas",ur,Je),sr(br.context,ir));let kr=n.Util.transform(lr,[1/ur,0,0,-1/Je,0,0]);kr=n.Util.transform(kr,[1,0,0,1,0,-Je]);const Pr=n.Util.applyTransform([0,0],kr),Er=n.Util.applyTransform([ur,Je],kr),Zr=n.Util.normalizeRect([Pr[0],Pr[1],Er[0],Er[1]]),ua=Math.round(Zr[2]-Zr[0])||1,Cr=Math.round(Zr[3]-Zr[1])||1,Jr=this.cachedCanvases.getCanvas("fillCanvas",ua,Cr),Qr=Jr.context,oa=Math.min(Pr[0],Er[0]),ta=Math.min(Pr[1],Er[1]);Qr.translate(-oa,-ta),Qr.transform(...kr),vr||(vr=this._scaleImage(br.canvas,(0,Ee.getCurrentTransformInverse)(Qr)),vr=vr.img,St&&or&&St.set(dr,vr)),Qr.imageSmoothingEnabled=wr((0,Ee.getCurrentTransform)(Qr),ir.interpolate),$e(Qr,vr,0,0,vr.width,vr.height,0,0,ur,Je),Qr.globalCompositeOperation="source-in";const Na=n.Util.transform((0,Ee.getCurrentTransformInverse)(Qr),[1,0,0,1,-oa,-ta]);return Qr.fillStyle=or?nr.getPattern(_r,this,Na,Ce.PathType.FILL):nr,Qr.fillRect(0,0,ur,Je),St&&!or&&(this.cachedCanvases.delete("fillCanvas"),St.set(dr,Jr.canvas)),{canvas:Jr.canvas,offsetX:Math.round(oa),offsetY:Math.round(ta)}}setLineWidth(ir){ir!==this.current.lineWidth&&(this._cachedScaleForStroking[0]=-1),this.current.lineWidth=ir,this.ctx.lineWidth=ir}setLineCap(ir){this.ctx.lineCap=Fr[ir]}setLineJoin(ir){this.ctx.lineJoin=Mr[ir]}setMiterLimit(ir){this.ctx.miterLimit=ir}setDash(ir,_r){const ur=this.ctx;ur.setLineDash!==void 0&&(ur.setLineDash(ir),ur.lineDashOffset=_r)}setRenderingIntent(ir){}setFlatness(ir){}setGState(ir){for(const[_r,ur]of ir)switch(_r){case"LW":this.setLineWidth(ur);break;case"LC":this.setLineCap(ur);break;case"LJ":this.setLineJoin(ur);break;case"ML":this.setMiterLimit(ur);break;case"D":this.setDash(ur[0],ur[1]);break;case"RI":this.setRenderingIntent(ur);break;case"FL":this.setFlatness(ur);break;case"Font":this.setFont(ur[0],ur[1]);break;case"CA":this.current.strokeAlpha=ur;break;case"ca":this.current.fillAlpha=ur,this.ctx.globalAlpha=ur;break;case"BM":this.ctx.globalCompositeOperation=ur;break;case"SMask":this.current.activeSMask=ur?this.tempSMask:null,this.tempSMask=null,this.checkSMaskState();break;case"TR":this.ctx.filter=this.current.transferMaps=this.filterFactory.addFilter(ur);break}}get inSMaskMode(){return!!this.suspendedCtx}checkSMaskState(){const ir=this.inSMaskMode;this.current.activeSMask&&!ir?this.beginSMaskMode():!this.current.activeSMask&&ir&&this.endSMaskMode()}beginSMaskMode(){if(this.inSMaskMode)throw new Error("beginSMaskMode called while already in smask mode");const ir=this.ctx.canvas.width,_r=this.ctx.canvas.height,ur="smaskGroupAt"+this.groupLevel,Je=this.cachedCanvases.getCanvas(ur,ir,_r);this.suspendedCtx=this.ctx,this.ctx=Je.context;const nr=this.ctx;nr.setTransform(...(0,Ee.getCurrentTransform)(this.suspendedCtx)),ar(this.suspendedCtx,nr),We(nr,this.suspendedCtx),this.setGState([["BM","source-over"],["ca",1],["CA",1]])}endSMaskMode(){if(!this.inSMaskMode)throw new Error("endSMaskMode called while not in smask mode");this.ctx._removeMirroring(),ar(this.ctx,this.suspendedCtx),this.ctx=this.suspendedCtx,this.suspendedCtx=null}compose(ir){if(!this.current.activeSMask)return;ir?(ir[0]=Math.floor(ir[0]),ir[1]=Math.floor(ir[1]),ir[2]=Math.ceil(ir[2]),ir[3]=Math.ceil(ir[3])):ir=[0,0,this.ctx.canvas.width,this.ctx.canvas.height];const _r=this.current.activeSMask,ur=this.suspendedCtx;mr(ur,_r,this.ctx,ir),this.ctx.save(),this.ctx.setTransform(1,0,0,1,0,0),this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height),this.ctx.restore()}save(){this.inSMaskMode?(ar(this.ctx,this.suspendedCtx),this.suspendedCtx.save()):this.ctx.save();const ir=this.current;this.stateStack.push(ir),this.current=ir.clone()}restore(){this.stateStack.length===0&&this.inSMaskMode&&this.endSMaskMode(),this.stateStack.length!==0&&(this.current=this.stateStack.pop(),this.inSMaskMode?(this.suspendedCtx.restore(),ar(this.suspendedCtx,this.ctx)):this.ctx.restore(),this.checkSMaskState(),this.pendingClip=null,this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null)}transform(ir,_r,ur,Je,nr,or){this.ctx.transform(ir,_r,ur,Je,nr,or),this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null}constructPath(ir,_r,ur){const Je=this.ctx,nr=this.current;let or=nr.x,lr=nr.y,St,dr;const vr=(0,Ee.getCurrentTransform)(Je),br=vr[0]===0&&vr[3]===0||vr[1]===0&&vr[2]===0,kr=br?ur.slice(0):null;for(let Pr=0,Er=0,Zr=ir.length;Pr<Zr;Pr++)switch(ir[Pr]|0){case n.OPS.rectangle:or=_r[Er++],lr=_r[Er++];const ua=_r[Er++],Cr=_r[Er++],Jr=or+ua,Qr=lr+Cr;Je.moveTo(or,lr),ua===0||Cr===0?Je.lineTo(Jr,Qr):(Je.lineTo(Jr,lr),Je.lineTo(Jr,Qr),Je.lineTo(or,Qr)),br||nr.updateRectMinMax(vr,[or,lr,Jr,Qr]),Je.closePath();break;case n.OPS.moveTo:or=_r[Er++],lr=_r[Er++],Je.moveTo(or,lr),br||nr.updatePathMinMax(vr,or,lr);break;case n.OPS.lineTo:or=_r[Er++],lr=_r[Er++],Je.lineTo(or,lr),br||nr.updatePathMinMax(vr,or,lr);break;case n.OPS.curveTo:St=or,dr=lr,or=_r[Er+4],lr=_r[Er+5],Je.bezierCurveTo(_r[Er],_r[Er+1],_r[Er+2],_r[Er+3],or,lr),nr.updateCurvePathMinMax(vr,St,dr,_r[Er],_r[Er+1],_r[Er+2],_r[Er+3],or,lr,kr),Er+=6;break;case n.OPS.curveTo2:St=or,dr=lr,Je.bezierCurveTo(or,lr,_r[Er],_r[Er+1],_r[Er+2],_r[Er+3]),nr.updateCurvePathMinMax(vr,St,dr,or,lr,_r[Er],_r[Er+1],_r[Er+2],_r[Er+3],kr),or=_r[Er+2],lr=_r[Er+3],Er+=4;break;case n.OPS.curveTo3:St=or,dr=lr,or=_r[Er+2],lr=_r[Er+3],Je.bezierCurveTo(_r[Er],_r[Er+1],or,lr,or,lr),nr.updateCurvePathMinMax(vr,St,dr,_r[Er],_r[Er+1],or,lr,or,lr,kr),Er+=4;break;case n.OPS.closePath:Je.closePath();break}br&&nr.updateScalingPathMinMax(vr,kr),nr.setCurrentPoint(or,lr)}closePath(){this.ctx.closePath()}stroke(ir=!0){const _r=this.ctx,ur=this.current.strokeColor;_r.globalAlpha=this.current.strokeAlpha,this.contentVisible&&(typeof ur=="object"&&ur?.getPattern?(_r.save(),_r.strokeStyle=ur.getPattern(_r,this,(0,Ee.getCurrentTransformInverse)(_r),Ce.PathType.STROKE),this.rescaleAndStroke(!1),_r.restore()):this.rescaleAndStroke(!0)),ir&&this.consumePath(this.current.getClippedPathBoundingBox()),_r.globalAlpha=this.current.fillAlpha}closeStroke(){this.closePath(),this.stroke()}fill(ir=!0){const _r=this.ctx,ur=this.current.fillColor,Je=this.current.patternFill;let nr=!1;Je&&(_r.save(),_r.fillStyle=ur.getPattern(_r,this,(0,Ee.getCurrentTransformInverse)(_r),Ce.PathType.FILL),nr=!0);const or=this.current.getClippedPathBoundingBox();this.contentVisible&&or!==null&&(this.pendingEOFill?(_r.fill("evenodd"),this.pendingEOFill=!1):_r.fill()),nr&&_r.restore(),ir&&this.consumePath(or)}eoFill(){this.pendingEOFill=!0,this.fill()}fillStroke(){this.fill(!1),this.stroke(!1),this.consumePath()}eoFillStroke(){this.pendingEOFill=!0,this.fillStroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.pendingEOFill=!0,this.closePath(),this.fillStroke()}endPath(){this.consumePath()}clip(){this.pendingClip=Hr}eoClip(){this.pendingClip=Nr}beginText(){this.current.textMatrix=n.IDENTITY_MATRIX,this.current.textMatrixScale=1,this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}endText(){const ir=this.pendingTextPaths,_r=this.ctx;if(ir===void 0){_r.beginPath();return}_r.save(),_r.beginPath();for(const ur of ir)_r.setTransform(...ur.transform),_r.translate(ur.x,ur.y),ur.addToPath(_r,ur.fontSize);_r.restore(),_r.clip(),_r.beginPath(),delete this.pendingTextPaths}setCharSpacing(ir){this.current.charSpacing=ir}setWordSpacing(ir){this.current.wordSpacing=ir}setHScale(ir){this.current.textHScale=ir/100}setLeading(ir){this.current.leading=-ir}setFont(ir,_r){const ur=this.commonObjs.get(ir),Je=this.current;if(!ur)throw new Error(`Can't find font for ${ir}`);if(Je.fontMatrix=ur.fontMatrix||n.FONT_IDENTITY_MATRIX,(Je.fontMatrix[0]===0||Je.fontMatrix[3]===0)&&(0,n.warn)("Invalid font matrix for font "+ir),_r<0?(_r=-_r,Je.fontDirection=-1):Je.fontDirection=1,this.current.font=ur,this.current.fontSize=_r,ur.isType3Font)return;const nr=ur.loadedName||"sans-serif",or=ur.systemFontInfo?.css||`"${nr}", ${ur.fallbackName}`;let lr="normal";ur.black?lr="900":ur.bold&&(lr="bold");const St=ur.italic?"italic":"normal";let dr=_r;_r<Me?dr=Me:_r>ze&&(dr=ze),this.current.fontSizeScale=_r/dr,this.ctx.font=`${St} ${lr} ${dr}px ${or}`}setTextRenderingMode(ir){this.current.textRenderingMode=ir}setTextRise(ir){this.current.textRise=ir}moveText(ir,_r){this.current.x=this.current.lineX+=ir,this.current.y=this.current.lineY+=_r}setLeadingMoveText(ir,_r){this.setLeading(-_r),this.moveText(ir,_r)}setTextMatrix(ir,_r,ur,Je,nr,or){this.current.textMatrix=[ir,_r,ur,Je,nr,or],this.current.textMatrixScale=Math.hypot(ir,_r),this.current.x=this.current.lineX=0,this.current.y=this.current.lineY=0}nextLine(){this.moveText(0,this.current.leading)}paintChar(ir,_r,ur,Je){const nr=this.ctx,or=this.current,lr=or.font,St=or.textRenderingMode,dr=or.fontSize/or.fontSizeScale,vr=St&n.TextRenderingMode.FILL_STROKE_MASK,br=!!(St&n.TextRenderingMode.ADD_TO_PATH_FLAG),kr=or.patternFill&&!lr.missingFile;let Pr;(lr.disableFontFace||br||kr)&&(Pr=lr.getPathGenerator(this.commonObjs,ir)),lr.disableFontFace||kr?(nr.save(),nr.translate(_r,ur),nr.beginPath(),Pr(nr,dr),Je&&nr.setTransform(...Je),(vr===n.TextRenderingMode.FILL||vr===n.TextRenderingMode.FILL_STROKE)&&nr.fill(),(vr===n.TextRenderingMode.STROKE||vr===n.TextRenderingMode.FILL_STROKE)&&nr.stroke(),nr.restore()):((vr===n.TextRenderingMode.FILL||vr===n.TextRenderingMode.FILL_STROKE)&&nr.fillText(ir,_r,ur),(vr===n.TextRenderingMode.STROKE||vr===n.TextRenderingMode.FILL_STROKE)&&nr.strokeText(ir,_r,ur)),br&&(this.pendingTextPaths||=[]).push({transform:(0,Ee.getCurrentTransform)(nr),x:_r,y:ur,fontSize:dr,addToPath:Pr})}get isFontSubpixelAAEnabled(){const{context:ir}=this.cachedCanvases.getCanvas("isFontSubpixelAAEnabled",10,10);ir.scale(1.5,1),ir.fillText("I",0,10);const _r=ir.getImageData(0,0,10,10).data;let ur=!1;for(let Je=3;Je<_r.length;Je+=4)if(_r[Je]>0&&_r[Je]<255){ur=!0;break}return(0,n.shadow)(this,"isFontSubpixelAAEnabled",ur)}showText(ir){const _r=this.current,ur=_r.font;if(ur.isType3Font)return this.showType3Text(ir);const Je=_r.fontSize;if(Je===0)return;const nr=this.ctx,or=_r.fontSizeScale,lr=_r.charSpacing,St=_r.wordSpacing,dr=_r.fontDirection,vr=_r.textHScale*dr,br=ir.length,kr=ur.vertical,Pr=kr?1:-1,Er=ur.defaultVMetrics,Zr=Je*_r.fontMatrix[0],ua=_r.textRenderingMode===n.TextRenderingMode.FILL&&!ur.disableFontFace&&!_r.patternFill;nr.save(),nr.transform(..._r.textMatrix),nr.translate(_r.x,_r.y+_r.textRise),dr>0?nr.scale(vr,-1):nr.scale(vr,1);let Cr;if(_r.patternFill){nr.save();const Na=_r.fillColor.getPattern(nr,this,(0,Ee.getCurrentTransformInverse)(nr),Ce.PathType.FILL);Cr=(0,Ee.getCurrentTransform)(nr),nr.restore(),nr.fillStyle=Na}let Jr=_r.lineWidth;const Qr=_r.textMatrixScale;if(Qr===0||Jr===0){const Na=_r.textRenderingMode&n.TextRenderingMode.FILL_STROKE_MASK;(Na===n.TextRenderingMode.STROKE||Na===n.TextRenderingMode.FILL_STROKE)&&(Jr=this.getSinglePixelWidth())}else Jr/=Qr;if(or!==1&&(nr.scale(or,or),Jr/=or),nr.lineWidth=Jr,ur.isInvalidPDFjsFont){const Na=[];let Ca=0;for(const za of ir)Na.push(za.unicode),Ca+=za.width;nr.fillText(Na.join(""),0,0),_r.x+=Ca*Zr*vr,nr.restore(),this.compose();return}let oa=0,ta;for(ta=0;ta<br;++ta){const Na=ir[ta];if(typeof Na=="number"){oa+=Pr*Na*Je/1e3;continue}let Ca=!1;const za=(Na.isSpace?St:0)+lr,Xa=Na.fontChar,Ya=Na.accent;let nn,on,yn=Na.width;if(kr){const Qa=Na.vmetric||Er,Ka=-(Na.vmetric?Qa[1]:yn*.5)*Zr,en=Qa[2]*Zr;yn=Qa?-Qa[0]:yn,nn=Ka/or,on=(oa+en)/or}else nn=oa/or,on=0;if(ur.remeasure&&yn>0){const Qa=nr.measureText(Xa).width*1e3/Je*or;if(yn<Qa&&this.isFontSubpixelAAEnabled){const Ka=yn/Qa;Ca=!0,nr.save(),nr.scale(Ka,1),nn/=Ka}else yn!==Qa&&(nn+=(yn-Qa)/2e3*Je/or)}if(this.contentVisible&&(Na.isInFont||ur.missingFile)){if(ua&&!Ya)nr.fillText(Xa,nn,on);else if(this.paintChar(Xa,nn,on,Cr),Ya){const Qa=nn+Je*Ya.offset.x/or,Ka=on-Je*Ya.offset.y/or;this.paintChar(Ya.fontChar,Qa,Ka,Cr)}}const fn=kr?yn*Zr-za*dr:yn*Zr+za*dr;oa+=fn,Ca&&nr.restore()}kr?_r.y-=oa:_r.x+=oa*vr,nr.restore(),this.compose()}showType3Text(ir){const _r=this.ctx,ur=this.current,Je=ur.font,nr=ur.fontSize,or=ur.fontDirection,lr=Je.vertical?1:-1,St=ur.charSpacing,dr=ur.wordSpacing,vr=ur.textHScale*or,br=ur.fontMatrix||n.FONT_IDENTITY_MATRIX,kr=ir.length,Pr=ur.textRenderingMode===n.TextRenderingMode.INVISIBLE;let Er,Zr,ua,Cr;if(!(Pr||nr===0)){for(this._cachedScaleForStroking[0]=-1,this._cachedGetSinglePixelWidth=null,_r.save(),_r.transform(...ur.textMatrix),_r.translate(ur.x,ur.y),_r.scale(vr,or),Er=0;Er<kr;++Er){if(Zr=ir[Er],typeof Zr=="number"){Cr=lr*Zr*nr/1e3,this.ctx.translate(Cr,0),ur.x+=Cr*vr;continue}const Jr=(Zr.isSpace?dr:0)+St,Qr=Je.charProcOperatorList[Zr.operatorListId];if(!Qr){(0,n.warn)(`Type3 character "${Zr.operatorListId}" is not available.`);continue}this.contentVisible&&(this.processingType3=Zr,this.save(),_r.scale(nr,nr),_r.transform(...br),this.executeOperatorList(Qr),this.restore()),ua=n.Util.applyTransform([Zr.width,0],br)[0]*nr+Jr,_r.translate(ua,0),ur.x+=ua*vr}_r.restore(),this.processingType3=null}}setCharWidth(ir,_r){}setCharWidthAndBounds(ir,_r,ur,Je,nr,or){this.ctx.rect(ur,Je,nr-ur,or-Je),this.ctx.clip(),this.endPath()}getColorN_Pattern(ir){let _r;if(ir[0]==="TilingPattern"){const ur=ir[1],Je=this.baseTransform||(0,Ee.getCurrentTransform)(this.ctx),nr={createCanvasGraphics:or=>new Ar(or,this.commonObjs,this.objs,this.canvasFactory,this.filterFactory,{optionalContentConfig:this.optionalContentConfig,markedContentStack:this.markedContentStack})};_r=new Ce.TilingPattern(ir,ur,this.ctx,nr,Je)}else _r=this._getPattern(ir[1],ir[2]);return _r}setStrokeColorN(){this.current.strokeColor=this.getColorN_Pattern(arguments)}setFillColorN(){this.current.fillColor=this.getColorN_Pattern(arguments),this.current.patternFill=!0}setStrokeRGBColor(ir,_r,ur){const Je=n.Util.makeHexColor(ir,_r,ur);this.ctx.strokeStyle=Je,this.current.strokeColor=Je}setFillRGBColor(ir,_r,ur){const Je=n.Util.makeHexColor(ir,_r,ur);this.ctx.fillStyle=Je,this.current.fillColor=Je,this.current.patternFill=!1}_getPattern(ir,_r=null){let ur;return this.cachedPatterns.has(ir)?ur=this.cachedPatterns.get(ir):(ur=(0,Ce.getShadingPattern)(this.getObject(ir)),this.cachedPatterns.set(ir,ur)),_r&&(ur.matrix=_r),ur}shadingFill(ir){if(!this.contentVisible)return;const _r=this.ctx;this.save();const ur=this._getPattern(ir);_r.fillStyle=ur.getPattern(_r,this,(0,Ee.getCurrentTransformInverse)(_r),Ce.PathType.SHADING);const Je=(0,Ee.getCurrentTransformInverse)(_r);if(Je){const{width:nr,height:or}=_r.canvas,[lr,St,dr,vr]=n.Util.getAxialAlignedBoundingBox([0,0,nr,or],Je);this.ctx.fillRect(lr,St,dr-lr,vr-St)}else this.ctx.fillRect(-1e10,-1e10,2e10,2e10);this.compose(this.current.getClippedPathBoundingBox()),this.restore()}beginInlineImage(){(0,n.unreachable)("Should not call beginInlineImage")}beginImageData(){(0,n.unreachable)("Should not call beginImageData")}paintFormXObjectBegin(ir,_r){if(this.contentVisible&&(this.save(),this.baseTransformStack.push(this.baseTransform),Array.isArray(ir)&&ir.length===6&&this.transform(...ir),this.baseTransform=(0,Ee.getCurrentTransform)(this.ctx),_r)){const ur=_r[2]-_r[0],Je=_r[3]-_r[1];this.ctx.rect(_r[0],_r[1],ur,Je),this.current.updateRectMinMax((0,Ee.getCurrentTransform)(this.ctx),_r),this.clip(),this.endPath()}}paintFormXObjectEnd(){this.contentVisible&&(this.restore(),this.baseTransform=this.baseTransformStack.pop())}beginGroup(ir){if(!this.contentVisible)return;this.save(),this.inSMaskMode&&(this.endSMaskMode(),this.current.activeSMask=null);const _r=this.ctx;ir.isolated||(0,n.info)("TODO: Support non-isolated groups."),ir.knockout&&(0,n.warn)("Knockout groups not supported.");const ur=(0,Ee.getCurrentTransform)(_r);if(ir.matrix&&_r.transform(...ir.matrix),!ir.bbox)throw new Error("Bounding box is required.");let Je=n.Util.getAxialAlignedBoundingBox(ir.bbox,(0,Ee.getCurrentTransform)(_r));const nr=[0,0,_r.canvas.width,_r.canvas.height];Je=n.Util.intersect(Je,nr)||[0,0,0,0];const or=Math.floor(Je[0]),lr=Math.floor(Je[1]);let St=Math.max(Math.ceil(Je[2])-or,1),dr=Math.max(Math.ceil(Je[3])-lr,1),vr=1,br=1;St>Oe&&(vr=St/Oe,St=Oe),dr>Oe&&(br=dr/Oe,dr=Oe),this.current.startNewPathAndClipBox([0,0,St,dr]);let kr="groupAt"+this.groupLevel;ir.smask&&(kr+="_smask_"+this.smaskCounter++%2);const Pr=this.cachedCanvases.getCanvas(kr,St,dr),Er=Pr.context;Er.scale(1/vr,1/br),Er.translate(-or,-lr),Er.transform(...ur),ir.smask?this.smaskStack.push({canvas:Pr.canvas,context:Er,offsetX:or,offsetY:lr,scaleX:vr,scaleY:br,subtype:ir.smask.subtype,backdrop:ir.smask.backdrop,transferMap:ir.smask.transferMap||null,startTransformInverse:null}):(_r.setTransform(1,0,0,1,0,0),_r.translate(or,lr),_r.scale(vr,br),_r.save()),ar(_r,Er),this.ctx=Er,this.setGState([["BM","source-over"],["ca",1],["CA",1]]),this.groupStack.push(_r),this.groupLevel++}endGroup(ir){if(!this.contentVisible)return;this.groupLevel--;const _r=this.ctx,ur=this.groupStack.pop();if(this.ctx=ur,this.ctx.imageSmoothingEnabled=!1,ir.smask)this.tempSMask=this.smaskStack.pop(),this.restore();else{this.ctx.restore();const Je=(0,Ee.getCurrentTransform)(this.ctx);this.restore(),this.ctx.save(),this.ctx.setTransform(...Je);const nr=n.Util.getAxialAlignedBoundingBox([0,0,_r.canvas.width,_r.canvas.height],Je);this.ctx.drawImage(_r.canvas,0,0),this.ctx.restore(),this.compose(nr)}}beginAnnotation(ir,_r,ur,Je,nr){if(this.#e(),hr(this.ctx),this.ctx.save(),this.save(),this.baseTransform&&this.ctx.setTransform(...this.baseTransform),Array.isArray(_r)&&_r.length===4){const or=_r[2]-_r[0],lr=_r[3]-_r[1];if(nr&&this.annotationCanvasMap){ur=ur.slice(),ur[4]-=_r[0],ur[5]-=_r[1],_r=_r.slice(),_r[0]=_r[1]=0,_r[2]=or,_r[3]=lr;const[St,dr]=n.Util.singularValueDecompose2dScale((0,Ee.getCurrentTransform)(this.ctx)),{viewportScale:vr}=this,br=Math.ceil(or*this.outputScaleX*vr),kr=Math.ceil(lr*this.outputScaleY*vr);this.annotationCanvas=this.canvasFactory.create(br,kr);const{canvas:Pr,context:Er}=this.annotationCanvas;this.annotationCanvasMap.set(ir,Pr),this.annotationCanvas.savedCtx=this.ctx,this.ctx=Er,this.ctx.save(),this.ctx.setTransform(St,0,0,-dr,0,lr*dr),hr(this.ctx)}else hr(this.ctx),this.ctx.rect(_r[0],_r[1],or,lr),this.ctx.clip(),this.endPath()}this.current=new rr(this.ctx.canvas.width,this.ctx.canvas.height),this.transform(...ur),this.transform(...Je)}endAnnotation(){this.annotationCanvas&&(this.ctx.restore(),this.#t(),this.ctx=this.annotationCanvas.savedCtx,delete this.annotationCanvas.savedCtx,delete this.annotationCanvas)}paintImageMaskXObject(ir){if(!this.contentVisible)return;const _r=ir.count;ir=this.getObject(ir.data,ir),ir.count=_r;const ur=this.ctx,Je=this.processingType3;if(Je&&(Je.compiled===void 0&&(Je.compiled=Ke(ir)),Je.compiled)){Je.compiled(ur);return}const nr=this._createMaskCanvas(ir),or=nr.canvas;ur.save(),ur.setTransform(1,0,0,1,0,0),ur.drawImage(or,nr.offsetX,nr.offsetY),ur.restore(),this.compose()}paintImageMaskXObjectRepeat(ir,_r,ur=0,Je=0,nr,or){if(!this.contentVisible)return;ir=this.getObject(ir.data,ir);const lr=this.ctx;lr.save();const St=(0,Ee.getCurrentTransform)(lr);lr.transform(_r,ur,Je,nr,0,0);const dr=this._createMaskCanvas(ir);lr.setTransform(1,0,0,1,dr.offsetX-St[4],dr.offsetY-St[5]);for(let vr=0,br=or.length;vr<br;vr+=2){const kr=n.Util.transform(St,[_r,ur,Je,nr,or[vr],or[vr+1]]),[Pr,Er]=n.Util.applyTransform([0,0],kr);lr.drawImage(dr.canvas,Pr,Er)}lr.restore(),this.compose()}paintImageMaskXObjectGroup(ir){if(!this.contentVisible)return;const _r=this.ctx,ur=this.current.fillColor,Je=this.current.patternFill;for(const nr of ir){const{data:or,width:lr,height:St,transform:dr}=nr,vr=this.cachedCanvases.getCanvas("maskCanvas",lr,St),br=vr.context;br.save();const kr=this.getObject(or,nr);sr(br,kr),br.globalCompositeOperation="source-in",br.fillStyle=Je?ur.getPattern(br,this,(0,Ee.getCurrentTransformInverse)(_r),Ce.PathType.FILL):ur,br.fillRect(0,0,lr,St),br.restore(),_r.save(),_r.transform(...dr),_r.scale(1,-1),$e(_r,vr.canvas,0,0,lr,St,0,-1,1,1),_r.restore()}this.compose()}paintImageXObject(ir){if(!this.contentVisible)return;const _r=this.getObject(ir);if(!_r){(0,n.warn)("Dependent image isn't ready yet");return}this.paintInlineImageXObject(_r)}paintImageXObjectRepeat(ir,_r,ur,Je){if(!this.contentVisible)return;const nr=this.getObject(ir);if(!nr){(0,n.warn)("Dependent image isn't ready yet");return}const or=nr.width,lr=nr.height,St=[];for(let dr=0,vr=Je.length;dr<vr;dr+=2)St.push({transform:[_r,0,0,ur,Je[dr],Je[dr+1]],x:0,y:0,w:or,h:lr});this.paintInlineImageXObjectGroup(nr,St)}applyTransferMapsToCanvas(ir){return this.current.transferMaps!=="none"&&(ir.filter=this.current.transferMaps,ir.drawImage(ir.canvas,0,0),ir.filter="none"),ir.canvas}applyTransferMapsToBitmap(ir){if(this.current.transferMaps==="none")return ir.bitmap;const{bitmap:_r,width:ur,height:Je}=ir,nr=this.cachedCanvases.getCanvas("inlineImage",ur,Je),or=nr.context;return or.filter=this.current.transferMaps,or.drawImage(_r,0,0),or.filter="none",nr.canvas}paintInlineImageXObject(ir){if(!this.contentVisible)return;const _r=ir.width,ur=ir.height,Je=this.ctx;if(this.save(),!n.isNodeJS){const{filter:lr}=Je;lr!=="none"&&lr!==""&&(Je.filter="none")}Je.scale(1/_r,-1/ur);let nr;if(ir.bitmap)nr=this.applyTransferMapsToBitmap(ir);else if(typeof HTMLElement=="function"&&ir instanceof HTMLElement||!ir.data)nr=ir;else{const St=this.cachedCanvases.getCanvas("inlineImage",_r,ur).context;tr(St,ir),nr=this.applyTransferMapsToCanvas(St)}const or=this._scaleImage(nr,(0,Ee.getCurrentTransformInverse)(Je));Je.imageSmoothingEnabled=wr((0,Ee.getCurrentTransform)(Je),ir.interpolate),$e(Je,or.img,0,0,or.paintWidth,or.paintHeight,0,-ur,_r,ur),this.compose(),this.restore()}paintInlineImageXObjectGroup(ir,_r){if(!this.contentVisible)return;const ur=this.ctx;let Je;if(ir.bitmap)Je=ir.bitmap;else{const nr=ir.width,or=ir.height,St=this.cachedCanvases.getCanvas("inlineImage",nr,or).context;tr(St,ir),Je=this.applyTransferMapsToCanvas(St)}for(const nr of _r)ur.save(),ur.transform(...nr.transform),ur.scale(1,-1),$e(ur,Je,nr.x,nr.y,nr.w,nr.h,0,-1,1,1),ur.restore();this.compose()}paintSolidColorImageMask(){this.contentVisible&&(this.ctx.fillRect(0,0,1,1),this.compose())}markPoint(ir){}markPointProps(ir,_r){}beginMarkedContent(ir){this.markedContentStack.push({visible:!0})}beginMarkedContentProps(ir,_r){ir==="OC"?this.markedContentStack.push({visible:this.optionalContentConfig.isVisible(_r)}):this.markedContentStack.push({visible:!0}),this.contentVisible=this.isContentVisible()}endMarkedContent(){this.markedContentStack.pop(),this.contentVisible=this.isContentVisible()}beginCompat(){}endCompat(){}consumePath(ir){const _r=this.current.isEmptyClip();this.pendingClip&&this.current.updateClipFromPath(),this.pendingClip||this.compose(ir);const ur=this.ctx;this.pendingClip&&(_r||(this.pendingClip===Nr?ur.clip("evenodd"):ur.clip()),this.pendingClip=null),this.current.startNewPathAndClipBox(this.current.clipBox),ur.beginPath()}getSinglePixelWidth(){if(!this._cachedGetSinglePixelWidth){const ir=(0,Ee.getCurrentTransform)(this.ctx);if(ir[1]===0&&ir[2]===0)this._cachedGetSinglePixelWidth=1/Math.min(Math.abs(ir[0]),Math.abs(ir[3]));else{const _r=Math.abs(ir[0]*ir[3]-ir[2]*ir[1]),ur=Math.hypot(ir[0],ir[2]),Je=Math.hypot(ir[1],ir[3]);this._cachedGetSinglePixelWidth=Math.max(ur,Je)/_r}}return this._cachedGetSinglePixelWidth}getScaleForStroking(){if(this._cachedScaleForStroking[0]===-1){const{lineWidth:ir}=this.current,{a:_r,b:ur,c:Je,d:nr}=this.ctx.getTransform();let or,lr;if(ur===0&&Je===0){const St=Math.abs(_r),dr=Math.abs(nr);if(St===dr)if(ir===0)or=lr=1/St;else{const vr=St*ir;or=lr=vr<1?1/vr:1}else if(ir===0)or=1/St,lr=1/dr;else{const vr=St*ir,br=dr*ir;or=vr<1?1/vr:1,lr=br<1?1/br:1}}else{const St=Math.abs(_r*nr-ur*Je),dr=Math.hypot(_r,ur),vr=Math.hypot(Je,nr);if(ir===0)or=vr/St,lr=dr/St;else{const br=ir*St;or=vr>br?vr/br:1,lr=dr>br?dr/br:1}}this._cachedScaleForStroking[0]=or,this._cachedScaleForStroking[1]=lr}return this._cachedScaleForStroking}rescaleAndStroke(ir){const{ctx:_r}=this,{lineWidth:ur}=this.current,[Je,nr]=this.getScaleForStroking();if(_r.lineWidth=ur||1,Je===1&&nr===1){_r.stroke();return}const or=_r.getLineDash();if(ir&&_r.save(),_r.scale(Je,nr),or.length>0){const lr=Math.max(Je,nr);_r.setLineDash(or.map(St=>St/lr)),_r.lineDashOffset/=lr}_r.stroke(),ir&&_r.restore()}isContentVisible(){for(let ir=this.markedContentStack.length-1;ir>=0;ir--)if(!this.markedContentStack[ir].visible)return!1;return!0}}t.CanvasGraphics=Ar;for(const xr in n.OPS)Ar.prototype[xr]!==void 0&&(Ar.prototype[n.OPS[xr]]=Ar.prototype[xr])}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TilingPattern=t.PathType=void 0,t.getShadingPattern=Xe;var n=r(1),Ee=r(6);const Ce={FILL:"Fill",STROKE:"Stroke",SHADING:"Shading"};t.PathType=Ce;function De($e,Ke){if(!Ke)return;const rr=Ke[2]-Ke[0],tr=Ke[3]-Ke[1],sr=new Path2D;sr.rect(Ke[0],Ke[1],rr,tr),$e.clip(sr)}class Me{constructor(){this.constructor===Me&&(0,n.unreachable)("Cannot initialize BaseShadingPattern.")}getPattern(){(0,n.unreachable)("Abstract method `getPattern` called.")}}class ze extends Me{constructor(Ke){super(),this._type=Ke[1],this._bbox=Ke[2],this._colorStops=Ke[3],this._p0=Ke[4],this._p1=Ke[5],this._r0=Ke[6],this._r1=Ke[7],this.matrix=null}_createGradient(Ke){let rr;this._type==="axial"?rr=Ke.createLinearGradient(this._p0[0],this._p0[1],this._p1[0],this._p1[1]):this._type==="radial"&&(rr=Ke.createRadialGradient(this._p0[0],this._p0[1],this._r0,this._p1[0],this._p1[1],this._r1));for(const tr of this._colorStops)rr.addColorStop(tr[0],tr[1]);return rr}getPattern(Ke,rr,tr,sr){let ar;if(sr===Ce.STROKE||sr===Ce.FILL){const hr=rr.current.getClippedPathBoundingBox(sr,(0,Ee.getCurrentTransform)(Ke))||[0,0,0,0],pr=Math.ceil(hr[2]-hr[0])||1,yr=Math.ceil(hr[3]-hr[1])||1,fr=rr.cachedCanvases.getCanvas("pattern",pr,yr,!0),Rr=fr.context;Rr.clearRect(0,0,Rr.canvas.width,Rr.canvas.height),Rr.beginPath(),Rr.rect(0,0,Rr.canvas.width,Rr.canvas.height),Rr.translate(-hr[0],-hr[1]),tr=n.Util.transform(tr,[1,0,0,1,hr[0],hr[1]]),Rr.transform(...rr.baseTransform),this.matrix&&Rr.transform(...this.matrix),De(Rr,this._bbox),Rr.fillStyle=this._createGradient(Rr),Rr.fill(),ar=Ke.createPattern(fr.canvas,"no-repeat");const mr=new DOMMatrix(tr);ar.setTransform(mr)}else De(Ke,this._bbox),ar=this._createGradient(Ke);return ar}}function Oe($e,Ke,rr,tr,sr,ar,hr,pr){const yr=Ke.coords,fr=Ke.colors,Rr=$e.data,mr=$e.width*4;let wr;yr[rr+1]>yr[tr+1]&&(wr=rr,rr=tr,tr=wr,wr=ar,ar=hr,hr=wr),yr[tr+1]>yr[sr+1]&&(wr=tr,tr=sr,sr=wr,wr=hr,hr=pr,pr=wr),yr[rr+1]>yr[tr+1]&&(wr=rr,rr=tr,tr=wr,wr=ar,ar=hr,hr=wr);const Fr=(yr[rr]+Ke.offsetX)*Ke.scaleX,Mr=(yr[rr+1]+Ke.offsetY)*Ke.scaleY,Hr=(yr[tr]+Ke.offsetX)*Ke.scaleX,Nr=(yr[tr+1]+Ke.offsetY)*Ke.scaleY,Ar=(yr[sr]+Ke.offsetX)*Ke.scaleX,xr=(yr[sr+1]+Ke.offsetY)*Ke.scaleY;if(Mr>=xr)return;const ir=fr[ar],_r=fr[ar+1],ur=fr[ar+2],Je=fr[hr],nr=fr[hr+1],or=fr[hr+2],lr=fr[pr],St=fr[pr+1],dr=fr[pr+2],vr=Math.round(Mr),br=Math.round(xr);let kr,Pr,Er,Zr,ua,Cr,Jr,Qr;for(let oa=vr;oa<=br;oa++){if(oa<Nr){const Xa=oa<Mr?0:(Mr-oa)/(Mr-Nr);kr=Fr-(Fr-Hr)*Xa,Pr=ir-(ir-Je)*Xa,Er=_r-(_r-nr)*Xa,Zr=ur-(ur-or)*Xa}else{let Xa;oa>xr?Xa=1:Nr===xr?Xa=0:Xa=(Nr-oa)/(Nr-xr),kr=Hr-(Hr-Ar)*Xa,Pr=Je-(Je-lr)*Xa,Er=nr-(nr-St)*Xa,Zr=or-(or-dr)*Xa}let ta;oa<Mr?ta=0:oa>xr?ta=1:ta=(Mr-oa)/(Mr-xr),ua=Fr-(Fr-Ar)*ta,Cr=ir-(ir-lr)*ta,Jr=_r-(_r-St)*ta,Qr=ur-(ur-dr)*ta;const Na=Math.round(Math.min(kr,ua)),Ca=Math.round(Math.max(kr,ua));let za=mr*oa+Na*4;for(let Xa=Na;Xa<=Ca;Xa++)ta=(kr-Xa)/(kr-ua),ta<0?ta=0:ta>1&&(ta=1),Rr[za++]=Pr-(Pr-Cr)*ta|0,Rr[za++]=Er-(Er-Jr)*ta|0,Rr[za++]=Zr-(Zr-Qr)*ta|0,Rr[za++]=255}}function Be($e,Ke,rr){const tr=Ke.coords,sr=Ke.colors;let ar,hr;switch(Ke.type){case"lattice":const pr=Ke.verticesPerRow,yr=Math.floor(tr.length/pr)-1,fr=pr-1;for(ar=0;ar<yr;ar++){let Rr=ar*pr;for(let mr=0;mr<fr;mr++,Rr++)Oe($e,rr,tr[Rr],tr[Rr+1],tr[Rr+pr],sr[Rr],sr[Rr+1],sr[Rr+pr]),Oe($e,rr,tr[Rr+pr+1],tr[Rr+1],tr[Rr+pr],sr[Rr+pr+1],sr[Rr+1],sr[Rr+pr])}break;case"triangles":for(ar=0,hr=tr.length;ar<hr;ar+=3)Oe($e,rr,tr[ar],tr[ar+1],tr[ar+2],sr[ar],sr[ar+1],sr[ar+2]);break;default:throw new Error("illegal figure")}}class He extends Me{constructor(Ke){super(),this._coords=Ke[2],this._colors=Ke[3],this._figures=Ke[4],this._bounds=Ke[5],this._bbox=Ke[7],this._background=Ke[8],this.matrix=null}_createMeshCanvas(Ke,rr,tr){const pr=Math.floor(this._bounds[0]),yr=Math.floor(this._bounds[1]),fr=Math.ceil(this._bounds[2])-pr,Rr=Math.ceil(this._bounds[3])-yr,mr=Math.min(Math.ceil(Math.abs(fr*Ke[0]*1.1)),3e3),wr=Math.min(Math.ceil(Math.abs(Rr*Ke[1]*1.1)),3e3),Fr=fr/mr,Mr=Rr/wr,Hr={coords:this._coords,colors:this._colors,offsetX:-pr,offsetY:-yr,scaleX:1/Fr,scaleY:1/Mr},Nr=mr+4,Ar=wr+4,xr=tr.getCanvas("mesh",Nr,Ar,!1),ir=xr.context,_r=ir.createImageData(mr,wr);if(rr){const Je=_r.data;for(let nr=0,or=Je.length;nr<or;nr+=4)Je[nr]=rr[0],Je[nr+1]=rr[1],Je[nr+2]=rr[2],Je[nr+3]=255}for(const Je of this._figures)Be(_r,Je,Hr);return ir.putImageData(_r,2,2),{canvas:xr.canvas,offsetX:pr-2*Fr,offsetY:yr-2*Mr,scaleX:Fr,scaleY:Mr}}getPattern(Ke,rr,tr,sr){De(Ke,this._bbox);let ar;if(sr===Ce.SHADING)ar=n.Util.singularValueDecompose2dScale((0,Ee.getCurrentTransform)(Ke));else if(ar=n.Util.singularValueDecompose2dScale(rr.baseTransform),this.matrix){const pr=n.Util.singularValueDecompose2dScale(this.matrix);ar=[ar[0]*pr[0],ar[1]*pr[1]]}const hr=this._createMeshCanvas(ar,sr===Ce.SHADING?null:this._background,rr.cachedCanvases);return sr!==Ce.SHADING&&(Ke.setTransform(...rr.baseTransform),this.matrix&&Ke.transform(...this.matrix)),Ke.translate(hr.offsetX,hr.offsetY),Ke.scale(hr.scaleX,hr.scaleY),Ke.createPattern(hr.canvas,"no-repeat")}}class Ve extends Me{getPattern(){return"hotpink"}}function Xe($e){switch($e[0]){case"RadialAxial":return new ze($e);case"Mesh":return new He($e);case"Dummy":return new Ve}throw new Error(`Unknown IR type: ${$e[0]}`)}const We={COLORED:1,UNCOLORED:2};class Ge{static MAX_PATTERN_SIZE=3e3;constructor(Ke,rr,tr,sr,ar){this.operatorList=Ke[2],this.matrix=Ke[3]||[1,0,0,1,0,0],this.bbox=Ke[4],this.xstep=Ke[5],this.ystep=Ke[6],this.paintType=Ke[7],this.tilingType=Ke[8],this.color=rr,this.ctx=tr,this.canvasGraphicsFactory=sr,this.baseTransform=ar}createPatternCanvas(Ke){const rr=this.operatorList,tr=this.bbox,sr=this.xstep,ar=this.ystep,hr=this.paintType,pr=this.tilingType,yr=this.color,fr=this.canvasGraphicsFactory;(0,n.info)("TilingType: "+pr);const Rr=tr[0],mr=tr[1],wr=tr[2],Fr=tr[3],Mr=n.Util.singularValueDecompose2dScale(this.matrix),Hr=n.Util.singularValueDecompose2dScale(this.baseTransform),Nr=[Mr[0]*Hr[0],Mr[1]*Hr[1]],Ar=this.getSizeAndScale(sr,this.ctx.canvas.width,Nr[0]),xr=this.getSizeAndScale(ar,this.ctx.canvas.height,Nr[1]),ir=Ke.cachedCanvases.getCanvas("pattern",Ar.size,xr.size,!0),_r=ir.context,ur=fr.createCanvasGraphics(_r);ur.groupLevel=Ke.groupLevel,this.setFillAndStrokeStyleToContext(ur,hr,yr);let Je=Rr,nr=mr,or=wr,lr=Fr;return Rr<0&&(Je=0,or+=Math.abs(Rr)),mr<0&&(nr=0,lr+=Math.abs(mr)),_r.translate(-(Ar.scale*Je),-(xr.scale*nr)),ur.transform(Ar.scale,0,0,xr.scale,0,0),_r.save(),this.clipBbox(ur,Je,nr,or,lr),ur.baseTransform=(0,Ee.getCurrentTransform)(ur.ctx),ur.executeOperatorList(rr),ur.endDrawing(),{canvas:ir.canvas,scaleX:Ar.scale,scaleY:xr.scale,offsetX:Je,offsetY:nr}}getSizeAndScale(Ke,rr,tr){Ke=Math.abs(Ke);const sr=Math.max(Ge.MAX_PATTERN_SIZE,rr);let ar=Math.ceil(Ke*tr);return ar>=sr?ar=sr:tr=ar/Ke,{scale:tr,size:ar}}clipBbox(Ke,rr,tr,sr,ar){const hr=sr-rr,pr=ar-tr;Ke.ctx.rect(rr,tr,hr,pr),Ke.current.updateRectMinMax((0,Ee.getCurrentTransform)(Ke.ctx),[rr,tr,sr,ar]),Ke.clip(),Ke.endPath()}setFillAndStrokeStyleToContext(Ke,rr,tr){const sr=Ke.ctx,ar=Ke.current;switch(rr){case We.COLORED:const hr=this.ctx;sr.fillStyle=hr.fillStyle,sr.strokeStyle=hr.strokeStyle,ar.fillColor=hr.fillStyle,ar.strokeColor=hr.strokeStyle;break;case We.UNCOLORED:const pr=n.Util.makeHexColor(tr[0],tr[1],tr[2]);sr.fillStyle=pr,sr.strokeStyle=pr,ar.fillColor=pr,ar.strokeColor=pr;break;default:throw new n.FormatError(`Unsupported paint type: ${rr}`)}}getPattern(Ke,rr,tr,sr){let ar=tr;sr!==Ce.SHADING&&(ar=n.Util.transform(ar,rr.baseTransform),this.matrix&&(ar=n.Util.transform(ar,this.matrix)));const hr=this.createPatternCanvas(rr);let pr=new DOMMatrix(ar);pr=pr.translate(hr.offsetX,hr.offsetY),pr=pr.scale(1/hr.scaleX,1/hr.scaleY);const yr=Ke.createPattern(hr.canvas,"repeat");return yr.setTransform(pr),yr}}t.TilingPattern=Ge}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertBlackAndWhiteToRGBA=Ce,t.convertToRGBA=Ee,t.grayToRGBA=Me;var n=r(1);function Ee(ze){switch(ze.kind){case n.ImageKind.GRAYSCALE_1BPP:return Ce(ze);case n.ImageKind.RGB_24BPP:return De(ze)}return null}function Ce({src:ze,srcPos:Oe=0,dest:Be,width:He,height:Ve,nonBlackColor:Xe=4294967295,inverseDecode:We=!1}){const Ge=n.FeatureTest.isLittleEndian?4278190080:255,[$e,Ke]=We?[Xe,Ge]:[Ge,Xe],rr=He>>3,tr=He&7,sr=ze.length;Be=new Uint32Array(Be.buffer);let ar=0;for(let hr=0;hr<Ve;hr++){for(const yr=Oe+rr;Oe<yr;Oe++){const fr=Oe<sr?ze[Oe]:255;Be[ar++]=fr&128?Ke:$e,Be[ar++]=fr&64?Ke:$e,Be[ar++]=fr&32?Ke:$e,Be[ar++]=fr&16?Ke:$e,Be[ar++]=fr&8?Ke:$e,Be[ar++]=fr&4?Ke:$e,Be[ar++]=fr&2?Ke:$e,Be[ar++]=fr&1?Ke:$e}if(tr===0)continue;const pr=Oe<sr?ze[Oe++]:255;for(let yr=0;yr<tr;yr++)Be[ar++]=pr&1<<7-yr?Ke:$e}return{srcPos:Oe,destPos:ar}}function De({src:ze,srcPos:Oe=0,dest:Be,destPos:He=0,width:Ve,height:Xe}){let We=0;const Ge=ze.length>>2,$e=new Uint32Array(ze.buffer,Oe,Ge);if(n.FeatureTest.isLittleEndian){for(;We<Ge-2;We+=3,He+=4){const Ke=$e[We],rr=$e[We+1],tr=$e[We+2];Be[He]=Ke|4278190080,Be[He+1]=Ke>>>24|rr<<8|4278190080,Be[He+2]=rr>>>16|tr<<16|4278190080,Be[He+3]=tr>>>8|4278190080}for(let Ke=We*4,rr=ze.length;Ke<rr;Ke+=3)Be[He++]=ze[Ke]|ze[Ke+1]<<8|ze[Ke+2]<<16|4278190080}else{for(;We<Ge-2;We+=3,He+=4){const Ke=$e[We],rr=$e[We+1],tr=$e[We+2];Be[He]=Ke|255,Be[He+1]=Ke<<24|rr>>>8|255,Be[He+2]=rr<<16|tr>>>16|255,Be[He+3]=tr<<8|255}for(let Ke=We*4,rr=ze.length;Ke<rr;Ke+=3)Be[He++]=ze[Ke]<<24|ze[Ke+1]<<16|ze[Ke+2]<<8|255}return{srcPos:Oe,destPos:He}}function Me(ze,Oe){if(n.FeatureTest.isLittleEndian)for(let Be=0,He=ze.length;Be<He;Be++)Oe[Be]=ze[Be]*65793|4278190080;else for(let Be=0,He=ze.length;Be<He;Be++)Oe[Be]=ze[Be]*16843008|255}}),((e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalWorkerOptions=void 0;const r=Object.create(null);t.GlobalWorkerOptions=r,r.workerPort=null,r.workerSrc=""}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MessageHandler=void 0;var n=r(1);const Ee={DATA:1,ERROR:2},Ce={CANCEL:1,CANCEL_COMPLETE:2,CLOSE:3,ENQUEUE:4,ERROR:5,PULL:6,PULL_COMPLETE:7,START_COMPLETE:8};function De(ze){switch(ze instanceof Error||typeof ze=="object"&&ze!==null||(0,n.unreachable)('wrapReason: Expected "reason" to be a (possibly cloned) Error.'),ze.name){case"AbortException":return new n.AbortException(ze.message);case"MissingPDFException":return new n.MissingPDFException(ze.message);case"PasswordException":return new n.PasswordException(ze.message,ze.code);case"UnexpectedResponseException":return new n.UnexpectedResponseException(ze.message,ze.status);case"UnknownErrorException":return new n.UnknownErrorException(ze.message,ze.details);default:return new n.UnknownErrorException(ze.message,ze.toString())}}class Me{constructor(Oe,Be,He){this.sourceName=Oe,this.targetName=Be,this.comObj=He,this.callbackId=1,this.streamId=1,this.streamSinks=Object.create(null),this.streamControllers=Object.create(null),this.callbackCapabilities=Object.create(null),this.actionHandler=Object.create(null),this._onComObjOnMessage=Ve=>{const Xe=Ve.data;if(Xe.targetName!==this.sourceName)return;if(Xe.stream){this.#t(Xe);return}if(Xe.callback){const Ge=Xe.callbackId,$e=this.callbackCapabilities[Ge];if(!$e)throw new Error(`Cannot resolve callback ${Ge}`);if(delete this.callbackCapabilities[Ge],Xe.callback===Ee.DATA)$e.resolve(Xe.data);else if(Xe.callback===Ee.ERROR)$e.reject(De(Xe.reason));else throw new Error("Unexpected callback case");return}const We=this.actionHandler[Xe.action];if(!We)throw new Error(`Unknown action from worker: ${Xe.action}`);if(Xe.callbackId){const Ge=this.sourceName,$e=Xe.sourceName;new Promise(function(Ke){Ke(We(Xe.data))}).then(function(Ke){He.postMessage({sourceName:Ge,targetName:$e,callback:Ee.DATA,callbackId:Xe.callbackId,data:Ke})},function(Ke){He.postMessage({sourceName:Ge,targetName:$e,callback:Ee.ERROR,callbackId:Xe.callbackId,reason:De(Ke)})});return}if(Xe.streamId){this.#e(Xe);return}We(Xe.data)},He.addEventListener("message",this._onComObjOnMessage)}on(Oe,Be){const He=this.actionHandler;if(He[Oe])throw new Error(`There is already an actionName called "${Oe}"`);He[Oe]=Be}send(Oe,Be,He){this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:Oe,data:Be},He)}sendWithPromise(Oe,Be,He){const Ve=this.callbackId++,Xe=new n.PromiseCapability;this.callbackCapabilities[Ve]=Xe;try{this.comObj.postMessage({sourceName:this.sourceName,targetName:this.targetName,action:Oe,callbackId:Ve,data:Be},He)}catch(We){Xe.reject(We)}return Xe.promise}sendWithStream(Oe,Be,He,Ve){const Xe=this.streamId++,We=this.sourceName,Ge=this.targetName,$e=this.comObj;return new ReadableStream({start:Ke=>{const rr=new n.PromiseCapability;return this.streamControllers[Xe]={controller:Ke,startCall:rr,pullCall:null,cancelCall:null,isClosed:!1},$e.postMessage({sourceName:We,targetName:Ge,action:Oe,streamId:Xe,data:Be,desiredSize:Ke.desiredSize},Ve),rr.promise},pull:Ke=>{const rr=new n.PromiseCapability;return this.streamControllers[Xe].pullCall=rr,$e.postMessage({sourceName:We,targetName:Ge,stream:Ce.PULL,streamId:Xe,desiredSize:Ke.desiredSize}),rr.promise},cancel:Ke=>{(0,n.assert)(Ke instanceof Error,"cancel must have a valid reason");const rr=new n.PromiseCapability;return this.streamControllers[Xe].cancelCall=rr,this.streamControllers[Xe].isClosed=!0,$e.postMessage({sourceName:We,targetName:Ge,stream:Ce.CANCEL,streamId:Xe,reason:De(Ke)}),rr.promise}},He)}#e(Oe){const Be=Oe.streamId,He=this.sourceName,Ve=Oe.sourceName,Xe=this.comObj,We=this,Ge=this.actionHandler[Oe.action],$e={enqueue(Ke,rr=1,tr){if(this.isCancelled)return;const sr=this.desiredSize;this.desiredSize-=rr,sr>0&&this.desiredSize<=0&&(this.sinkCapability=new n.PromiseCapability,this.ready=this.sinkCapability.promise),Xe.postMessage({sourceName:He,targetName:Ve,stream:Ce.ENQUEUE,streamId:Be,chunk:Ke},tr)},close(){this.isCancelled||(this.isCancelled=!0,Xe.postMessage({sourceName:He,targetName:Ve,stream:Ce.CLOSE,streamId:Be}),delete We.streamSinks[Be])},error(Ke){(0,n.assert)(Ke instanceof Error,"error must have a valid reason"),!this.isCancelled&&(this.isCancelled=!0,Xe.postMessage({sourceName:He,targetName:Ve,stream:Ce.ERROR,streamId:Be,reason:De(Ke)}))},sinkCapability:new n.PromiseCapability,onPull:null,onCancel:null,isCancelled:!1,desiredSize:Oe.desiredSize,ready:null};$e.sinkCapability.resolve(),$e.ready=$e.sinkCapability.promise,this.streamSinks[Be]=$e,new Promise(function(Ke){Ke(Ge(Oe.data,$e))}).then(function(){Xe.postMessage({sourceName:He,targetName:Ve,stream:Ce.START_COMPLETE,streamId:Be,success:!0})},function(Ke){Xe.postMessage({sourceName:He,targetName:Ve,stream:Ce.START_COMPLETE,streamId:Be,reason:De(Ke)})})}#t(Oe){const Be=Oe.streamId,He=this.sourceName,Ve=Oe.sourceName,Xe=this.comObj,We=this.streamControllers[Be],Ge=this.streamSinks[Be];switch(Oe.stream){case Ce.START_COMPLETE:Oe.success?We.startCall.resolve():We.startCall.reject(De(Oe.reason));break;case Ce.PULL_COMPLETE:Oe.success?We.pullCall.resolve():We.pullCall.reject(De(Oe.reason));break;case Ce.PULL:if(!Ge){Xe.postMessage({sourceName:He,targetName:Ve,stream:Ce.PULL_COMPLETE,streamId:Be,success:!0});break}Ge.desiredSize<=0&&Oe.desiredSize>0&&Ge.sinkCapability.resolve(),Ge.desiredSize=Oe.desiredSize,new Promise(function($e){$e(Ge.onPull?.())}).then(function(){Xe.postMessage({sourceName:He,targetName:Ve,stream:Ce.PULL_COMPLETE,streamId:Be,success:!0})},function($e){Xe.postMessage({sourceName:He,targetName:Ve,stream:Ce.PULL_COMPLETE,streamId:Be,reason:De($e)})});break;case Ce.ENQUEUE:if((0,n.assert)(We,"enqueue should have stream controller"),We.isClosed)break;We.controller.enqueue(Oe.chunk);break;case Ce.CLOSE:if((0,n.assert)(We,"close should have stream controller"),We.isClosed)break;We.isClosed=!0,We.controller.close(),this.#r(We,Be);break;case Ce.ERROR:(0,n.assert)(We,"error should have stream controller"),We.controller.error(De(Oe.reason)),this.#r(We,Be);break;case Ce.CANCEL_COMPLETE:Oe.success?We.cancelCall.resolve():We.cancelCall.reject(De(Oe.reason)),this.#r(We,Be);break;case Ce.CANCEL:if(!Ge)break;new Promise(function($e){$e(Ge.onCancel?.(De(Oe.reason)))}).then(function(){Xe.postMessage({sourceName:He,targetName:Ve,stream:Ce.CANCEL_COMPLETE,streamId:Be,success:!0})},function($e){Xe.postMessage({sourceName:He,targetName:Ve,stream:Ce.CANCEL_COMPLETE,streamId:Be,reason:De($e)})}),Ge.sinkCapability.reject(De(Oe.reason)),Ge.isCancelled=!0,delete this.streamSinks[Be];break;default:throw new Error("Unexpected stream case")}}async#r(Oe,Be){await Promise.allSettled([Oe.startCall?.promise,Oe.pullCall?.promise,Oe.cancelCall?.promise]),delete this.streamControllers[Be]}destroy(){this.comObj.removeEventListener("message",this._onComObjOnMessage)}}t.MessageHandler=Me}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.Metadata=void 0;var n=r(1);class Ee{#e;#t;constructor({parsedData:De,rawData:Me}){this.#e=De,this.#t=Me}getRaw(){return this.#t}get(De){return this.#e.get(De)??null}getAll(){return(0,n.objectFromMap)(this.#e)}has(De){return this.#e.has(De)}}t.Metadata=Ee}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.OptionalContentConfig=void 0;var n=r(1),Ee=r(8);const Ce=Symbol("INTERNAL");class De{#e=!0;constructor(Oe,Be){this.name=Oe,this.intent=Be}get visible(){return this.#e}_setVisible(Oe,Be){Oe!==Ce&&(0,n.unreachable)("Internal method `_setVisible` called."),this.#e=Be}}class Me{#e=null;#t=new Map;#r=null;#a=null;constructor(Oe){if(this.name=null,this.creator=null,Oe!==null){this.name=Oe.name,this.creator=Oe.creator,this.#a=Oe.order;for(const Be of Oe.groups)this.#t.set(Be.id,new De(Be.name,Be.intent));if(Oe.baseState==="OFF")for(const Be of this.#t.values())Be._setVisible(Ce,!1);for(const Be of Oe.on)this.#t.get(Be)._setVisible(Ce,!0);for(const Be of Oe.off)this.#t.get(Be)._setVisible(Ce,!1);this.#r=this.getHash()}}#o(Oe){const Be=Oe.length;if(Be<2)return!0;const He=Oe[0];for(let Ve=1;Ve<Be;Ve++){const Xe=Oe[Ve];let We;if(Array.isArray(Xe))We=this.#o(Xe);else if(this.#t.has(Xe))We=this.#t.get(Xe).visible;else return(0,n.warn)(`Optional content group not found: ${Xe}`),!0;switch(He){case"And":if(!We)return!1;break;case"Or":if(We)return!0;break;case"Not":return!We;default:return!0}}return He==="And"}isVisible(Oe){if(this.#t.size===0)return!0;if(!Oe)return(0,n.warn)("Optional content group not defined."),!0;if(Oe.type==="OCG")return this.#t.has(Oe.id)?this.#t.get(Oe.id).visible:((0,n.warn)(`Optional content group not found: ${Oe.id}`),!0);if(Oe.type==="OCMD"){if(Oe.expression)return this.#o(Oe.expression);if(!Oe.policy||Oe.policy==="AnyOn"){for(const Be of Oe.ids){if(!this.#t.has(Be))return(0,n.warn)(`Optional content group not found: ${Be}`),!0;if(this.#t.get(Be).visible)return!0}return!1}else if(Oe.policy==="AllOn"){for(const Be of Oe.ids){if(!this.#t.has(Be))return(0,n.warn)(`Optional content group not found: ${Be}`),!0;if(!this.#t.get(Be).visible)return!1}return!0}else if(Oe.policy==="AnyOff"){for(const Be of Oe.ids){if(!this.#t.has(Be))return(0,n.warn)(`Optional content group not found: ${Be}`),!0;if(!this.#t.get(Be).visible)return!0}return!1}else if(Oe.policy==="AllOff"){for(const Be of Oe.ids){if(!this.#t.has(Be))return(0,n.warn)(`Optional content group not found: ${Be}`),!0;if(this.#t.get(Be).visible)return!1}return!0}return(0,n.warn)(`Unknown optional content policy ${Oe.policy}.`),!0}return(0,n.warn)(`Unknown group type ${Oe.type}.`),!0}setVisibility(Oe,Be=!0){if(!this.#t.has(Oe)){(0,n.warn)(`Optional content group not found: ${Oe}`);return}this.#t.get(Oe)._setVisible(Ce,!!Be),this.#e=null}get hasInitialVisibility(){return this.#r===null||this.getHash()===this.#r}getOrder(){return this.#t.size?this.#a?this.#a.slice():[...this.#t.keys()]:null}getGroups(){return this.#t.size>0?(0,n.objectFromMap)(this.#t):null}getGroup(Oe){return this.#t.get(Oe)||null}getHash(){if(this.#e!==null)return this.#e;const Oe=new Ee.MurmurHash3_64;for(const[Be,He]of this.#t)Oe.update(`${Be}:${He.visible}`);return this.#e=Oe.hexdigest()}}t.OptionalContentConfig=Me}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFDataTransportStream=void 0;var n=r(1),Ee=r(6);class Ce{constructor({length:Oe,initialData:Be,progressiveDone:He=!1,contentDispositionFilename:Ve=null,disableRange:Xe=!1,disableStream:We=!1},Ge){if((0,n.assert)(Ge,'PDFDataTransportStream - missing required "pdfDataRangeTransport" argument.'),this._queuedChunks=[],this._progressiveDone=He,this._contentDispositionFilename=Ve,Be?.length>0){const $e=Be instanceof Uint8Array&&Be.byteLength===Be.buffer.byteLength?Be.buffer:new Uint8Array(Be).buffer;this._queuedChunks.push($e)}this._pdfDataRangeTransport=Ge,this._isStreamingSupported=!We,this._isRangeSupported=!Xe,this._contentLength=Oe,this._fullRequestReader=null,this._rangeReaders=[],this._pdfDataRangeTransport.addRangeListener(($e,Ke)=>{this._onReceiveData({begin:$e,chunk:Ke})}),this._pdfDataRangeTransport.addProgressListener(($e,Ke)=>{this._onProgress({loaded:$e,total:Ke})}),this._pdfDataRangeTransport.addProgressiveReadListener($e=>{this._onReceiveData({chunk:$e})}),this._pdfDataRangeTransport.addProgressiveDoneListener(()=>{this._onProgressiveDone()}),this._pdfDataRangeTransport.transportReady()}_onReceiveData({begin:Oe,chunk:Be}){const He=Be instanceof Uint8Array&&Be.byteLength===Be.buffer.byteLength?Be.buffer:new Uint8Array(Be).buffer;if(Oe===void 0)this._fullRequestReader?this._fullRequestReader._enqueue(He):this._queuedChunks.push(He);else{const Ve=this._rangeReaders.some(function(Xe){return Xe._begin!==Oe?!1:(Xe._enqueue(He),!0)});(0,n.assert)(Ve,"_onReceiveData - no `PDFDataTransportStreamRangeReader` instance found.")}}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}_onProgress(Oe){Oe.total===void 0?this._rangeReaders[0]?.onProgress?.({loaded:Oe.loaded}):this._fullRequestReader?.onProgress?.({loaded:Oe.loaded,total:Oe.total})}_onProgressiveDone(){this._fullRequestReader?.progressiveDone(),this._progressiveDone=!0}_removeRangeReader(Oe){const Be=this._rangeReaders.indexOf(Oe);Be>=0&&this._rangeReaders.splice(Be,1)}getFullReader(){(0,n.assert)(!this._fullRequestReader,"PDFDataTransportStream.getFullReader can only be called once.");const Oe=this._queuedChunks;return this._queuedChunks=null,new De(this,Oe,this._progressiveDone,this._contentDispositionFilename)}getRangeReader(Oe,Be){if(Be<=this._progressiveDataLength)return null;const He=new Me(this,Oe,Be);return this._pdfDataRangeTransport.requestDataRange(Oe,Be),this._rangeReaders.push(He),He}cancelAllRequests(Oe){this._fullRequestReader?.cancel(Oe);for(const Be of this._rangeReaders.slice(0))Be.cancel(Oe);this._pdfDataRangeTransport.abort()}}t.PDFDataTransportStream=Ce;class De{constructor(Oe,Be,He=!1,Ve=null){this._stream=Oe,this._done=He||!1,this._filename=(0,Ee.isPdfFile)(Ve)?Ve:null,this._queuedChunks=Be||[],this._loaded=0;for(const Xe of this._queuedChunks)this._loaded+=Xe.byteLength;this._requests=[],this._headersReady=Promise.resolve(),Oe._fullRequestReader=this,this.onProgress=null}_enqueue(Oe){this._done||(this._requests.length>0?this._requests.shift().resolve({value:Oe,done:!1}):this._queuedChunks.push(Oe),this._loaded+=Oe.byteLength)}get headersReady(){return this._headersReady}get filename(){return this._filename}get isRangeSupported(){return this._stream._isRangeSupported}get isStreamingSupported(){return this._stream._isStreamingSupported}get contentLength(){return this._stream._contentLength}async read(){if(this._queuedChunks.length>0)return{value:this._queuedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const Oe=new n.PromiseCapability;return this._requests.push(Oe),Oe.promise}cancel(Oe){this._done=!0;for(const Be of this._requests)Be.resolve({value:void 0,done:!0});this._requests.length=0}progressiveDone(){this._done||(this._done=!0)}}class Me{constructor(Oe,Be,He){this._stream=Oe,this._begin=Be,this._end=He,this._queuedChunk=null,this._requests=[],this._done=!1,this.onProgress=null}_enqueue(Oe){if(!this._done){if(this._requests.length===0)this._queuedChunk=Oe;else{this._requests.shift().resolve({value:Oe,done:!1});for(const He of this._requests)He.resolve({value:void 0,done:!0});this._requests.length=0}this._done=!0,this._stream._removeRangeReader(this)}}get isStreamingSupported(){return!1}async read(){if(this._queuedChunk){const Be=this._queuedChunk;return this._queuedChunk=null,{value:Be,done:!1}}if(this._done)return{value:void 0,done:!0};const Oe=new n.PromiseCapability;return this._requests.push(Oe),Oe.promise}cancel(Oe){this._done=!0;for(const Be of this._requests)Be.resolve({value:void 0,done:!0});this._requests.length=0,this._stream._removeRangeReader(this)}}}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFFetchStream=void 0;var n=r(1),Ee=r(20);function Ce(He,Ve,Xe){return{method:"GET",headers:He,signal:Xe.signal,mode:"cors",credentials:Ve?"include":"same-origin",redirect:"follow"}}function De(He){const Ve=new Headers;for(const Xe in He){const We=He[Xe];We!==void 0&&Ve.append(Xe,We)}return Ve}function Me(He){return He instanceof Uint8Array?He.buffer:He instanceof ArrayBuffer?He:((0,n.warn)(`getArrayBuffer - unexpected data format: ${He}`),new Uint8Array(He).buffer)}class ze{constructor(Ve){this.source=Ve,this.isHttp=/^https?:/i.test(Ve.url),this.httpHeaders=this.isHttp&&Ve.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFFetchStream.getFullReader can only be called once."),this._fullRequestReader=new Oe(this),this._fullRequestReader}getRangeReader(Ve,Xe){if(Xe<=this._progressiveDataLength)return null;const We=new Be(this,Ve,Xe);return this._rangeRequestReaders.push(We),We}cancelAllRequests(Ve){this._fullRequestReader?.cancel(Ve);for(const Xe of this._rangeRequestReaders.slice(0))Xe.cancel(Ve)}}t.PDFFetchStream=ze;class Oe{constructor(Ve){this._stream=Ve,this._reader=null,this._loaded=0,this._filename=null;const Xe=Ve.source;this._withCredentials=Xe.withCredentials||!1,this._contentLength=Xe.length,this._headersCapability=new n.PromiseCapability,this._disableRange=Xe.disableRange||!1,this._rangeChunkSize=Xe.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._abortController=new AbortController,this._isStreamingSupported=!Xe.disableStream,this._isRangeSupported=!Xe.disableRange,this._headers=De(this._stream.httpHeaders);const We=Xe.url;fetch(We,Ce(this._headers,this._withCredentials,this._abortController)).then(Ge=>{if(!(0,Ee.validateResponseStatus)(Ge.status))throw(0,Ee.createResponseStatusError)(Ge.status,We);this._reader=Ge.body.getReader(),this._headersCapability.resolve();const $e=tr=>Ge.headers.get(tr),{allowRangeRequests:Ke,suggestedLength:rr}=(0,Ee.validateRangeRequestCapabilities)({getResponseHeader:$e,isHttp:this._stream.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=Ke,this._contentLength=rr||this._contentLength,this._filename=(0,Ee.extractFilenameFromHeader)($e),!this._isStreamingSupported&&this._isRangeSupported&&this.cancel(new n.AbortException("Streaming is disabled."))}).catch(this._headersCapability.reject),this.onProgress=null}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._headersCapability.promise;const{value:Ve,done:Xe}=await this._reader.read();return Xe?{value:Ve,done:Xe}:(this._loaded+=Ve.byteLength,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:Me(Ve),done:!1})}cancel(Ve){this._reader?.cancel(Ve),this._abortController.abort()}}class Be{constructor(Ve,Xe,We){this._stream=Ve,this._reader=null,this._loaded=0;const Ge=Ve.source;this._withCredentials=Ge.withCredentials||!1,this._readCapability=new n.PromiseCapability,this._isStreamingSupported=!Ge.disableStream,this._abortController=new AbortController,this._headers=De(this._stream.httpHeaders),this._headers.append("Range",`bytes=${Xe}-${We-1}`);const $e=Ge.url;fetch($e,Ce(this._headers,this._withCredentials,this._abortController)).then(Ke=>{if(!(0,Ee.validateResponseStatus)(Ke.status))throw(0,Ee.createResponseStatusError)(Ke.status,$e);this._readCapability.resolve(),this._reader=Ke.body.getReader()}).catch(this._readCapability.reject),this.onProgress=null}get isStreamingSupported(){return this._isStreamingSupported}async read(){await this._readCapability.promise;const{value:Ve,done:Xe}=await this._reader.read();return Xe?{value:Ve,done:Xe}:(this._loaded+=Ve.byteLength,this.onProgress?.({loaded:this._loaded}),{value:Me(Ve),done:!1})}cancel(Ve){this._reader?.cancel(Ve),this._abortController.abort()}}}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createResponseStatusError=ze,t.extractFilenameFromHeader=Me,t.validateRangeRequestCapabilities=De,t.validateResponseStatus=Oe;var n=r(1),Ee=r(21),Ce=r(6);function De({getResponseHeader:Be,isHttp:He,rangeChunkSize:Ve,disableRange:Xe}){const We={allowRangeRequests:!1,suggestedLength:void 0},Ge=parseInt(Be("Content-Length"),10);return!Number.isInteger(Ge)||(We.suggestedLength=Ge,Ge<=2*Ve)||Xe||!He||Be("Accept-Ranges")!=="bytes"||(Be("Content-Encoding")||"identity")!=="identity"||(We.allowRangeRequests=!0),We}function Me(Be){const He=Be("Content-Disposition");if(He){let Ve=(0,Ee.getFilenameFromContentDispositionHeader)(He);if(Ve.includes("%"))try{Ve=decodeURIComponent(Ve)}catch{}if((0,Ce.isPdfFile)(Ve))return Ve}return null}function ze(Be,He){return Be===404||Be===0&&He.startsWith("file:")?new n.MissingPDFException('Missing PDF "'+He+'".'):new n.UnexpectedResponseException(`Unexpected server response (${Be}) while retrieving PDF "${He}".`,Be)}function Oe(Be){return Be===200||Be===206}}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getFilenameFromContentDispositionHeader=Ee;var n=r(1);function Ee(Ce){let De=!0,Me=ze("filename\\*","i").exec(Ce);if(Me){Me=Me[1];let Ge=Ve(Me);return Ge=unescape(Ge),Ge=Xe(Ge),Ge=We(Ge),Be(Ge)}if(Me=He(Ce),Me){const Ge=We(Me);return Be(Ge)}if(Me=ze("filename","i").exec(Ce),Me){Me=Me[1];let Ge=Ve(Me);return Ge=We(Ge),Be(Ge)}function ze(Ge,$e){return new RegExp("(?:^|;)\\s*"+Ge+'\\s*=\\s*([^";\\s][^;\\s]*|"(?:[^"\\\\]|\\\\"?)+"?)',$e)}function Oe(Ge,$e){if(Ge){if(!/^[\x00-\xFF]+$/.test($e))return $e;try{const Ke=new TextDecoder(Ge,{fatal:!0}),rr=(0,n.stringToBytes)($e);$e=Ke.decode(rr),De=!1}catch{}}return $e}function Be(Ge){return De&&/[\x80-\xff]/.test(Ge)&&(Ge=Oe("utf-8",Ge),De&&(Ge=Oe("iso-8859-1",Ge))),Ge}function He(Ge){const $e=[];let Ke;const rr=ze("filename\\*((?!0\\d)\\d+)(\\*?)","ig");for(;(Ke=rr.exec(Ge))!==null;){let[,sr,ar,hr]=Ke;if(sr=parseInt(sr,10),sr in $e){if(sr===0)break;continue}$e[sr]=[ar,hr]}const tr=[];for(let sr=0;sr<$e.length&&sr in $e;++sr){let[ar,hr]=$e[sr];hr=Ve(hr),ar&&(hr=unescape(hr),sr===0&&(hr=Xe(hr))),tr.push(hr)}return tr.join("")}function Ve(Ge){if(Ge.startsWith('"')){const $e=Ge.slice(1).split('\\"');for(let Ke=0;Ke<$e.length;++Ke){const rr=$e[Ke].indexOf('"');rr!==-1&&($e[Ke]=$e[Ke].slice(0,rr),$e.length=Ke+1),$e[Ke]=$e[Ke].replaceAll(/\\(.)/g,"$1")}Ge=$e.join('"')}return Ge}function Xe(Ge){const $e=Ge.indexOf("'");if($e===-1)return Ge;const Ke=Ge.slice(0,$e),tr=Ge.slice($e+1).replace(/^[^']*'/,"");return Oe(Ke,tr)}function We(Ge){return!Ge.startsWith("=?")||/[\x00-\x19\x80-\xff]/.test(Ge)?Ge:Ge.replaceAll(/=\?([\w-]*)\?([QqBb])\?((?:[^?]|\?(?!=))*)\?=/g,function($e,Ke,rr,tr){if(rr==="q"||rr==="Q")return tr=tr.replaceAll("_"," "),tr=tr.replaceAll(/=([0-9a-fA-F]{2})/g,function(sr,ar){return String.fromCharCode(parseInt(ar,16))}),Oe(Ke,tr);try{tr=atob(tr)}catch{}return Oe(Ke,tr)})}return""}}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNetworkStream=void 0;var n=r(1),Ee=r(20);const Ce=200,De=206;function Me(Ve){const Xe=Ve.response;return typeof Xe!="string"?Xe:(0,n.stringToBytes)(Xe).buffer}class ze{constructor(Xe,We={}){this.url=Xe,this.isHttp=/^https?:/i.test(Xe),this.httpHeaders=this.isHttp&&We.httpHeaders||Object.create(null),this.withCredentials=We.withCredentials||!1,this.currXhrId=0,this.pendingRequests=Object.create(null)}requestRange(Xe,We,Ge){const $e={begin:Xe,end:We};for(const Ke in Ge)$e[Ke]=Ge[Ke];return this.request($e)}requestFull(Xe){return this.request(Xe)}request(Xe){const We=new XMLHttpRequest,Ge=this.currXhrId++,$e=this.pendingRequests[Ge]={xhr:We};We.open("GET",this.url),We.withCredentials=this.withCredentials;for(const Ke in this.httpHeaders){const rr=this.httpHeaders[Ke];rr!==void 0&&We.setRequestHeader(Ke,rr)}return this.isHttp&&"begin"in Xe&&"end"in Xe?(We.setRequestHeader("Range",`bytes=${Xe.begin}-${Xe.end-1}`),$e.expectedStatus=De):$e.expectedStatus=Ce,We.responseType="arraybuffer",Xe.onError&&(We.onerror=function(Ke){Xe.onError(We.status)}),We.onreadystatechange=this.onStateChange.bind(this,Ge),We.onprogress=this.onProgress.bind(this,Ge),$e.onHeadersReceived=Xe.onHeadersReceived,$e.onDone=Xe.onDone,$e.onError=Xe.onError,$e.onProgress=Xe.onProgress,We.send(null),Ge}onProgress(Xe,We){const Ge=this.pendingRequests[Xe];Ge&&Ge.onProgress?.(We)}onStateChange(Xe,We){const Ge=this.pendingRequests[Xe];if(!Ge)return;const $e=Ge.xhr;if($e.readyState>=2&&Ge.onHeadersReceived&&(Ge.onHeadersReceived(),delete Ge.onHeadersReceived),$e.readyState!==4||!(Xe in this.pendingRequests))return;if(delete this.pendingRequests[Xe],$e.status===0&&this.isHttp){Ge.onError?.($e.status);return}const Ke=$e.status||Ce;if(!(Ke===Ce&&Ge.expectedStatus===De)&&Ke!==Ge.expectedStatus){Ge.onError?.($e.status);return}const tr=Me($e);if(Ke===De){const sr=$e.getResponseHeader("Content-Range"),ar=/bytes (\d+)-(\d+)\/(\d+)/.exec(sr);Ge.onDone({begin:parseInt(ar[1],10),chunk:tr})}else tr?Ge.onDone({begin:0,chunk:tr}):Ge.onError?.($e.status)}getRequestXhr(Xe){return this.pendingRequests[Xe].xhr}isPendingRequest(Xe){return Xe in this.pendingRequests}abortRequest(Xe){const We=this.pendingRequests[Xe].xhr;delete this.pendingRequests[Xe],We.abort()}}class Oe{constructor(Xe){this._source=Xe,this._manager=new ze(Xe.url,{httpHeaders:Xe.httpHeaders,withCredentials:Xe.withCredentials}),this._rangeChunkSize=Xe.rangeChunkSize,this._fullRequestReader=null,this._rangeRequestReaders=[]}_onRangeRequestReaderClosed(Xe){const We=this._rangeRequestReaders.indexOf(Xe);We>=0&&this._rangeRequestReaders.splice(We,1)}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNetworkStream.getFullReader can only be called once."),this._fullRequestReader=new Be(this._manager,this._source),this._fullRequestReader}getRangeReader(Xe,We){const Ge=new He(this._manager,Xe,We);return Ge.onClosed=this._onRangeRequestReaderClosed.bind(this),this._rangeRequestReaders.push(Ge),Ge}cancelAllRequests(Xe){this._fullRequestReader?.cancel(Xe);for(const We of this._rangeRequestReaders.slice(0))We.cancel(Xe)}}t.PDFNetworkStream=Oe;class Be{constructor(Xe,We){this._manager=Xe;const Ge={onHeadersReceived:this._onHeadersReceived.bind(this),onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=We.url,this._fullRequestId=Xe.requestFull(Ge),this._headersReceivedCapability=new n.PromiseCapability,this._disableRange=We.disableRange||!1,this._contentLength=We.length,this._rangeChunkSize=We.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!1,this._isRangeSupported=!1,this._cachedChunks=[],this._requests=[],this._done=!1,this._storedError=void 0,this._filename=null,this.onProgress=null}_onHeadersReceived(){const Xe=this._fullRequestId,We=this._manager.getRequestXhr(Xe),Ge=rr=>We.getResponseHeader(rr),{allowRangeRequests:$e,suggestedLength:Ke}=(0,Ee.validateRangeRequestCapabilities)({getResponseHeader:Ge,isHttp:this._manager.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});$e&&(this._isRangeSupported=!0),this._contentLength=Ke||this._contentLength,this._filename=(0,Ee.extractFilenameFromHeader)(Ge),this._isRangeSupported&&this._manager.abortRequest(Xe),this._headersReceivedCapability.resolve()}_onDone(Xe){if(Xe&&(this._requests.length>0?this._requests.shift().resolve({value:Xe.chunk,done:!1}):this._cachedChunks.push(Xe.chunk)),this._done=!0,!(this._cachedChunks.length>0)){for(const We of this._requests)We.resolve({value:void 0,done:!0});this._requests.length=0}}_onError(Xe){this._storedError=(0,Ee.createResponseStatusError)(Xe,this._url),this._headersReceivedCapability.reject(this._storedError);for(const We of this._requests)We.reject(this._storedError);this._requests.length=0,this._cachedChunks.length=0}_onProgress(Xe){this.onProgress?.({loaded:Xe.loaded,total:Xe.lengthComputable?Xe.total:this._contentLength})}get filename(){return this._filename}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}get contentLength(){return this._contentLength}get headersReady(){return this._headersReceivedCapability.promise}async read(){if(this._storedError)throw this._storedError;if(this._cachedChunks.length>0)return{value:this._cachedChunks.shift(),done:!1};if(this._done)return{value:void 0,done:!0};const Xe=new n.PromiseCapability;return this._requests.push(Xe),Xe.promise}cancel(Xe){this._done=!0,this._headersReceivedCapability.reject(Xe);for(const We of this._requests)We.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._fullRequestId)&&this._manager.abortRequest(this._fullRequestId),this._fullRequestReader=null}}class He{constructor(Xe,We,Ge){this._manager=Xe;const $e={onDone:this._onDone.bind(this),onError:this._onError.bind(this),onProgress:this._onProgress.bind(this)};this._url=Xe.url,this._requestId=Xe.requestRange(We,Ge,$e),this._requests=[],this._queuedChunk=null,this._done=!1,this._storedError=void 0,this.onProgress=null,this.onClosed=null}_close(){this.onClosed?.(this)}_onDone(Xe){const We=Xe.chunk;this._requests.length>0?this._requests.shift().resolve({value:We,done:!1}):this._queuedChunk=We,this._done=!0;for(const Ge of this._requests)Ge.resolve({value:void 0,done:!0});this._requests.length=0,this._close()}_onError(Xe){this._storedError=(0,Ee.createResponseStatusError)(Xe,this._url);for(const We of this._requests)We.reject(this._storedError);this._requests.length=0,this._queuedChunk=null}_onProgress(Xe){this.isStreamingSupported||this.onProgress?.({loaded:Xe.loaded})}get isStreamingSupported(){return!1}async read(){if(this._storedError)throw this._storedError;if(this._queuedChunk!==null){const We=this._queuedChunk;return this._queuedChunk=null,{value:We,done:!1}}if(this._done)return{value:void 0,done:!0};const Xe=new n.PromiseCapability;return this._requests.push(Xe),Xe.promise}cancel(Xe){this._done=!0;for(const We of this._requests)We.resolve({value:void 0,done:!0});this._requests.length=0,this._manager.isPendingRequest(this._requestId)&&this._manager.abortRequest(this._requestId),this._close()}}}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PDFNodeStream=void 0;var n=r(1),Ee=r(20);const Ce=/^file:\/\/\/[a-zA-Z]:\//;function De(Ge){const $e=require$$5,Ke=$e.parse(Ge);return Ke.protocol==="file:"||Ke.host?Ke:/^[a-z]:[/\\]/i.test(Ge)?$e.parse(`file:///${Ge}`):(Ke.host||(Ke.protocol="file:"),Ke)}class Me{constructor($e){this.source=$e,this.url=De($e.url),this.isHttp=this.url.protocol==="http:"||this.url.protocol==="https:",this.isFsUrl=this.url.protocol==="file:",this.httpHeaders=this.isHttp&&$e.httpHeaders||{},this._fullRequestReader=null,this._rangeRequestReaders=[]}get _progressiveDataLength(){return this._fullRequestReader?._loaded??0}getFullReader(){return(0,n.assert)(!this._fullRequestReader,"PDFNodeStream.getFullReader can only be called once."),this._fullRequestReader=this.isFsUrl?new Xe(this):new He(this),this._fullRequestReader}getRangeReader($e,Ke){if(Ke<=this._progressiveDataLength)return null;const rr=this.isFsUrl?new We(this,$e,Ke):new Ve(this,$e,Ke);return this._rangeRequestReaders.push(rr),rr}cancelAllRequests($e){this._fullRequestReader?.cancel($e);for(const Ke of this._rangeRequestReaders.slice(0))Ke.cancel($e)}}t.PDFNodeStream=Me;class ze{constructor($e){this._url=$e.url,this._done=!1,this._storedError=null,this.onProgress=null;const Ke=$e.source;this._contentLength=Ke.length,this._loaded=0,this._filename=null,this._disableRange=Ke.disableRange||!1,this._rangeChunkSize=Ke.rangeChunkSize,!this._rangeChunkSize&&!this._disableRange&&(this._disableRange=!0),this._isStreamingSupported=!Ke.disableStream,this._isRangeSupported=!Ke.disableRange,this._readableStream=null,this._readCapability=new n.PromiseCapability,this._headersCapability=new n.PromiseCapability}get headersReady(){return this._headersCapability.promise}get filename(){return this._filename}get contentLength(){return this._contentLength}get isRangeSupported(){return this._isRangeSupported}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const $e=this._readableStream.read();return $e===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=$e.length,this.onProgress?.({loaded:this._loaded,total:this._contentLength}),{value:new Uint8Array($e).buffer,done:!1})}cancel($e){if(!this._readableStream){this._error($e);return}this._readableStream.destroy($e)}_error($e){this._storedError=$e,this._readCapability.resolve()}_setReadableStream($e){this._readableStream=$e,$e.on("readable",()=>{this._readCapability.resolve()}),$e.on("end",()=>{$e.destroy(),this._done=!0,this._readCapability.resolve()}),$e.on("error",Ke=>{this._error(Ke)}),!this._isStreamingSupported&&this._isRangeSupported&&this._error(new n.AbortException("streaming is disabled")),this._storedError&&this._readableStream.destroy(this._storedError)}}class Oe{constructor($e){this._url=$e.url,this._done=!1,this._storedError=null,this.onProgress=null,this._loaded=0,this._readableStream=null,this._readCapability=new n.PromiseCapability;const Ke=$e.source;this._isStreamingSupported=!Ke.disableStream}get isStreamingSupported(){return this._isStreamingSupported}async read(){if(await this._readCapability.promise,this._done)return{value:void 0,done:!0};if(this._storedError)throw this._storedError;const $e=this._readableStream.read();return $e===null?(this._readCapability=new n.PromiseCapability,this.read()):(this._loaded+=$e.length,this.onProgress?.({loaded:this._loaded}),{value:new Uint8Array($e).buffer,done:!1})}cancel($e){if(!this._readableStream){this._error($e);return}this._readableStream.destroy($e)}_error($e){this._storedError=$e,this._readCapability.resolve()}_setReadableStream($e){this._readableStream=$e,$e.on("readable",()=>{this._readCapability.resolve()}),$e.on("end",()=>{$e.destroy(),this._done=!0,this._readCapability.resolve()}),$e.on("error",Ke=>{this._error(Ke)}),this._storedError&&this._readableStream.destroy(this._storedError)}}function Be(Ge,$e){return{protocol:Ge.protocol,auth:Ge.auth,host:Ge.hostname,port:Ge.port,path:Ge.path,method:"GET",headers:$e}}class He extends ze{constructor($e){super($e);const Ke=rr=>{if(rr.statusCode===404){const hr=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=hr,this._headersCapability.reject(hr);return}this._headersCapability.resolve(),this._setReadableStream(rr);const tr=hr=>this._readableStream.headers[hr.toLowerCase()],{allowRangeRequests:sr,suggestedLength:ar}=(0,Ee.validateRangeRequestCapabilities)({getResponseHeader:tr,isHttp:$e.isHttp,rangeChunkSize:this._rangeChunkSize,disableRange:this._disableRange});this._isRangeSupported=sr,this._contentLength=ar||this._contentLength,this._filename=(0,Ee.extractFilenameFromHeader)(tr)};if(this._request=null,this._url.protocol==="http:"){const rr=require$$5;this._request=rr.request(Be(this._url,$e.httpHeaders),Ke)}else{const rr=require$$5;this._request=rr.request(Be(this._url,$e.httpHeaders),Ke)}this._request.on("error",rr=>{this._storedError=rr,this._headersCapability.reject(rr)}),this._request.end()}}class Ve extends Oe{constructor($e,Ke,rr){super($e),this._httpHeaders={};for(const sr in $e.httpHeaders){const ar=$e.httpHeaders[sr];ar!==void 0&&(this._httpHeaders[sr]=ar)}this._httpHeaders.Range=`bytes=${Ke}-${rr-1}`;const tr=sr=>{if(sr.statusCode===404){const ar=new n.MissingPDFException(`Missing PDF "${this._url}".`);this._storedError=ar;return}this._setReadableStream(sr)};if(this._request=null,this._url.protocol==="http:"){const sr=require$$5;this._request=sr.request(Be(this._url,this._httpHeaders),tr)}else{const sr=require$$5;this._request=sr.request(Be(this._url,this._httpHeaders),tr)}this._request.on("error",sr=>{this._storedError=sr}),this._request.end()}}class Xe extends ze{constructor($e){super($e);let Ke=decodeURIComponent(this._url.path);Ce.test(this._url.href)&&(Ke=Ke.replace(/^\//,""));const rr=require$$5;rr.lstat(Ke,(tr,sr)=>{if(tr){tr.code==="ENOENT"&&(tr=new n.MissingPDFException(`Missing PDF "${Ke}".`)),this._storedError=tr,this._headersCapability.reject(tr);return}this._contentLength=sr.size,this._setReadableStream(rr.createReadStream(Ke)),this._headersCapability.resolve()})}}class We extends Oe{constructor($e,Ke,rr){super($e);let tr=decodeURIComponent(this._url.path);Ce.test(this._url.href)&&(tr=tr.replace(/^\//,""));const sr=require$$5;this._setReadableStream(sr.createReadStream(tr,{start:Ke,end:rr-1}))}}}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SVGGraphics=void 0;var n=r(6),Ee=r(1);const Ce={fontStyle:"normal",fontWeight:"normal",fillColor:"#000000"},De="http://www.w3.org/XML/1998/namespace",Me="http://www.w3.org/1999/xlink",ze=["butt","round","square"],Oe=["miter","round","bevel"],Be=function(sr,ar="",hr=!1){if(URL.createObjectURL&&typeof Blob<"u"&&!hr)return URL.createObjectURL(new Blob([sr],{type:ar}));const pr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let yr=`data:${ar};base64,`;for(let fr=0,Rr=sr.length;fr<Rr;fr+=3){const mr=sr[fr]&255,wr=sr[fr+1]&255,Fr=sr[fr+2]&255,Mr=mr>>2,Hr=(mr&3)<<4|wr>>4,Nr=fr+1<Rr?(wr&15)<<2|Fr>>6:64,Ar=fr+2<Rr?Fr&63:64;yr+=pr[Mr]+pr[Hr]+pr[Nr]+pr[Ar]}return yr},He=(function(){const sr=new Uint8Array([137,80,78,71,13,10,26,10]),ar=12,hr=new Int32Array(256);for(let Fr=0;Fr<256;Fr++){let Mr=Fr;for(let Hr=0;Hr<8;Hr++)Mr=Mr&1?3988292384^Mr>>1&2147483647:Mr>>1&2147483647;hr[Fr]=Mr}function pr(Fr,Mr,Hr){let Nr=-1;for(let Ar=Mr;Ar<Hr;Ar++){const xr=(Nr^Fr[Ar])&255,ir=hr[xr];Nr=Nr>>>8^ir}return Nr^-1}function yr(Fr,Mr,Hr,Nr){let Ar=Nr;const xr=Mr.length;Hr[Ar]=xr>>24&255,Hr[Ar+1]=xr>>16&255,Hr[Ar+2]=xr>>8&255,Hr[Ar+3]=xr&255,Ar+=4,Hr[Ar]=Fr.charCodeAt(0)&255,Hr[Ar+1]=Fr.charCodeAt(1)&255,Hr[Ar+2]=Fr.charCodeAt(2)&255,Hr[Ar+3]=Fr.charCodeAt(3)&255,Ar+=4,Hr.set(Mr,Ar),Ar+=Mr.length;const ir=pr(Hr,Nr+4,Ar);Hr[Ar]=ir>>24&255,Hr[Ar+1]=ir>>16&255,Hr[Ar+2]=ir>>8&255,Hr[Ar+3]=ir&255}function fr(Fr,Mr,Hr){let Nr=1,Ar=0;for(let xr=Mr;xr<Hr;++xr)Nr=(Nr+(Fr[xr]&255))%65521,Ar=(Ar+Nr)%65521;return Ar<<16|Nr}function Rr(Fr){if(!Ee.isNodeJS)return mr(Fr);try{const Mr=parseInt(process.versions.node)>=8?Fr:Buffer.from(Fr),Hr=require$$5.deflateSync(Mr,{level:9});return Hr instanceof Uint8Array?Hr:new Uint8Array(Hr)}catch(Mr){(0,Ee.warn)("Not compressing PNG because zlib.deflateSync is unavailable: "+Mr)}return mr(Fr)}function mr(Fr){let Mr=Fr.length;const Hr=65535,Nr=Math.ceil(Mr/Hr),Ar=new Uint8Array(2+Mr+Nr*5+4);let xr=0;Ar[xr++]=120,Ar[xr++]=156;let ir=0;for(;Mr>Hr;)Ar[xr++]=0,Ar[xr++]=255,Ar[xr++]=255,Ar[xr++]=0,Ar[xr++]=0,Ar.set(Fr.subarray(ir,ir+Hr),xr),xr+=Hr,ir+=Hr,Mr-=Hr;Ar[xr++]=1,Ar[xr++]=Mr&255,Ar[xr++]=Mr>>8&255,Ar[xr++]=~Mr&65535&255,Ar[xr++]=(~Mr&65535)>>8&255,Ar.set(Fr.subarray(ir),xr),xr+=Fr.length-ir;const _r=fr(Fr,0,Fr.length);return Ar[xr++]=_r>>24&255,Ar[xr++]=_r>>16&255,Ar[xr++]=_r>>8&255,Ar[xr++]=_r&255,Ar}function wr(Fr,Mr,Hr,Nr){const Ar=Fr.width,xr=Fr.height;let ir,_r,ur;const Je=Fr.data;switch(Mr){case Ee.ImageKind.GRAYSCALE_1BPP:_r=0,ir=1,ur=Ar+7>>3;break;case Ee.ImageKind.RGB_24BPP:_r=2,ir=8,ur=Ar*3;break;case Ee.ImageKind.RGBA_32BPP:_r=6,ir=8,ur=Ar*4;break;default:throw new Error("invalid format")}const nr=new Uint8Array((1+ur)*xr);let or=0,lr=0;for(let Pr=0;Pr<xr;++Pr)nr[or++]=0,nr.set(Je.subarray(lr,lr+ur),or),lr+=ur,or+=ur;if(Mr===Ee.ImageKind.GRAYSCALE_1BPP&&Nr){or=0;for(let Pr=0;Pr<xr;Pr++){or++;for(let Er=0;Er<ur;Er++)nr[or++]^=255}}const St=new Uint8Array([Ar>>24&255,Ar>>16&255,Ar>>8&255,Ar&255,xr>>24&255,xr>>16&255,xr>>8&255,xr&255,ir,_r,0,0,0]),dr=Rr(nr),vr=sr.length+ar*3+St.length+dr.length,br=new Uint8Array(vr);let kr=0;return br.set(sr,kr),kr+=sr.length,yr("IHDR",St,br,kr),kr+=ar+St.length,yr("IDATA",dr,br,kr),kr+=ar+dr.length,yr("IEND",new Uint8Array(0),br,kr),Be(br,"image/png",Hr)}return function(Mr,Hr,Nr){const Ar=Mr.kind===void 0?Ee.ImageKind.GRAYSCALE_1BPP:Mr.kind;return wr(Mr,Ar,Hr,Nr)}})();class Ve{constructor(){this.fontSizeScale=1,this.fontWeight=Ce.fontWeight,this.fontSize=0,this.textMatrix=Ee.IDENTITY_MATRIX,this.fontMatrix=Ee.FONT_IDENTITY_MATRIX,this.leading=0,this.textRenderingMode=Ee.TextRenderingMode.FILL,this.textMatrixScale=1,this.x=0,this.y=0,this.lineX=0,this.lineY=0,this.charSpacing=0,this.wordSpacing=0,this.textHScale=1,this.textRise=0,this.fillColor=Ce.fillColor,this.strokeColor="#000000",this.fillAlpha=1,this.strokeAlpha=1,this.lineWidth=1,this.lineJoin="",this.lineCap="",this.miterLimit=0,this.dashArray=[],this.dashPhase=0,this.dependencies=[],this.activeClipUrl=null,this.clipGroup=null,this.maskId=""}clone(){return Object.create(this)}setCurrentPoint(ar,hr){this.x=ar,this.y=hr}}function Xe(sr){let ar=[];const hr=[];for(const pr of sr){if(pr.fn==="save"){ar.push({fnId:92,fn:"group",items:[]}),hr.push(ar),ar=ar.at(-1).items;continue}pr.fn==="restore"?ar=hr.pop():ar.push(pr)}return ar}function We(sr){if(Number.isInteger(sr))return sr.toString();const ar=sr.toFixed(10);let hr=ar.length-1;if(ar[hr]!=="0")return ar;do hr--;while(ar[hr]==="0");return ar.substring(0,ar[hr]==="."?hr:hr+1)}function Ge(sr){if(sr[4]===0&&sr[5]===0){if(sr[1]===0&&sr[2]===0)return sr[0]===1&&sr[3]===1?"":`scale(${We(sr[0])} ${We(sr[3])})`;if(sr[0]===sr[3]&&sr[1]===-sr[2]){const ar=Math.acos(sr[0])*180/Math.PI;return`rotate(${We(ar)})`}}else if(sr[0]===1&&sr[1]===0&&sr[2]===0&&sr[3]===1)return`translate(${We(sr[4])} ${We(sr[5])})`;return`matrix(${We(sr[0])} ${We(sr[1])} ${We(sr[2])} ${We(sr[3])} ${We(sr[4])} ${We(sr[5])})`}let $e=0,Ke=0,rr=0;class tr{constructor(ar,hr,pr=!1){(0,n.deprecated)("The SVG back-end is no longer maintained and *may* be removed in the future."),this.svgFactory=new n.DOMSVGFactory,this.current=new Ve,this.transformMatrix=Ee.IDENTITY_MATRIX,this.transformStack=[],this.extraStack=[],this.commonObjs=ar,this.objs=hr,this.pendingClip=null,this.pendingEOFill=!1,this.embedFonts=!1,this.embeddedFonts=Object.create(null),this.cssStyle=null,this.forceDataSchema=!!pr,this._operatorIdMapping=[];for(const yr in Ee.OPS)this._operatorIdMapping[Ee.OPS[yr]]=yr}getObject(ar,hr=null){return typeof ar=="string"?ar.startsWith("g_")?this.commonObjs.get(ar):this.objs.get(ar):hr}save(){this.transformStack.push(this.transformMatrix);const ar=this.current;this.extraStack.push(ar),this.current=ar.clone()}restore(){this.transformMatrix=this.transformStack.pop(),this.current=this.extraStack.pop(),this.pendingClip=null,this.tgrp=null}group(ar){this.save(),this.executeOpTree(ar),this.restore()}loadDependencies(ar){const hr=ar.fnArray,pr=ar.argsArray;for(let yr=0,fr=hr.length;yr<fr;yr++)if(hr[yr]===Ee.OPS.dependency)for(const Rr of pr[yr]){const mr=Rr.startsWith("g_")?this.commonObjs:this.objs,wr=new Promise(Fr=>{mr.get(Rr,Fr)});this.current.dependencies.push(wr)}return Promise.all(this.current.dependencies)}transform(ar,hr,pr,yr,fr,Rr){const mr=[ar,hr,pr,yr,fr,Rr];this.transformMatrix=Ee.Util.transform(this.transformMatrix,mr),this.tgrp=null}getSVG(ar,hr){this.viewport=hr;const pr=this._initialize(hr);return this.loadDependencies(ar).then(()=>(this.transformMatrix=Ee.IDENTITY_MATRIX,this.executeOpTree(this.convertOpList(ar)),pr))}convertOpList(ar){const hr=this._operatorIdMapping,pr=ar.argsArray,yr=ar.fnArray,fr=[];for(let Rr=0,mr=yr.length;Rr<mr;Rr++){const wr=yr[Rr];fr.push({fnId:wr,fn:hr[wr],args:pr[Rr]})}return Xe(fr)}executeOpTree(ar){for(const hr of ar){const pr=hr.fn,yr=hr.fnId,fr=hr.args;switch(yr|0){case Ee.OPS.beginText:this.beginText();break;case Ee.OPS.dependency:break;case Ee.OPS.setLeading:this.setLeading(fr);break;case Ee.OPS.setLeadingMoveText:this.setLeadingMoveText(fr[0],fr[1]);break;case Ee.OPS.setFont:this.setFont(fr);break;case Ee.OPS.showText:this.showText(fr[0]);break;case Ee.OPS.showSpacedText:this.showText(fr[0]);break;case Ee.OPS.endText:this.endText();break;case Ee.OPS.moveText:this.moveText(fr[0],fr[1]);break;case Ee.OPS.setCharSpacing:this.setCharSpacing(fr[0]);break;case Ee.OPS.setWordSpacing:this.setWordSpacing(fr[0]);break;case Ee.OPS.setHScale:this.setHScale(fr[0]);break;case Ee.OPS.setTextMatrix:this.setTextMatrix(fr[0],fr[1],fr[2],fr[3],fr[4],fr[5]);break;case Ee.OPS.setTextRise:this.setTextRise(fr[0]);break;case Ee.OPS.setTextRenderingMode:this.setTextRenderingMode(fr[0]);break;case Ee.OPS.setLineWidth:this.setLineWidth(fr[0]);break;case Ee.OPS.setLineJoin:this.setLineJoin(fr[0]);break;case Ee.OPS.setLineCap:this.setLineCap(fr[0]);break;case Ee.OPS.setMiterLimit:this.setMiterLimit(fr[0]);break;case Ee.OPS.setFillRGBColor:this.setFillRGBColor(fr[0],fr[1],fr[2]);break;case Ee.OPS.setStrokeRGBColor:this.setStrokeRGBColor(fr[0],fr[1],fr[2]);break;case Ee.OPS.setStrokeColorN:this.setStrokeColorN(fr);break;case Ee.OPS.setFillColorN:this.setFillColorN(fr);break;case Ee.OPS.shadingFill:this.shadingFill(fr[0]);break;case Ee.OPS.setDash:this.setDash(fr[0],fr[1]);break;case Ee.OPS.setRenderingIntent:this.setRenderingIntent(fr[0]);break;case Ee.OPS.setFlatness:this.setFlatness(fr[0]);break;case Ee.OPS.setGState:this.setGState(fr[0]);break;case Ee.OPS.fill:this.fill();break;case Ee.OPS.eoFill:this.eoFill();break;case Ee.OPS.stroke:this.stroke();break;case Ee.OPS.fillStroke:this.fillStroke();break;case Ee.OPS.eoFillStroke:this.eoFillStroke();break;case Ee.OPS.clip:this.clip("nonzero");break;case Ee.OPS.eoClip:this.clip("evenodd");break;case Ee.OPS.paintSolidColorImageMask:this.paintSolidColorImageMask();break;case Ee.OPS.paintImageXObject:this.paintImageXObject(fr[0]);break;case Ee.OPS.paintInlineImageXObject:this.paintInlineImageXObject(fr[0]);break;case Ee.OPS.paintImageMaskXObject:this.paintImageMaskXObject(fr[0]);break;case Ee.OPS.paintFormXObjectBegin:this.paintFormXObjectBegin(fr[0],fr[1]);break;case Ee.OPS.paintFormXObjectEnd:this.paintFormXObjectEnd();break;case Ee.OPS.closePath:this.closePath();break;case Ee.OPS.closeStroke:this.closeStroke();break;case Ee.OPS.closeFillStroke:this.closeFillStroke();break;case Ee.OPS.closeEOFillStroke:this.closeEOFillStroke();break;case Ee.OPS.nextLine:this.nextLine();break;case Ee.OPS.transform:this.transform(fr[0],fr[1],fr[2],fr[3],fr[4],fr[5]);break;case Ee.OPS.constructPath:this.constructPath(fr[0],fr[1]);break;case Ee.OPS.endPath:this.endPath();break;case 92:this.group(hr.items);break;default:(0,Ee.warn)(`Unimplemented operator ${pr}`);break}}}setWordSpacing(ar){this.current.wordSpacing=ar}setCharSpacing(ar){this.current.charSpacing=ar}nextLine(){this.moveText(0,this.current.leading)}setTextMatrix(ar,hr,pr,yr,fr,Rr){const mr=this.current;mr.textMatrix=mr.lineMatrix=[ar,hr,pr,yr,fr,Rr],mr.textMatrixScale=Math.hypot(ar,hr),mr.x=mr.lineX=0,mr.y=mr.lineY=0,mr.xcoords=[],mr.ycoords=[],mr.tspan=this.svgFactory.createElement("svg:tspan"),mr.tspan.setAttributeNS(null,"font-family",mr.fontFamily),mr.tspan.setAttributeNS(null,"font-size",`${We(mr.fontSize)}px`),mr.tspan.setAttributeNS(null,"y",We(-mr.y)),mr.txtElement=this.svgFactory.createElement("svg:text"),mr.txtElement.append(mr.tspan)}beginText(){const ar=this.current;ar.x=ar.lineX=0,ar.y=ar.lineY=0,ar.textMatrix=Ee.IDENTITY_MATRIX,ar.lineMatrix=Ee.IDENTITY_MATRIX,ar.textMatrixScale=1,ar.tspan=this.svgFactory.createElement("svg:tspan"),ar.txtElement=this.svgFactory.createElement("svg:text"),ar.txtgrp=this.svgFactory.createElement("svg:g"),ar.xcoords=[],ar.ycoords=[]}moveText(ar,hr){const pr=this.current;pr.x=pr.lineX+=ar,pr.y=pr.lineY+=hr,pr.xcoords=[],pr.ycoords=[],pr.tspan=this.svgFactory.createElement("svg:tspan"),pr.tspan.setAttributeNS(null,"font-family",pr.fontFamily),pr.tspan.setAttributeNS(null,"font-size",`${We(pr.fontSize)}px`),pr.tspan.setAttributeNS(null,"y",We(-pr.y))}showText(ar){const hr=this.current,pr=hr.font,yr=hr.fontSize;if(yr===0)return;const fr=hr.fontSizeScale,Rr=hr.charSpacing,mr=hr.wordSpacing,wr=hr.fontDirection,Fr=hr.textHScale*wr,Mr=pr.vertical,Hr=Mr?1:-1,Nr=pr.defaultVMetrics,Ar=yr*hr.fontMatrix[0];let xr=0;for(const ur of ar){if(ur===null){xr+=wr*mr;continue}else if(typeof ur=="number"){xr+=Hr*ur*yr/1e3;continue}const Je=(ur.isSpace?mr:0)+Rr,nr=ur.fontChar;let or,lr,St=ur.width;if(Mr){let vr;const br=ur.vmetric||Nr;vr=ur.vmetric?br[1]:St*.5,vr=-vr*Ar;const kr=br[2]*Ar;St=br?-br[0]:St,or=vr/fr,lr=(xr+kr)/fr}else or=xr/fr,lr=0;(ur.isInFont||pr.missingFile)&&(hr.xcoords.push(hr.x+or),Mr&&hr.ycoords.push(-hr.y+lr),hr.tspan.textContent+=nr);const dr=Mr?St*Ar-Je*wr:St*Ar+Je*wr;xr+=dr}hr.tspan.setAttributeNS(null,"x",hr.xcoords.map(We).join(" ")),Mr?hr.tspan.setAttributeNS(null,"y",hr.ycoords.map(We).join(" ")):hr.tspan.setAttributeNS(null,"y",We(-hr.y)),Mr?hr.y-=xr:hr.x+=xr*Fr,hr.tspan.setAttributeNS(null,"font-family",hr.fontFamily),hr.tspan.setAttributeNS(null,"font-size",`${We(hr.fontSize)}px`),hr.fontStyle!==Ce.fontStyle&&hr.tspan.setAttributeNS(null,"font-style",hr.fontStyle),hr.fontWeight!==Ce.fontWeight&&hr.tspan.setAttributeNS(null,"font-weight",hr.fontWeight);const ir=hr.textRenderingMode&Ee.TextRenderingMode.FILL_STROKE_MASK;if(ir===Ee.TextRenderingMode.FILL||ir===Ee.TextRenderingMode.FILL_STROKE?(hr.fillColor!==Ce.fillColor&&hr.tspan.setAttributeNS(null,"fill",hr.fillColor),hr.fillAlpha<1&&hr.tspan.setAttributeNS(null,"fill-opacity",hr.fillAlpha)):hr.textRenderingMode===Ee.TextRenderingMode.ADD_TO_PATH?hr.tspan.setAttributeNS(null,"fill","transparent"):hr.tspan.setAttributeNS(null,"fill","none"),ir===Ee.TextRenderingMode.STROKE||ir===Ee.TextRenderingMode.FILL_STROKE){const ur=1/(hr.textMatrixScale||1);this._setStrokeAttributes(hr.tspan,ur)}let _r=hr.textMatrix;hr.textRise!==0&&(_r=_r.slice(),_r[5]+=hr.textRise),hr.txtElement.setAttributeNS(null,"transform",`${Ge(_r)} scale(${We(Fr)}, -1)`),hr.txtElement.setAttributeNS(De,"xml:space","preserve"),hr.txtElement.append(hr.tspan),hr.txtgrp.append(hr.txtElement),this._ensureTransformGroup().append(hr.txtElement)}setLeadingMoveText(ar,hr){this.setLeading(-hr),this.moveText(ar,hr)}addFontStyle(ar){if(!ar.data)throw new Error('addFontStyle: No font data available, ensure that the "fontExtraProperties" API parameter is set.');this.cssStyle||(this.cssStyle=this.svgFactory.createElement("svg:style"),this.cssStyle.setAttributeNS(null,"type","text/css"),this.defs.append(this.cssStyle));const hr=Be(ar.data,ar.mimetype,this.forceDataSchema);this.cssStyle.textContent+=`@font-face { font-family: "${ar.loadedName}"; src: url(${hr}); }
`}setFont(ar){const hr=this.current,pr=this.commonObjs.get(ar[0]);let yr=ar[1];hr.font=pr,this.embedFonts&&!pr.missingFile&&!this.embeddedFonts[pr.loadedName]&&(this.addFontStyle(pr),this.embeddedFonts[pr.loadedName]=pr),hr.fontMatrix=pr.fontMatrix||Ee.FONT_IDENTITY_MATRIX;let fr="normal";pr.black?fr="900":pr.bold&&(fr="bold");const Rr=pr.italic?"italic":"normal";yr<0?(yr=-yr,hr.fontDirection=-1):hr.fontDirection=1,hr.fontSize=yr,hr.fontFamily=pr.loadedName,hr.fontWeight=fr,hr.fontStyle=Rr,hr.tspan=this.svgFactory.createElement("svg:tspan"),hr.tspan.setAttributeNS(null,"y",We(-hr.y)),hr.xcoords=[],hr.ycoords=[]}endText(){const ar=this.current;ar.textRenderingMode&Ee.TextRenderingMode.ADD_TO_PATH_FLAG&&ar.txtElement?.hasChildNodes()&&(ar.element=ar.txtElement,this.clip("nonzero"),this.endPath())}setLineWidth(ar){ar>0&&(this.current.lineWidth=ar)}setLineCap(ar){this.current.lineCap=ze[ar]}setLineJoin(ar){this.current.lineJoin=Oe[ar]}setMiterLimit(ar){this.current.miterLimit=ar}setStrokeAlpha(ar){this.current.strokeAlpha=ar}setStrokeRGBColor(ar,hr,pr){this.current.strokeColor=Ee.Util.makeHexColor(ar,hr,pr)}setFillAlpha(ar){this.current.fillAlpha=ar}setFillRGBColor(ar,hr,pr){this.current.fillColor=Ee.Util.makeHexColor(ar,hr,pr),this.current.tspan=this.svgFactory.createElement("svg:tspan"),this.current.xcoords=[],this.current.ycoords=[]}setStrokeColorN(ar){this.current.strokeColor=this._makeColorN_Pattern(ar)}setFillColorN(ar){this.current.fillColor=this._makeColorN_Pattern(ar)}shadingFill(ar){const{width:hr,height:pr}=this.viewport,yr=Ee.Util.inverseTransform(this.transformMatrix),[fr,Rr,mr,wr]=Ee.Util.getAxialAlignedBoundingBox([0,0,hr,pr],yr),Fr=this.svgFactory.createElement("svg:rect");Fr.setAttributeNS(null,"x",fr),Fr.setAttributeNS(null,"y",Rr),Fr.setAttributeNS(null,"width",mr-fr),Fr.setAttributeNS(null,"height",wr-Rr),Fr.setAttributeNS(null,"fill",this._makeShadingPattern(ar)),this.current.fillAlpha<1&&Fr.setAttributeNS(null,"fill-opacity",this.current.fillAlpha),this._ensureTransformGroup().append(Fr)}_makeColorN_Pattern(ar){return ar[0]==="TilingPattern"?this._makeTilingPattern(ar):this._makeShadingPattern(ar)}_makeTilingPattern(ar){const hr=ar[1],pr=ar[2],yr=ar[3]||Ee.IDENTITY_MATRIX,[fr,Rr,mr,wr]=ar[4],Fr=ar[5],Mr=ar[6],Hr=ar[7],Nr=`shading${rr++}`,[Ar,xr,ir,_r]=Ee.Util.normalizeRect([...Ee.Util.applyTransform([fr,Rr],yr),...Ee.Util.applyTransform([mr,wr],yr)]),[ur,Je]=Ee.Util.singularValueDecompose2dScale(yr),nr=Fr*ur,or=Mr*Je,lr=this.svgFactory.createElement("svg:pattern");lr.setAttributeNS(null,"id",Nr),lr.setAttributeNS(null,"patternUnits","userSpaceOnUse"),lr.setAttributeNS(null,"width",nr),lr.setAttributeNS(null,"height",or),lr.setAttributeNS(null,"x",`${Ar}`),lr.setAttributeNS(null,"y",`${xr}`);const St=this.svg,dr=this.transformMatrix,vr=this.current.fillColor,br=this.current.strokeColor,kr=this.svgFactory.create(ir-Ar,_r-xr);if(this.svg=kr,this.transformMatrix=yr,Hr===2){const Pr=Ee.Util.makeHexColor(...hr);this.current.fillColor=Pr,this.current.strokeColor=Pr}return this.executeOpTree(this.convertOpList(pr)),this.svg=St,this.transformMatrix=dr,this.current.fillColor=vr,this.current.strokeColor=br,lr.append(kr.childNodes[0]),this.defs.append(lr),`url(#${Nr})`}_makeShadingPattern(ar){switch(typeof ar=="string"&&(ar=this.objs.get(ar)),ar[0]){case"RadialAxial":const hr=`shading${rr++}`,pr=ar[3];let yr;switch(ar[1]){case"axial":const fr=ar[4],Rr=ar[5];yr=this.svgFactory.createElement("svg:linearGradient"),yr.setAttributeNS(null,"id",hr),yr.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),yr.setAttributeNS(null,"x1",fr[0]),yr.setAttributeNS(null,"y1",fr[1]),yr.setAttributeNS(null,"x2",Rr[0]),yr.setAttributeNS(null,"y2",Rr[1]);break;case"radial":const mr=ar[4],wr=ar[5],Fr=ar[6],Mr=ar[7];yr=this.svgFactory.createElement("svg:radialGradient"),yr.setAttributeNS(null,"id",hr),yr.setAttributeNS(null,"gradientUnits","userSpaceOnUse"),yr.setAttributeNS(null,"cx",wr[0]),yr.setAttributeNS(null,"cy",wr[1]),yr.setAttributeNS(null,"r",Mr),yr.setAttributeNS(null,"fx",mr[0]),yr.setAttributeNS(null,"fy",mr[1]),yr.setAttributeNS(null,"fr",Fr);break;default:throw new Error(`Unknown RadialAxial type: ${ar[1]}`)}for(const fr of pr){const Rr=this.svgFactory.createElement("svg:stop");Rr.setAttributeNS(null,"offset",fr[0]),Rr.setAttributeNS(null,"stop-color",fr[1]),yr.append(Rr)}return this.defs.append(yr),`url(#${hr})`;case"Mesh":return(0,Ee.warn)("Unimplemented pattern Mesh"),null;case"Dummy":return"hotpink";default:throw new Error(`Unknown IR type: ${ar[0]}`)}}setDash(ar,hr){this.current.dashArray=ar,this.current.dashPhase=hr}constructPath(ar,hr){const pr=this.current;let yr=pr.x,fr=pr.y,Rr=[],mr=0;for(const wr of ar)switch(wr|0){case Ee.OPS.rectangle:yr=hr[mr++],fr=hr[mr++];const Fr=hr[mr++],Mr=hr[mr++],Hr=yr+Fr,Nr=fr+Mr;Rr.push("M",We(yr),We(fr),"L",We(Hr),We(fr),"L",We(Hr),We(Nr),"L",We(yr),We(Nr),"Z");break;case Ee.OPS.moveTo:yr=hr[mr++],fr=hr[mr++],Rr.push("M",We(yr),We(fr));break;case Ee.OPS.lineTo:yr=hr[mr++],fr=hr[mr++],Rr.push("L",We(yr),We(fr));break;case Ee.OPS.curveTo:yr=hr[mr+4],fr=hr[mr+5],Rr.push("C",We(hr[mr]),We(hr[mr+1]),We(hr[mr+2]),We(hr[mr+3]),We(yr),We(fr)),mr+=6;break;case Ee.OPS.curveTo2:Rr.push("C",We(yr),We(fr),We(hr[mr]),We(hr[mr+1]),We(hr[mr+2]),We(hr[mr+3])),yr=hr[mr+2],fr=hr[mr+3],mr+=4;break;case Ee.OPS.curveTo3:yr=hr[mr+2],fr=hr[mr+3],Rr.push("C",We(hr[mr]),We(hr[mr+1]),We(yr),We(fr),We(yr),We(fr)),mr+=4;break;case Ee.OPS.closePath:Rr.push("Z");break}Rr=Rr.join(" "),pr.path&&ar.length>0&&ar[0]!==Ee.OPS.rectangle&&ar[0]!==Ee.OPS.moveTo?Rr=pr.path.getAttributeNS(null,"d")+Rr:(pr.path=this.svgFactory.createElement("svg:path"),this._ensureTransformGroup().append(pr.path)),pr.path.setAttributeNS(null,"d",Rr),pr.path.setAttributeNS(null,"fill","none"),pr.element=pr.path,pr.setCurrentPoint(yr,fr)}endPath(){const ar=this.current;if(ar.path=null,!this.pendingClip)return;if(!ar.element){this.pendingClip=null;return}const hr=`clippath${$e++}`,pr=this.svgFactory.createElement("svg:clipPath");pr.setAttributeNS(null,"id",hr),pr.setAttributeNS(null,"transform",Ge(this.transformMatrix));const yr=ar.element.cloneNode(!0);if(this.pendingClip==="evenodd"?yr.setAttributeNS(null,"clip-rule","evenodd"):yr.setAttributeNS(null,"clip-rule","nonzero"),this.pendingClip=null,pr.append(yr),this.defs.append(pr),ar.activeClipUrl){ar.clipGroup=null;for(const fr of this.extraStack)fr.clipGroup=null;pr.setAttributeNS(null,"clip-path",ar.activeClipUrl)}ar.activeClipUrl=`url(#${hr})`,this.tgrp=null}clip(ar){this.pendingClip=ar}closePath(){const ar=this.current;if(ar.path){const hr=`${ar.path.getAttributeNS(null,"d")}Z`;ar.path.setAttributeNS(null,"d",hr)}}setLeading(ar){this.current.leading=-ar}setTextRise(ar){this.current.textRise=ar}setTextRenderingMode(ar){this.current.textRenderingMode=ar}setHScale(ar){this.current.textHScale=ar/100}setRenderingIntent(ar){}setFlatness(ar){}setGState(ar){for(const[hr,pr]of ar)switch(hr){case"LW":this.setLineWidth(pr);break;case"LC":this.setLineCap(pr);break;case"LJ":this.setLineJoin(pr);break;case"ML":this.setMiterLimit(pr);break;case"D":this.setDash(pr[0],pr[1]);break;case"RI":this.setRenderingIntent(pr);break;case"FL":this.setFlatness(pr);break;case"Font":this.setFont(pr);break;case"CA":this.setStrokeAlpha(pr);break;case"ca":this.setFillAlpha(pr);break;default:(0,Ee.warn)(`Unimplemented graphic state operator ${hr}`);break}}fill(){const ar=this.current;ar.element&&(ar.element.setAttributeNS(null,"fill",ar.fillColor),ar.element.setAttributeNS(null,"fill-opacity",ar.fillAlpha),this.endPath())}stroke(){const ar=this.current;ar.element&&(this._setStrokeAttributes(ar.element),ar.element.setAttributeNS(null,"fill","none"),this.endPath())}_setStrokeAttributes(ar,hr=1){const pr=this.current;let yr=pr.dashArray;hr!==1&&yr.length>0&&(yr=yr.map(function(fr){return hr*fr})),ar.setAttributeNS(null,"stroke",pr.strokeColor),ar.setAttributeNS(null,"stroke-opacity",pr.strokeAlpha),ar.setAttributeNS(null,"stroke-miterlimit",We(pr.miterLimit)),ar.setAttributeNS(null,"stroke-linecap",pr.lineCap),ar.setAttributeNS(null,"stroke-linejoin",pr.lineJoin),ar.setAttributeNS(null,"stroke-width",We(hr*pr.lineWidth)+"px"),ar.setAttributeNS(null,"stroke-dasharray",yr.map(We).join(" ")),ar.setAttributeNS(null,"stroke-dashoffset",We(hr*pr.dashPhase)+"px")}eoFill(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fill()}fillStroke(){this.stroke(),this.fill()}eoFillStroke(){this.current.element?.setAttributeNS(null,"fill-rule","evenodd"),this.fillStroke()}closeStroke(){this.closePath(),this.stroke()}closeFillStroke(){this.closePath(),this.fillStroke()}closeEOFillStroke(){this.closePath(),this.eoFillStroke()}paintSolidColorImageMask(){const ar=this.svgFactory.createElement("svg:rect");ar.setAttributeNS(null,"x","0"),ar.setAttributeNS(null,"y","0"),ar.setAttributeNS(null,"width","1px"),ar.setAttributeNS(null,"height","1px"),ar.setAttributeNS(null,"fill",this.current.fillColor),this._ensureTransformGroup().append(ar)}paintImageXObject(ar){const hr=this.getObject(ar);if(!hr){(0,Ee.warn)(`Dependent image with object ID ${ar} is not ready yet`);return}this.paintInlineImageXObject(hr)}paintInlineImageXObject(ar,hr){const pr=ar.width,yr=ar.height,fr=He(ar,this.forceDataSchema,!!hr),Rr=this.svgFactory.createElement("svg:rect");Rr.setAttributeNS(null,"x","0"),Rr.setAttributeNS(null,"y","0"),Rr.setAttributeNS(null,"width",We(pr)),Rr.setAttributeNS(null,"height",We(yr)),this.current.element=Rr,this.clip("nonzero");const mr=this.svgFactory.createElement("svg:image");mr.setAttributeNS(Me,"xlink:href",fr),mr.setAttributeNS(null,"x","0"),mr.setAttributeNS(null,"y",We(-yr)),mr.setAttributeNS(null,"width",We(pr)+"px"),mr.setAttributeNS(null,"height",We(yr)+"px"),mr.setAttributeNS(null,"transform",`scale(${We(1/pr)} ${We(-1/yr)})`),hr?hr.append(mr):this._ensureTransformGroup().append(mr)}paintImageMaskXObject(ar){const hr=this.getObject(ar.data,ar);if(hr.bitmap){(0,Ee.warn)("paintImageMaskXObject: ImageBitmap support is not implemented, ensure that the `isOffscreenCanvasSupported` API parameter is disabled.");return}const pr=this.current,yr=hr.width,fr=hr.height,Rr=pr.fillColor;pr.maskId=`mask${Ke++}`;const mr=this.svgFactory.createElement("svg:mask");mr.setAttributeNS(null,"id",pr.maskId);const wr=this.svgFactory.createElement("svg:rect");wr.setAttributeNS(null,"x","0"),wr.setAttributeNS(null,"y","0"),wr.setAttributeNS(null,"width",We(yr)),wr.setAttributeNS(null,"height",We(fr)),wr.setAttributeNS(null,"fill",Rr),wr.setAttributeNS(null,"mask",`url(#${pr.maskId})`),this.defs.append(mr),this._ensureTransformGroup().append(wr),this.paintInlineImageXObject(hr,mr)}paintFormXObjectBegin(ar,hr){if(Array.isArray(ar)&&ar.length===6&&this.transform(ar[0],ar[1],ar[2],ar[3],ar[4],ar[5]),hr){const pr=hr[2]-hr[0],yr=hr[3]-hr[1],fr=this.svgFactory.createElement("svg:rect");fr.setAttributeNS(null,"x",hr[0]),fr.setAttributeNS(null,"y",hr[1]),fr.setAttributeNS(null,"width",We(pr)),fr.setAttributeNS(null,"height",We(yr)),this.current.element=fr,this.clip("nonzero"),this.endPath()}}paintFormXObjectEnd(){}_initialize(ar){const hr=this.svgFactory.create(ar.width,ar.height),pr=this.svgFactory.createElement("svg:defs");hr.append(pr),this.defs=pr;const yr=this.svgFactory.createElement("svg:g");return yr.setAttributeNS(null,"transform",Ge(ar.transform)),hr.append(yr),this.svg=yr,hr}_ensureClipGroup(){if(!this.current.clipGroup){const ar=this.svgFactory.createElement("svg:g");ar.setAttributeNS(null,"clip-path",this.current.activeClipUrl),this.svg.append(ar),this.current.clipGroup=ar}return this.current.clipGroup}_ensureTransformGroup(){return this.tgrp||(this.tgrp=this.svgFactory.createElement("svg:g"),this.tgrp.setAttributeNS(null,"transform",Ge(this.transformMatrix)),this.current.activeClipUrl?this._ensureClipGroup().append(this.tgrp):this.svg.append(this.tgrp)),this.tgrp}}t.SVGGraphics=tr}),((e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaText=void 0;class r{static textContent(Ee){const Ce=[],De={items:Ce,styles:Object.create(null)};function Me(ze){if(!ze)return;let Oe=null;const Be=ze.name;if(Be==="#text")Oe=ze.value;else if(r.shouldBuildText(Be))ze?.attributes?.textContent?Oe=ze.attributes.textContent:ze.value&&(Oe=ze.value);else return;if(Oe!==null&&Ce.push({str:Oe}),!!ze.children)for(const He of ze.children)Me(He)}return Me(Ee),De}static shouldBuildText(Ee){return!(Ee==="textarea"||Ee==="input"||Ee==="option"||Ee==="select")}}t.XfaText=r}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TextLayerRenderTask=void 0,t.renderTextLayer=Ge,t.updateTextLayer=$e;var n=r(1),Ee=r(6);const Ce=1e5,De=30,Me=.8,ze=new Map;function Oe(Ke,rr){let tr;if(rr&&n.FeatureTest.isOffscreenCanvasSupported)tr=new OffscreenCanvas(Ke,Ke).getContext("2d",{alpha:!1});else{const sr=document.createElement("canvas");sr.width=sr.height=Ke,tr=sr.getContext("2d",{alpha:!1})}return tr}function Be(Ke,rr){const tr=ze.get(Ke);if(tr)return tr;const sr=Oe(De,rr);sr.font=`${De}px ${Ke}`;const ar=sr.measureText("");let hr=ar.fontBoundingBoxAscent,pr=Math.abs(ar.fontBoundingBoxDescent);if(hr){const fr=hr/(hr+pr);return ze.set(Ke,fr),sr.canvas.width=sr.canvas.height=0,fr}sr.strokeStyle="red",sr.clearRect(0,0,De,De),sr.strokeText("g",0,0);let yr=sr.getImageData(0,0,De,De).data;pr=0;for(let fr=yr.length-1-3;fr>=0;fr-=4)if(yr[fr]>0){pr=Math.ceil(fr/4/De);break}sr.clearRect(0,0,De,De),sr.strokeText("A",0,De),yr=sr.getImageData(0,0,De,De).data,hr=0;for(let fr=0,Rr=yr.length;fr<Rr;fr+=4)if(yr[fr]>0){hr=De-Math.floor(fr/4/De);break}if(sr.canvas.width=sr.canvas.height=0,hr){const fr=hr/(hr+pr);return ze.set(Ke,fr),fr}return ze.set(Ke,Me),Me}function He(Ke,rr,tr){const sr=document.createElement("span"),ar={angle:0,canvasWidth:0,hasText:rr.str!=="",hasEOL:rr.hasEOL,fontSize:0};Ke._textDivs.push(sr);const hr=n.Util.transform(Ke._transform,rr.transform);let pr=Math.atan2(hr[1],hr[0]);const yr=tr[rr.fontName];yr.vertical&&(pr+=Math.PI/2);const fr=Math.hypot(hr[2],hr[3]),Rr=fr*Be(yr.fontFamily,Ke._isOffscreenCanvasSupported);let mr,wr;pr===0?(mr=hr[4],wr=hr[5]-Rr):(mr=hr[4]+Rr*Math.sin(pr),wr=hr[5]-Rr*Math.cos(pr));const Fr="calc(var(--scale-factor)*",Mr=sr.style;Ke._container===Ke._rootContainer?(Mr.left=`${(100*mr/Ke._pageWidth).toFixed(2)}%`,Mr.top=`${(100*wr/Ke._pageHeight).toFixed(2)}%`):(Mr.left=`${Fr}${mr.toFixed(2)}px)`,Mr.top=`${Fr}${wr.toFixed(2)}px)`),Mr.fontSize=`${Fr}${fr.toFixed(2)}px)`,Mr.fontFamily=yr.fontFamily,ar.fontSize=fr,sr.setAttribute("role","presentation"),sr.textContent=rr.str,sr.dir=rr.dir,Ke._fontInspectorEnabled&&(sr.dataset.fontName=rr.fontName),pr!==0&&(ar.angle=pr*(180/Math.PI));let Hr=!1;if(rr.str.length>1)Hr=!0;else if(rr.str!==" "&&rr.transform[0]!==rr.transform[3]){const Nr=Math.abs(rr.transform[0]),Ar=Math.abs(rr.transform[3]);Nr!==Ar&&Math.max(Nr,Ar)/Math.min(Nr,Ar)>1.5&&(Hr=!0)}Hr&&(ar.canvasWidth=yr.vertical?rr.height:rr.width),Ke._textDivProperties.set(sr,ar),Ke._isReadableStream&&Ke._layoutText(sr)}function Ve(Ke){const{div:rr,scale:tr,properties:sr,ctx:ar,prevFontSize:hr,prevFontFamily:pr}=Ke,{style:yr}=rr;let fr="";if(sr.canvasWidth!==0&&sr.hasText){const{fontFamily:Rr}=yr,{canvasWidth:mr,fontSize:wr}=sr;(hr!==wr||pr!==Rr)&&(ar.font=`${wr*tr}px ${Rr}`,Ke.prevFontSize=wr,Ke.prevFontFamily=Rr);const{width:Fr}=ar.measureText(rr.textContent);Fr>0&&(fr=`scaleX(${mr*tr/Fr})`)}sr.angle!==0&&(fr=`rotate(${sr.angle}deg) ${fr}`),fr.length>0&&(yr.transform=fr)}function Xe(Ke){if(Ke._canceled)return;const rr=Ke._textDivs,tr=Ke._capability;if(rr.length>Ce){tr.resolve();return}if(!Ke._isReadableStream)for(const ar of rr)Ke._layoutText(ar);tr.resolve()}class We{constructor({textContentSource:rr,container:tr,viewport:sr,textDivs:ar,textDivProperties:hr,textContentItemsStr:pr,isOffscreenCanvasSupported:yr}){this._textContentSource=rr,this._isReadableStream=rr instanceof ReadableStream,this._container=this._rootContainer=tr,this._textDivs=ar||[],this._textContentItemsStr=pr||[],this._isOffscreenCanvasSupported=yr,this._fontInspectorEnabled=!!globalThis.FontInspector?.enabled,this._reader=null,this._textDivProperties=hr||new WeakMap,this._canceled=!1,this._capability=new n.PromiseCapability,this._layoutTextParams={prevFontSize:null,prevFontFamily:null,div:null,scale:sr.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:Oe(0,yr)};const{pageWidth:fr,pageHeight:Rr,pageX:mr,pageY:wr}=sr.rawDims;this._transform=[1,0,0,-1,-mr,wr+Rr],this._pageWidth=fr,this._pageHeight=Rr,(0,Ee.setLayerDimensions)(tr,sr),this._capability.promise.finally(()=>{this._layoutTextParams=null}).catch(()=>{})}get promise(){return this._capability.promise}cancel(){this._canceled=!0,this._reader&&(this._reader.cancel(new n.AbortException("TextLayer task cancelled.")).catch(()=>{}),this._reader=null),this._capability.reject(new n.AbortException("TextLayer task cancelled."))}_processItems(rr,tr){for(const sr of rr){if(sr.str===void 0){if(sr.type==="beginMarkedContentProps"||sr.type==="beginMarkedContent"){const ar=this._container;this._container=document.createElement("span"),this._container.classList.add("markedContent"),sr.id!==null&&this._container.setAttribute("id",`${sr.id}`),ar.append(this._container)}else sr.type==="endMarkedContent"&&(this._container=this._container.parentNode);continue}this._textContentItemsStr.push(sr.str),He(this,sr,tr)}}_layoutText(rr){const tr=this._layoutTextParams.properties=this._textDivProperties.get(rr);if(this._layoutTextParams.div=rr,Ve(this._layoutTextParams),tr.hasText&&this._container.append(rr),tr.hasEOL){const sr=document.createElement("br");sr.setAttribute("role","presentation"),this._container.append(sr)}}_render(){const rr=new n.PromiseCapability;let tr=Object.create(null);if(this._isReadableStream){const sr=()=>{this._reader.read().then(({value:ar,done:hr})=>{if(hr){rr.resolve();return}Object.assign(tr,ar.styles),this._processItems(ar.items,tr),sr()},rr.reject)};this._reader=this._textContentSource.getReader(),sr()}else if(this._textContentSource){const{items:sr,styles:ar}=this._textContentSource;this._processItems(sr,ar),rr.resolve()}else throw new Error('No "textContentSource" parameter specified.');rr.promise.then(()=>{tr=null,Xe(this)},this._capability.reject)}}t.TextLayerRenderTask=We;function Ge(Ke){!Ke.textContentSource&&(Ke.textContent||Ke.textContentStream)&&((0,Ee.deprecated)("The TextLayerRender `textContent`/`textContentStream` parameters will be removed in the future, please use `textContentSource` instead."),Ke.textContentSource=Ke.textContent||Ke.textContentStream);const{container:rr,viewport:tr}=Ke,sr=getComputedStyle(rr),ar=sr.getPropertyValue("visibility"),hr=parseFloat(sr.getPropertyValue("--scale-factor"));ar==="visible"&&(!hr||Math.abs(hr-tr.scale)>1e-5)&&console.error("The `--scale-factor` CSS-variable must be set, to the same value as `viewport.scale`, either on the `container`-element itself or higher up in the DOM.");const pr=new We(Ke);return pr._render(),pr}function $e({container:Ke,viewport:rr,textDivs:tr,textDivProperties:sr,isOffscreenCanvasSupported:ar,mustRotate:hr=!0,mustRescale:pr=!0}){if(hr&&(0,Ee.setLayerDimensions)(Ke,{rotation:rr.rotation}),pr){const yr=Oe(0,ar),Rr={prevFontSize:null,prevFontFamily:null,div:null,scale:rr.scale*(globalThis.devicePixelRatio||1),properties:null,ctx:yr};for(const mr of tr)Rr.properties=sr.get(mr),Rr.div=mr,Ve(Rr)}}}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AnnotationEditorLayer=void 0;var n=r(1),Ee=r(4),Ce=r(28),De=r(33),Me=r(6),ze=r(34);class Oe{#e;#t=!1;#r=null;#a=this.pointerup.bind(this);#o=this.pointerdown.bind(this);#s=new Map;#i=!1;#l=!1;#c=!1;#n;static _initialized=!1;constructor({uiManager:He,pageIndex:Ve,div:Xe,accessibilityManager:We,annotationLayer:Ge,viewport:$e,l10n:Ke}){const rr=[Ce.FreeTextEditor,De.InkEditor,ze.StampEditor];if(!Oe._initialized){Oe._initialized=!0;for(const tr of rr)tr.initialize(Ke)}He.registerEditorTypes(rr),this.#n=He,this.pageIndex=Ve,this.div=Xe,this.#e=We,this.#r=Ge,this.viewport=$e,this.#n.addLayer(this)}get isEmpty(){return this.#s.size===0}updateToolbar(He){this.#n.updateToolbar(He)}updateMode(He=this.#n.getMode()){this.#p(),He===n.AnnotationEditorType.INK?(this.addInkEditorIfNeeded(!1),this.disableClick()):this.enableClick(),He!==n.AnnotationEditorType.NONE&&(this.div.classList.toggle("freeTextEditing",He===n.AnnotationEditorType.FREETEXT),this.div.classList.toggle("inkEditing",He===n.AnnotationEditorType.INK),this.div.classList.toggle("stampEditing",He===n.AnnotationEditorType.STAMP),this.div.hidden=!1)}addInkEditorIfNeeded(He){if(!He&&this.#n.getMode()!==n.AnnotationEditorType.INK)return;if(!He){for(const Xe of this.#s.values())if(Xe.isEmpty()){Xe.setInBackground();return}}this.#f({offsetX:0,offsetY:0},!1).setInBackground()}setEditingState(He){this.#n.setEditingState(He)}addCommands(He){this.#n.addCommands(He)}enable(){this.div.style.pointerEvents="auto";const He=new Set;for(const Xe of this.#s.values())Xe.enableEditing(),Xe.annotationElementId&&He.add(Xe.annotationElementId);if(!this.#r)return;const Ve=this.#r.getEditableAnnotations();for(const Xe of Ve){if(Xe.hide(),this.#n.isDeletedAnnotationElement(Xe.data.id)||He.has(Xe.data.id))continue;const We=this.deserialize(Xe);We&&(this.addOrRebuild(We),We.enableEditing())}}disable(){this.#c=!0,this.div.style.pointerEvents="none";const He=new Set;for(const Ve of this.#s.values()){if(Ve.disableEditing(),!Ve.annotationElementId||Ve.serialize()!==null){He.add(Ve.annotationElementId);continue}this.getEditableAnnotation(Ve.annotationElementId)?.show(),Ve.remove()}if(this.#r){const Ve=this.#r.getEditableAnnotations();for(const Xe of Ve){const{id:We}=Xe.data;He.has(We)||this.#n.isDeletedAnnotationElement(We)||Xe.show()}}this.#p(),this.isEmpty&&(this.div.hidden=!0),this.#c=!1}getEditableAnnotation(He){return this.#r?.getEditableAnnotation(He)||null}setActiveEditor(He){this.#n.getActive()!==He&&this.#n.setActiveEditor(He)}enableClick(){this.div.addEventListener("pointerdown",this.#o),this.div.addEventListener("pointerup",this.#a)}disableClick(){this.div.removeEventListener("pointerdown",this.#o),this.div.removeEventListener("pointerup",this.#a)}attach(He){this.#s.set(He.id,He);const{annotationElementId:Ve}=He;Ve&&this.#n.isDeletedAnnotationElement(Ve)&&this.#n.removeDeletedAnnotationElement(He)}detach(He){this.#s.delete(He.id),this.#e?.removePointerInTextLayer(He.contentDiv),!this.#c&&He.annotationElementId&&this.#n.addDeletedAnnotationElement(He)}remove(He){this.detach(He),this.#n.removeEditor(He),He.div.contains(document.activeElement)&&setTimeout(()=>{this.#n.focusMainContainer()},0),He.div.remove(),He.isAttachedToDOM=!1,this.#l||this.addInkEditorIfNeeded(!1)}changeParent(He){He.parent!==this&&(He.annotationElementId&&(this.#n.addDeletedAnnotationElement(He.annotationElementId),Ee.AnnotationEditor.deleteAnnotationElement(He),He.annotationElementId=null),this.attach(He),He.parent?.detach(He),He.setParent(this),He.div&&He.isAttachedToDOM&&(He.div.remove(),this.div.append(He.div)))}add(He){if(this.changeParent(He),this.#n.addEditor(He),this.attach(He),!He.isAttachedToDOM){const Ve=He.render();this.div.append(Ve),He.isAttachedToDOM=!0}He.fixAndSetPosition(),He.onceAdded(),this.#n.addToAnnotationStorage(He)}moveEditorInDOM(He){if(!He.isAttachedToDOM)return;const{activeElement:Ve}=document;He.div.contains(Ve)&&(He._focusEventsAllowed=!1,setTimeout(()=>{He.div.contains(document.activeElement)?He._focusEventsAllowed=!0:(He.div.addEventListener("focusin",()=>{He._focusEventsAllowed=!0},{once:!0}),Ve.focus())},0)),He._structTreeParentId=this.#e?.moveElementInDOM(this.div,He.div,He.contentDiv,!0)}addOrRebuild(He){He.needsToBeRebuilt()?He.rebuild():this.add(He)}addUndoableEditor(He){const Ve=()=>He._uiManager.rebuild(He),Xe=()=>{He.remove()};this.addCommands({cmd:Ve,undo:Xe,mustExec:!1})}getNextId(){return this.#n.getId()}#d(He){switch(this.#n.getMode()){case n.AnnotationEditorType.FREETEXT:return new Ce.FreeTextEditor(He);case n.AnnotationEditorType.INK:return new De.InkEditor(He);case n.AnnotationEditorType.STAMP:return new ze.StampEditor(He)}return null}pasteEditor(He,Ve){this.#n.updateToolbar(He),this.#n.updateMode(He);const{offsetX:Xe,offsetY:We}=this.#h(),Ge=this.getNextId(),$e=this.#d({parent:this,id:Ge,x:Xe,y:We,uiManager:this.#n,isCentered:!0,...Ve});$e&&this.add($e)}deserialize(He){switch(He.annotationType??He.annotationEditorType){case n.AnnotationEditorType.FREETEXT:return Ce.FreeTextEditor.deserialize(He,this,this.#n);case n.AnnotationEditorType.INK:return De.InkEditor.deserialize(He,this,this.#n);case n.AnnotationEditorType.STAMP:return ze.StampEditor.deserialize(He,this,this.#n)}return null}#f(He,Ve){const Xe=this.getNextId(),We=this.#d({parent:this,id:Xe,x:He.offsetX,y:He.offsetY,uiManager:this.#n,isCentered:Ve});return We&&this.add(We),We}#h(){const{x:He,y:Ve,width:Xe,height:We}=this.div.getBoundingClientRect(),Ge=Math.max(0,He),$e=Math.max(0,Ve),Ke=Math.min(window.innerWidth,He+Xe),rr=Math.min(window.innerHeight,Ve+We),tr=(Ge+Ke)/2-He,sr=($e+rr)/2-Ve,[ar,hr]=this.viewport.rotation%180===0?[tr,sr]:[sr,tr];return{offsetX:ar,offsetY:hr}}addNewEditor(){this.#f(this.#h(),!0)}setSelected(He){this.#n.setSelected(He)}toggleSelected(He){this.#n.toggleSelected(He)}isSelected(He){return this.#n.isSelected(He)}unselect(He){this.#n.unselect(He)}pointerup(He){const{isMac:Ve}=n.FeatureTest.platform;if(!(He.button!==0||He.ctrlKey&&Ve)&&He.target===this.div&&this.#i){if(this.#i=!1,!this.#t){this.#t=!0;return}if(this.#n.getMode()===n.AnnotationEditorType.STAMP){this.#n.unselectAll();return}this.#f(He,!1)}}pointerdown(He){if(this.#i){this.#i=!1;return}const{isMac:Ve}=n.FeatureTest.platform;if(He.button!==0||He.ctrlKey&&Ve||He.target!==this.div)return;this.#i=!0;const Xe=this.#n.getActive();this.#t=!Xe||Xe.isEmpty()}findNewParent(He,Ve,Xe){const We=this.#n.findParent(Ve,Xe);return We===null||We===this?!1:(We.changeParent(He),!0)}destroy(){this.#n.getActive()?.parent===this&&(this.#n.commitOrRemove(),this.#n.setActiveEditor(null));for(const He of this.#s.values())this.#e?.removePointerInTextLayer(He.contentDiv),He.setParent(null),He.isAttachedToDOM=!1,He.div.remove();this.div=null,this.#s.clear(),this.#n.removeLayer(this)}#p(){this.#l=!0;for(const He of this.#s.values())He.isEmpty()&&He.remove();this.#l=!1}render({viewport:He}){this.viewport=He,(0,Me.setLayerDimensions)(this.div,He);for(const Ve of this.#n.getEditors(this.pageIndex))this.add(Ve);this.updateMode()}update({viewport:He}){this.#n.commitOrRemove(),this.viewport=He,(0,Me.setLayerDimensions)(this.div,{rotation:He.rotation}),this.updateMode()}get pageDimensions(){const{pageWidth:He,pageHeight:Ve}=this.viewport.rawDims;return[He,Ve]}}t.AnnotationEditorLayer=Oe}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.FreeTextEditor=void 0;var n=r(1),Ee=r(5),Ce=r(4),De=r(29);class Me extends Ce.AnnotationEditor{#e=this.editorDivBlur.bind(this);#t=this.editorDivFocus.bind(this);#r=this.editorDivInput.bind(this);#a=this.editorDivKeydown.bind(this);#o;#s="";#i=`${this.id}-editor`;#l;#c=null;static _freeTextDefaultContent="";static _internalPadding=0;static _defaultColor=null;static _defaultFontSize=10;static get _keyboardManager(){const Oe=Me.prototype,Be=Xe=>Xe.isEmpty(),He=Ee.AnnotationEditorUIManager.TRANSLATE_SMALL,Ve=Ee.AnnotationEditorUIManager.TRANSLATE_BIG;return(0,n.shadow)(this,"_keyboardManager",new Ee.KeyboardManager([[["ctrl+s","mac+meta+s","ctrl+p","mac+meta+p"],Oe.commitOrRemove,{bubbles:!0}],[["ctrl+Enter","mac+meta+Enter","Escape","mac+Escape"],Oe.commitOrRemove],[["ArrowLeft","mac+ArrowLeft"],Oe._translateEmpty,{args:[-He,0],checker:Be}],[["ctrl+ArrowLeft","mac+shift+ArrowLeft"],Oe._translateEmpty,{args:[-Ve,0],checker:Be}],[["ArrowRight","mac+ArrowRight"],Oe._translateEmpty,{args:[He,0],checker:Be}],[["ctrl+ArrowRight","mac+shift+ArrowRight"],Oe._translateEmpty,{args:[Ve,0],checker:Be}],[["ArrowUp","mac+ArrowUp"],Oe._translateEmpty,{args:[0,-He],checker:Be}],[["ctrl+ArrowUp","mac+shift+ArrowUp"],Oe._translateEmpty,{args:[0,-Ve],checker:Be}],[["ArrowDown","mac+ArrowDown"],Oe._translateEmpty,{args:[0,He],checker:Be}],[["ctrl+ArrowDown","mac+shift+ArrowDown"],Oe._translateEmpty,{args:[0,Ve],checker:Be}]]))}static _type="freetext";constructor(Oe){super({...Oe,name:"freeTextEditor"}),this.#o=Oe.color||Me._defaultColor||Ce.AnnotationEditor._defaultLineColor,this.#l=Oe.fontSize||Me._defaultFontSize}static initialize(Oe){Ce.AnnotationEditor.initialize(Oe,{strings:["free_text2_default_content","editor_free_text2_aria_label"]});const Be=getComputedStyle(document.documentElement);this._internalPadding=parseFloat(Be.getPropertyValue("--freetext-padding"))}static updateDefaultParams(Oe,Be){switch(Oe){case n.AnnotationEditorParamsType.FREETEXT_SIZE:Me._defaultFontSize=Be;break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:Me._defaultColor=Be;break}}updateParams(Oe,Be){switch(Oe){case n.AnnotationEditorParamsType.FREETEXT_SIZE:this.#n(Be);break;case n.AnnotationEditorParamsType.FREETEXT_COLOR:this.#d(Be);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,Me._defaultFontSize],[n.AnnotationEditorParamsType.FREETEXT_COLOR,Me._defaultColor||Ce.AnnotationEditor._defaultLineColor]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.FREETEXT_SIZE,this.#l],[n.AnnotationEditorParamsType.FREETEXT_COLOR,this.#o]]}#n(Oe){const Be=Ve=>{this.editorDiv.style.fontSize=`calc(${Ve}px * var(--scale-factor))`,this.translate(0,-(Ve-this.#l)*this.parentScale),this.#l=Ve,this.#h()},He=this.#l;this.addCommands({cmd:()=>{Be(Oe)},undo:()=>{Be(He)},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_SIZE,overwriteIfSameType:!0,keepUndo:!0})}#d(Oe){const Be=this.#o;this.addCommands({cmd:()=>{this.#o=this.editorDiv.style.color=Oe},undo:()=>{this.#o=this.editorDiv.style.color=Be},mustExec:!0,type:n.AnnotationEditorParamsType.FREETEXT_COLOR,overwriteIfSameType:!0,keepUndo:!0})}_translateEmpty(Oe,Be){this._uiManager.translateSelectedEditors(Oe,Be,!0)}getInitialTranslation(){const Oe=this.parentScale;return[-Me._internalPadding*Oe,-(Me._internalPadding+this.#l)*Oe]}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.isAttachedToDOM||this.parent.add(this)))}enableEditMode(){this.isInEditMode()||(this.parent.setEditingState(!1),this.parent.updateToolbar(n.AnnotationEditorType.FREETEXT),super.enableEditMode(),this.overlayDiv.classList.remove("enabled"),this.editorDiv.contentEditable=!0,this._isDraggable=!1,this.div.removeAttribute("aria-activedescendant"),this.editorDiv.addEventListener("keydown",this.#a),this.editorDiv.addEventListener("focus",this.#t),this.editorDiv.addEventListener("blur",this.#e),this.editorDiv.addEventListener("input",this.#r))}disableEditMode(){this.isInEditMode()&&(this.parent.setEditingState(!0),super.disableEditMode(),this.overlayDiv.classList.add("enabled"),this.editorDiv.contentEditable=!1,this.div.setAttribute("aria-activedescendant",this.#i),this._isDraggable=!0,this.editorDiv.removeEventListener("keydown",this.#a),this.editorDiv.removeEventListener("focus",this.#t),this.editorDiv.removeEventListener("blur",this.#e),this.editorDiv.removeEventListener("input",this.#r),this.div.focus({preventScroll:!0}),this.isEditing=!1,this.parent.div.classList.add("freeTextEditing"))}focusin(Oe){this._focusEventsAllowed&&(super.focusin(Oe),Oe.target!==this.editorDiv&&this.editorDiv.focus())}onceAdded(){if(this.width){this.#m();return}this.enableEditMode(),this.editorDiv.focus(),this._initialOptions?.isCentered&&this.center(),this._initialOptions=null}isEmpty(){return!this.editorDiv||this.editorDiv.innerText.trim()===""}remove(){this.isEditing=!1,this.parent&&(this.parent.setEditingState(!0),this.parent.div.classList.add("freeTextEditing")),super.remove()}#f(){const Oe=this.editorDiv.getElementsByTagName("div");if(Oe.length===0)return this.editorDiv.innerText;const Be=[];for(const He of Oe)Be.push(He.innerText.replace(/\r\n?|\n/,""));return Be.join(`
`)}#h(){const[Oe,Be]=this.parentDimensions;let He;if(this.isAttachedToDOM)He=this.div.getBoundingClientRect();else{const{currentLayer:Ve,div:Xe}=this,We=Xe.style.display;Xe.style.display="hidden",Ve.div.append(this.div),He=Xe.getBoundingClientRect(),Xe.remove(),Xe.style.display=We}this.rotation%180===this.parentRotation%180?(this.width=He.width/Oe,this.height=He.height/Be):(this.width=He.height/Oe,this.height=He.width/Be),this.fixAndSetPosition()}commit(){if(!this.isInEditMode())return;super.commit(),this.disableEditMode();const Oe=this.#s,Be=this.#s=this.#f().trimEnd();if(Oe===Be)return;const He=Ve=>{if(this.#s=Ve,!Ve){this.remove();return}this.#p(),this._uiManager.rebuild(this),this.#h()};this.addCommands({cmd:()=>{He(Be)},undo:()=>{He(Oe)},mustExec:!1}),this.#h()}shouldGetKeyboardEvents(){return this.isInEditMode()}enterInEditMode(){this.enableEditMode(),this.editorDiv.focus()}dblclick(Oe){this.enterInEditMode()}keydown(Oe){Oe.target===this.div&&Oe.key==="Enter"&&(this.enterInEditMode(),Oe.preventDefault())}editorDivKeydown(Oe){Me._keyboardManager.exec(this,Oe)}editorDivFocus(Oe){this.isEditing=!0}editorDivBlur(Oe){this.isEditing=!1}editorDivInput(Oe){this.parent.div.classList.toggle("freeTextEditing",this.isEmpty())}disableEditing(){this.editorDiv.setAttribute("role","comment"),this.editorDiv.removeAttribute("aria-multiline")}enableEditing(){this.editorDiv.setAttribute("role","textbox"),this.editorDiv.setAttribute("aria-multiline",!0)}render(){if(this.div)return this.div;let Oe,Be;this.width&&(Oe=this.x,Be=this.y),super.render(),this.editorDiv=document.createElement("div"),this.editorDiv.className="internal",this.editorDiv.setAttribute("id",this.#i),this.enableEditing(),Ce.AnnotationEditor._l10nPromise.get("editor_free_text2_aria_label").then(Ve=>this.editorDiv?.setAttribute("aria-label",Ve)),Ce.AnnotationEditor._l10nPromise.get("free_text2_default_content").then(Ve=>this.editorDiv?.setAttribute("default-content",Ve)),this.editorDiv.contentEditable=!0;const{style:He}=this.editorDiv;if(He.fontSize=`calc(${this.#l}px * var(--scale-factor))`,He.color=this.#o,this.div.append(this.editorDiv),this.overlayDiv=document.createElement("div"),this.overlayDiv.classList.add("overlay","enabled"),this.div.append(this.overlayDiv),(0,Ee.bindEvents)(this,this.div,["dblclick","keydown"]),this.width){const[Ve,Xe]=this.parentDimensions;if(this.annotationElementId){const{position:We}=this.#c;let[Ge,$e]=this.getInitialTranslation();[Ge,$e]=this.pageTranslationToScreen(Ge,$e);const[Ke,rr]=this.pageDimensions,[tr,sr]=this.pageTranslation;let ar,hr;switch(this.rotation){case 0:ar=Oe+(We[0]-tr)/Ke,hr=Be+this.height-(We[1]-sr)/rr;break;case 90:ar=Oe+(We[0]-tr)/Ke,hr=Be-(We[1]-sr)/rr,[Ge,$e]=[$e,-Ge];break;case 180:ar=Oe-this.width+(We[0]-tr)/Ke,hr=Be-(We[1]-sr)/rr,[Ge,$e]=[-Ge,-$e];break;case 270:ar=Oe+(We[0]-tr-this.height*rr)/Ke,hr=Be+(We[1]-sr-this.width*Ke)/rr,[Ge,$e]=[-$e,Ge];break}this.setAt(ar*Ve,hr*Xe,Ge,$e)}else this.setAt(Oe*Ve,Be*Xe,this.width*Ve,this.height*Xe);this.#p(),this._isDraggable=!0,this.editorDiv.contentEditable=!1}else this._isDraggable=!1,this.editorDiv.contentEditable=!0;return this.div}#p(){if(this.editorDiv.replaceChildren(),!!this.#s)for(const Oe of this.#s.split(`
`)){const Be=document.createElement("div");Be.append(Oe?document.createTextNode(Oe):document.createElement("br")),this.editorDiv.append(Be)}}get contentDiv(){return this.editorDiv}static deserialize(Oe,Be,He){let Ve=null;if(Oe instanceof De.FreeTextAnnotationElement){const{data:{defaultAppearanceData:{fontSize:We,fontColor:Ge},rect:$e,rotation:Ke,id:rr},textContent:tr,textPosition:sr,parent:{page:{pageNumber:ar}}}=Oe;if(!tr||tr.length===0)return null;Ve=Oe={annotationType:n.AnnotationEditorType.FREETEXT,color:Array.from(Ge),fontSize:We,value:tr.join(`
`),position:sr,pageIndex:ar-1,rect:$e,rotation:Ke,id:rr,deleted:!1}}const Xe=super.deserialize(Oe,Be,He);return Xe.#l=Oe.fontSize,Xe.#o=n.Util.makeHexColor(...Oe.color),Xe.#s=Oe.value,Xe.annotationElementId=Oe.id||null,Xe.#c=Ve,Xe}serialize(Oe=!1){if(this.isEmpty())return null;if(this.deleted)return{pageIndex:this.pageIndex,id:this.annotationElementId,deleted:!0};const Be=Me._internalPadding*this.parentScale,He=this.getRect(Be,Be),Ve=Ce.AnnotationEditor._colorManager.convert(this.isAttachedToDOM?getComputedStyle(this.editorDiv).color:this.#o),Xe={annotationType:n.AnnotationEditorType.FREETEXT,color:Ve,fontSize:this.#l,value:this.#s,pageIndex:this.pageIndex,rect:He,rotation:this.rotation,structTreeParentId:this._structTreeParentId};return Oe?Xe:this.annotationElementId&&!this.#_(Xe)?null:(Xe.id=this.annotationElementId,Xe)}#_(Oe){const{value:Be,fontSize:He,color:Ve,rect:Xe,pageIndex:We}=this.#c;return Oe.value!==Be||Oe.fontSize!==He||Oe.rect.some((Ge,$e)=>Math.abs(Ge-Xe[$e])>=1)||Oe.color.some((Ge,$e)=>Ge!==Ve[$e])||Oe.pageIndex!==We}#m(Oe=!1){if(!this.annotationElementId)return;if(this.#h(),!Oe&&(this.width===0||this.height===0)){setTimeout(()=>this.#m(!0),0);return}const Be=Me._internalPadding*this.parentScale;this.#c.rect=this.getRect(Be,Be)}}t.FreeTextEditor=Me}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StampAnnotationElement=t.InkAnnotationElement=t.FreeTextAnnotationElement=t.AnnotationLayer=void 0;var n=r(1),Ee=r(6),Ce=r(3),De=r(30),Me=r(31),ze=r(32);const Oe=1e3,Be=9,He=new WeakSet;function Ve(lr){return{width:lr[2]-lr[0],height:lr[3]-lr[1]}}class Xe{static create(St){switch(St.data.annotationType){case n.AnnotationType.LINK:return new Ge(St);case n.AnnotationType.TEXT:return new $e(St);case n.AnnotationType.WIDGET:switch(St.data.fieldType){case"Tx":return new rr(St);case"Btn":return St.data.radioButton?new ar(St):St.data.checkBox?new sr(St):new hr(St);case"Ch":return new pr(St);case"Sig":return new tr(St)}return new Ke(St);case n.AnnotationType.POPUP:return new yr(St);case n.AnnotationType.FREETEXT:return new Rr(St);case n.AnnotationType.LINE:return new mr(St);case n.AnnotationType.SQUARE:return new wr(St);case n.AnnotationType.CIRCLE:return new Fr(St);case n.AnnotationType.POLYLINE:return new Mr(St);case n.AnnotationType.CARET:return new Nr(St);case n.AnnotationType.INK:return new Ar(St);case n.AnnotationType.POLYGON:return new Hr(St);case n.AnnotationType.HIGHLIGHT:return new xr(St);case n.AnnotationType.UNDERLINE:return new ir(St);case n.AnnotationType.SQUIGGLY:return new _r(St);case n.AnnotationType.STRIKEOUT:return new ur(St);case n.AnnotationType.STAMP:return new Je(St);case n.AnnotationType.FILEATTACHMENT:return new nr(St);default:return new We(St)}}}class We{#e=!1;constructor(St,{isRenderable:dr=!1,ignoreBorder:vr=!1,createQuadrilaterals:br=!1}={}){this.isRenderable=dr,this.data=St.data,this.layer=St.layer,this.linkService=St.linkService,this.downloadManager=St.downloadManager,this.imageResourcesPath=St.imageResourcesPath,this.renderForms=St.renderForms,this.svgFactory=St.svgFactory,this.annotationStorage=St.annotationStorage,this.enableScripting=St.enableScripting,this.hasJSActions=St.hasJSActions,this._fieldObjects=St.fieldObjects,this.parent=St.parent,dr&&(this.container=this._createContainer(vr)),br&&this._createQuadrilaterals()}static _hasPopupData({titleObj:St,contentsObj:dr,richText:vr}){return!!(St?.str||dr?.str||vr?.str)}get hasPopupData(){return We._hasPopupData(this.data)}_createContainer(St){const{data:dr,parent:{page:vr,viewport:br}}=this,kr=document.createElement("section");kr.setAttribute("data-annotation-id",dr.id),this instanceof Ke||(kr.tabIndex=Oe),kr.style.zIndex=this.parent.zIndex++,this.data.popupRef&&kr.setAttribute("aria-haspopup","dialog"),dr.noRotate&&kr.classList.add("norotate");const{pageWidth:Pr,pageHeight:Er,pageX:Zr,pageY:ua}=br.rawDims;if(!dr.rect||this instanceof yr){const{rotation:ta}=dr;return!dr.hasOwnCanvas&&ta!==0&&this.setRotation(ta,kr),kr}const{width:Cr,height:Jr}=Ve(dr.rect),Qr=n.Util.normalizeRect([dr.rect[0],vr.view[3]-dr.rect[1]+vr.view[1],dr.rect[2],vr.view[3]-dr.rect[3]+vr.view[1]]);if(!St&&dr.borderStyle.width>0){kr.style.borderWidth=`${dr.borderStyle.width}px`;const ta=dr.borderStyle.horizontalCornerRadius,Na=dr.borderStyle.verticalCornerRadius;if(ta>0||Na>0){const za=`calc(${ta}px * var(--scale-factor)) / calc(${Na}px * var(--scale-factor))`;kr.style.borderRadius=za}else if(this instanceof ar){const za=`calc(${Cr}px * var(--scale-factor)) / calc(${Jr}px * var(--scale-factor))`;kr.style.borderRadius=za}switch(dr.borderStyle.style){case n.AnnotationBorderStyleType.SOLID:kr.style.borderStyle="solid";break;case n.AnnotationBorderStyleType.DASHED:kr.style.borderStyle="dashed";break;case n.AnnotationBorderStyleType.BEVELED:(0,n.warn)("Unimplemented border style: beveled");break;case n.AnnotationBorderStyleType.INSET:(0,n.warn)("Unimplemented border style: inset");break;case n.AnnotationBorderStyleType.UNDERLINE:kr.style.borderBottomStyle="solid";break}const Ca=dr.borderColor||null;Ca?(this.#e=!0,kr.style.borderColor=n.Util.makeHexColor(Ca[0]|0,Ca[1]|0,Ca[2]|0)):kr.style.borderWidth=0}kr.style.left=`${100*(Qr[0]-Zr)/Pr}%`,kr.style.top=`${100*(Qr[1]-ua)/Er}%`;const{rotation:oa}=dr;return dr.hasOwnCanvas||oa===0?(kr.style.width=`${100*Cr/Pr}%`,kr.style.height=`${100*Jr/Er}%`):this.setRotation(oa,kr),kr}setRotation(St,dr=this.container){if(!this.data.rect)return;const{pageWidth:vr,pageHeight:br}=this.parent.viewport.rawDims,{width:kr,height:Pr}=Ve(this.data.rect);let Er,Zr;St%180===0?(Er=100*kr/vr,Zr=100*Pr/br):(Er=100*Pr/vr,Zr=100*kr/br),dr.style.width=`${Er}%`,dr.style.height=`${Zr}%`,dr.setAttribute("data-main-rotation",(360-St)%360)}get _commonActions(){const St=(dr,vr,br)=>{const kr=br.detail[dr],Pr=kr[0],Er=kr.slice(1);br.target.style[vr]=De.ColorConverters[`${Pr}_HTML`](Er),this.annotationStorage.setValue(this.data.id,{[vr]:De.ColorConverters[`${Pr}_rgb`](Er)})};return(0,n.shadow)(this,"_commonActions",{display:dr=>{const{display:vr}=dr.detail,br=vr%2===1;this.container.style.visibility=br?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noView:br,noPrint:vr===1||vr===2})},print:dr=>{this.annotationStorage.setValue(this.data.id,{noPrint:!dr.detail.print})},hidden:dr=>{const{hidden:vr}=dr.detail;this.container.style.visibility=vr?"hidden":"visible",this.annotationStorage.setValue(this.data.id,{noPrint:vr,noView:vr})},focus:dr=>{setTimeout(()=>dr.target.focus({preventScroll:!1}),0)},userName:dr=>{dr.target.title=dr.detail.userName},readonly:dr=>{dr.target.disabled=dr.detail.readonly},required:dr=>{this._setRequired(dr.target,dr.detail.required)},bgColor:dr=>{St("bgColor","backgroundColor",dr)},fillColor:dr=>{St("fillColor","backgroundColor",dr)},fgColor:dr=>{St("fgColor","color",dr)},textColor:dr=>{St("textColor","color",dr)},borderColor:dr=>{St("borderColor","borderColor",dr)},strokeColor:dr=>{St("strokeColor","borderColor",dr)},rotation:dr=>{const vr=dr.detail.rotation;this.setRotation(vr),this.annotationStorage.setValue(this.data.id,{rotation:vr})}})}_dispatchEventFromSandbox(St,dr){const vr=this._commonActions;for(const br of Object.keys(dr.detail))(St[br]||vr[br])?.(dr)}_setDefaultPropertiesFromJS(St){if(!this.enableScripting)return;const dr=this.annotationStorage.getRawValue(this.data.id);if(!dr)return;const vr=this._commonActions;for(const[br,kr]of Object.entries(dr)){const Pr=vr[br];if(Pr){const Er={detail:{[br]:kr},target:St};Pr(Er),delete dr[br]}}}_createQuadrilaterals(){if(!this.container)return;const{quadPoints:St}=this.data;if(!St)return;const[dr,vr,br,kr]=this.data.rect;if(St.length===1){const[,{x:Na,y:Ca},{x:za,y:Xa}]=St[0];if(br===Na&&kr===Ca&&dr===za&&vr===Xa)return}const{style:Pr}=this.container;let Er;if(this.#e){const{borderColor:Na,borderWidth:Ca}=Pr;Pr.borderWidth=0,Er=["url('data:image/svg+xml;utf8,",'<svg xmlns="http://www.w3.org/2000/svg"',' preserveAspectRatio="none" viewBox="0 0 1 1">',`<g fill="transparent" stroke="${Na}" stroke-width="${Ca}">`],this.container.classList.add("hasBorder")}const Zr=br-dr,ua=kr-vr,{svgFactory:Cr}=this,Jr=Cr.createElement("svg");Jr.classList.add("quadrilateralsContainer"),Jr.setAttribute("width",0),Jr.setAttribute("height",0);const Qr=Cr.createElement("defs");Jr.append(Qr);const oa=Cr.createElement("clipPath"),ta=`clippath_${this.data.id}`;oa.setAttribute("id",ta),oa.setAttribute("clipPathUnits","objectBoundingBox"),Qr.append(oa);for(const[,{x:Na,y:Ca},{x:za,y:Xa}]of St){const Ya=Cr.createElement("rect"),nn=(za-dr)/Zr,on=(kr-Ca)/ua,yn=(Na-za)/Zr,fn=(Ca-Xa)/ua;Ya.setAttribute("x",nn),Ya.setAttribute("y",on),Ya.setAttribute("width",yn),Ya.setAttribute("height",fn),oa.append(Ya),Er?.push(`<rect vector-effect="non-scaling-stroke" x="${nn}" y="${on}" width="${yn}" height="${fn}"/>`)}this.#e&&(Er.push("</g></svg>')"),Pr.backgroundImage=Er.join("")),this.container.append(Jr),this.container.style.clipPath=`url(#${ta})`}_createPopup(){const{container:St,data:dr}=this;St.setAttribute("aria-haspopup","dialog");const vr=new yr({data:{color:dr.color,titleObj:dr.titleObj,modificationDate:dr.modificationDate,contentsObj:dr.contentsObj,richText:dr.richText,parentRect:dr.rect,borderStyle:0,id:`popup_${dr.id}`,rotation:dr.rotation},parent:this.parent,elements:[this]});this.parent.div.append(vr.render())}render(){(0,n.unreachable)("Abstract method `AnnotationElement.render` called")}_getElementsByName(St,dr=null){const vr=[];if(this._fieldObjects){const br=this._fieldObjects[St];if(br)for(const{page:kr,id:Pr,exportValues:Er}of br){if(kr===-1||Pr===dr)continue;const Zr=typeof Er=="string"?Er:null,ua=document.querySelector(`[data-element-id="${Pr}"]`);if(ua&&!He.has(ua)){(0,n.warn)(`_getElementsByName - element not allowed: ${Pr}`);continue}vr.push({id:Pr,exportValue:Zr,domElement:ua})}return vr}for(const br of document.getElementsByName(St)){const{exportValue:kr}=br,Pr=br.getAttribute("data-element-id");Pr!==dr&&He.has(br)&&vr.push({id:Pr,exportValue:kr,domElement:br})}return vr}show(){this.container&&(this.container.hidden=!1),this.popup?.maybeShow()}hide(){this.container&&(this.container.hidden=!0),this.popup?.forceHide()}getElementsToTriggerPopup(){return this.container}addHighlightArea(){const St=this.getElementsToTriggerPopup();if(Array.isArray(St))for(const dr of St)dr.classList.add("highlightArea");else St.classList.add("highlightArea")}_editOnDoubleClick(){const{annotationEditorType:St,data:{id:dr}}=this;this.container.addEventListener("dblclick",()=>{this.linkService.eventBus?.dispatch("switchannotationeditormode",{source:this,mode:St,editId:dr})})}}class Ge extends We{constructor(St,dr=null){super(St,{isRenderable:!0,ignoreBorder:!!dr?.ignoreBorder,createQuadrilaterals:!0}),this.isTooltipOnly=St.data.isTooltipOnly}render(){const{data:St,linkService:dr}=this,vr=document.createElement("a");vr.setAttribute("data-element-id",St.id);let br=!1;return St.url?(dr.addLinkAttributes(vr,St.url,St.newWindow),br=!0):St.action?(this._bindNamedAction(vr,St.action),br=!0):St.attachment?(this._bindAttachment(vr,St.attachment),br=!0):St.setOCGState?(this.#t(vr,St.setOCGState),br=!0):St.dest?(this._bindLink(vr,St.dest),br=!0):(St.actions&&(St.actions.Action||St.actions["Mouse Up"]||St.actions["Mouse Down"])&&this.enableScripting&&this.hasJSActions&&(this._bindJSAction(vr,St),br=!0),St.resetForm?(this._bindResetFormAction(vr,St.resetForm),br=!0):this.isTooltipOnly&&!br&&(this._bindLink(vr,""),br=!0)),this.container.classList.add("linkAnnotation"),br&&this.container.append(vr),this.container}#e(){this.container.setAttribute("data-internal-link","")}_bindLink(St,dr){St.href=this.linkService.getDestinationHash(dr),St.onclick=()=>(dr&&this.linkService.goToDestination(dr),!1),(dr||dr==="")&&this.#e()}_bindNamedAction(St,dr){St.href=this.linkService.getAnchorUrl(""),St.onclick=()=>(this.linkService.executeNamedAction(dr),!1),this.#e()}_bindAttachment(St,dr){St.href=this.linkService.getAnchorUrl(""),St.onclick=()=>(this.downloadManager?.openOrDownloadData(this.container,dr.content,dr.filename),!1),this.#e()}#t(St,dr){St.href=this.linkService.getAnchorUrl(""),St.onclick=()=>(this.linkService.executeSetOCGState(dr),!1),this.#e()}_bindJSAction(St,dr){St.href=this.linkService.getAnchorUrl("");const vr=new Map([["Action","onclick"],["Mouse Up","onmouseup"],["Mouse Down","onmousedown"]]);for(const br of Object.keys(dr.actions)){const kr=vr.get(br);kr&&(St[kr]=()=>(this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:dr.id,name:br}}),!1))}St.onclick||(St.onclick=()=>!1),this.#e()}_bindResetFormAction(St,dr){const vr=St.onclick;if(vr||(St.href=this.linkService.getAnchorUrl("")),this.#e(),!this._fieldObjects){(0,n.warn)('_bindResetFormAction - "resetForm" action not supported, ensure that the `fieldObjects` parameter is provided.'),vr||(St.onclick=()=>!1);return}St.onclick=()=>{vr?.();const{fields:br,refs:kr,include:Pr}=dr,Er=[];if(br.length!==0||kr.length!==0){const Cr=new Set(kr);for(const Jr of br){const Qr=this._fieldObjects[Jr]||[];for(const{id:oa}of Qr)Cr.add(oa)}for(const Jr of Object.values(this._fieldObjects))for(const Qr of Jr)Cr.has(Qr.id)===Pr&&Er.push(Qr)}else for(const Cr of Object.values(this._fieldObjects))Er.push(...Cr);const Zr=this.annotationStorage,ua=[];for(const Cr of Er){const{id:Jr}=Cr;switch(ua.push(Jr),Cr.type){case"text":{const oa=Cr.defaultValue||"";Zr.setValue(Jr,{value:oa});break}case"checkbox":case"radiobutton":{const oa=Cr.defaultValue===Cr.exportValues;Zr.setValue(Jr,{value:oa});break}case"combobox":case"listbox":{const oa=Cr.defaultValue||"";Zr.setValue(Jr,{value:oa});break}default:continue}const Qr=document.querySelector(`[data-element-id="${Jr}"]`);if(Qr){if(!He.has(Qr)){(0,n.warn)(`_bindResetFormAction - element not allowed: ${Jr}`);continue}}else continue;Qr.dispatchEvent(new Event("resetform"))}return this.enableScripting&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:"app",ids:ua,name:"ResetForm"}}),!1}}}class $e extends We{constructor(St){super(St,{isRenderable:!0})}render(){this.container.classList.add("textAnnotation");const St=document.createElement("img");return St.src=this.imageResourcesPath+"annotation-"+this.data.name.toLowerCase()+".svg",St.alt="[{{type}} Annotation]",St.dataset.l10nId="text_annotation_type",St.dataset.l10nArgs=JSON.stringify({type:this.data.name}),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.append(St),this.container}}class Ke extends We{render(){return this.data.alternativeText&&(this.container.title=this.data.alternativeText),this.container}showElementAndHideCanvas(St){this.data.hasOwnCanvas&&(St.previousSibling?.nodeName==="CANVAS"&&(St.previousSibling.hidden=!0),St.hidden=!1)}_getKeyModifier(St){const{isWin:dr,isMac:vr}=n.FeatureTest.platform;return dr&&St.ctrlKey||vr&&St.metaKey}_setEventListener(St,dr,vr,br,kr){vr.includes("mouse")?St.addEventListener(vr,Pr=>{this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:br,value:kr(Pr),shift:Pr.shiftKey,modifier:this._getKeyModifier(Pr)}})}):St.addEventListener(vr,Pr=>{if(vr==="blur"){if(!dr.focused||!Pr.relatedTarget)return;dr.focused=!1}else if(vr==="focus"){if(dr.focused)return;dr.focused=!0}kr&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:this.data.id,name:br,value:kr(Pr)}})})}_setEventListeners(St,dr,vr,br){for(const[kr,Pr]of vr)(Pr==="Action"||this.data.actions?.[Pr])&&((Pr==="Focus"||Pr==="Blur")&&(dr||={focused:!1}),this._setEventListener(St,dr,kr,Pr,br),Pr==="Focus"&&!this.data.actions?.Blur?this._setEventListener(St,dr,"blur","Blur",null):Pr==="Blur"&&!this.data.actions?.Focus&&this._setEventListener(St,dr,"focus","Focus",null))}_setBackgroundColor(St){const dr=this.data.backgroundColor||null;St.style.backgroundColor=dr===null?"transparent":n.Util.makeHexColor(dr[0],dr[1],dr[2])}_setTextStyle(St){const dr=["left","center","right"],{fontColor:vr}=this.data.defaultAppearanceData,br=this.data.defaultAppearanceData.fontSize||Be,kr=St.style;let Pr;const Er=2,Zr=ua=>Math.round(10*ua)/10;if(this.data.multiLine){const ua=Math.abs(this.data.rect[3]-this.data.rect[1]-Er),Cr=Math.round(ua/(n.LINE_FACTOR*br))||1,Jr=ua/Cr;Pr=Math.min(br,Zr(Jr/n.LINE_FACTOR))}else{const ua=Math.abs(this.data.rect[3]-this.data.rect[1]-Er);Pr=Math.min(br,Zr(ua/n.LINE_FACTOR))}kr.fontSize=`calc(${Pr}px * var(--scale-factor))`,kr.color=n.Util.makeHexColor(vr[0],vr[1],vr[2]),this.data.textAlignment!==null&&(kr.textAlign=dr[this.data.textAlignment])}_setRequired(St,dr){dr?St.setAttribute("required",!0):St.removeAttribute("required"),St.setAttribute("aria-required",dr)}}class rr extends Ke{constructor(St){const dr=St.renderForms||!St.data.hasAppearance&&!!St.data.fieldValue;super(St,{isRenderable:dr})}setPropertyOnSiblings(St,dr,vr,br){const kr=this.annotationStorage;for(const Pr of this._getElementsByName(St.name,St.id))Pr.domElement&&(Pr.domElement[dr]=vr),kr.setValue(Pr.id,{[br]:vr})}render(){const St=this.annotationStorage,dr=this.data.id;this.container.classList.add("textWidgetAnnotation");let vr=null;if(this.renderForms){const br=St.getValue(dr,{value:this.data.fieldValue});let kr=br.value||"";const Pr=St.getValue(dr,{charLimit:this.data.maxLen}).charLimit;Pr&&kr.length>Pr&&(kr=kr.slice(0,Pr));let Er=br.formattedValue||this.data.textContent?.join(`
`)||null;Er&&this.data.comb&&(Er=Er.replaceAll(/\s+/g,""));const Zr={userValue:kr,formattedValue:Er,lastCommittedValue:null,commitKey:1,focused:!1};this.data.multiLine?(vr=document.createElement("textarea"),vr.textContent=Er??kr,this.data.doNotScroll&&(vr.style.overflowY="hidden")):(vr=document.createElement("input"),vr.type="text",vr.setAttribute("value",Er??kr),this.data.doNotScroll&&(vr.style.overflowX="hidden")),this.data.hasOwnCanvas&&(vr.hidden=!0),He.add(vr),vr.setAttribute("data-element-id",dr),vr.disabled=this.data.readOnly,vr.name=this.data.fieldName,vr.tabIndex=Oe,this._setRequired(vr,this.data.required),Pr&&(vr.maxLength=Pr),vr.addEventListener("input",Cr=>{St.setValue(dr,{value:Cr.target.value}),this.setPropertyOnSiblings(vr,"value",Cr.target.value,"value"),Zr.formattedValue=null}),vr.addEventListener("resetform",Cr=>{const Jr=this.data.defaultFieldValue??"";vr.value=Zr.userValue=Jr,Zr.formattedValue=null});let ua=Cr=>{const{formattedValue:Jr}=Zr;Jr!=null&&(Cr.target.value=Jr),Cr.target.scrollLeft=0};if(this.enableScripting&&this.hasJSActions){vr.addEventListener("focus",Jr=>{if(Zr.focused)return;const{target:Qr}=Jr;Zr.userValue&&(Qr.value=Zr.userValue),Zr.lastCommittedValue=Qr.value,Zr.commitKey=1,Zr.focused=!0}),vr.addEventListener("updatefromsandbox",Jr=>{this.showElementAndHideCanvas(Jr.target);const Qr={value(oa){Zr.userValue=oa.detail.value??"",St.setValue(dr,{value:Zr.userValue.toString()}),oa.target.value=Zr.userValue},formattedValue(oa){const{formattedValue:ta}=oa.detail;Zr.formattedValue=ta,ta!=null&&oa.target!==document.activeElement&&(oa.target.value=ta),St.setValue(dr,{formattedValue:ta})},selRange(oa){oa.target.setSelectionRange(...oa.detail.selRange)},charLimit:oa=>{const{charLimit:ta}=oa.detail,{target:Na}=oa;if(ta===0){Na.removeAttribute("maxLength");return}Na.setAttribute("maxLength",ta);let Ca=Zr.userValue;!Ca||Ca.length<=ta||(Ca=Ca.slice(0,ta),Na.value=Zr.userValue=Ca,St.setValue(dr,{value:Ca}),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:dr,name:"Keystroke",value:Ca,willCommit:!0,commitKey:1,selStart:Na.selectionStart,selEnd:Na.selectionEnd}}))}};this._dispatchEventFromSandbox(Qr,Jr)}),vr.addEventListener("keydown",Jr=>{Zr.commitKey=1;let Qr=-1;if(Jr.key==="Escape"?Qr=0:Jr.key==="Enter"&&!this.data.multiLine?Qr=2:Jr.key==="Tab"&&(Zr.commitKey=3),Qr===-1)return;const{value:oa}=Jr.target;Zr.lastCommittedValue!==oa&&(Zr.lastCommittedValue=oa,Zr.userValue=oa,this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:dr,name:"Keystroke",value:oa,willCommit:!0,commitKey:Qr,selStart:Jr.target.selectionStart,selEnd:Jr.target.selectionEnd}}))});const Cr=ua;ua=null,vr.addEventListener("blur",Jr=>{if(!Zr.focused||!Jr.relatedTarget)return;Zr.focused=!1;const{value:Qr}=Jr.target;Zr.userValue=Qr,Zr.lastCommittedValue!==Qr&&this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:dr,name:"Keystroke",value:Qr,willCommit:!0,commitKey:Zr.commitKey,selStart:Jr.target.selectionStart,selEnd:Jr.target.selectionEnd}}),Cr(Jr)}),this.data.actions?.Keystroke&&vr.addEventListener("beforeinput",Jr=>{Zr.lastCommittedValue=null;const{data:Qr,target:oa}=Jr,{value:ta,selectionStart:Na,selectionEnd:Ca}=oa;let za=Na,Xa=Ca;switch(Jr.inputType){case"deleteWordBackward":{const Ya=ta.substring(0,Na).match(/\w*[^\w]*$/);Ya&&(za-=Ya[0].length);break}case"deleteWordForward":{const Ya=ta.substring(Na).match(/^[^\w]*\w*/);Ya&&(Xa+=Ya[0].length);break}case"deleteContentBackward":Na===Ca&&(za-=1);break;case"deleteContentForward":Na===Ca&&(Xa+=1);break}Jr.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:dr,name:"Keystroke",value:ta,change:Qr||"",willCommit:!1,selStart:za,selEnd:Xa}})}),this._setEventListeners(vr,Zr,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Jr=>Jr.target.value)}if(ua&&vr.addEventListener("blur",ua),this.data.comb){const Jr=(this.data.rect[2]-this.data.rect[0])/Pr;vr.classList.add("comb"),vr.style.letterSpacing=`calc(${Jr}px * var(--scale-factor) - 1ch)`}}else vr=document.createElement("div"),vr.textContent=this.data.fieldValue,vr.style.verticalAlign="middle",vr.style.display="table-cell";return this._setTextStyle(vr),this._setBackgroundColor(vr),this._setDefaultPropertiesFromJS(vr),this.container.append(vr),this.container}}class tr extends Ke{constructor(St){super(St,{isRenderable:!!St.data.hasOwnCanvas})}}class sr extends Ke{constructor(St){super(St,{isRenderable:St.renderForms})}render(){const St=this.annotationStorage,dr=this.data,vr=dr.id;let br=St.getValue(vr,{value:dr.exportValue===dr.fieldValue}).value;typeof br=="string"&&(br=br!=="Off",St.setValue(vr,{value:br})),this.container.classList.add("buttonWidgetAnnotation","checkBox");const kr=document.createElement("input");return He.add(kr),kr.setAttribute("data-element-id",vr),kr.disabled=dr.readOnly,this._setRequired(kr,this.data.required),kr.type="checkbox",kr.name=dr.fieldName,br&&kr.setAttribute("checked",!0),kr.setAttribute("exportValue",dr.exportValue),kr.tabIndex=Oe,kr.addEventListener("change",Pr=>{const{name:Er,checked:Zr}=Pr.target;for(const ua of this._getElementsByName(Er,vr)){const Cr=Zr&&ua.exportValue===dr.exportValue;ua.domElement&&(ua.domElement.checked=Cr),St.setValue(ua.id,{value:Cr})}St.setValue(vr,{value:Zr})}),kr.addEventListener("resetform",Pr=>{const Er=dr.defaultFieldValue||"Off";Pr.target.checked=Er===dr.exportValue}),this.enableScripting&&this.hasJSActions&&(kr.addEventListener("updatefromsandbox",Pr=>{const Er={value(Zr){Zr.target.checked=Zr.detail.value!=="Off",St.setValue(vr,{value:Zr.target.checked})}};this._dispatchEventFromSandbox(Er,Pr)}),this._setEventListeners(kr,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Pr=>Pr.target.checked)),this._setBackgroundColor(kr),this._setDefaultPropertiesFromJS(kr),this.container.append(kr),this.container}}class ar extends Ke{constructor(St){super(St,{isRenderable:St.renderForms})}render(){this.container.classList.add("buttonWidgetAnnotation","radioButton");const St=this.annotationStorage,dr=this.data,vr=dr.id;let br=St.getValue(vr,{value:dr.fieldValue===dr.buttonValue}).value;typeof br=="string"&&(br=br!==dr.buttonValue,St.setValue(vr,{value:br}));const kr=document.createElement("input");if(He.add(kr),kr.setAttribute("data-element-id",vr),kr.disabled=dr.readOnly,this._setRequired(kr,this.data.required),kr.type="radio",kr.name=dr.fieldName,br&&kr.setAttribute("checked",!0),kr.tabIndex=Oe,kr.addEventListener("change",Pr=>{const{name:Er,checked:Zr}=Pr.target;for(const ua of this._getElementsByName(Er,vr))St.setValue(ua.id,{value:!1});St.setValue(vr,{value:Zr})}),kr.addEventListener("resetform",Pr=>{const Er=dr.defaultFieldValue;Pr.target.checked=Er!=null&&Er===dr.buttonValue}),this.enableScripting&&this.hasJSActions){const Pr=dr.buttonValue;kr.addEventListener("updatefromsandbox",Er=>{const Zr={value:ua=>{const Cr=Pr===ua.detail.value;for(const Jr of this._getElementsByName(ua.target.name)){const Qr=Cr&&Jr.id===vr;Jr.domElement&&(Jr.domElement.checked=Qr),St.setValue(Jr.id,{value:Qr})}}};this._dispatchEventFromSandbox(Zr,Er)}),this._setEventListeners(kr,null,[["change","Validate"],["change","Action"],["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"]],Er=>Er.target.checked)}return this._setBackgroundColor(kr),this._setDefaultPropertiesFromJS(kr),this.container.append(kr),this.container}}class hr extends Ge{constructor(St){super(St,{ignoreBorder:St.data.hasAppearance})}render(){const St=super.render();St.classList.add("buttonWidgetAnnotation","pushButton"),this.data.alternativeText&&(St.title=this.data.alternativeText);const dr=St.lastChild;return this.enableScripting&&this.hasJSActions&&dr&&(this._setDefaultPropertiesFromJS(dr),dr.addEventListener("updatefromsandbox",vr=>{this._dispatchEventFromSandbox({},vr)})),St}}class pr extends Ke{constructor(St){super(St,{isRenderable:St.renderForms})}render(){this.container.classList.add("choiceWidgetAnnotation");const St=this.annotationStorage,dr=this.data.id,vr=St.getValue(dr,{value:this.data.fieldValue}),br=document.createElement("select");He.add(br),br.setAttribute("data-element-id",dr),br.disabled=this.data.readOnly,this._setRequired(br,this.data.required),br.name=this.data.fieldName,br.tabIndex=Oe;let kr=this.data.combo&&this.data.options.length>0;this.data.combo||(br.size=this.data.options.length,this.data.multiSelect&&(br.multiple=!0)),br.addEventListener("resetform",Cr=>{const Jr=this.data.defaultFieldValue;for(const Qr of br.options)Qr.selected=Qr.value===Jr});for(const Cr of this.data.options){const Jr=document.createElement("option");Jr.textContent=Cr.displayValue,Jr.value=Cr.exportValue,vr.value.includes(Cr.exportValue)&&(Jr.setAttribute("selected",!0),kr=!1),br.append(Jr)}let Pr=null;if(kr){const Cr=document.createElement("option");Cr.value=" ",Cr.setAttribute("hidden",!0),Cr.setAttribute("selected",!0),br.prepend(Cr),Pr=()=>{Cr.remove(),br.removeEventListener("input",Pr),Pr=null},br.addEventListener("input",Pr)}const Er=Cr=>{const Jr=Cr?"value":"textContent",{options:Qr,multiple:oa}=br;return oa?Array.prototype.filter.call(Qr,ta=>ta.selected).map(ta=>ta[Jr]):Qr.selectedIndex===-1?null:Qr[Qr.selectedIndex][Jr]};let Zr=Er(!1);const ua=Cr=>{const Jr=Cr.target.options;return Array.prototype.map.call(Jr,Qr=>({displayValue:Qr.textContent,exportValue:Qr.value}))};return this.enableScripting&&this.hasJSActions?(br.addEventListener("updatefromsandbox",Cr=>{const Jr={value(Qr){Pr?.();const oa=Qr.detail.value,ta=new Set(Array.isArray(oa)?oa:[oa]);for(const Na of br.options)Na.selected=ta.has(Na.value);St.setValue(dr,{value:Er(!0)}),Zr=Er(!1)},multipleSelection(Qr){br.multiple=!0},remove(Qr){const oa=br.options,ta=Qr.detail.remove;oa[ta].selected=!1,br.remove(ta),oa.length>0&&Array.prototype.findIndex.call(oa,Ca=>Ca.selected)===-1&&(oa[0].selected=!0),St.setValue(dr,{value:Er(!0),items:ua(Qr)}),Zr=Er(!1)},clear(Qr){for(;br.length!==0;)br.remove(0);St.setValue(dr,{value:null,items:[]}),Zr=Er(!1)},insert(Qr){const{index:oa,displayValue:ta,exportValue:Na}=Qr.detail.insert,Ca=br.children[oa],za=document.createElement("option");za.textContent=ta,za.value=Na,Ca?Ca.before(za):br.append(za),St.setValue(dr,{value:Er(!0),items:ua(Qr)}),Zr=Er(!1)},items(Qr){const{items:oa}=Qr.detail;for(;br.length!==0;)br.remove(0);for(const ta of oa){const{displayValue:Na,exportValue:Ca}=ta,za=document.createElement("option");za.textContent=Na,za.value=Ca,br.append(za)}br.options.length>0&&(br.options[0].selected=!0),St.setValue(dr,{value:Er(!0),items:ua(Qr)}),Zr=Er(!1)},indices(Qr){const oa=new Set(Qr.detail.indices);for(const ta of Qr.target.options)ta.selected=oa.has(ta.index);St.setValue(dr,{value:Er(!0)}),Zr=Er(!1)},editable(Qr){Qr.target.disabled=!Qr.detail.editable}};this._dispatchEventFromSandbox(Jr,Cr)}),br.addEventListener("input",Cr=>{const Jr=Er(!0);St.setValue(dr,{value:Jr}),Cr.preventDefault(),this.linkService.eventBus?.dispatch("dispatcheventinsandbox",{source:this,detail:{id:dr,name:"Keystroke",value:Zr,changeEx:Jr,willCommit:!1,commitKey:1,keyDown:!1}})}),this._setEventListeners(br,null,[["focus","Focus"],["blur","Blur"],["mousedown","Mouse Down"],["mouseenter","Mouse Enter"],["mouseleave","Mouse Exit"],["mouseup","Mouse Up"],["input","Action"],["input","Validate"]],Cr=>Cr.target.value)):br.addEventListener("input",function(Cr){St.setValue(dr,{value:Er(!0)})}),this.data.combo&&this._setTextStyle(br),this._setBackgroundColor(br),this._setDefaultPropertiesFromJS(br),this.container.append(br),this.container}}class yr extends We{constructor(St){const{data:dr,elements:vr}=St;super(St,{isRenderable:We._hasPopupData(dr)}),this.elements=vr}render(){this.container.classList.add("popupAnnotation");const St=new fr({container:this.container,color:this.data.color,titleObj:this.data.titleObj,modificationDate:this.data.modificationDate,contentsObj:this.data.contentsObj,richText:this.data.richText,rect:this.data.rect,parentRect:this.data.parentRect||null,parent:this.parent,elements:this.elements,open:this.data.open}),dr=[];for(const vr of this.elements)vr.popup=St,dr.push(vr.data.id),vr.addHighlightArea();return this.container.setAttribute("aria-controls",dr.map(vr=>`${n.AnnotationPrefix}${vr}`).join(",")),this.container}}class fr{#e=null;#t=this.#u.bind(this);#r=this.#b.bind(this);#a=this.#S.bind(this);#o=this.#x.bind(this);#s=null;#i=null;#l=null;#c=null;#n=null;#d=null;#f=!1;#h=null;#p=null;#_=null;#m=null;#g=!1;constructor({container:St,color:dr,elements:vr,titleObj:br,modificationDate:kr,contentsObj:Pr,richText:Er,parent:Zr,rect:ua,parentRect:Cr,open:Jr}){this.#i=St,this.#m=br,this.#l=Pr,this.#_=Er,this.#n=Zr,this.#s=dr,this.#p=ua,this.#d=Cr,this.#c=vr;const Qr=Ee.PDFDateString.toDateObject(kr);Qr&&(this.#e=Zr.l10n.get("annotation_date_string",{date:Qr.toLocaleDateString(),time:Qr.toLocaleTimeString()})),this.trigger=vr.flatMap(oa=>oa.getElementsToTriggerPopup());for(const oa of this.trigger)oa.addEventListener("click",this.#o),oa.addEventListener("mouseenter",this.#a),oa.addEventListener("mouseleave",this.#r),oa.classList.add("popupTriggerArea");for(const oa of vr)oa.container?.addEventListener("keydown",this.#t);this.#i.hidden=!0,Jr&&this.#x()}render(){if(this.#h)return;const{page:{view:St},viewport:{rawDims:{pageWidth:dr,pageHeight:vr,pageX:br,pageY:kr}}}=this.#n,Pr=this.#h=document.createElement("div");if(Pr.className="popup",this.#s){const Ya=Pr.style.outlineColor=n.Util.makeHexColor(...this.#s);CSS.supports("background-color","color-mix(in srgb, red 30%, white)")?Pr.style.backgroundColor=`color-mix(in srgb, ${Ya} 30%, white)`:Pr.style.backgroundColor=n.Util.makeHexColor(...this.#s.map(on=>Math.floor(.7*(255-on)+on)))}const Er=document.createElement("span");Er.className="header";const Zr=document.createElement("h1");if(Er.append(Zr),{dir:Zr.dir,str:Zr.textContent}=this.#m,Pr.append(Er),this.#e){const Ya=document.createElement("span");Ya.classList.add("popupDate"),this.#e.then(nn=>{Ya.textContent=nn}),Er.append(Ya)}const ua=this.#l,Cr=this.#_;if(Cr?.str&&(!ua?.str||ua.str===Cr.str))ze.XfaLayer.render({xfaHtml:Cr.html,intent:"richText",div:Pr}),Pr.lastChild.classList.add("richText","popupContent");else{const Ya=this._formatContents(ua);Pr.append(Ya)}let Jr=!!this.#d,Qr=Jr?this.#d:this.#p;for(const Ya of this.#c)if(!Qr||n.Util.intersect(Ya.data.rect,Qr)!==null){Qr=Ya.data.rect,Jr=!0;break}const oa=n.Util.normalizeRect([Qr[0],St[3]-Qr[1]+St[1],Qr[2],St[3]-Qr[3]+St[1]]),Na=Jr?Qr[2]-Qr[0]+5:0,Ca=oa[0]+Na,za=oa[1],{style:Xa}=this.#i;Xa.left=`${100*(Ca-br)/dr}%`,Xa.top=`${100*(za-kr)/vr}%`,this.#i.append(Pr)}_formatContents({str:St,dir:dr}){const vr=document.createElement("p");vr.classList.add("popupContent"),vr.dir=dr;const br=St.split(/(?:\r\n?|\n)/);for(let kr=0,Pr=br.length;kr<Pr;++kr){const Er=br[kr];vr.append(document.createTextNode(Er)),kr<Pr-1&&vr.append(document.createElement("br"))}return vr}#u(St){St.altKey||St.shiftKey||St.ctrlKey||St.metaKey||(St.key==="Enter"||St.key==="Escape"&&this.#f)&&this.#x()}#x(){this.#f=!this.#f,this.#f?(this.#S(),this.#i.addEventListener("click",this.#o),this.#i.addEventListener("keydown",this.#t)):(this.#b(),this.#i.removeEventListener("click",this.#o),this.#i.removeEventListener("keydown",this.#t))}#S(){this.#h||this.render(),this.isVisible?this.#f&&this.#i.classList.add("focused"):(this.#i.hidden=!1,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)+1e3)}#b(){this.#i.classList.remove("focused"),!(this.#f||!this.isVisible)&&(this.#i.hidden=!0,this.#i.style.zIndex=parseInt(this.#i.style.zIndex)-1e3)}forceHide(){this.#g=this.isVisible,this.#g&&(this.#i.hidden=!0)}maybeShow(){this.#g&&(this.#g=!1,this.#i.hidden=!1)}get isVisible(){return this.#i.hidden===!1}}class Rr extends We{constructor(St){super(St,{isRenderable:!0,ignoreBorder:!0}),this.textContent=St.data.textContent,this.textPosition=St.data.textPosition,this.annotationEditorType=n.AnnotationEditorType.FREETEXT}render(){if(this.container.classList.add("freeTextAnnotation"),this.textContent){const St=document.createElement("div");St.classList.add("annotationTextContent"),St.setAttribute("role","comment");for(const dr of this.textContent){const vr=document.createElement("span");vr.textContent=dr,St.append(vr)}this.container.append(St)}return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this._editOnDoubleClick(),this.container}}t.FreeTextAnnotationElement=Rr;class mr extends We{#e=null;constructor(St){super(St,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("lineAnnotation");const St=this.data,{width:dr,height:vr}=Ve(St.rect),br=this.svgFactory.create(dr,vr,!0),kr=this.#e=this.svgFactory.createElement("svg:line");return kr.setAttribute("x1",St.rect[2]-St.lineCoordinates[0]),kr.setAttribute("y1",St.rect[3]-St.lineCoordinates[1]),kr.setAttribute("x2",St.rect[2]-St.lineCoordinates[2]),kr.setAttribute("y2",St.rect[3]-St.lineCoordinates[3]),kr.setAttribute("stroke-width",St.borderStyle.width||1),kr.setAttribute("stroke","transparent"),kr.setAttribute("fill","transparent"),br.append(kr),this.container.append(br),!St.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class wr extends We{#e=null;constructor(St){super(St,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("squareAnnotation");const St=this.data,{width:dr,height:vr}=Ve(St.rect),br=this.svgFactory.create(dr,vr,!0),kr=St.borderStyle.width,Pr=this.#e=this.svgFactory.createElement("svg:rect");return Pr.setAttribute("x",kr/2),Pr.setAttribute("y",kr/2),Pr.setAttribute("width",dr-kr),Pr.setAttribute("height",vr-kr),Pr.setAttribute("stroke-width",kr||1),Pr.setAttribute("stroke","transparent"),Pr.setAttribute("fill","transparent"),br.append(Pr),this.container.append(br),!St.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Fr extends We{#e=null;constructor(St){super(St,{isRenderable:!0,ignoreBorder:!0})}render(){this.container.classList.add("circleAnnotation");const St=this.data,{width:dr,height:vr}=Ve(St.rect),br=this.svgFactory.create(dr,vr,!0),kr=St.borderStyle.width,Pr=this.#e=this.svgFactory.createElement("svg:ellipse");return Pr.setAttribute("cx",dr/2),Pr.setAttribute("cy",vr/2),Pr.setAttribute("rx",dr/2-kr/2),Pr.setAttribute("ry",vr/2-kr/2),Pr.setAttribute("stroke-width",kr||1),Pr.setAttribute("stroke","transparent"),Pr.setAttribute("fill","transparent"),br.append(Pr),this.container.append(br),!St.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Mr extends We{#e=null;constructor(St){super(St,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="polylineAnnotation",this.svgElementName="svg:polyline"}render(){this.container.classList.add(this.containerClassName);const St=this.data,{width:dr,height:vr}=Ve(St.rect),br=this.svgFactory.create(dr,vr,!0);let kr=[];for(const Er of St.vertices){const Zr=Er.x-St.rect[0],ua=St.rect[3]-Er.y;kr.push(Zr+","+ua)}kr=kr.join(" ");const Pr=this.#e=this.svgFactory.createElement(this.svgElementName);return Pr.setAttribute("points",kr),Pr.setAttribute("stroke-width",St.borderStyle.width||1),Pr.setAttribute("stroke","transparent"),Pr.setAttribute("fill","transparent"),br.append(Pr),this.container.append(br),!St.popupRef&&this.hasPopupData&&this._createPopup(),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}class Hr extends Mr{constructor(St){super(St),this.containerClassName="polygonAnnotation",this.svgElementName="svg:polygon"}}class Nr extends We{constructor(St){super(St,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("caretAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}class Ar extends We{#e=[];constructor(St){super(St,{isRenderable:!0,ignoreBorder:!0}),this.containerClassName="inkAnnotation",this.svgElementName="svg:polyline",this.annotationEditorType=n.AnnotationEditorType.INK}render(){this.container.classList.add(this.containerClassName);const St=this.data,{width:dr,height:vr}=Ve(St.rect),br=this.svgFactory.create(dr,vr,!0);for(const kr of St.inkLists){let Pr=[];for(const Zr of kr){const ua=Zr.x-St.rect[0],Cr=St.rect[3]-Zr.y;Pr.push(`${ua},${Cr}`)}Pr=Pr.join(" ");const Er=this.svgFactory.createElement(this.svgElementName);this.#e.push(Er),Er.setAttribute("points",Pr),Er.setAttribute("stroke-width",St.borderStyle.width||1),Er.setAttribute("stroke","transparent"),Er.setAttribute("fill","transparent"),!St.popupRef&&this.hasPopupData&&this._createPopup(),br.append(Er)}return this.container.append(br),this.container}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}}t.InkAnnotationElement=Ar;class xr extends We{constructor(St){super(St,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("highlightAnnotation"),this.container}}class ir extends We{constructor(St){super(St,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("underlineAnnotation"),this.container}}class _r extends We{constructor(St){super(St,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("squigglyAnnotation"),this.container}}class ur extends We{constructor(St){super(St,{isRenderable:!0,ignoreBorder:!0,createQuadrilaterals:!0})}render(){return!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container.classList.add("strikeoutAnnotation"),this.container}}class Je extends We{constructor(St){super(St,{isRenderable:!0,ignoreBorder:!0})}render(){return this.container.classList.add("stampAnnotation"),!this.data.popupRef&&this.hasPopupData&&this._createPopup(),this.container}}t.StampAnnotationElement=Je;class nr extends We{#e=null;constructor(St){super(St,{isRenderable:!0});const{filename:dr,content:vr}=this.data.file;this.filename=(0,Ee.getFilenameFromUrl)(dr,!0),this.content=vr,this.linkService.eventBus?.dispatch("fileattachmentannotation",{source:this,filename:dr,content:vr})}render(){this.container.classList.add("fileAttachmentAnnotation");const{container:St,data:dr}=this;let vr;dr.hasAppearance||dr.fillAlpha===0?vr=document.createElement("div"):(vr=document.createElement("img"),vr.src=`${this.imageResourcesPath}annotation-${/paperclip/i.test(dr.name)?"paperclip":"pushpin"}.svg`,dr.fillAlpha&&dr.fillAlpha<1&&(vr.style=`filter: opacity(${Math.round(dr.fillAlpha*100)}%);`)),vr.addEventListener("dblclick",this.#t.bind(this)),this.#e=vr;const{isMac:br}=n.FeatureTest.platform;return St.addEventListener("keydown",kr=>{kr.key==="Enter"&&(br?kr.metaKey:kr.ctrlKey)&&this.#t()}),!dr.popupRef&&this.hasPopupData?this._createPopup():vr.classList.add("popupTriggerArea"),St.append(vr),St}getElementsToTriggerPopup(){return this.#e}addHighlightArea(){this.container.classList.add("highlightArea")}#t(){this.downloadManager?.openOrDownloadData(this.container,this.content,this.filename)}}class or{#e=null;#t=null;#r=new Map;constructor({div:St,accessibilityManager:dr,annotationCanvasMap:vr,l10n:br,page:kr,viewport:Pr}){this.div=St,this.#e=dr,this.#t=vr,this.l10n=br,this.page=kr,this.viewport=Pr,this.zIndex=0,this.l10n||=Me.NullL10n}#a(St,dr){const vr=St.firstChild||St;vr.id=`${n.AnnotationPrefix}${dr}`,this.div.append(St),this.#e?.moveElementInDOM(this.div,St,vr,!1)}async render(St){const{annotations:dr}=St,vr=this.div;(0,Ee.setLayerDimensions)(vr,this.viewport);const br=new Map,kr={data:null,layer:vr,linkService:St.linkService,downloadManager:St.downloadManager,imageResourcesPath:St.imageResourcesPath||"",renderForms:St.renderForms!==!1,svgFactory:new Ee.DOMSVGFactory,annotationStorage:St.annotationStorage||new Ce.AnnotationStorage,enableScripting:St.enableScripting===!0,hasJSActions:St.hasJSActions,fieldObjects:St.fieldObjects,parent:this,elements:null};for(const Pr of dr){if(Pr.noHTML)continue;const Er=Pr.annotationType===n.AnnotationType.POPUP;if(Er){const Cr=br.get(Pr.id);if(!Cr)continue;kr.elements=Cr}else{const{width:Cr,height:Jr}=Ve(Pr.rect);if(Cr<=0||Jr<=0)continue}kr.data=Pr;const Zr=Xe.create(kr);if(!Zr.isRenderable)continue;if(!Er&&Pr.popupRef){const Cr=br.get(Pr.popupRef);Cr?Cr.push(Zr):br.set(Pr.popupRef,[Zr])}Zr.annotationEditorType>0&&this.#r.set(Zr.data.id,Zr);const ua=Zr.render();Pr.hidden&&(ua.style.visibility="hidden"),this.#a(ua,Pr.id)}this.#o(),await this.l10n.translate(vr)}update({viewport:St}){const dr=this.div;this.viewport=St,(0,Ee.setLayerDimensions)(dr,{rotation:St.rotation}),this.#o(),dr.hidden=!1}#o(){if(!this.#t)return;const St=this.div;for(const[dr,vr]of this.#t){const br=St.querySelector(`[data-annotation-id="${dr}"]`);if(!br)continue;const{firstChild:kr}=br;kr?kr.nodeName==="CANVAS"?kr.replaceWith(vr):kr.before(vr):br.append(vr)}this.#t.clear()}getEditableAnnotations(){return Array.from(this.#r.values())}getEditableAnnotation(St){return this.#r.get(St)}}t.AnnotationLayer=or}),((e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ColorConverters=void 0;function r(Ce){return Math.floor(Math.max(0,Math.min(1,Ce))*255).toString(16).padStart(2,"0")}function n(Ce){return Math.max(0,Math.min(255,255*Ce))}class Ee{static CMYK_G([De,Me,ze,Oe]){return["G",1-Math.min(1,.3*De+.59*ze+.11*Me+Oe)]}static G_CMYK([De]){return["CMYK",0,0,0,1-De]}static G_RGB([De]){return["RGB",De,De,De]}static G_rgb([De]){return De=n(De),[De,De,De]}static G_HTML([De]){const Me=r(De);return`#${Me}${Me}${Me}`}static RGB_G([De,Me,ze]){return["G",.3*De+.59*Me+.11*ze]}static RGB_rgb(De){return De.map(n)}static RGB_HTML(De){return`#${De.map(r).join("")}`}static T_HTML(){return"#00000000"}static T_rgb(){return[null]}static CMYK_RGB([De,Me,ze,Oe]){return["RGB",1-Math.min(1,De+Oe),1-Math.min(1,ze+Oe),1-Math.min(1,Me+Oe)]}static CMYK_rgb([De,Me,ze,Oe]){return[n(1-Math.min(1,De+Oe)),n(1-Math.min(1,ze+Oe)),n(1-Math.min(1,Me+Oe))]}static CMYK_HTML(De){const Me=this.CMYK_RGB(De).slice(1);return this.RGB_HTML(Me)}static RGB_CMYK([De,Me,ze]){const Oe=1-De,Be=1-Me,He=1-ze,Ve=Math.min(Oe,Be,He);return["CMYK",Oe,Be,He,Ve]}}t.ColorConverters=Ee}),((e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NullL10n=void 0,t.getL10nFallback=n;const r={of_pages:"of {{pagesCount}}",page_of_pages:"({{pageNumber}} of {{pagesCount}})",document_properties_kb:"{{size_kb}} KB ({{size_b}} bytes)",document_properties_mb:"{{size_mb}} MB ({{size_b}} bytes)",document_properties_date_string:"{{date}}, {{time}}",document_properties_page_size_unit_inches:"in",document_properties_page_size_unit_millimeters:"mm",document_properties_page_size_orientation_portrait:"portrait",document_properties_page_size_orientation_landscape:"landscape",document_properties_page_size_name_a3:"A3",document_properties_page_size_name_a4:"A4",document_properties_page_size_name_letter:"Letter",document_properties_page_size_name_legal:"Legal",document_properties_page_size_dimension_string:"{{width}}  {{height}} {{unit}} ({{orientation}})",document_properties_page_size_dimension_name_string:"{{width}}  {{height}} {{unit}} ({{name}}, {{orientation}})",document_properties_linearized_yes:"Yes",document_properties_linearized_no:"No",additional_layers:"Additional Layers",page_landmark:"Page {{page}}",thumb_page_title:"Page {{page}}",thumb_page_canvas:"Thumbnail of Page {{page}}",find_reached_top:"Reached top of document, continued from bottom",find_reached_bottom:"Reached end of document, continued from top","find_match_count[one]":"{{current}} of {{total}} match","find_match_count[other]":"{{current}} of {{total}} matches","find_match_count_limit[one]":"More than {{limit}} match","find_match_count_limit[other]":"More than {{limit}} matches",find_not_found:"Phrase not found",page_scale_width:"Page Width",page_scale_fit:"Page Fit",page_scale_auto:"Automatic Zoom",page_scale_actual:"Actual Size",page_scale_percent:"{{scale}}%",loading_error:"An error occurred while loading the PDF.",invalid_file_error:"Invalid or corrupted PDF file.",missing_file_error:"Missing PDF file.",unexpected_response_error:"Unexpected server response.",rendering_error:"An error occurred while rendering the page.",annotation_date_string:"{{date}}, {{time}}",printing_not_supported:"Warning: Printing is not fully supported by this browser.",printing_not_ready:"Warning: The PDF is not fully loaded for printing.",web_fonts_disabled:"Web fonts are disabled: unable to use embedded PDF fonts.",free_text2_default_content:"Start typing",editor_free_text2_aria_label:"Text Editor",editor_ink2_aria_label:"Draw Editor",editor_ink_canvas_aria_label:"User-created image",editor_alt_text_button_label:"Alt text",editor_alt_text_edit_button_label:"Edit alt text",editor_alt_text_decorative_tooltip:"Marked as decorative"};r.print_progress_percent="{{progress}}%";function n(De,Me){switch(De){case"find_match_count":De=`find_match_count[${Me.total===1?"one":"other"}]`;break;case"find_match_count_limit":De=`find_match_count_limit[${Me.limit===1?"one":"other"}]`;break}return r[De]||""}function Ee(De,Me){return Me?De.replaceAll(/\{\{\s*(\w+)\s*\}\}/g,(ze,Oe)=>Oe in Me?Me[Oe]:"{{"+Oe+"}}"):De}const Ce={async getLanguage(){return"en-us"},async getDirection(){return"ltr"},async get(De,Me=null,ze=n(De,Me)){return Ee(ze,Me)},async translate(De){}};t.NullL10n=Ce}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.XfaLayer=void 0;var n=r(25);class Ee{static setupStorage(De,Me,ze,Oe,Be){const He=Oe.getValue(Me,{value:null});switch(ze.name){case"textarea":if(He.value!==null&&(De.textContent=He.value),Be==="print")break;De.addEventListener("input",Ve=>{Oe.setValue(Me,{value:Ve.target.value})});break;case"input":if(ze.attributes.type==="radio"||ze.attributes.type==="checkbox"){if(He.value===ze.attributes.xfaOn?De.setAttribute("checked",!0):He.value===ze.attributes.xfaOff&&De.removeAttribute("checked"),Be==="print")break;De.addEventListener("change",Ve=>{Oe.setValue(Me,{value:Ve.target.checked?Ve.target.getAttribute("xfaOn"):Ve.target.getAttribute("xfaOff")})})}else{if(He.value!==null&&De.setAttribute("value",He.value),Be==="print")break;De.addEventListener("input",Ve=>{Oe.setValue(Me,{value:Ve.target.value})})}break;case"select":if(He.value!==null){De.setAttribute("value",He.value);for(const Ve of ze.children)Ve.attributes.value===He.value?Ve.attributes.selected=!0:Ve.attributes.hasOwnProperty("selected")&&delete Ve.attributes.selected}De.addEventListener("input",Ve=>{const Xe=Ve.target.options,We=Xe.selectedIndex===-1?"":Xe[Xe.selectedIndex].value;Oe.setValue(Me,{value:We})});break}}static setAttributes({html:De,element:Me,storage:ze=null,intent:Oe,linkService:Be}){const{attributes:He}=Me,Ve=De instanceof HTMLAnchorElement;He.type==="radio"&&(He.name=`${He.name}-${Oe}`);for(const[Xe,We]of Object.entries(He))if(We!=null)switch(Xe){case"class":We.length&&De.setAttribute(Xe,We.join(" "));break;case"dataId":break;case"id":De.setAttribute("data-element-id",We);break;case"style":Object.assign(De.style,We);break;case"textContent":De.textContent=We;break;default:(!Ve||Xe!=="href"&&Xe!=="newWindow")&&De.setAttribute(Xe,We)}Ve&&Be.addLinkAttributes(De,He.href,He.newWindow),ze&&He.dataId&&this.setupStorage(De,He.dataId,Me,ze)}static render(De){const Me=De.annotationStorage,ze=De.linkService,Oe=De.xfaHtml,Be=De.intent||"display",He=document.createElement(Oe.name);Oe.attributes&&this.setAttributes({html:He,element:Oe,intent:Be,linkService:ze});const Ve=[[Oe,-1,He]],Xe=De.div;if(Xe.append(He),De.viewport){const Ge=`matrix(${De.viewport.transform.join(",")})`;Xe.style.transform=Ge}Be!=="richText"&&Xe.setAttribute("class","xfaLayer xfaFont");const We=[];for(;Ve.length>0;){const[Ge,$e,Ke]=Ve.at(-1);if($e+1===Ge.children.length){Ve.pop();continue}const rr=Ge.children[++Ve.at(-1)[1]];if(rr===null)continue;const{name:tr}=rr;if(tr==="#text"){const ar=document.createTextNode(rr.value);We.push(ar),Ke.append(ar);continue}const sr=rr?.attributes?.xmlns?document.createElementNS(rr.attributes.xmlns,tr):document.createElement(tr);if(Ke.append(sr),rr.attributes&&this.setAttributes({html:sr,element:rr,storage:Me,intent:Be,linkService:ze}),rr.children&&rr.children.length>0)Ve.push([rr,-1,sr]);else if(rr.value){const ar=document.createTextNode(rr.value);n.XfaText.shouldBuildText(tr)&&We.push(ar),sr.append(ar)}}for(const Ge of Xe.querySelectorAll(".xfaNonInteractive input, .xfaNonInteractive textarea"))Ge.setAttribute("readOnly",!0);return{textDivs:We}}static update(De){const Me=`matrix(${De.viewport.transform.join(",")})`;De.div.style.transform=Me,De.div.hidden=!1}}t.XfaLayer=Ee}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.InkEditor=void 0;var n=r(1),Ee=r(4),Ce=r(29),De=r(6),Me=r(5);class ze extends Ee.AnnotationEditor{#e=0;#t=0;#r=this.canvasPointermove.bind(this);#a=this.canvasPointerleave.bind(this);#o=this.canvasPointerup.bind(this);#s=this.canvasPointerdown.bind(this);#i=new Path2D;#l=!1;#c=!1;#n=!1;#d=null;#f=0;#h=0;#p=null;static _defaultColor=null;static _defaultOpacity=1;static _defaultThickness=1;static _type="ink";constructor(Be){super({...Be,name:"inkEditor"}),this.color=Be.color||null,this.thickness=Be.thickness||null,this.opacity=Be.opacity||null,this.paths=[],this.bezierPath2D=[],this.allRawPaths=[],this.currentPath=[],this.scaleFactor=1,this.translationX=this.translationY=0,this.x=0,this.y=0,this._willKeepAspectRatio=!0}static initialize(Be){Ee.AnnotationEditor.initialize(Be,{strings:["editor_ink_canvas_aria_label","editor_ink2_aria_label"]})}static updateDefaultParams(Be,He){switch(Be){case n.AnnotationEditorParamsType.INK_THICKNESS:ze._defaultThickness=He;break;case n.AnnotationEditorParamsType.INK_COLOR:ze._defaultColor=He;break;case n.AnnotationEditorParamsType.INK_OPACITY:ze._defaultOpacity=He/100;break}}updateParams(Be,He){switch(Be){case n.AnnotationEditorParamsType.INK_THICKNESS:this.#_(He);break;case n.AnnotationEditorParamsType.INK_COLOR:this.#m(He);break;case n.AnnotationEditorParamsType.INK_OPACITY:this.#g(He);break}}static get defaultPropertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,ze._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,ze._defaultColor||Ee.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(ze._defaultOpacity*100)]]}get propertiesToUpdate(){return[[n.AnnotationEditorParamsType.INK_THICKNESS,this.thickness||ze._defaultThickness],[n.AnnotationEditorParamsType.INK_COLOR,this.color||ze._defaultColor||Ee.AnnotationEditor._defaultLineColor],[n.AnnotationEditorParamsType.INK_OPACITY,Math.round(100*(this.opacity??ze._defaultOpacity))]]}#_(Be){const He=this.thickness;this.addCommands({cmd:()=>{this.thickness=Be,this.#E()},undo:()=>{this.thickness=He,this.#E()},mustExec:!0,type:n.AnnotationEditorParamsType.INK_THICKNESS,overwriteIfSameType:!0,keepUndo:!0})}#m(Be){const He=this.color;this.addCommands({cmd:()=>{this.color=Be,this.#v()},undo:()=>{this.color=He,this.#v()},mustExec:!0,type:n.AnnotationEditorParamsType.INK_COLOR,overwriteIfSameType:!0,keepUndo:!0})}#g(Be){Be/=100;const He=this.opacity;this.addCommands({cmd:()=>{this.opacity=Be,this.#v()},undo:()=>{this.opacity=He,this.#v()},mustExec:!0,type:n.AnnotationEditorParamsType.INK_OPACITY,overwriteIfSameType:!0,keepUndo:!0})}rebuild(){this.parent&&(super.rebuild(),this.div!==null&&(this.canvas||(this.#R(),this.#N()),this.isAttachedToDOM||(this.parent.add(this),this.#y()),this.#E()))}remove(){this.canvas!==null&&(this.isEmpty()||this.commit(),this.canvas.width=this.canvas.height=0,this.canvas.remove(),this.canvas=null,this.#d.disconnect(),this.#d=null,super.remove())}setParent(Be){!this.parent&&Be?this._uiManager.removeShouldRescale(this):this.parent&&Be===null&&this._uiManager.addShouldRescale(this),super.setParent(Be)}onScaleChanging(){const[Be,He]=this.parentDimensions,Ve=this.width*Be,Xe=this.height*He;this.setDimensions(Ve,Xe)}enableEditMode(){this.#l||this.canvas===null||(super.enableEditMode(),this._isDraggable=!1,this.canvas.addEventListener("pointerdown",this.#s))}disableEditMode(){!this.isInEditMode()||this.canvas===null||(super.disableEditMode(),this._isDraggable=!this.isEmpty(),this.div.classList.remove("editing"),this.canvas.removeEventListener("pointerdown",this.#s))}onceAdded(){this._isDraggable=!this.isEmpty()}isEmpty(){return this.paths.length===0||this.paths.length===1&&this.paths[0].length===0}#u(){const{parentRotation:Be,parentDimensions:[He,Ve]}=this;switch(Be){case 90:return[0,Ve,Ve,He];case 180:return[He,Ve,He,Ve];case 270:return[He,0,Ve,He];default:return[0,0,He,Ve]}}#x(){const{ctx:Be,color:He,opacity:Ve,thickness:Xe,parentScale:We,scaleFactor:Ge}=this;Be.lineWidth=Xe*We/Ge,Be.lineCap="round",Be.lineJoin="round",Be.miterLimit=10,Be.strokeStyle=`${He}${(0,Me.opacityToHex)(Ve)}`}#S(Be,He){this.canvas.addEventListener("contextmenu",De.noContextMenu),this.canvas.addEventListener("pointerleave",this.#a),this.canvas.addEventListener("pointermove",this.#r),this.canvas.addEventListener("pointerup",this.#o),this.canvas.removeEventListener("pointerdown",this.#s),this.isEditing=!0,this.#n||(this.#n=!0,this.#y(),this.thickness||=ze._defaultThickness,this.color||=ze._defaultColor||Ee.AnnotationEditor._defaultLineColor,this.opacity??=ze._defaultOpacity),this.currentPath.push([Be,He]),this.#c=!1,this.#x(),this.#p=()=>{this.#M(),this.#p&&window.requestAnimationFrame(this.#p)},window.requestAnimationFrame(this.#p)}#b(Be,He){const[Ve,Xe]=this.currentPath.at(-1);if(this.currentPath.length>1&&Be===Ve&&He===Xe)return;const We=this.currentPath;let Ge=this.#i;if(We.push([Be,He]),this.#c=!0,We.length<=2){Ge.moveTo(...We[0]),Ge.lineTo(Be,He);return}We.length===3&&(this.#i=Ge=new Path2D,Ge.moveTo(...We[0])),this.#O(Ge,...We.at(-3),...We.at(-2),Be,He)}#T(){if(this.currentPath.length===0)return;const Be=this.currentPath.at(-1);this.#i.lineTo(...Be)}#C(Be,He){this.#p=null,Be=Math.min(Math.max(Be,0),this.canvas.width),He=Math.min(Math.max(He,0),this.canvas.height),this.#b(Be,He),this.#T();let Ve;if(this.currentPath.length!==1)Ve=this.#P();else{const Ke=[Be,He];Ve=[[Ke,Ke.slice(),Ke.slice(),Ke]]}const Xe=this.#i,We=this.currentPath;this.currentPath=[],this.#i=new Path2D;const Ge=()=>{this.allRawPaths.push(We),this.paths.push(Ve),this.bezierPath2D.push(Xe),this.rebuild()},$e=()=>{this.allRawPaths.pop(),this.paths.pop(),this.bezierPath2D.pop(),this.paths.length===0?this.remove():(this.canvas||(this.#R(),this.#N()),this.#E())};this.addCommands({cmd:Ge,undo:$e,mustExec:!0})}#M(){if(!this.#c)return;this.#c=!1;const Be=Math.ceil(this.thickness*this.parentScale),He=this.currentPath.slice(-3),Ve=He.map(Ge=>Ge[0]),Xe=He.map(Ge=>Ge[1]);Math.min(...Ve)-Be,Math.max(...Ve)+Be,Math.min(...Xe)-Be,Math.max(...Xe)+Be;const{ctx:We}=this;We.save(),We.clearRect(0,0,this.canvas.width,this.canvas.height);for(const Ge of this.bezierPath2D)We.stroke(Ge);We.stroke(this.#i),We.restore()}#O(Be,He,Ve,Xe,We,Ge,$e){const Ke=(He+Xe)/2,rr=(Ve+We)/2,tr=(Xe+Ge)/2,sr=(We+$e)/2;Be.bezierCurveTo(Ke+2*(Xe-Ke)/3,rr+2*(We-rr)/3,tr+2*(Xe-tr)/3,sr+2*(We-sr)/3,tr,sr)}#P(){const Be=this.currentPath;if(Be.length<=2)return[[Be[0],Be[0],Be.at(-1),Be.at(-1)]];const He=[];let Ve,[Xe,We]=Be[0];for(Ve=1;Ve<Be.length-2;Ve++){const[ar,hr]=Be[Ve],[pr,yr]=Be[Ve+1],fr=(ar+pr)/2,Rr=(hr+yr)/2,mr=[Xe+2*(ar-Xe)/3,We+2*(hr-We)/3],wr=[fr+2*(ar-fr)/3,Rr+2*(hr-Rr)/3];He.push([[Xe,We],mr,wr,[fr,Rr]]),[Xe,We]=[fr,Rr]}const[Ge,$e]=Be[Ve],[Ke,rr]=Be[Ve+1],tr=[Xe+2*(Ge-Xe)/3,We+2*($e-We)/3],sr=[Ke+2*(Ge-Ke)/3,rr+2*($e-rr)/3];return He.push([[Xe,We],tr,sr,[Ke,rr]]),He}#v(){if(this.isEmpty()){this.#A();return}this.#x();const{canvas:Be,ctx:He}=this;He.setTransform(1,0,0,1,0,0),He.clearRect(0,0,Be.width,Be.height),this.#A();for(const Ve of this.bezierPath2D)He.stroke(Ve)}commit(){this.#l||(super.commit(),this.isEditing=!1,this.disableEditMode(),this.setInForeground(),this.#l=!0,this.div.classList.add("disabled"),this.#E(!0),this.makeResizable(),this.parent.addInkEditorIfNeeded(!0),this.moveInDOM(),this.div.focus({preventScroll:!0}))}focusin(Be){this._focusEventsAllowed&&(super.focusin(Be),this.enableEditMode())}canvasPointerdown(Be){Be.button!==0||!this.isInEditMode()||this.#l||(this.setInForeground(),Be.preventDefault(),Be.type!=="mouse"&&this.div.focus(),this.#S(Be.offsetX,Be.offsetY))}canvasPointermove(Be){Be.preventDefault(),this.#b(Be.offsetX,Be.offsetY)}canvasPointerup(Be){Be.preventDefault(),this.#D(Be)}canvasPointerleave(Be){this.#D(Be)}#D(Be){this.canvas.removeEventListener("pointerleave",this.#a),this.canvas.removeEventListener("pointermove",this.#r),this.canvas.removeEventListener("pointerup",this.#o),this.canvas.addEventListener("pointerdown",this.#s),setTimeout(()=>{this.canvas.removeEventListener("contextmenu",De.noContextMenu)},10),this.#C(Be.offsetX,Be.offsetY),this.addToAnnotationStorage(),this.setInBackground()}#R(){this.canvas=document.createElement("canvas"),this.canvas.width=this.canvas.height=0,this.canvas.className="inkEditorCanvas",Ee.AnnotationEditor._l10nPromise.get("editor_ink_canvas_aria_label").then(Be=>this.canvas?.setAttribute("aria-label",Be)),this.div.append(this.canvas),this.ctx=this.canvas.getContext("2d")}#N(){this.#d=new ResizeObserver(Be=>{const He=Be[0].contentRect;He.width&&He.height&&this.setDimensions(He.width,He.height)}),this.#d.observe(this.div)}get isResizable(){return!this.isEmpty()&&this.#l}render(){if(this.div)return this.div;let Be,He;this.width&&(Be=this.x,He=this.y),super.render(),Ee.AnnotationEditor._l10nPromise.get("editor_ink2_aria_label").then($e=>this.div?.setAttribute("aria-label",$e));const[Ve,Xe,We,Ge]=this.#u();if(this.setAt(Ve,Xe,0,0),this.setDims(We,Ge),this.#R(),this.width){const[$e,Ke]=this.parentDimensions;this.setAspectRatio(this.width*$e,this.height*Ke),this.setAt(Be*$e,He*Ke,this.width*$e,this.height*Ke),this.#n=!0,this.#y(),this.setDims(this.width*$e,this.height*Ke),this.#v(),this.div.classList.add("disabled")}else this.div.classList.add("editing"),this.enableEditMode();return this.#N(),this.div}#y(){if(!this.#n)return;const[Be,He]=this.parentDimensions;this.canvas.width=Math.ceil(this.width*Be),this.canvas.height=Math.ceil(this.height*He),this.#A()}setDimensions(Be,He){const Ve=Math.round(Be),Xe=Math.round(He);if(this.#f===Ve&&this.#h===Xe)return;this.#f=Ve,this.#h=Xe,this.canvas.style.visibility="hidden";const[We,Ge]=this.parentDimensions;this.width=Be/We,this.height=He/Ge,this.fixAndSetPosition(),this.#l&&this.#k(Be,He),this.#y(),this.#v(),this.canvas.style.visibility="visible",this.fixDims()}#k(Be,He){const Ve=this.#L(),Xe=(Be-Ve)/this.#t,We=(He-Ve)/this.#e;this.scaleFactor=Math.min(Xe,We)}#A(){const Be=this.#L()/2;this.ctx.setTransform(this.scaleFactor,0,0,this.scaleFactor,this.translationX*this.scaleFactor+Be,this.translationY*this.scaleFactor+Be)}static#I(Be){const He=new Path2D;for(let Ve=0,Xe=Be.length;Ve<Xe;Ve++){const[We,Ge,$e,Ke]=Be[Ve];Ve===0&&He.moveTo(...We),He.bezierCurveTo(Ge[0],Ge[1],$e[0],$e[1],Ke[0],Ke[1])}return He}static#B(Be,He,Ve){const[Xe,We,Ge,$e]=He;switch(Ve){case 0:for(let Ke=0,rr=Be.length;Ke<rr;Ke+=2)Be[Ke]+=Xe,Be[Ke+1]=$e-Be[Ke+1];break;case 90:for(let Ke=0,rr=Be.length;Ke<rr;Ke+=2){const tr=Be[Ke];Be[Ke]=Be[Ke+1]+Xe,Be[Ke+1]=tr+We}break;case 180:for(let Ke=0,rr=Be.length;Ke<rr;Ke+=2)Be[Ke]=Ge-Be[Ke],Be[Ke+1]+=We;break;case 270:for(let Ke=0,rr=Be.length;Ke<rr;Ke+=2){const tr=Be[Ke];Be[Ke]=Ge-Be[Ke+1],Be[Ke+1]=$e-tr}break;default:throw new Error("Invalid rotation")}return Be}static#j(Be,He,Ve){const[Xe,We,Ge,$e]=He;switch(Ve){case 0:for(let Ke=0,rr=Be.length;Ke<rr;Ke+=2)Be[Ke]-=Xe,Be[Ke+1]=$e-Be[Ke+1];break;case 90:for(let Ke=0,rr=Be.length;Ke<rr;Ke+=2){const tr=Be[Ke];Be[Ke]=Be[Ke+1]-We,Be[Ke+1]=tr-Xe}break;case 180:for(let Ke=0,rr=Be.length;Ke<rr;Ke+=2)Be[Ke]=Ge-Be[Ke],Be[Ke+1]-=We;break;case 270:for(let Ke=0,rr=Be.length;Ke<rr;Ke+=2){const tr=Be[Ke];Be[Ke]=$e-Be[Ke+1],Be[Ke+1]=Ge-tr}break;default:throw new Error("Invalid rotation")}return Be}#U(Be,He,Ve,Xe){const We=[],Ge=this.thickness/2,$e=Be*He+Ge,Ke=Be*Ve+Ge;for(const rr of this.paths){const tr=[],sr=[];for(let ar=0,hr=rr.length;ar<hr;ar++){const[pr,yr,fr,Rr]=rr[ar],mr=Be*pr[0]+$e,wr=Be*pr[1]+Ke,Fr=Be*yr[0]+$e,Mr=Be*yr[1]+Ke,Hr=Be*fr[0]+$e,Nr=Be*fr[1]+Ke,Ar=Be*Rr[0]+$e,xr=Be*Rr[1]+Ke;ar===0&&(tr.push(mr,wr),sr.push(mr,wr)),tr.push(Fr,Mr,Hr,Nr,Ar,xr),sr.push(Fr,Mr),ar===hr-1&&sr.push(Ar,xr)}We.push({bezier:ze.#B(tr,Xe,this.rotation),points:ze.#B(sr,Xe,this.rotation)})}return We}#F(){let Be=1/0,He=-1/0,Ve=1/0,Xe=-1/0;for(const We of this.paths)for(const[Ge,$e,Ke,rr]of We){const tr=n.Util.bezierBoundingBox(...Ge,...$e,...Ke,...rr);Be=Math.min(Be,tr[0]),Ve=Math.min(Ve,tr[1]),He=Math.max(He,tr[2]),Xe=Math.max(Xe,tr[3])}return[Be,Ve,He,Xe]}#L(){return this.#l?Math.ceil(this.thickness*this.parentScale):0}#E(Be=!1){if(this.isEmpty())return;if(!this.#l){this.#v();return}const He=this.#F(),Ve=this.#L();this.#t=Math.max(Ee.AnnotationEditor.MIN_SIZE,He[2]-He[0]),this.#e=Math.max(Ee.AnnotationEditor.MIN_SIZE,He[3]-He[1]);const Xe=Math.ceil(Ve+this.#t*this.scaleFactor),We=Math.ceil(Ve+this.#e*this.scaleFactor),[Ge,$e]=this.parentDimensions;this.width=Xe/Ge,this.height=We/$e,this.setAspectRatio(Xe,We);const Ke=this.translationX,rr=this.translationY;this.translationX=-He[0],this.translationY=-He[1],this.#y(),this.#v(),this.#f=Xe,this.#h=We,this.setDims(Xe,We);const tr=Be?Ve/this.scaleFactor/2:0;this.translate(Ke-this.translationX-tr,rr-this.translationY-tr)}static deserialize(Be,He,Ve){if(Be instanceof Ce.InkAnnotationElement)return null;const Xe=super.deserialize(Be,He,Ve);Xe.thickness=Be.thickness,Xe.color=n.Util.makeHexColor(...Be.color),Xe.opacity=Be.opacity;const[We,Ge]=Xe.pageDimensions,$e=Xe.width*We,Ke=Xe.height*Ge,rr=Xe.parentScale,tr=Be.thickness/2;Xe.#l=!0,Xe.#f=Math.round($e),Xe.#h=Math.round(Ke);const{paths:sr,rect:ar,rotation:hr}=Be;for(let{bezier:yr}of sr){yr=ze.#j(yr,ar,hr);const fr=[];Xe.paths.push(fr);let Rr=rr*(yr[0]-tr),mr=rr*(yr[1]-tr);for(let Fr=2,Mr=yr.length;Fr<Mr;Fr+=6){const Hr=rr*(yr[Fr]-tr),Nr=rr*(yr[Fr+1]-tr),Ar=rr*(yr[Fr+2]-tr),xr=rr*(yr[Fr+3]-tr),ir=rr*(yr[Fr+4]-tr),_r=rr*(yr[Fr+5]-tr);fr.push([[Rr,mr],[Hr,Nr],[Ar,xr],[ir,_r]]),Rr=ir,mr=_r}const wr=this.#I(fr);Xe.bezierPath2D.push(wr)}const pr=Xe.#F();return Xe.#t=Math.max(Ee.AnnotationEditor.MIN_SIZE,pr[2]-pr[0]),Xe.#e=Math.max(Ee.AnnotationEditor.MIN_SIZE,pr[3]-pr[1]),Xe.#k($e,Ke),Xe}serialize(){if(this.isEmpty())return null;const Be=this.getRect(0,0),He=Ee.AnnotationEditor._colorManager.convert(this.ctx.strokeStyle);return{annotationType:n.AnnotationEditorType.INK,color:He,thickness:this.thickness,opacity:this.opacity,paths:this.#U(this.scaleFactor/this.parentScale,this.translationX,this.translationY,Be),pageIndex:this.pageIndex,rect:Be,rotation:this.rotation,structTreeParentId:this._structTreeParentId}}}t.InkEditor=ze}),((e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.StampEditor=void 0;var n=r(1),Ee=r(4),Ce=r(6),De=r(29);class Me extends Ee.AnnotationEditor{#e=null;#t=null;#r=null;#a=null;#o=null;#s=null;#i=null;#l=null;#c=!1;#n=!1;static _type="stamp";constructor(Oe){super({...Oe,name:"stampEditor"}),this.#a=Oe.bitmapUrl,this.#o=Oe.bitmapFile}static initialize(Oe){Ee.AnnotationEditor.initialize(Oe)}static get supportedTypes(){const Oe=["apng","avif","bmp","gif","jpeg","png","svg+xml","webp","x-icon"];return(0,n.shadow)(this,"supportedTypes",Oe.map(Be=>`image/${Be}`))}static get supportedTypesStr(){return(0,n.shadow)(this,"supportedTypesStr",this.supportedTypes.join(","))}static isHandlingMimeForPasting(Oe){return this.supportedTypes.includes(Oe)}static paste(Oe,Be){Be.pasteEditor(n.AnnotationEditorType.STAMP,{bitmapFile:Oe.getAsFile()})}#d(Oe,Be=!1){if(!Oe){this.remove();return}this.#e=Oe.bitmap,Be||(this.#t=Oe.id,this.#c=Oe.isSvg),this.#p()}#f(){this.#r=null,this._uiManager.enableWaiting(!1),this.#s&&this.div.focus()}#h(){if(this.#t){this._uiManager.enableWaiting(!0),this._uiManager.imageManager.getFromId(this.#t).then(Be=>this.#d(Be,!0)).finally(()=>this.#f());return}if(this.#a){const Be=this.#a;this.#a=null,this._uiManager.enableWaiting(!0),this.#r=this._uiManager.imageManager.getFromUrl(Be).then(He=>this.#d(He)).finally(()=>this.#f());return}if(this.#o){const Be=this.#o;this.#o=null,this._uiManager.enableWaiting(!0),this.#r=this._uiManager.imageManager.getFromFile(Be).then(He=>this.#d(He)).finally(()=>this.#f());return}const Oe=document.createElement("input");Oe.type="file",Oe.accept=Me.supportedTypesStr,this.#r=new Promise(Be=>{Oe.addEventListener("change",async()=>{if(!Oe.files||Oe.files.length===0)this.remove();else{this._uiManager.enableWaiting(!0);const He=await this._uiManager.imageManager.getFromFile(Oe.files[0]);this.#d(He)}Be()}),Oe.addEventListener("cancel",()=>{this.remove(),Be()})}).finally(()=>this.#f()),Oe.click()}remove(){this.#t&&(this.#e=null,this._uiManager.imageManager.deleteId(this.#t),this.#s?.remove(),this.#s=null,this.#i?.disconnect(),this.#i=null),super.remove()}rebuild(){if(!this.parent){this.#t&&this.#h();return}super.rebuild(),this.div!==null&&(this.#t&&this.#h(),this.isAttachedToDOM||this.parent.add(this))}onceAdded(){this._isDraggable=!0,this.div.focus()}isEmpty(){return!(this.#r||this.#e||this.#a||this.#o)}get isResizable(){return!0}render(){if(this.div)return this.div;let Oe,Be;if(this.width&&(Oe=this.x,Be=this.y),super.render(),this.div.hidden=!0,this.#e?this.#p():this.#h(),this.width){const[He,Ve]=this.parentDimensions;this.setAt(Oe*He,Be*Ve,this.width*He,this.height*Ve)}return this.div}#p(){const{div:Oe}=this;let{width:Be,height:He}=this.#e;const[Ve,Xe]=this.pageDimensions,We=.75;if(this.width)Be=this.width*Ve,He=this.height*Xe;else if(Be>We*Ve||He>We*Xe){const rr=Math.min(We*Ve/Be,We*Xe/He);Be*=rr,He*=rr}const[Ge,$e]=this.parentDimensions;this.setDims(Be*Ge/Ve,He*$e/Xe),this._uiManager.enableWaiting(!1);const Ke=this.#s=document.createElement("canvas");Oe.append(Ke),Oe.hidden=!1,this.#g(Be,He),this.#x(),this.#n||(this.parent.addUndoableEditor(this),this.#n=!0),this._uiManager._eventBus.dispatch("reporttelemetry",{source:this,details:{type:"editing",subtype:this.editorType,data:{action:"inserted_image"}}}),this.addAltTextButton()}#_(Oe,Be){const[He,Ve]=this.parentDimensions;this.width=Oe/He,this.height=Be/Ve,this.setDims(Oe,Be),this._initialOptions?.isCentered?this.center():this.fixAndSetPosition(),this._initialOptions=null,this.#l!==null&&clearTimeout(this.#l);const Xe=200;this.#l=setTimeout(()=>{this.#l=null,this.#g(Oe,Be)},Xe)}#m(Oe,Be){const{width:He,height:Ve}=this.#e;let Xe=He,We=Ve,Ge=this.#e;for(;Xe>2*Oe||We>2*Be;){const $e=Xe,Ke=We;Xe>2*Oe&&(Xe=Xe>=16384?Math.floor(Xe/2)-1:Math.ceil(Xe/2)),We>2*Be&&(We=We>=16384?Math.floor(We/2)-1:Math.ceil(We/2));const rr=new OffscreenCanvas(Xe,We);rr.getContext("2d").drawImage(Ge,0,0,$e,Ke,0,0,Xe,We),Ge=rr.transferToImageBitmap()}return Ge}#g(Oe,Be){Oe=Math.ceil(Oe),Be=Math.ceil(Be);const He=this.#s;if(!He||He.width===Oe&&He.height===Be)return;He.width=Oe,He.height=Be;const Ve=this.#c?this.#e:this.#m(Oe,Be),Xe=He.getContext("2d");Xe.filter=this._uiManager.hcmFilter,Xe.drawImage(Ve,0,0,Ve.width,Ve.height,0,0,Oe,Be)}#u(Oe){if(Oe){if(this.#c){const Ve=this._uiManager.imageManager.getSvgUrl(this.#t);if(Ve)return Ve}const Be=document.createElement("canvas");return{width:Be.width,height:Be.height}=this.#e,Be.getContext("2d").drawImage(this.#e,0,0),Be.toDataURL()}if(this.#c){const[Be,He]=this.pageDimensions,Ve=Math.round(this.width*Be*Ce.PixelsPerInch.PDF_TO_CSS_UNITS),Xe=Math.round(this.height*He*Ce.PixelsPerInch.PDF_TO_CSS_UNITS),We=new OffscreenCanvas(Ve,Xe);return We.getContext("2d").drawImage(this.#e,0,0,this.#e.width,this.#e.height,0,0,Ve,Xe),We.transferToImageBitmap()}return structuredClone(this.#e)}#x(){this.#i=new ResizeObserver(Oe=>{const Be=Oe[0].contentRect;Be.width&&Be.height&&this.#_(Be.width,Be.height)}),this.#i.observe(this.div)}static deserialize(Oe,Be,He){if(Oe instanceof De.StampAnnotationElement)return null;const Ve=super.deserialize(Oe,Be,He),{rect:Xe,bitmapUrl:We,bitmapId:Ge,isSvg:$e,accessibilityData:Ke}=Oe;Ge&&He.imageManager.isValidId(Ge)?Ve.#t=Ge:Ve.#a=We,Ve.#c=$e;const[rr,tr]=Ve.pageDimensions;return Ve.width=(Xe[2]-Xe[0])/rr,Ve.height=(Xe[3]-Xe[1])/tr,Ke&&(Ve.altTextData=Ke),Ve}serialize(Oe=!1,Be=null){if(this.isEmpty())return null;const He={annotationType:n.AnnotationEditorType.STAMP,bitmapId:this.#t,pageIndex:this.pageIndex,rect:this.getRect(0,0),rotation:this.rotation,isSvg:this.#c,structTreeParentId:this._structTreeParentId};if(Oe)return He.bitmapUrl=this.#u(!0),He.accessibilityData=this.altTextData,He;const{decorative:Ve,altText:Xe}=this.altTextData;if(!Ve&&Xe&&(He.accessibilityData={type:"Figure",alt:Xe}),Be===null)return He;Be.stamps||=new Map;const We=this.#c?(He.rect[2]-He.rect[0])*(He.rect[3]-He.rect[1]):null;if(!Be.stamps.has(this.#t))Be.stamps.set(this.#t,{area:We,serialized:He}),He.bitmap=this.#u(!1);else if(this.#c){const Ge=Be.stamps.get(this.#t);We>Ge.area&&(Ge.area=We,Ge.serialized.bitmap.close(),Ge.serialized.bitmap=this.#u(!1))}return He}}t.StampEditor=Me})],__webpack_module_cache__={};function __w_pdfjs_require__(e){var t=__webpack_module_cache__[e];if(t!==void 0)return t.exports;var r=__webpack_module_cache__[e]={exports:{}};return __webpack_modules__[e](r,r.exports,__w_pdfjs_require__),r.exports}var __webpack_exports__={};return(()=>{var e=__webpack_exports__;Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"AbortException",{enumerable:!0,get:function(){return t.AbortException}}),Object.defineProperty(e,"AnnotationEditorLayer",{enumerable:!0,get:function(){return Ce.AnnotationEditorLayer}}),Object.defineProperty(e,"AnnotationEditorParamsType",{enumerable:!0,get:function(){return t.AnnotationEditorParamsType}}),Object.defineProperty(e,"AnnotationEditorType",{enumerable:!0,get:function(){return t.AnnotationEditorType}}),Object.defineProperty(e,"AnnotationEditorUIManager",{enumerable:!0,get:function(){return De.AnnotationEditorUIManager}}),Object.defineProperty(e,"AnnotationLayer",{enumerable:!0,get:function(){return Me.AnnotationLayer}}),Object.defineProperty(e,"AnnotationMode",{enumerable:!0,get:function(){return t.AnnotationMode}}),Object.defineProperty(e,"CMapCompressionType",{enumerable:!0,get:function(){return t.CMapCompressionType}}),Object.defineProperty(e,"DOMSVGFactory",{enumerable:!0,get:function(){return n.DOMSVGFactory}}),Object.defineProperty(e,"FeatureTest",{enumerable:!0,get:function(){return t.FeatureTest}}),Object.defineProperty(e,"GlobalWorkerOptions",{enumerable:!0,get:function(){return ze.GlobalWorkerOptions}}),Object.defineProperty(e,"ImageKind",{enumerable:!0,get:function(){return t.ImageKind}}),Object.defineProperty(e,"InvalidPDFException",{enumerable:!0,get:function(){return t.InvalidPDFException}}),Object.defineProperty(e,"MissingPDFException",{enumerable:!0,get:function(){return t.MissingPDFException}}),Object.defineProperty(e,"OPS",{enumerable:!0,get:function(){return t.OPS}}),Object.defineProperty(e,"PDFDataRangeTransport",{enumerable:!0,get:function(){return r.PDFDataRangeTransport}}),Object.defineProperty(e,"PDFDateString",{enumerable:!0,get:function(){return n.PDFDateString}}),Object.defineProperty(e,"PDFWorker",{enumerable:!0,get:function(){return r.PDFWorker}}),Object.defineProperty(e,"PasswordResponses",{enumerable:!0,get:function(){return t.PasswordResponses}}),Object.defineProperty(e,"PermissionFlag",{enumerable:!0,get:function(){return t.PermissionFlag}}),Object.defineProperty(e,"PixelsPerInch",{enumerable:!0,get:function(){return n.PixelsPerInch}}),Object.defineProperty(e,"PromiseCapability",{enumerable:!0,get:function(){return t.PromiseCapability}}),Object.defineProperty(e,"RenderingCancelledException",{enumerable:!0,get:function(){return n.RenderingCancelledException}}),Object.defineProperty(e,"SVGGraphics",{enumerable:!0,get:function(){return r.SVGGraphics}}),Object.defineProperty(e,"UnexpectedResponseException",{enumerable:!0,get:function(){return t.UnexpectedResponseException}}),Object.defineProperty(e,"Util",{enumerable:!0,get:function(){return t.Util}}),Object.defineProperty(e,"VerbosityLevel",{enumerable:!0,get:function(){return t.VerbosityLevel}}),Object.defineProperty(e,"XfaLayer",{enumerable:!0,get:function(){return Oe.XfaLayer}}),Object.defineProperty(e,"build",{enumerable:!0,get:function(){return r.build}}),Object.defineProperty(e,"createValidAbsoluteUrl",{enumerable:!0,get:function(){return t.createValidAbsoluteUrl}}),Object.defineProperty(e,"getDocument",{enumerable:!0,get:function(){return r.getDocument}}),Object.defineProperty(e,"getFilenameFromUrl",{enumerable:!0,get:function(){return n.getFilenameFromUrl}}),Object.defineProperty(e,"getPdfFilenameFromUrl",{enumerable:!0,get:function(){return n.getPdfFilenameFromUrl}}),Object.defineProperty(e,"getXfaPageViewport",{enumerable:!0,get:function(){return n.getXfaPageViewport}}),Object.defineProperty(e,"isDataScheme",{enumerable:!0,get:function(){return n.isDataScheme}}),Object.defineProperty(e,"isPdfFile",{enumerable:!0,get:function(){return n.isPdfFile}}),Object.defineProperty(e,"loadScript",{enumerable:!0,get:function(){return n.loadScript}}),Object.defineProperty(e,"noContextMenu",{enumerable:!0,get:function(){return n.noContextMenu}}),Object.defineProperty(e,"normalizeUnicode",{enumerable:!0,get:function(){return t.normalizeUnicode}}),Object.defineProperty(e,"renderTextLayer",{enumerable:!0,get:function(){return Ee.renderTextLayer}}),Object.defineProperty(e,"setLayerDimensions",{enumerable:!0,get:function(){return n.setLayerDimensions}}),Object.defineProperty(e,"shadow",{enumerable:!0,get:function(){return t.shadow}}),Object.defineProperty(e,"updateTextLayer",{enumerable:!0,get:function(){return Ee.updateTextLayer}}),Object.defineProperty(e,"version",{enumerable:!0,get:function(){return r.version}});var t=__w_pdfjs_require__(1),r=__w_pdfjs_require__(2),n=__w_pdfjs_require__(6),Ee=__w_pdfjs_require__(26),Ce=__w_pdfjs_require__(27),De=__w_pdfjs_require__(5),Me=__w_pdfjs_require__(29),ze=__w_pdfjs_require__(14),Oe=__w_pdfjs_require__(32)})(),__webpack_exports__})())})(pdf$1)),pdf$1.exports}var pdfExports=requirePdf();const pdf=getDefaultExportFromCjs(pdfExports),pdfjsLib=_mergeNamespaces({__proto__:null,default:pdf},[pdfExports]),pdfjs$1=pdf||pdfjsLib;pdfjs$1?.GlobalWorkerOptions&&(pdfjs$1.GlobalWorkerOptions.workerSrc=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs$1.version||"3.11.174"}/pdf.worker.min.js`);const cleanTeacherName=e=>{if(!e)return"";let t=e.replace(/[\n\r]+/g," ").replace(/^[0-9\.\-\)\(\s]+/,"").replace(/\s+/g," ").trim();return["NBET","NOBETCI","DAREC","IDARECI","MDR","MUDUR","YARDIMCI","YARDIMCISI","YRD","KAT","ZEMN","BAHE","GR","KAPI","BLOK","KUZEY","GNEY","DOU","BATI","KANTN","RETMEN","OGRETMEN","GREVL","SAYIN"].forEach(n=>{const Ee=new RegExp(`(^|\\s)${n}(?=\\s|$)`,"gi");t=t.replace(Ee," ")}),t=t.replace(/\s+/g," ").trim().toLocaleUpperCase("tr-TR"),t.length<3?"":t},fileToArrayBuffer=e=>new Promise((t,r)=>{const n=new FileReader;n.readAsArrayBuffer(e),n.onload=()=>t(n.result),n.onerror=r});async function getPageTextItems(e,t){return(await(await e.getPage(t)).getTextContent()).items.map(Ee=>({str:Ee.str,x:Ee.transform[4],y:Ee.transform[5],w:Ee.width,h:Ee.height,centerX:Ee.transform[4]+Ee.width/2,centerY:Ee.transform[5]+Ee.height/2,fontSize:Math.sqrt(Math.pow(Ee.transform[0],2)+Math.pow(Ee.transform[1],2))}))}function normalizeDayName(e){const t=e.trim().toLocaleUpperCase("tr-TR");return t.startsWith("PA")&&!t.startsWith("PER")?"Pazartesi":t.startsWith("SA")?"Sal":t.startsWith("A")||t.startsWith("CR")?"aramba":t.startsWith("PE")||t.startsWith("PR")?"Perembe":t.startsWith("CU")||t.startsWith("CM")?"Cuma":e}const parseSchedulePDF=async e=>{let t=e instanceof File?await fileToArrayBuffer(e):new Uint8Array(window.atob(e).split("").map(Ee=>Ee.charCodeAt(0))).buffer;const r=await pdfjs$1.getDocument({data:t}).promise,n=[];for(let Ee=1;Ee<=r.numPages;Ee++)try{const Ce=await getPageTextItems(r,Ee);let De="";const Me=Ce.filter(ar=>ar.y>300&&!/T\.C|MDRL|LSES|LKRETM|OKULU|DERS|PROGRAMI|SINIF|TARH|Say|Konu|Haftalk|Oluturuldu|Eitim|retim|Yl/i.test(ar.str)&&ar.str.trim().length>3);Me.sort((ar,hr)=>(hr.fontSize||0)-(ar.fontSize||0)),Me.length>0&&(De=cleanTeacherName(Me[0].str)),De||(De=`retmen (Sayfa ${Ee})`);const ze=["PAZARTES","SALI","ARAMBA","PEREMBE","CUMA","PA","SA","A","PE","CU","PZT","PR"];let Oe=Ce.filter(ar=>{if(ar.x>150)return!1;const hr=ar.str.trim().toLocaleUpperCase("tr-TR");return ze.some(pr=>hr===pr||hr.startsWith(pr+" "))});const Be=[];if(Oe.sort((ar,hr)=>hr.y-ar.y),Oe.forEach(ar=>{Be.find(pr=>Math.abs(pr.centerY-ar.centerY)<20)||Be.push({day:normalizeDayName(ar.str),centerY:ar.centerY})}),Be.length<3)continue;let He=0;for(let ar=0;ar<Be.length-1;ar++)He+=Math.abs(Be[ar].centerY-Be[ar+1].centerY);const Xe=He/(Be.length-1)*.45,We=Be[0].centerY,Ge=Ce.filter(ar=>ar.y>We&&ar.y<We+200&&/^[1-8]$/.test(ar.str.trim())),$e=[];if(Ge.sort((ar,hr)=>ar.x-hr.x),Ge.forEach(ar=>{const hr=parseInt(ar.str);$e.find(pr=>pr.period===hr)||$e.push({period:hr,centerX:ar.centerX})}),$e.length<5)for(let yr=1;yr<=8;yr++)$e.push({period:yr,centerX:140+51.25*(yr-1)+51.25/2});const rr=($e[$e.length-1].centerX-$e[0].centerX)/($e.length-1)*.55,tr=Ce.filter(ar=>ar.x>100&&ar.y<We+Xe&&ar.y>Be[Be.length-1].centerY-Xe&&!/^[1-8]$/.test(ar.str.trim())),sr={};Be.forEach(ar=>{sr[ar.day]=Array(8).fill(null).map((hr,pr)=>({period:pr+1,className:null,subject:null}))}),tr.forEach(ar=>{let hr=-1,pr=1/0;if(Be.forEach((mr,wr)=>{const Fr=Math.abs(mr.centerY-ar.centerY);Fr<pr&&(pr=Fr,hr=wr)}),pr>Xe)return;const yr=Be[hr].day;let fr=-1,Rr=1/0;if($e.forEach(mr=>{const wr=Math.abs(mr.centerX-ar.centerX);wr<Rr&&(Rr=wr,fr=mr.period)}),!(Rr>rr)&&fr>=1&&fr<=8){const mr=fr-1,wr=sr[yr][mr].className||"",Fr=ar.str.trim();Fr&&!wr.includes(Fr)&&(sr[yr][mr].className=(wr+" "+Fr).trim())}}),Object.keys(sr).forEach(ar=>{sr[ar].forEach(hr=>{hr.className&&(/^[\.\-\:\s\d]+$/.test(hr.className)?hr.className=null:hr.className=hr.className.replace(/\s+/g," ").trim())})}),n.push({name:De,schedule:sr})}catch(Ce){console.warn(`Error parsing page ${Ee}`,Ce)}return n};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var XLSX={};XLSX.version="0.18.5";var current_ansi=1252,VALID_ANSI=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],CS2CP={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},set_ansi=function(e){VALID_ANSI.indexOf(e)!=-1&&(current_ansi=CS2CP[0]=e)};function reset_ansi(){set_ansi(1252)}var set_cp=function(e){set_ansi(e)};function reset_cp(){set_cp(1200),reset_ansi()}function char_codes(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function utf16leread(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function utf16beread(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var debom=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?utf16leread(e.slice(2)):t==254&&r==255?utf16beread(e.slice(2)):t==65279?e.slice(1):e},_getchar=function e(t){return String.fromCharCode(t)},_getansi=function e(t){return String.fromCharCode(t)},$cptable,Base64_map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Base64_encode(e){for(var t="",r=0,n=0,Ee=0,Ce=0,De=0,Me=0,ze=0,Oe=0;Oe<e.length;)r=e.charCodeAt(Oe++),Ce=r>>2,n=e.charCodeAt(Oe++),De=(r&3)<<4|n>>4,Ee=e.charCodeAt(Oe++),Me=(n&15)<<2|Ee>>6,ze=Ee&63,isNaN(n)?Me=ze=64:isNaN(Ee)&&(ze=64),t+=Base64_map.charAt(Ce)+Base64_map.charAt(De)+Base64_map.charAt(Me)+Base64_map.charAt(ze);return t}function Base64_decode(e){var t="",r=0,n=0,Ee=0,Ce=0,De=0,Me=0,ze=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var Oe=0;Oe<e.length;)Ce=Base64_map.indexOf(e.charAt(Oe++)),De=Base64_map.indexOf(e.charAt(Oe++)),r=Ce<<2|De>>4,t+=String.fromCharCode(r),Me=Base64_map.indexOf(e.charAt(Oe++)),n=(De&15)<<4|Me>>2,Me!==64&&(t+=String.fromCharCode(n)),ze=Base64_map.indexOf(e.charAt(Oe++)),Ee=(Me&3)<<6|ze,ze!==64&&(t+=String.fromCharCode(Ee));return t}var has_buf=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Buffer_from=(function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}})();function new_raw_buf(e){return has_buf?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function new_unsafe_buf(e){return has_buf?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var s2a=function e(t){return has_buf?Buffer_from(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function s2ab(e){if(typeof ArrayBuffer>"u")return s2a(e);for(var t=new ArrayBuffer(e.length),r=new Uint8Array(t),n=0;n!=e.length;++n)r[n]=e.charCodeAt(n)&255;return t}function a2s(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function a2u(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function ab2a(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return ab2a(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var bconcat=has_buf?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:Buffer_from(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),Ee=0;for(t=0,r=0;t<e.length;r+=Ee,++t)if(Ee=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(Ce){return Array.isArray(Ce)?Ce:[].slice.call(Ce)}))};function utf8decode(e){for(var t=[],r=0,n=e.length+250,Ee=new_raw_buf(e.length+255),Ce=0;Ce<e.length;++Ce){var De=e.charCodeAt(Ce);if(De<128)Ee[r++]=De;else if(De<2048)Ee[r++]=192|De>>6&31,Ee[r++]=128|De&63;else if(De>=55296&&De<57344){De=(De&1023)+64;var Me=e.charCodeAt(++Ce)&1023;Ee[r++]=240|De>>8&7,Ee[r++]=128|De>>2&63,Ee[r++]=128|Me>>6&15|(De&3)<<4,Ee[r++]=128|Me&63}else Ee[r++]=224|De>>12&15,Ee[r++]=128|De>>6&63,Ee[r++]=128|De&63;r>n&&(t.push(Ee.slice(0,r)),r=0,Ee=new_raw_buf(65535),n=65530)}return t.push(Ee.slice(0,r)),bconcat(t)}var chr0=/\u0000/g,chr1=/[\u0001-\u0006]/g;function _strrev(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function pad0(e,t){var r=""+e;return r.length>=t?r:fill("0",t-r.length)+r}function pad_(e,t){var r=""+e;return r.length>=t?r:fill(" ",t-r.length)+r}function rpad_(e,t){var r=""+e;return r.length>=t?r:r+fill(" ",t-r.length)}function pad0r1(e,t){var r=""+Math.round(e);return r.length>=t?r:fill("0",t-r.length)+r}function pad0r2(e,t){var r=""+e;return r.length>=t?r:fill("0",t-r.length)+r}var p2_32=Math.pow(2,32);function pad0r(e,t){if(e>p2_32||e<-p2_32)return pad0r1(e,t);var r=Math.round(e);return pad0r2(r,t)}function SSF_isgeneral(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var days=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],months=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function SSF_init_table(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var table_fmt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},SSF_default_map={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},SSF_default_str={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function SSF_frac(e,t,r){for(var n=e<0?-1:1,Ee=e*n,Ce=0,De=1,Me=0,ze=1,Oe=0,Be=0,He=Math.floor(Ee);Oe<t&&(He=Math.floor(Ee),Me=He*De+Ce,Be=He*Oe+ze,!(Ee-He<5e-8));)Ee=1/(Ee-He),Ce=De,De=Me,ze=Oe,Oe=Be;if(Be>t&&(Oe>t?(Be=ze,Me=Ce):(Be=Oe,Me=De)),!r)return[0,n*Me,Be];var Ve=Math.floor(n*Me/Be);return[Ve,n*Me-Ve*Be,Be]}function SSF_parse_date_code(e,t,r){if(e>2958465||e<0)return null;var n=e|0,Ee=Math.floor(86400*(e-n)),Ce=0,De=[],Me={D:n,T:Ee,u:86400*(e-n)-Ee,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(Me.u)<1e-6&&(Me.u=0),t&&t.date1904&&(n+=1462),Me.u>.9999&&(Me.u=0,++Ee==86400&&(Me.T=Ee=0,++n,++Me.D)),n===60)De=r?[1317,10,29]:[1900,2,29],Ce=3;else if(n===0)De=r?[1317,8,29]:[1900,1,0],Ce=6;else{n>60&&--n;var ze=new Date(1900,0,1);ze.setDate(ze.getDate()+n-1),De=[ze.getFullYear(),ze.getMonth()+1,ze.getDate()],Ce=ze.getDay(),n<60&&(Ce=(Ce+6)%7),r&&(Ce=SSF_fix_hijri(ze,De))}return Me.y=De[0],Me.m=De[1],Me.d=De[2],Me.S=Ee%60,Ee=Math.floor(Ee/60),Me.M=Ee%60,Ee=Math.floor(Ee/60),Me.H=Ee,Me.q=Ce,Me}var SSFbasedate=new Date(1899,11,31,0,0,0),SSFdnthresh=SSFbasedate.getTime(),SSFbase1904=new Date(1900,2,1,0,0,0);function datenum_local(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=SSFbase1904&&(r+=1440*60*1e3),(r-(SSFdnthresh+(e.getTimezoneOffset()-SSFbasedate.getTimezoneOffset())*6e4))/(1440*60*1e3)}function SSF_strip_decimal(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function SSF_normalize_exp(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function SSF_small_exp(e){var t=e<0?12:11,r=SSF_strip_decimal(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function SSF_large_exp(e){var t=SSF_strip_decimal(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function SSF_general_num(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=SSF_small_exp(e):t===10?r=e.toFixed(10).substr(0,12):r=SSF_large_exp(e),SSF_strip_decimal(SSF_normalize_exp(r.toUpperCase()))}function SSF_general(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):SSF_general_num(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return SSF_format(14,datenum_local(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function SSF_fix_hijri(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function SSF_write_date(e,t,r,n){var Ee="",Ce=0,De=0,Me=r.y,ze,Oe=0;switch(e){case 98:Me=r.y+543;case 121:switch(t.length){case 1:case 2:ze=Me%100,Oe=2;break;default:ze=Me%1e4,Oe=4;break}break;case 109:switch(t.length){case 1:case 2:ze=r.m,Oe=t.length;break;case 3:return months[r.m-1][1];case 5:return months[r.m-1][0];default:return months[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:ze=r.d,Oe=t.length;break;case 3:return days[r.q][0];default:return days[r.q][1]}break;case 104:switch(t.length){case 1:case 2:ze=1+(r.H+11)%12,Oe=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:ze=r.H,Oe=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:ze=r.M,Oe=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?pad0(r.S,t.length):(n>=2?De=n===3?1e3:100:De=n===1?10:1,Ce=Math.round(De*(r.S+r.u)),Ce>=60*De&&(Ce=0),t==="s"?Ce===0?"0":""+Ce/De:(Ee=pad0(Ce,2+n),t==="ss"?Ee.substr(0,2):"."+Ee.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":ze=r.D*24+r.H;break;case"[m]":case"[mm]":ze=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":ze=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}Oe=t.length===3?1:2;break;case 101:ze=Me,Oe=1;break}var Be=Oe>0?pad0(ze,Oe):"";return Be}function commaify(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var pct1=/%/g;function write_num_pct(e,t,r){var n=t.replace(pct1,""),Ee=t.length-n.length;return write_num(e,n,r*Math.pow(10,2*Ee))+fill("%",Ee)}function write_num_cm(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return write_num(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function write_num_exp(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+write_num_exp(e,-t);var Ee=e.indexOf(".");Ee===-1&&(Ee=e.indexOf("E"));var Ce=Math.floor(Math.log(t)*Math.LOG10E)%Ee;if(Ce<0&&(Ce+=Ee),r=(t/Math.pow(10,Ce)).toPrecision(n+1+(Ee+Ce)%Ee),r.indexOf("e")===-1){var De=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(De-r.length+Ce):r+="E+"+(De-Ce);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,Ee)+"."+r.substr(2+Ee),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(Me,ze,Oe,Be){return ze+Oe+Be.substr(0,(Ee+Ce)%Ee)+"."+Be.substr(Ce)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var frac1=/# (\?+)( ?)\/( ?)(\d+)/;function write_num_f1(e,t,r){var n=parseInt(e[4],10),Ee=Math.round(t*n),Ce=Math.floor(Ee/n),De=Ee-Ce*n,Me=n;return r+(Ce===0?"":""+Ce)+" "+(De===0?fill(" ",e[1].length+1+e[4].length):pad_(De,e[1].length)+e[2]+"/"+e[3]+pad0(Me,e[4].length))}function write_num_f2(e,t,r){return r+(t===0?"":""+t)+fill(" ",e[1].length+2+e[4].length)}var dec1=/^#*0*\.([0#]+)/,closeparen=/\).*[0#]/,phone=/\(###\) ###\\?-####/;function hashq(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function rnd(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function dec(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function carry(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function flr(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function write_num_flt(e,t,r){if(e.charCodeAt(0)===40&&!t.match(closeparen)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?write_num_flt("n",n,r):"("+write_num_flt("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return write_num_cm(e,t,r);if(t.indexOf("%")!==-1)return write_num_pct(e,t,r);if(t.indexOf("E")!==-1)return write_num_exp(t,r);if(t.charCodeAt(0)===36)return"$"+write_num_flt(e,t.substr(t.charAt(1)==" "?2:1),r);var Ee,Ce,De,Me,ze=Math.abs(r),Oe=r<0?"-":"";if(t.match(/^00+$/))return Oe+pad0r(ze,t.length);if(t.match(/^[#?]+$/))return Ee=pad0r(r,0),Ee==="0"&&(Ee=""),Ee.length>t.length?Ee:hashq(t.substr(0,t.length-Ee.length))+Ee;if(Ce=t.match(frac1))return write_num_f1(Ce,ze,Oe);if(t.match(/^#+0+$/))return Oe+pad0r(ze,t.length-t.indexOf("0"));if(Ce=t.match(dec1))return Ee=rnd(r,Ce[1].length).replace(/^([^\.]+)$/,"$1."+hashq(Ce[1])).replace(/\.$/,"."+hashq(Ce[1])).replace(/\.(\d*)$/,function(We,Ge){return"."+Ge+fill("0",hashq(Ce[1]).length-Ge.length)}),t.indexOf("0.")!==-1?Ee:Ee.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),Ce=t.match(/^(0*)\.(#*)$/))return Oe+rnd(ze,Ce[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,Ce[1].length?"0.":".");if(Ce=t.match(/^#{1,3},##0(\.?)$/))return Oe+commaify(pad0r(ze,0));if(Ce=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+write_num_flt(e,t,-r):commaify(""+(Math.floor(r)+carry(r,Ce[1].length)))+"."+pad0(dec(r,Ce[1].length),Ce[1].length);if(Ce=t.match(/^#,#*,#0/))return write_num_flt(e,t.replace(/^#,#*,/,""),r);if(Ce=t.match(/^([0#]+)(\\?-([0#]+))+$/))return Ee=_strrev(write_num_flt(e,t.replace(/[\\-]/g,""),r)),De=0,_strrev(_strrev(t.replace(/\\/g,"")).replace(/[0#]/g,function(We){return De<Ee.length?Ee.charAt(De++):We==="0"?"0":""}));if(t.match(phone))return Ee=write_num_flt(e,"##########",r),"("+Ee.substr(0,3)+") "+Ee.substr(3,3)+"-"+Ee.substr(6);var Be="";if(Ce=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return De=Math.min(Ce[4].length,7),Me=SSF_frac(ze,Math.pow(10,De)-1,!1),Ee=""+Oe,Be=write_num("n",Ce[1],Me[1]),Be.charAt(Be.length-1)==" "&&(Be=Be.substr(0,Be.length-1)+"0"),Ee+=Be+Ce[2]+"/"+Ce[3],Be=rpad_(Me[2],De),Be.length<Ce[4].length&&(Be=hashq(Ce[4].substr(Ce[4].length-Be.length))+Be),Ee+=Be,Ee;if(Ce=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return De=Math.min(Math.max(Ce[1].length,Ce[4].length),7),Me=SSF_frac(ze,Math.pow(10,De)-1,!0),Oe+(Me[0]||(Me[1]?"":"0"))+" "+(Me[1]?pad_(Me[1],De)+Ce[2]+"/"+Ce[3]+rpad_(Me[2],De):fill(" ",2*De+1+Ce[2].length+Ce[3].length));if(Ce=t.match(/^[#0?]+$/))return Ee=pad0r(r,0),t.length<=Ee.length?Ee:hashq(t.substr(0,t.length-Ee.length))+Ee;if(Ce=t.match(/^([#0?]+)\.([#0]+)$/)){Ee=""+r.toFixed(Math.min(Ce[2].length,10)).replace(/([^0])0+$/,"$1"),De=Ee.indexOf(".");var He=t.indexOf(".")-De,Ve=t.length-Ee.length-He;return hashq(t.substr(0,He)+Ee+t.substr(t.length-Ve))}if(Ce=t.match(/^00,000\.([#0]*0)$/))return De=dec(r,Ce[1].length),r<0?"-"+write_num_flt(e,t,-r):commaify(flr(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(We){return"00,"+(We.length<3?pad0(0,3-We.length):"")+We})+"."+pad0(De,Ce[1].length);switch(t){case"###,##0.00":return write_num_flt(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var Xe=commaify(pad0r(ze,0));return Xe!=="0"?Oe+Xe:"";case"###,###.00":return write_num_flt(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return write_num_flt(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function write_num_cm2(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return write_num(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function write_num_pct2(e,t,r){var n=t.replace(pct1,""),Ee=t.length-n.length;return write_num(e,n,r*Math.pow(10,2*Ee))+fill("%",Ee)}function write_num_exp2(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+write_num_exp2(e,-t);var Ee=e.indexOf(".");Ee===-1&&(Ee=e.indexOf("E"));var Ce=Math.floor(Math.log(t)*Math.LOG10E)%Ee;if(Ce<0&&(Ce+=Ee),r=(t/Math.pow(10,Ce)).toPrecision(n+1+(Ee+Ce)%Ee),!r.match(/[Ee]/)){var De=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(De-r.length+Ce):r+="E+"+(De-Ce),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(Me,ze,Oe,Be){return ze+Oe+Be.substr(0,(Ee+Ce)%Ee)+"."+Be.substr(Ce)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function write_num_int(e,t,r){if(e.charCodeAt(0)===40&&!t.match(closeparen)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?write_num_int("n",n,r):"("+write_num_int("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return write_num_cm2(e,t,r);if(t.indexOf("%")!==-1)return write_num_pct2(e,t,r);if(t.indexOf("E")!==-1)return write_num_exp2(t,r);if(t.charCodeAt(0)===36)return"$"+write_num_int(e,t.substr(t.charAt(1)==" "?2:1),r);var Ee,Ce,De,Me,ze=Math.abs(r),Oe=r<0?"-":"";if(t.match(/^00+$/))return Oe+pad0(ze,t.length);if(t.match(/^[#?]+$/))return Ee=""+r,r===0&&(Ee=""),Ee.length>t.length?Ee:hashq(t.substr(0,t.length-Ee.length))+Ee;if(Ce=t.match(frac1))return write_num_f2(Ce,ze,Oe);if(t.match(/^#+0+$/))return Oe+pad0(ze,t.length-t.indexOf("0"));if(Ce=t.match(dec1))return Ee=(""+r).replace(/^([^\.]+)$/,"$1."+hashq(Ce[1])).replace(/\.$/,"."+hashq(Ce[1])),Ee=Ee.replace(/\.(\d*)$/,function(We,Ge){return"."+Ge+fill("0",hashq(Ce[1]).length-Ge.length)}),t.indexOf("0.")!==-1?Ee:Ee.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),Ce=t.match(/^(0*)\.(#*)$/))return Oe+(""+ze).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,Ce[1].length?"0.":".");if(Ce=t.match(/^#{1,3},##0(\.?)$/))return Oe+commaify(""+ze);if(Ce=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+write_num_int(e,t,-r):commaify(""+r)+"."+fill("0",Ce[1].length);if(Ce=t.match(/^#,#*,#0/))return write_num_int(e,t.replace(/^#,#*,/,""),r);if(Ce=t.match(/^([0#]+)(\\?-([0#]+))+$/))return Ee=_strrev(write_num_int(e,t.replace(/[\\-]/g,""),r)),De=0,_strrev(_strrev(t.replace(/\\/g,"")).replace(/[0#]/g,function(We){return De<Ee.length?Ee.charAt(De++):We==="0"?"0":""}));if(t.match(phone))return Ee=write_num_int(e,"##########",r),"("+Ee.substr(0,3)+") "+Ee.substr(3,3)+"-"+Ee.substr(6);var Be="";if(Ce=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return De=Math.min(Ce[4].length,7),Me=SSF_frac(ze,Math.pow(10,De)-1,!1),Ee=""+Oe,Be=write_num("n",Ce[1],Me[1]),Be.charAt(Be.length-1)==" "&&(Be=Be.substr(0,Be.length-1)+"0"),Ee+=Be+Ce[2]+"/"+Ce[3],Be=rpad_(Me[2],De),Be.length<Ce[4].length&&(Be=hashq(Ce[4].substr(Ce[4].length-Be.length))+Be),Ee+=Be,Ee;if(Ce=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return De=Math.min(Math.max(Ce[1].length,Ce[4].length),7),Me=SSF_frac(ze,Math.pow(10,De)-1,!0),Oe+(Me[0]||(Me[1]?"":"0"))+" "+(Me[1]?pad_(Me[1],De)+Ce[2]+"/"+Ce[3]+rpad_(Me[2],De):fill(" ",2*De+1+Ce[2].length+Ce[3].length));if(Ce=t.match(/^[#0?]+$/))return Ee=""+r,t.length<=Ee.length?Ee:hashq(t.substr(0,t.length-Ee.length))+Ee;if(Ce=t.match(/^([#0]+)\.([#0]+)$/)){Ee=""+r.toFixed(Math.min(Ce[2].length,10)).replace(/([^0])0+$/,"$1"),De=Ee.indexOf(".");var He=t.indexOf(".")-De,Ve=t.length-Ee.length-He;return hashq(t.substr(0,He)+Ee+t.substr(t.length-Ve))}if(Ce=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+write_num_int(e,t,-r):commaify(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(We){return"00,"+(We.length<3?pad0(0,3-We.length):"")+We})+"."+pad0(0,Ce[1].length);switch(t){case"###,###":case"##,###":case"#,###":var Xe=commaify(""+ze);return Xe!=="0"?Oe+Xe:"";default:if(t.match(/\.[0#?]*$/))return write_num_int(e,t.slice(0,t.lastIndexOf(".")),r)+hashq(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function write_num(e,t,r){return(r|0)===r?write_num_int(e,t,r):write_num_flt(e,t,r)}function SSF_split_fmt(e){for(var t=[],r=!1,n=0,Ee=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(Ee,n-Ee),Ee=n+1}if(t[t.length]=e.substr(Ee),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var SSF_abstime=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fmt_is_date(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":SSF_isgeneral(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(SSF_abstime))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function eval_fmt(e,t,r,n){for(var Ee=[],Ce="",De=0,Me="",ze="t",Oe,Be,He,Ve="H";De<e.length;)switch(Me=e.charAt(De)){case"G":if(!SSF_isgeneral(e,De))throw new Error("unrecognized character "+Me+" in "+e);Ee[Ee.length]={t:"G",v:"General"},De+=7;break;case'"':for(Ce="";(He=e.charCodeAt(++De))!==34&&De<e.length;)Ce+=String.fromCharCode(He);Ee[Ee.length]={t:"t",v:Ce},++De;break;case"\\":var Xe=e.charAt(++De),We=Xe==="("||Xe===")"?Xe:"t";Ee[Ee.length]={t:We,v:Xe},++De;break;case"_":Ee[Ee.length]={t:"t",v:" "},De+=2;break;case"@":Ee[Ee.length]={t:"T",v:t},++De;break;case"B":case"b":if(e.charAt(De+1)==="1"||e.charAt(De+1)==="2"){if(Oe==null&&(Oe=SSF_parse_date_code(t,r,e.charAt(De+1)==="2"),Oe==null))return"";Ee[Ee.length]={t:"X",v:e.substr(De,2)},ze=Me,De+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":Me=Me.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||Oe==null&&(Oe=SSF_parse_date_code(t,r),Oe==null))return"";for(Ce=Me;++De<e.length&&e.charAt(De).toLowerCase()===Me;)Ce+=Me;Me==="m"&&ze.toLowerCase()==="h"&&(Me="M"),Me==="h"&&(Me=Ve),Ee[Ee.length]={t:Me,v:Ce},ze=Me;break;case"A":case"a":case"":var Ge={t:Me,v:Me};if(Oe==null&&(Oe=SSF_parse_date_code(t,r)),e.substr(De,3).toUpperCase()==="A/P"?(Oe!=null&&(Ge.v=Oe.H>=12?"P":"A"),Ge.t="T",Ve="h",De+=3):e.substr(De,5).toUpperCase()==="AM/PM"?(Oe!=null&&(Ge.v=Oe.H>=12?"PM":"AM"),Ge.t="T",De+=5,Ve="h"):e.substr(De,5).toUpperCase()==="/"?(Oe!=null&&(Ge.v=Oe.H>=12?"":""),Ge.t="T",De+=5,Ve="h"):(Ge.t="t",++De),Oe==null&&Ge.t==="T")return"";Ee[Ee.length]=Ge,ze=Me;break;case"[":for(Ce=Me;e.charAt(De++)!=="]"&&De<e.length;)Ce+=e.charAt(De);if(Ce.slice(-1)!=="]")throw'unterminated "[" block: |'+Ce+"|";if(Ce.match(SSF_abstime)){if(Oe==null&&(Oe=SSF_parse_date_code(t,r),Oe==null))return"";Ee[Ee.length]={t:"Z",v:Ce.toLowerCase()},ze=Ce.charAt(1)}else Ce.indexOf("$")>-1&&(Ce=(Ce.match(/\$([^-\[\]]*)/)||[])[1]||"$",fmt_is_date(e)||(Ee[Ee.length]={t:"t",v:Ce}));break;case".":if(Oe!=null){for(Ce=Me;++De<e.length&&(Me=e.charAt(De))==="0";)Ce+=Me;Ee[Ee.length]={t:"s",v:Ce};break}case"0":case"#":for(Ce=Me;++De<e.length&&"0#?.,E+-%".indexOf(Me=e.charAt(De))>-1;)Ce+=Me;Ee[Ee.length]={t:"n",v:Ce};break;case"?":for(Ce=Me;e.charAt(++De)===Me;)Ce+=Me;Ee[Ee.length]={t:Me,v:Ce},ze=Me;break;case"*":++De,(e.charAt(De)==" "||e.charAt(De)=="*")&&++De;break;case"(":case")":Ee[Ee.length]={t:n===1?"t":Me,v:Me},++De;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(Ce=Me;De<e.length&&"0123456789".indexOf(e.charAt(++De))>-1;)Ce+=e.charAt(De);Ee[Ee.length]={t:"D",v:Ce};break;case" ":Ee[Ee.length]={t:Me,v:Me},++De;break;case"$":Ee[Ee.length]={t:"t",v:"$"},++De;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(Me)===-1)throw new Error("unrecognized character "+Me+" in "+e);Ee[Ee.length]={t:"t",v:Me},++De;break}var $e=0,Ke=0,rr;for(De=Ee.length-1,ze="t";De>=0;--De)switch(Ee[De].t){case"h":case"H":Ee[De].t=Ve,ze="h",$e<1&&($e=1);break;case"s":(rr=Ee[De].v.match(/\.0+$/))&&(Ke=Math.max(Ke,rr[0].length-1)),$e<3&&($e=3);case"d":case"y":case"M":case"e":ze=Ee[De].t;break;case"m":ze==="s"&&(Ee[De].t="M",$e<2&&($e=2));break;case"X":break;case"Z":$e<1&&Ee[De].v.match(/[Hh]/)&&($e=1),$e<2&&Ee[De].v.match(/[Mm]/)&&($e=2),$e<3&&Ee[De].v.match(/[Ss]/)&&($e=3)}switch($e){case 0:break;case 1:Oe.u>=.5&&(Oe.u=0,++Oe.S),Oe.S>=60&&(Oe.S=0,++Oe.M),Oe.M>=60&&(Oe.M=0,++Oe.H);break;case 2:Oe.u>=.5&&(Oe.u=0,++Oe.S),Oe.S>=60&&(Oe.S=0,++Oe.M);break}var tr="",sr;for(De=0;De<Ee.length;++De)switch(Ee[De].t){case"t":case"T":case" ":case"D":break;case"X":Ee[De].v="",Ee[De].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":Ee[De].v=SSF_write_date(Ee[De].t.charCodeAt(0),Ee[De].v,Oe,Ke),Ee[De].t="t";break;case"n":case"?":for(sr=De+1;Ee[sr]!=null&&((Me=Ee[sr].t)==="?"||Me==="D"||(Me===" "||Me==="t")&&Ee[sr+1]!=null&&(Ee[sr+1].t==="?"||Ee[sr+1].t==="t"&&Ee[sr+1].v==="/")||Ee[De].t==="("&&(Me===" "||Me==="n"||Me===")")||Me==="t"&&(Ee[sr].v==="/"||Ee[sr].v===" "&&Ee[sr+1]!=null&&Ee[sr+1].t=="?"));)Ee[De].v+=Ee[sr].v,Ee[sr]={v:"",t:";"},++sr;tr+=Ee[De].v,De=sr-1;break;case"G":Ee[De].t="t",Ee[De].v=SSF_general(t,r);break}var ar="",hr,pr;if(tr.length>0){tr.charCodeAt(0)==40?(hr=t<0&&tr.charCodeAt(0)===45?-t:t,pr=write_num("n",tr,hr)):(hr=t<0&&n>1?-t:t,pr=write_num("n",tr,hr),hr<0&&Ee[0]&&Ee[0].t=="t"&&(pr=pr.substr(1),Ee[0].v="-"+Ee[0].v)),sr=pr.length-1;var yr=Ee.length;for(De=0;De<Ee.length;++De)if(Ee[De]!=null&&Ee[De].t!="t"&&Ee[De].v.indexOf(".")>-1){yr=De;break}var fr=Ee.length;if(yr===Ee.length&&pr.indexOf("E")===-1){for(De=Ee.length-1;De>=0;--De)Ee[De]==null||"n?".indexOf(Ee[De].t)===-1||(sr>=Ee[De].v.length-1?(sr-=Ee[De].v.length,Ee[De].v=pr.substr(sr+1,Ee[De].v.length)):sr<0?Ee[De].v="":(Ee[De].v=pr.substr(0,sr+1),sr=-1),Ee[De].t="t",fr=De);sr>=0&&fr<Ee.length&&(Ee[fr].v=pr.substr(0,sr+1)+Ee[fr].v)}else if(yr!==Ee.length&&pr.indexOf("E")===-1){for(sr=pr.indexOf(".")-1,De=yr;De>=0;--De)if(!(Ee[De]==null||"n?".indexOf(Ee[De].t)===-1)){for(Be=Ee[De].v.indexOf(".")>-1&&De===yr?Ee[De].v.indexOf(".")-1:Ee[De].v.length-1,ar=Ee[De].v.substr(Be+1);Be>=0;--Be)sr>=0&&(Ee[De].v.charAt(Be)==="0"||Ee[De].v.charAt(Be)==="#")&&(ar=pr.charAt(sr--)+ar);Ee[De].v=ar,Ee[De].t="t",fr=De}for(sr>=0&&fr<Ee.length&&(Ee[fr].v=pr.substr(0,sr+1)+Ee[fr].v),sr=pr.indexOf(".")+1,De=yr;De<Ee.length;++De)if(!(Ee[De]==null||"n?(".indexOf(Ee[De].t)===-1&&De!==yr)){for(Be=Ee[De].v.indexOf(".")>-1&&De===yr?Ee[De].v.indexOf(".")+1:0,ar=Ee[De].v.substr(0,Be);Be<Ee[De].v.length;++Be)sr<pr.length&&(ar+=pr.charAt(sr++));Ee[De].v=ar,Ee[De].t="t",fr=De}}}for(De=0;De<Ee.length;++De)Ee[De]!=null&&"n?".indexOf(Ee[De].t)>-1&&(hr=n>1&&t<0&&De>0&&Ee[De-1].v==="-"?-t:t,Ee[De].v=write_num(Ee[De].t,Ee[De].v,hr),Ee[De].t="t");var Rr="";for(De=0;De!==Ee.length;++De)Ee[De]!=null&&(Rr+=Ee[De].v);return Rr}var cfregex2=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function chkcond(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function choose_fmt(e,t){var r=SSF_split_fmt(e),n=r.length,Ee=r[n-1].indexOf("@");if(n<4&&Ee>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||Ee>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=Ee>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=Ee>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=Ee>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var Ce=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,Ce];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var De=r[0].match(cfregex2),Me=r[1].match(cfregex2);return chkcond(t,De)?[n,r[0]]:chkcond(t,Me)?[n,r[1]]:[n,r[De!=null&&Me!=null?2:1]]}return[n,Ce]}function SSF_format(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:table_fmt)[e],n==null&&(n=r.table&&r.table[SSF_default_map[e]]||table_fmt[SSF_default_map[e]]),n==null&&(n=SSF_default_str[e]||"General");break}if(SSF_isgeneral(n,0))return SSF_general(t,r);t instanceof Date&&(t=datenum_local(t,r.date1904));var Ee=choose_fmt(n,t);if(SSF_isgeneral(Ee[1]))return SSF_general(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return eval_fmt(Ee[1],t,r,Ee[0])}function SSF_load(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(table_fmt[r]==null){t<0&&(t=r);continue}if(table_fmt[r]==e){t=r;break}}t<0&&(t=391)}return table_fmt[t]=e,t}function SSF_load_table(e){for(var t=0;t!=392;++t)e[t]!==void 0&&SSF_load(e[t],t)}function make_ssf(){table_fmt=SSF_init_table()}var SSFImplicit={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},dateNFregex=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function dateNF_regex(e){var t=typeof e=="number"?table_fmt[e]:e;return t=t.replace(dateNFregex,"(\\d+)"),new RegExp("^"+t+"$")}function dateNF_fix(e,t,r){var n=-1,Ee=-1,Ce=-1,De=-1,Me=-1,ze=-1;(t.match(dateNFregex)||[]).forEach(function(He,Ve){var Xe=parseInt(r[Ve+1],10);switch(He.toLowerCase().charAt(0)){case"y":n=Xe;break;case"d":Ce=Xe;break;case"h":De=Xe;break;case"s":ze=Xe;break;case"m":De>=0?Me=Xe:Ee=Xe;break}}),ze>=0&&Me==-1&&Ee>=0&&(Me=Ee,Ee=-1);var Oe=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(Ee>=1?Ee:1)).slice(-2)+"-"+("00"+(Ce>=1?Ce:1)).slice(-2);Oe.length==7&&(Oe="0"+Oe),Oe.length==8&&(Oe="20"+Oe);var Be=("00"+(De>=0?De:0)).slice(-2)+":"+("00"+(Me>=0?Me:0)).slice(-2)+":"+("00"+(ze>=0?ze:0)).slice(-2);return De==-1&&Me==-1&&ze==-1?Oe:n==-1&&Ee==-1&&Ce==-1?Be:Oe+"T"+Be}var CRC32=(function(){var e={};e.version="1.2.0";function t(){for(var pr=0,yr=new Array(256),fr=0;fr!=256;++fr)pr=fr,pr=pr&1?-306674912^pr>>>1:pr>>>1,pr=pr&1?-306674912^pr>>>1:pr>>>1,pr=pr&1?-306674912^pr>>>1:pr>>>1,pr=pr&1?-306674912^pr>>>1:pr>>>1,pr=pr&1?-306674912^pr>>>1:pr>>>1,pr=pr&1?-306674912^pr>>>1:pr>>>1,pr=pr&1?-306674912^pr>>>1:pr>>>1,pr=pr&1?-306674912^pr>>>1:pr>>>1,yr[fr]=pr;return typeof Int32Array<"u"?new Int32Array(yr):yr}var r=t();function n(pr){var yr=0,fr=0,Rr=0,mr=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(Rr=0;Rr!=256;++Rr)mr[Rr]=pr[Rr];for(Rr=0;Rr!=256;++Rr)for(fr=pr[Rr],yr=256+Rr;yr<4096;yr+=256)fr=mr[yr]=fr>>>8^pr[fr&255];var wr=[];for(Rr=1;Rr!=16;++Rr)wr[Rr-1]=typeof Int32Array<"u"?mr.subarray(Rr*256,Rr*256+256):mr.slice(Rr*256,Rr*256+256);return wr}var Ee=n(r),Ce=Ee[0],De=Ee[1],Me=Ee[2],ze=Ee[3],Oe=Ee[4],Be=Ee[5],He=Ee[6],Ve=Ee[7],Xe=Ee[8],We=Ee[9],Ge=Ee[10],$e=Ee[11],Ke=Ee[12],rr=Ee[13],tr=Ee[14];function sr(pr,yr){for(var fr=yr^-1,Rr=0,mr=pr.length;Rr<mr;)fr=fr>>>8^r[(fr^pr.charCodeAt(Rr++))&255];return~fr}function ar(pr,yr){for(var fr=yr^-1,Rr=pr.length-15,mr=0;mr<Rr;)fr=tr[pr[mr++]^fr&255]^rr[pr[mr++]^fr>>8&255]^Ke[pr[mr++]^fr>>16&255]^$e[pr[mr++]^fr>>>24]^Ge[pr[mr++]]^We[pr[mr++]]^Xe[pr[mr++]]^Ve[pr[mr++]]^He[pr[mr++]]^Be[pr[mr++]]^Oe[pr[mr++]]^ze[pr[mr++]]^Me[pr[mr++]]^De[pr[mr++]]^Ce[pr[mr++]]^r[pr[mr++]];for(Rr+=15;mr<Rr;)fr=fr>>>8^r[(fr^pr[mr++])&255];return~fr}function hr(pr,yr){for(var fr=yr^-1,Rr=0,mr=pr.length,wr=0,Fr=0;Rr<mr;)wr=pr.charCodeAt(Rr++),wr<128?fr=fr>>>8^r[(fr^wr)&255]:wr<2048?(fr=fr>>>8^r[(fr^(192|wr>>6&31))&255],fr=fr>>>8^r[(fr^(128|wr&63))&255]):wr>=55296&&wr<57344?(wr=(wr&1023)+64,Fr=pr.charCodeAt(Rr++)&1023,fr=fr>>>8^r[(fr^(240|wr>>8&7))&255],fr=fr>>>8^r[(fr^(128|wr>>2&63))&255],fr=fr>>>8^r[(fr^(128|Fr>>6&15|(wr&3)<<4))&255],fr=fr>>>8^r[(fr^(128|Fr&63))&255]):(fr=fr>>>8^r[(fr^(224|wr>>12&15))&255],fr=fr>>>8^r[(fr^(128|wr>>6&63))&255],fr=fr>>>8^r[(fr^(128|wr&63))&255]);return~fr}return e.table=r,e.bstr=sr,e.buf=ar,e.str=hr,e})(),CFB=(function e(){var t={};t.version="1.2.1";function r(Or,Yr){for(var zr=Or.split("/"),Xr=Yr.split("/"),Wr=0,$r=0,ga=Math.min(zr.length,Xr.length);Wr<ga;++Wr){if($r=zr[Wr].length-Xr[Wr].length)return $r;if(zr[Wr]!=Xr[Wr])return zr[Wr]<Xr[Wr]?-1:1}return zr.length-Xr.length}function n(Or){if(Or.charAt(Or.length-1)=="/")return Or.slice(0,-1).indexOf("/")===-1?Or:n(Or.slice(0,-1));var Yr=Or.lastIndexOf("/");return Yr===-1?Or:Or.slice(0,Yr+1)}function Ee(Or){if(Or.charAt(Or.length-1)=="/")return Ee(Or.slice(0,-1));var Yr=Or.lastIndexOf("/");return Yr===-1?Or:Or.slice(Yr+1)}function Ce(Or,Yr){typeof Yr=="string"&&(Yr=new Date(Yr));var zr=Yr.getHours();zr=zr<<6|Yr.getMinutes(),zr=zr<<5|Yr.getSeconds()>>>1,Or.write_shift(2,zr);var Xr=Yr.getFullYear()-1980;Xr=Xr<<4|Yr.getMonth()+1,Xr=Xr<<5|Yr.getDate(),Or.write_shift(2,Xr)}function De(Or){var Yr=Or.read_shift(2)&65535,zr=Or.read_shift(2)&65535,Xr=new Date,Wr=zr&31;zr>>>=5;var $r=zr&15;zr>>>=4,Xr.setMilliseconds(0),Xr.setFullYear(zr+1980),Xr.setMonth($r-1),Xr.setDate(Wr);var ga=Yr&31;Yr>>>=5;var Fa=Yr&63;return Yr>>>=6,Xr.setHours(Yr),Xr.setMinutes(Fa),Xr.setSeconds(ga<<1),Xr}function Me(Or){prep_blob(Or,0);for(var Yr={},zr=0;Or.l<=Or.length-4;){var Xr=Or.read_shift(2),Wr=Or.read_shift(2),$r=Or.l+Wr,ga={};switch(Xr){case 21589:zr=Or.read_shift(1),zr&1&&(ga.mtime=Or.read_shift(4)),Wr>5&&(zr&2&&(ga.atime=Or.read_shift(4)),zr&4&&(ga.ctime=Or.read_shift(4))),ga.mtime&&(ga.mt=new Date(ga.mtime*1e3));break}Or.l=$r,Yr[Xr]=ga}return Yr}var ze;function Oe(){return ze||(ze={})}function Be(Or,Yr){if(Or[0]==80&&Or[1]==75)return xa(Or,Yr);if((Or[0]|32)==109&&(Or[1]|32)==105)return sn(Or,Yr);if(Or.length<512)throw new Error("CFB file size "+Or.length+" < 512");var zr=3,Xr=512,Wr=0,$r=0,ga=0,Fa=0,ya=0,wa=[],Sa=Or.slice(0,512);prep_blob(Sa,0);var Va=He(Sa);switch(zr=Va[0],zr){case 3:Xr=512;break;case 4:Xr=4096;break;case 0:if(Va[1]==0)return xa(Or,Yr);default:throw new Error("Major Version: Expected 3 or 4 saw "+zr)}Xr!==512&&(Sa=Or.slice(0,Xr),prep_blob(Sa,28));var Ja=Or.slice(0,Xr);Ve(Sa,zr);var an=Sa.read_shift(4,"i");if(zr===3&&an!==0)throw new Error("# Directory Sectors: Expected 0 saw "+an);Sa.l+=4,ga=Sa.read_shift(4,"i"),Sa.l+=4,Sa.chk("00100000","Mini Stream Cutoff Size: "),Fa=Sa.read_shift(4,"i"),Wr=Sa.read_shift(4,"i"),ya=Sa.read_shift(4,"i"),$r=Sa.read_shift(4,"i");for(var Za=-1,tn=0;tn<109&&(Za=Sa.read_shift(4,"i"),!(Za<0));++tn)wa[tn]=Za;var dn=Xe(Or,Xr);$e(ya,$r,dn,Xr,wa);var ii=rr(dn,ga,wa,Xr);ii[ga].name="!Directory",Wr>0&&Fa!==Fr&&(ii[Fa].name="!MiniFAT"),ii[wa[0]].name="!FAT",ii.fat_addrs=wa,ii.ssz=Xr;var Un={},ci=[],vs=[],to=[];tr(ga,ii,dn,ci,Wr,Un,vs,Fa),We(vs,to,ci),ci.shift();var ro={FileIndex:vs,FullPaths:to};return Yr&&Yr.raw&&(ro.raw={header:Ja,sectors:dn}),ro}function He(Or){if(Or[Or.l]==80&&Or[Or.l+1]==75)return[0,0];Or.chk(Mr,"Header Signature: "),Or.l+=16;var Yr=Or.read_shift(2,"u");return[Or.read_shift(2,"u"),Yr]}function Ve(Or,Yr){var zr=9;switch(Or.l+=2,zr=Or.read_shift(2)){case 9:if(Yr!=3)throw new Error("Sector Shift: Expected 9 saw "+zr);break;case 12:if(Yr!=4)throw new Error("Sector Shift: Expected 12 saw "+zr);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+zr)}Or.chk("0600","Mini Sector Shift: "),Or.chk("000000000000","Reserved: ")}function Xe(Or,Yr){for(var zr=Math.ceil(Or.length/Yr)-1,Xr=[],Wr=1;Wr<zr;++Wr)Xr[Wr-1]=Or.slice(Wr*Yr,(Wr+1)*Yr);return Xr[zr-1]=Or.slice(zr*Yr),Xr}function We(Or,Yr,zr){for(var Xr=0,Wr=0,$r=0,ga=0,Fa=0,ya=zr.length,wa=[],Sa=[];Xr<ya;++Xr)wa[Xr]=Sa[Xr]=Xr,Yr[Xr]=zr[Xr];for(;Fa<Sa.length;++Fa)Xr=Sa[Fa],Wr=Or[Xr].L,$r=Or[Xr].R,ga=Or[Xr].C,wa[Xr]===Xr&&(Wr!==-1&&wa[Wr]!==Wr&&(wa[Xr]=wa[Wr]),$r!==-1&&wa[$r]!==$r&&(wa[Xr]=wa[$r])),ga!==-1&&(wa[ga]=Xr),Wr!==-1&&Xr!=wa[Xr]&&(wa[Wr]=wa[Xr],Sa.lastIndexOf(Wr)<Fa&&Sa.push(Wr)),$r!==-1&&Xr!=wa[Xr]&&(wa[$r]=wa[Xr],Sa.lastIndexOf($r)<Fa&&Sa.push($r));for(Xr=1;Xr<ya;++Xr)wa[Xr]===Xr&&($r!==-1&&wa[$r]!==$r?wa[Xr]=wa[$r]:Wr!==-1&&wa[Wr]!==Wr&&(wa[Xr]=wa[Wr]));for(Xr=1;Xr<ya;++Xr)if(Or[Xr].type!==0){if(Fa=Xr,Fa!=wa[Fa])do Fa=wa[Fa],Yr[Xr]=Yr[Fa]+"/"+Yr[Xr];while(Fa!==0&&wa[Fa]!==-1&&Fa!=wa[Fa]);wa[Xr]=-1}for(Yr[0]+="/",Xr=1;Xr<ya;++Xr)Or[Xr].type!==2&&(Yr[Xr]+="/")}function Ge(Or,Yr,zr){for(var Xr=Or.start,Wr=Or.size,$r=[],ga=Xr;zr&&Wr>0&&ga>=0;)$r.push(Yr.slice(ga*wr,ga*wr+wr)),Wr-=wr,ga=__readInt32LE(zr,ga*4);return $r.length===0?new_buf(0):bconcat($r).slice(0,Or.size)}function $e(Or,Yr,zr,Xr,Wr){var $r=Fr;if(Or===Fr){if(Yr!==0)throw new Error("DIFAT chain shorter than expected")}else if(Or!==-1){var ga=zr[Or],Fa=(Xr>>>2)-1;if(!ga)return;for(var ya=0;ya<Fa&&($r=__readInt32LE(ga,ya*4))!==Fr;++ya)Wr.push($r);$e(__readInt32LE(ga,Xr-4),Yr-1,zr,Xr,Wr)}}function Ke(Or,Yr,zr,Xr,Wr){var $r=[],ga=[];Wr||(Wr=[]);var Fa=Xr-1,ya=0,wa=0;for(ya=Yr;ya>=0;){Wr[ya]=!0,$r[$r.length]=ya,ga.push(Or[ya]);var Sa=zr[Math.floor(ya*4/Xr)];if(wa=ya*4&Fa,Xr<4+wa)throw new Error("FAT boundary crossed: "+ya+" 4 "+Xr);if(!Or[Sa])break;ya=__readInt32LE(Or[Sa],wa)}return{nodes:$r,data:__toBuffer([ga])}}function rr(Or,Yr,zr,Xr){var Wr=Or.length,$r=[],ga=[],Fa=[],ya=[],wa=Xr-1,Sa=0,Va=0,Ja=0,an=0;for(Sa=0;Sa<Wr;++Sa)if(Fa=[],Ja=Sa+Yr,Ja>=Wr&&(Ja-=Wr),!ga[Ja]){ya=[];var Za=[];for(Va=Ja;Va>=0;){Za[Va]=!0,ga[Va]=!0,Fa[Fa.length]=Va,ya.push(Or[Va]);var tn=zr[Math.floor(Va*4/Xr)];if(an=Va*4&wa,Xr<4+an)throw new Error("FAT boundary crossed: "+Va+" 4 "+Xr);if(!Or[tn]||(Va=__readInt32LE(Or[tn],an),Za[Va]))break}$r[Ja]={nodes:Fa,data:__toBuffer([ya])}}return $r}function tr(Or,Yr,zr,Xr,Wr,$r,ga,Fa){for(var ya=0,wa=Xr.length?2:0,Sa=Yr[Or].data,Va=0,Ja=0,an;Va<Sa.length;Va+=128){var Za=Sa.slice(Va,Va+128);prep_blob(Za,64),Ja=Za.read_shift(2),an=__utf16le(Za,0,Ja-wa),Xr.push(an);var tn={name:an,type:Za.read_shift(1),color:Za.read_shift(1),L:Za.read_shift(4,"i"),R:Za.read_shift(4,"i"),C:Za.read_shift(4,"i"),clsid:Za.read_shift(16),state:Za.read_shift(4,"i"),start:0,size:0},dn=Za.read_shift(2)+Za.read_shift(2)+Za.read_shift(2)+Za.read_shift(2);dn!==0&&(tn.ct=sr(Za,Za.l-8));var ii=Za.read_shift(2)+Za.read_shift(2)+Za.read_shift(2)+Za.read_shift(2);ii!==0&&(tn.mt=sr(Za,Za.l-8)),tn.start=Za.read_shift(4,"i"),tn.size=Za.read_shift(4,"i"),tn.size<0&&tn.start<0&&(tn.size=tn.type=0,tn.start=Fr,tn.name=""),tn.type===5?(ya=tn.start,Wr>0&&ya!==Fr&&(Yr[ya].name="!StreamData")):tn.size>=4096?(tn.storage="fat",Yr[tn.start]===void 0&&(Yr[tn.start]=Ke(zr,tn.start,Yr.fat_addrs,Yr.ssz)),Yr[tn.start].name=tn.name,tn.content=Yr[tn.start].data.slice(0,tn.size)):(tn.storage="minifat",tn.size<0?tn.size=0:ya!==Fr&&tn.start!==Fr&&Yr[ya]&&(tn.content=Ge(tn,Yr[ya].data,(Yr[Fa]||{}).data))),tn.content&&prep_blob(tn.content,0),$r[an]=tn,ga.push(tn)}}function sr(Or,Yr){return new Date((__readUInt32LE(Or,Yr+4)/1e7*Math.pow(2,32)+__readUInt32LE(Or,Yr)/1e7-11644473600)*1e3)}function ar(Or,Yr){return Oe(),Be(ze.readFileSync(Or),Yr)}function hr(Or,Yr){var zr=Yr&&Yr.type;switch(zr||has_buf&&Buffer.isBuffer(Or)&&(zr="buffer"),zr||"base64"){case"file":return ar(Or,Yr);case"base64":return Be(s2a(Base64_decode(Or)),Yr);case"binary":return Be(s2a(Or),Yr)}return Be(Or,Yr)}function pr(Or,Yr){var zr=Yr||{},Xr=zr.root||"Root Entry";if(Or.FullPaths||(Or.FullPaths=[]),Or.FileIndex||(Or.FileIndex=[]),Or.FullPaths.length!==Or.FileIndex.length)throw new Error("inconsistent CFB structure");Or.FullPaths.length===0&&(Or.FullPaths[0]=Xr+"/",Or.FileIndex[0]={name:Xr,type:5}),zr.CLSID&&(Or.FileIndex[0].clsid=zr.CLSID),yr(Or)}function yr(Or){var Yr="Sh33tJ5";if(!CFB.find(Or,"/"+Yr)){var zr=new_buf(4);zr[0]=55,zr[1]=zr[3]=50,zr[2]=54,Or.FileIndex.push({name:Yr,type:2,content:zr,size:4,L:69,R:69,C:69}),Or.FullPaths.push(Or.FullPaths[0]+Yr),fr(Or)}}function fr(Or,Yr){pr(Or);for(var zr=!1,Xr=!1,Wr=Or.FullPaths.length-1;Wr>=0;--Wr){var $r=Or.FileIndex[Wr];switch($r.type){case 0:Xr?zr=!0:(Or.FileIndex.pop(),Or.FullPaths.pop());break;case 1:case 2:case 5:Xr=!0,isNaN($r.R*$r.L*$r.C)&&(zr=!0),$r.R>-1&&$r.L>-1&&$r.R==$r.L&&(zr=!0);break;default:zr=!0;break}}if(!(!zr&&!Yr)){var ga=new Date(1987,1,19),Fa=0,ya=Object.create?Object.create(null):{},wa=[];for(Wr=0;Wr<Or.FullPaths.length;++Wr)ya[Or.FullPaths[Wr]]=!0,Or.FileIndex[Wr].type!==0&&wa.push([Or.FullPaths[Wr],Or.FileIndex[Wr]]);for(Wr=0;Wr<wa.length;++Wr){var Sa=n(wa[Wr][0]);Xr=ya[Sa],Xr||(wa.push([Sa,{name:Ee(Sa).replace("/",""),type:1,clsid:Nr,ct:ga,mt:ga,content:null}]),ya[Sa]=!0)}for(wa.sort(function(an,Za){return r(an[0],Za[0])}),Or.FullPaths=[],Or.FileIndex=[],Wr=0;Wr<wa.length;++Wr)Or.FullPaths[Wr]=wa[Wr][0],Or.FileIndex[Wr]=wa[Wr][1];for(Wr=0;Wr<wa.length;++Wr){var Va=Or.FileIndex[Wr],Ja=Or.FullPaths[Wr];if(Va.name=Ee(Ja).replace("/",""),Va.L=Va.R=Va.C=-(Va.color=1),Va.size=Va.content?Va.content.length:0,Va.start=0,Va.clsid=Va.clsid||Nr,Wr===0)Va.C=wa.length>1?1:-1,Va.size=0,Va.type=5;else if(Ja.slice(-1)=="/"){for(Fa=Wr+1;Fa<wa.length&&n(Or.FullPaths[Fa])!=Ja;++Fa);for(Va.C=Fa>=wa.length?-1:Fa,Fa=Wr+1;Fa<wa.length&&n(Or.FullPaths[Fa])!=n(Ja);++Fa);Va.R=Fa>=wa.length?-1:Fa,Va.type=1}else n(Or.FullPaths[Wr+1]||"")==n(Ja)&&(Va.R=Wr+1),Va.type=2}}}function Rr(Or,Yr){var zr=Yr||{};if(zr.fileType=="mad")return Gi(Or,zr);switch(fr(Or),zr.fileType){case"zip":return ka(Or,zr)}var Xr=(function(an){for(var Za=0,tn=0,dn=0;dn<an.FileIndex.length;++dn){var ii=an.FileIndex[dn];if(ii.content){var Un=ii.content.length;Un>0&&(Un<4096?Za+=Un+63>>6:tn+=Un+511>>9)}}for(var ci=an.FullPaths.length+3>>2,vs=Za+7>>3,to=Za+127>>7,ro=vs+tn+ci+to,Fs=ro+127>>7,nl=Fs<=109?0:Math.ceil((Fs-109)/127);ro+Fs+nl+127>>7>Fs;)nl=++Fs<=109?0:Math.ceil((Fs-109)/127);var Ai=[1,nl,Fs,to,ci,tn,Za,0];return an.FileIndex[0].size=Za<<6,Ai[7]=(an.FileIndex[0].start=Ai[0]+Ai[1]+Ai[2]+Ai[3]+Ai[4]+Ai[5])+(Ai[6]+7>>3),Ai})(Or),Wr=new_buf(Xr[7]<<9),$r=0,ga=0;{for($r=0;$r<8;++$r)Wr.write_shift(1,Hr[$r]);for($r=0;$r<8;++$r)Wr.write_shift(2,0);for(Wr.write_shift(2,62),Wr.write_shift(2,3),Wr.write_shift(2,65534),Wr.write_shift(2,9),Wr.write_shift(2,6),$r=0;$r<3;++$r)Wr.write_shift(2,0);for(Wr.write_shift(4,0),Wr.write_shift(4,Xr[2]),Wr.write_shift(4,Xr[0]+Xr[1]+Xr[2]+Xr[3]-1),Wr.write_shift(4,0),Wr.write_shift(4,4096),Wr.write_shift(4,Xr[3]?Xr[0]+Xr[1]+Xr[2]-1:Fr),Wr.write_shift(4,Xr[3]),Wr.write_shift(-4,Xr[1]?Xr[0]-1:Fr),Wr.write_shift(4,Xr[1]),$r=0;$r<109;++$r)Wr.write_shift(-4,$r<Xr[2]?Xr[1]+$r:-1)}if(Xr[1])for(ga=0;ga<Xr[1];++ga){for(;$r<236+ga*127;++$r)Wr.write_shift(-4,$r<Xr[2]?Xr[1]+$r:-1);Wr.write_shift(-4,ga===Xr[1]-1?Fr:ga+1)}var Fa=function(an){for(ga+=an;$r<ga-1;++$r)Wr.write_shift(-4,$r+1);an&&(++$r,Wr.write_shift(-4,Fr))};for(ga=$r=0,ga+=Xr[1];$r<ga;++$r)Wr.write_shift(-4,Ar.DIFSECT);for(ga+=Xr[2];$r<ga;++$r)Wr.write_shift(-4,Ar.FATSECT);Fa(Xr[3]),Fa(Xr[4]);for(var ya=0,wa=0,Sa=Or.FileIndex[0];ya<Or.FileIndex.length;++ya)Sa=Or.FileIndex[ya],Sa.content&&(wa=Sa.content.length,!(wa<4096)&&(Sa.start=ga,Fa(wa+511>>9)));for(Fa(Xr[6]+7>>3);Wr.l&511;)Wr.write_shift(-4,Ar.ENDOFCHAIN);for(ga=$r=0,ya=0;ya<Or.FileIndex.length;++ya)Sa=Or.FileIndex[ya],Sa.content&&(wa=Sa.content.length,!(!wa||wa>=4096)&&(Sa.start=ga,Fa(wa+63>>6)));for(;Wr.l&511;)Wr.write_shift(-4,Ar.ENDOFCHAIN);for($r=0;$r<Xr[4]<<2;++$r){var Va=Or.FullPaths[$r];if(!Va||Va.length===0){for(ya=0;ya<17;++ya)Wr.write_shift(4,0);for(ya=0;ya<3;++ya)Wr.write_shift(4,-1);for(ya=0;ya<12;++ya)Wr.write_shift(4,0);continue}Sa=Or.FileIndex[$r],$r===0&&(Sa.start=Sa.size?Sa.start-1:Fr);var Ja=$r===0&&zr.root||Sa.name;if(wa=2*(Ja.length+1),Wr.write_shift(64,Ja,"utf16le"),Wr.write_shift(2,wa),Wr.write_shift(1,Sa.type),Wr.write_shift(1,Sa.color),Wr.write_shift(-4,Sa.L),Wr.write_shift(-4,Sa.R),Wr.write_shift(-4,Sa.C),Sa.clsid)Wr.write_shift(16,Sa.clsid,"hex");else for(ya=0;ya<4;++ya)Wr.write_shift(4,0);Wr.write_shift(4,Sa.state||0),Wr.write_shift(4,0),Wr.write_shift(4,0),Wr.write_shift(4,0),Wr.write_shift(4,0),Wr.write_shift(4,Sa.start),Wr.write_shift(4,Sa.size),Wr.write_shift(4,0)}for($r=1;$r<Or.FileIndex.length;++$r)if(Sa=Or.FileIndex[$r],Sa.size>=4096)if(Wr.l=Sa.start+1<<9,has_buf&&Buffer.isBuffer(Sa.content))Sa.content.copy(Wr,Wr.l,0,Sa.size),Wr.l+=Sa.size+511&-512;else{for(ya=0;ya<Sa.size;++ya)Wr.write_shift(1,Sa.content[ya]);for(;ya&511;++ya)Wr.write_shift(1,0)}for($r=1;$r<Or.FileIndex.length;++$r)if(Sa=Or.FileIndex[$r],Sa.size>0&&Sa.size<4096)if(has_buf&&Buffer.isBuffer(Sa.content))Sa.content.copy(Wr,Wr.l,0,Sa.size),Wr.l+=Sa.size+63&-64;else{for(ya=0;ya<Sa.size;++ya)Wr.write_shift(1,Sa.content[ya]);for(;ya&63;++ya)Wr.write_shift(1,0)}if(has_buf)Wr.l=Wr.length;else for(;Wr.l<Wr.length;)Wr.write_shift(1,0);return Wr}function mr(Or,Yr){var zr=Or.FullPaths.map(function(ya){return ya.toUpperCase()}),Xr=zr.map(function(ya){var wa=ya.split("/");return wa[wa.length-(ya.slice(-1)=="/"?2:1)]}),Wr=!1;Yr.charCodeAt(0)===47?(Wr=!0,Yr=zr[0].slice(0,-1)+Yr):Wr=Yr.indexOf("/")!==-1;var $r=Yr.toUpperCase(),ga=Wr===!0?zr.indexOf($r):Xr.indexOf($r);if(ga!==-1)return Or.FileIndex[ga];var Fa=!$r.match(chr1);for($r=$r.replace(chr0,""),Fa&&($r=$r.replace(chr1,"!")),ga=0;ga<zr.length;++ga)if((Fa?zr[ga].replace(chr1,"!"):zr[ga]).replace(chr0,"")==$r||(Fa?Xr[ga].replace(chr1,"!"):Xr[ga]).replace(chr0,"")==$r)return Or.FileIndex[ga];return null}var wr=64,Fr=-2,Mr="d0cf11e0a1b11ae1",Hr=[208,207,17,224,161,177,26,225],Nr="00000000000000000000000000000000",Ar={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Fr,FREESECT:-1,HEADER_SIGNATURE:Mr,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Nr,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function xr(Or,Yr,zr){Oe();var Xr=Rr(Or,zr);ze.writeFileSync(Yr,Xr)}function ir(Or){for(var Yr=new Array(Or.length),zr=0;zr<Or.length;++zr)Yr[zr]=String.fromCharCode(Or[zr]);return Yr.join("")}function _r(Or,Yr){var zr=Rr(Or,Yr);switch(Yr&&Yr.type||"buffer"){case"file":return Oe(),ze.writeFileSync(Yr.filename,zr),zr;case"binary":return typeof zr=="string"?zr:ir(zr);case"base64":return Base64_encode(typeof zr=="string"?zr:ir(zr));case"buffer":if(has_buf)return Buffer.isBuffer(zr)?zr:Buffer_from(zr);case"array":return typeof zr=="string"?s2a(zr):zr}return zr}var ur;function Je(Or){try{var Yr=Or.InflateRaw,zr=new Yr;if(zr._processChunk(new Uint8Array([3,0]),zr._finishFlushFlag),zr.bytesRead)ur=Or;else throw new Error("zlib does not expose bytesRead")}catch(Xr){console.error("cannot use native zlib: "+(Xr.message||Xr))}}function nr(Or,Yr){if(!ur)return ca(Or,Yr);var zr=ur.InflateRaw,Xr=new zr,Wr=Xr._processChunk(Or.slice(Or.l),Xr._finishFlushFlag);return Or.l+=Xr.bytesRead,Wr}function or(Or){return ur?ur.deflateRawSync(Or):Ka(Or)}var lr=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],St=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],dr=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function vr(Or){var Yr=(Or<<1|Or<<11)&139536|(Or<<5|Or<<15)&558144;return(Yr>>16|Yr>>8|Yr)&255}for(var br=typeof Uint8Array<"u",kr=br?new Uint8Array(256):[],Pr=0;Pr<256;++Pr)kr[Pr]=vr(Pr);function Er(Or,Yr){var zr=kr[Or&255];return Yr<=8?zr>>>8-Yr:(zr=zr<<8|kr[Or>>8&255],Yr<=16?zr>>>16-Yr:(zr=zr<<8|kr[Or>>16&255],zr>>>24-Yr))}function Zr(Or,Yr){var zr=Yr&7,Xr=Yr>>>3;return(Or[Xr]|(zr<=6?0:Or[Xr+1]<<8))>>>zr&3}function ua(Or,Yr){var zr=Yr&7,Xr=Yr>>>3;return(Or[Xr]|(zr<=5?0:Or[Xr+1]<<8))>>>zr&7}function Cr(Or,Yr){var zr=Yr&7,Xr=Yr>>>3;return(Or[Xr]|(zr<=4?0:Or[Xr+1]<<8))>>>zr&15}function Jr(Or,Yr){var zr=Yr&7,Xr=Yr>>>3;return(Or[Xr]|(zr<=3?0:Or[Xr+1]<<8))>>>zr&31}function Qr(Or,Yr){var zr=Yr&7,Xr=Yr>>>3;return(Or[Xr]|(zr<=1?0:Or[Xr+1]<<8))>>>zr&127}function oa(Or,Yr,zr){var Xr=Yr&7,Wr=Yr>>>3,$r=(1<<zr)-1,ga=Or[Wr]>>>Xr;return zr<8-Xr||(ga|=Or[Wr+1]<<8-Xr,zr<16-Xr)||(ga|=Or[Wr+2]<<16-Xr,zr<24-Xr)||(ga|=Or[Wr+3]<<24-Xr),ga&$r}function ta(Or,Yr,zr){var Xr=Yr&7,Wr=Yr>>>3;return Xr<=5?Or[Wr]|=(zr&7)<<Xr:(Or[Wr]|=zr<<Xr&255,Or[Wr+1]=(zr&7)>>8-Xr),Yr+3}function Na(Or,Yr,zr){var Xr=Yr&7,Wr=Yr>>>3;return zr=(zr&1)<<Xr,Or[Wr]|=zr,Yr+1}function Ca(Or,Yr,zr){var Xr=Yr&7,Wr=Yr>>>3;return zr<<=Xr,Or[Wr]|=zr&255,zr>>>=8,Or[Wr+1]=zr,Yr+8}function za(Or,Yr,zr){var Xr=Yr&7,Wr=Yr>>>3;return zr<<=Xr,Or[Wr]|=zr&255,zr>>>=8,Or[Wr+1]=zr&255,Or[Wr+2]=zr>>>8,Yr+16}function Xa(Or,Yr){var zr=Or.length,Xr=2*zr>Yr?2*zr:Yr+5,Wr=0;if(zr>=Yr)return Or;if(has_buf){var $r=new_unsafe_buf(Xr);if(Or.copy)Or.copy($r);else for(;Wr<Or.length;++Wr)$r[Wr]=Or[Wr];return $r}else if(br){var ga=new Uint8Array(Xr);if(ga.set)ga.set(Or);else for(;Wr<zr;++Wr)ga[Wr]=Or[Wr];return ga}return Or.length=Xr,Or}function Ya(Or){for(var Yr=new Array(Or),zr=0;zr<Or;++zr)Yr[zr]=0;return Yr}function nn(Or,Yr,zr){var Xr=1,Wr=0,$r=0,ga=0,Fa=0,ya=Or.length,wa=br?new Uint16Array(32):Ya(32);for($r=0;$r<32;++$r)wa[$r]=0;for($r=ya;$r<zr;++$r)Or[$r]=0;ya=Or.length;var Sa=br?new Uint16Array(ya):Ya(ya);for($r=0;$r<ya;++$r)wa[Wr=Or[$r]]++,Xr<Wr&&(Xr=Wr),Sa[$r]=0;for(wa[0]=0,$r=1;$r<=Xr;++$r)wa[$r+16]=Fa=Fa+wa[$r-1]<<1;for($r=0;$r<ya;++$r)Fa=Or[$r],Fa!=0&&(Sa[$r]=wa[Fa+16]++);var Va=0;for($r=0;$r<ya;++$r)if(Va=Or[$r],Va!=0)for(Fa=Er(Sa[$r],Xr)>>Xr-Va,ga=(1<<Xr+4-Va)-1;ga>=0;--ga)Yr[Fa|ga<<Va]=Va&15|$r<<4;return Xr}var on=br?new Uint16Array(512):Ya(512),yn=br?new Uint16Array(32):Ya(32);if(!br){for(var fn=0;fn<512;++fn)on[fn]=0;for(fn=0;fn<32;++fn)yn[fn]=0}(function(){for(var Or=[],Yr=0;Yr<32;Yr++)Or.push(5);nn(Or,yn,32);var zr=[];for(Yr=0;Yr<=143;Yr++)zr.push(8);for(;Yr<=255;Yr++)zr.push(9);for(;Yr<=279;Yr++)zr.push(7);for(;Yr<=287;Yr++)zr.push(8);nn(zr,on,288)})();var Qa=(function(){for(var Yr=br?new Uint8Array(32768):[],zr=0,Xr=0;zr<dr.length-1;++zr)for(;Xr<dr[zr+1];++Xr)Yr[Xr]=zr;for(;Xr<32768;++Xr)Yr[Xr]=29;var Wr=br?new Uint8Array(259):[];for(zr=0,Xr=0;zr<St.length-1;++zr)for(;Xr<St[zr+1];++Xr)Wr[Xr]=zr;function $r(Fa,ya){for(var wa=0;wa<Fa.length;){var Sa=Math.min(65535,Fa.length-wa),Va=wa+Sa==Fa.length;for(ya.write_shift(1,+Va),ya.write_shift(2,Sa),ya.write_shift(2,~Sa&65535);Sa-- >0;)ya[ya.l++]=Fa[wa++]}return ya.l}function ga(Fa,ya){for(var wa=0,Sa=0,Va=br?new Uint16Array(32768):[];Sa<Fa.length;){var Ja=Math.min(65535,Fa.length-Sa);if(Ja<10){for(wa=ta(ya,wa,+(Sa+Ja==Fa.length)),wa&7&&(wa+=8-(wa&7)),ya.l=wa/8|0,ya.write_shift(2,Ja),ya.write_shift(2,~Ja&65535);Ja-- >0;)ya[ya.l++]=Fa[Sa++];wa=ya.l*8;continue}wa=ta(ya,wa,+(Sa+Ja==Fa.length)+2);for(var an=0;Ja-- >0;){var Za=Fa[Sa];an=(an<<5^Za)&32767;var tn=-1,dn=0;if((tn=Va[an])&&(tn|=Sa&-32768,tn>Sa&&(tn-=32768),tn<Sa))for(;Fa[tn+dn]==Fa[Sa+dn]&&dn<250;)++dn;if(dn>2){Za=Wr[dn],Za<=22?wa=Ca(ya,wa,kr[Za+1]>>1)-1:(Ca(ya,wa,3),wa+=5,Ca(ya,wa,kr[Za-23]>>5),wa+=3);var ii=Za<8?0:Za-4>>2;ii>0&&(za(ya,wa,dn-St[Za]),wa+=ii),Za=Yr[Sa-tn],wa=Ca(ya,wa,kr[Za]>>3),wa-=3;var Un=Za<4?0:Za-2>>1;Un>0&&(za(ya,wa,Sa-tn-dr[Za]),wa+=Un);for(var ci=0;ci<dn;++ci)Va[an]=Sa&32767,an=(an<<5^Fa[Sa])&32767,++Sa;Ja-=dn-1}else Za<=143?Za=Za+48:wa=Na(ya,wa,1),wa=Ca(ya,wa,kr[Za]),Va[an]=Sa&32767,++Sa}wa=Ca(ya,wa,0)-1}return ya.l=(wa+7)/8|0,ya.l}return function(ya,wa){return ya.length<8?$r(ya,wa):ga(ya,wa)}})();function Ka(Or){var Yr=new_buf(50+Math.floor(Or.length*1.1)),zr=Qa(Or,Yr);return Yr.slice(0,zr)}var en=br?new Uint16Array(32768):Ya(32768),Bn=br?new Uint16Array(32768):Ya(32768),vn=br?new Uint16Array(128):Ya(128),va=1,aa=1;function ia(Or,Yr){var zr=Jr(Or,Yr)+257;Yr+=5;var Xr=Jr(Or,Yr)+1;Yr+=5;var Wr=Cr(Or,Yr)+4;Yr+=4;for(var $r=0,ga=br?new Uint8Array(19):Ya(19),Fa=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ya=1,wa=br?new Uint8Array(8):Ya(8),Sa=br?new Uint8Array(8):Ya(8),Va=ga.length,Ja=0;Ja<Wr;++Ja)ga[lr[Ja]]=$r=ua(Or,Yr),ya<$r&&(ya=$r),wa[$r]++,Yr+=3;var an=0;for(wa[0]=0,Ja=1;Ja<=ya;++Ja)Sa[Ja]=an=an+wa[Ja-1]<<1;for(Ja=0;Ja<Va;++Ja)(an=ga[Ja])!=0&&(Fa[Ja]=Sa[an]++);var Za=0;for(Ja=0;Ja<Va;++Ja)if(Za=ga[Ja],Za!=0){an=kr[Fa[Ja]]>>8-Za;for(var tn=(1<<7-Za)-1;tn>=0;--tn)vn[an|tn<<Za]=Za&7|Ja<<3}var dn=[];for(ya=1;dn.length<zr+Xr;)switch(an=vn[Qr(Or,Yr)],Yr+=an&7,an>>>=3){case 16:for($r=3+Zr(Or,Yr),Yr+=2,an=dn[dn.length-1];$r-- >0;)dn.push(an);break;case 17:for($r=3+ua(Or,Yr),Yr+=3;$r-- >0;)dn.push(0);break;case 18:for($r=11+Qr(Or,Yr),Yr+=7;$r-- >0;)dn.push(0);break;default:dn.push(an),ya<an&&(ya=an);break}var ii=dn.slice(0,zr),Un=dn.slice(zr);for(Ja=zr;Ja<286;++Ja)ii[Ja]=0;for(Ja=Xr;Ja<30;++Ja)Un[Ja]=0;return va=nn(ii,en,286),aa=nn(Un,Bn,30),Yr}function Oa(Or,Yr){if(Or[0]==3&&!(Or[1]&3))return[new_raw_buf(Yr),2];for(var zr=0,Xr=0,Wr=new_unsafe_buf(Yr||1<<18),$r=0,ga=Wr.length>>>0,Fa=0,ya=0;(Xr&1)==0;){if(Xr=ua(Or,zr),zr+=3,Xr>>>1)Xr>>1==1?(Fa=9,ya=5):(zr=ia(Or,zr),Fa=va,ya=aa);else{zr&7&&(zr+=8-(zr&7));var wa=Or[zr>>>3]|Or[(zr>>>3)+1]<<8;if(zr+=32,wa>0)for(!Yr&&ga<$r+wa&&(Wr=Xa(Wr,$r+wa),ga=Wr.length);wa-- >0;)Wr[$r++]=Or[zr>>>3],zr+=8;continue}for(;;){!Yr&&ga<$r+32767&&(Wr=Xa(Wr,$r+32767),ga=Wr.length);var Sa=oa(Or,zr,Fa),Va=Xr>>>1==1?on[Sa]:en[Sa];if(zr+=Va&15,Va>>>=4,(Va>>>8&255)===0)Wr[$r++]=Va;else{if(Va==256)break;Va-=257;var Ja=Va<8?0:Va-4>>2;Ja>5&&(Ja=0);var an=$r+St[Va];Ja>0&&(an+=oa(Or,zr,Ja),zr+=Ja),Sa=oa(Or,zr,ya),Va=Xr>>>1==1?yn[Sa]:Bn[Sa],zr+=Va&15,Va>>>=4;var Za=Va<4?0:Va-2>>1,tn=dr[Va];for(Za>0&&(tn+=oa(Or,zr,Za),zr+=Za),!Yr&&ga<an&&(Wr=Xa(Wr,an+100),ga=Wr.length);$r<an;)Wr[$r]=Wr[$r-tn],++$r}}}return Yr?[Wr,zr+7>>>3]:[Wr.slice(0,$r),zr+7>>>3]}function ca(Or,Yr){var zr=Or.slice(Or.l||0),Xr=Oa(zr,Yr);return Or.l+=Xr[1],Xr[0]}function pa(Or,Yr){if(Or)typeof console<"u"&&console.error(Yr);else throw new Error(Yr)}function xa(Or,Yr){var zr=Or;prep_blob(zr,0);var Xr=[],Wr=[],$r={FileIndex:Xr,FullPaths:Wr};pr($r,{root:Yr.root});for(var ga=zr.length-4;(zr[ga]!=80||zr[ga+1]!=75||zr[ga+2]!=5||zr[ga+3]!=6)&&ga>=0;)--ga;zr.l=ga+4,zr.l+=4;var Fa=zr.read_shift(2);zr.l+=6;var ya=zr.read_shift(4);for(zr.l=ya,ga=0;ga<Fa;++ga){zr.l+=20;var wa=zr.read_shift(4),Sa=zr.read_shift(4),Va=zr.read_shift(2),Ja=zr.read_shift(2),an=zr.read_shift(2);zr.l+=8;var Za=zr.read_shift(4),tn=Me(zr.slice(zr.l+Va,zr.l+Va+Ja));zr.l+=Va+Ja+an;var dn=zr.l;zr.l=Za+4,$a(zr,wa,Sa,$r,tn),zr.l=dn}return $r}function $a(Or,Yr,zr,Xr,Wr){Or.l+=2;var $r=Or.read_shift(2),ga=Or.read_shift(2),Fa=De(Or);if($r&8257)throw new Error("Unsupported ZIP encryption");for(var ya=Or.read_shift(4),wa=Or.read_shift(4),Sa=Or.read_shift(4),Va=Or.read_shift(2),Ja=Or.read_shift(2),an="",Za=0;Za<Va;++Za)an+=String.fromCharCode(Or[Or.l++]);if(Ja){var tn=Me(Or.slice(Or.l,Or.l+Ja));(tn[21589]||{}).mt&&(Fa=tn[21589].mt),((Wr||{})[21589]||{}).mt&&(Fa=Wr[21589].mt)}Or.l+=Ja;var dn=Or.slice(Or.l,Or.l+wa);switch(ga){case 8:dn=nr(Or,Sa);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ga)}var ii=!1;$r&8&&(ya=Or.read_shift(4),ya==134695760&&(ya=Or.read_shift(4),ii=!0),wa=Or.read_shift(4),Sa=Or.read_shift(4)),wa!=Yr&&pa(ii,"Bad compressed size: "+Yr+" != "+wa),Sa!=zr&&pa(ii,"Bad uncompressed size: "+zr+" != "+Sa),Si(Xr,an,dn,{unsafe:!0,mt:Fa})}function ka(Or,Yr){var zr=Yr||{},Xr=[],Wr=[],$r=new_buf(1),ga=zr.compression?8:0,Fa=0,ya=0,wa=0,Sa=0,Va=0,Ja=Or.FullPaths[0],an=Ja,Za=Or.FileIndex[0],tn=[],dn=0;for(ya=1;ya<Or.FullPaths.length;++ya)if(an=Or.FullPaths[ya].slice(Ja.length),Za=Or.FileIndex[ya],!(!Za.size||!Za.content||an=="Sh33tJ5")){var ii=Sa,Un=new_buf(an.length);for(wa=0;wa<an.length;++wa)Un.write_shift(1,an.charCodeAt(wa)&127);Un=Un.slice(0,Un.l),tn[Va]=CRC32.buf(Za.content,0);var ci=Za.content;ga==8&&(ci=or(ci)),$r=new_buf(30),$r.write_shift(4,67324752),$r.write_shift(2,20),$r.write_shift(2,Fa),$r.write_shift(2,ga),Za.mt?Ce($r,Za.mt):$r.write_shift(4,0),$r.write_shift(-4,tn[Va]),$r.write_shift(4,ci.length),$r.write_shift(4,Za.content.length),$r.write_shift(2,Un.length),$r.write_shift(2,0),Sa+=$r.length,Xr.push($r),Sa+=Un.length,Xr.push(Un),Sa+=ci.length,Xr.push(ci),$r=new_buf(46),$r.write_shift(4,33639248),$r.write_shift(2,0),$r.write_shift(2,20),$r.write_shift(2,Fa),$r.write_shift(2,ga),$r.write_shift(4,0),$r.write_shift(-4,tn[Va]),$r.write_shift(4,ci.length),$r.write_shift(4,Za.content.length),$r.write_shift(2,Un.length),$r.write_shift(2,0),$r.write_shift(2,0),$r.write_shift(2,0),$r.write_shift(2,0),$r.write_shift(4,0),$r.write_shift(4,ii),dn+=$r.l,Wr.push($r),dn+=Un.length,Wr.push(Un),++Va}return $r=new_buf(22),$r.write_shift(4,101010256),$r.write_shift(2,0),$r.write_shift(2,0),$r.write_shift(2,Va),$r.write_shift(2,Va),$r.write_shift(4,dn),$r.write_shift(4,Sa),$r.write_shift(2,0),bconcat([bconcat(Xr),bconcat(Wr),$r])}var La={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Wa(Or,Yr){if(Or.ctype)return Or.ctype;var zr=Or.name||"",Xr=zr.match(/\.([^\.]+)$/);return Xr&&La[Xr[1]]||Yr&&(Xr=(zr=Yr).match(/[\.\\]([^\.\\])+$/),Xr&&La[Xr[1]])?La[Xr[1]]:"application/octet-stream"}function _n(Or){for(var Yr=Base64_encode(Or),zr=[],Xr=0;Xr<Yr.length;Xr+=76)zr.push(Yr.slice(Xr,Xr+76));return zr.join(`\r
`)+`\r
`}function hn(Or){var Yr=Or.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(wa){var Sa=wa.charCodeAt(0).toString(16).toUpperCase();return"="+(Sa.length==1?"0"+Sa:Sa)});Yr=Yr.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),Yr.charAt(0)==`
`&&(Yr="=0D"+Yr.slice(1)),Yr=Yr.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var zr=[],Xr=Yr.split(`\r
`),Wr=0;Wr<Xr.length;++Wr){var $r=Xr[Wr];if($r.length==0){zr.push("");continue}for(var ga=0;ga<$r.length;){var Fa=76,ya=$r.slice(ga,ga+Fa);ya.charAt(Fa-1)=="="?Fa--:ya.charAt(Fa-2)=="="?Fa-=2:ya.charAt(Fa-3)=="="&&(Fa-=3),ya=$r.slice(ga,ga+Fa),ga+=Fa,ga<$r.length&&(ya+="="),zr.push(ya)}}return zr.join(`\r
`)}function Fn(Or){for(var Yr=[],zr=0;zr<Or.length;++zr){for(var Xr=Or[zr];zr<=Or.length&&Xr.charAt(Xr.length-1)=="=";)Xr=Xr.slice(0,Xr.length-1)+Or[++zr];Yr.push(Xr)}for(var Wr=0;Wr<Yr.length;++Wr)Yr[Wr]=Yr[Wr].replace(/[=][0-9A-Fa-f]{2}/g,function($r){return String.fromCharCode(parseInt($r.slice(1),16))});return s2a(Yr.join(`\r
`))}function Tn(Or,Yr,zr){for(var Xr="",Wr="",$r="",ga,Fa=0;Fa<10;++Fa){var ya=Yr[Fa];if(!ya||ya.match(/^\s*$/))break;var wa=ya.match(/^(.*?):\s*([^\s].*)$/);if(wa)switch(wa[1].toLowerCase()){case"content-location":Xr=wa[2].trim();break;case"content-type":$r=wa[2].trim();break;case"content-transfer-encoding":Wr=wa[2].trim();break}}switch(++Fa,Wr.toLowerCase()){case"base64":ga=s2a(Base64_decode(Yr.slice(Fa).join("")));break;case"quoted-printable":ga=Fn(Yr.slice(Fa));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+Wr)}var Sa=Si(Or,Xr.slice(zr.length),ga,{unsafe:!0});$r&&(Sa.ctype=$r)}function sn(Or,Yr){if(ir(Or.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var zr=Yr&&Yr.root||"",Xr=(has_buf&&Buffer.isBuffer(Or)?Or.toString("binary"):ir(Or)).split(`\r
`),Wr=0,$r="";for(Wr=0;Wr<Xr.length;++Wr)if($r=Xr[Wr],!!/^Content-Location:/i.test($r)&&($r=$r.slice($r.indexOf("file")),zr||(zr=$r.slice(0,$r.lastIndexOf("/")+1)),$r.slice(0,zr.length)!=zr))for(;zr.length>0&&(zr=zr.slice(0,zr.length-1),zr=zr.slice(0,zr.lastIndexOf("/")+1),$r.slice(0,zr.length)!=zr););var ga=(Xr[1]||"").match(/boundary="(.*?)"/);if(!ga)throw new Error("MAD cannot find boundary");var Fa="--"+(ga[1]||""),ya=[],wa=[],Sa={FileIndex:ya,FullPaths:wa};pr(Sa);var Va,Ja=0;for(Wr=0;Wr<Xr.length;++Wr){var an=Xr[Wr];an!==Fa&&an!==Fa+"--"||(Ja++&&Tn(Sa,Xr.slice(Va,Wr),zr),Va=Wr)}return Sa}function Gi(Or,Yr){var zr=Yr||{},Xr=zr.boundary||"SheetJS";Xr="------="+Xr;for(var Wr=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+Xr.slice(2)+'"',"","",""],$r=Or.FullPaths[0],ga=$r,Fa=Or.FileIndex[0],ya=1;ya<Or.FullPaths.length;++ya)if(ga=Or.FullPaths[ya].slice($r.length),Fa=Or.FileIndex[ya],!(!Fa.size||!Fa.content||ga=="Sh33tJ5")){ga=ga.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(dn){return"_x"+dn.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(dn){return"_u"+dn.charCodeAt(0).toString(16)+"_"});for(var wa=Fa.content,Sa=has_buf&&Buffer.isBuffer(wa)?wa.toString("binary"):ir(wa),Va=0,Ja=Math.min(1024,Sa.length),an=0,Za=0;Za<=Ja;++Za)(an=Sa.charCodeAt(Za))>=32&&an<128&&++Va;var tn=Va>=Ja*4/5;Wr.push(Xr),Wr.push("Content-Location: "+(zr.root||"file:///C:/SheetJS/")+ga),Wr.push("Content-Transfer-Encoding: "+(tn?"quoted-printable":"base64")),Wr.push("Content-Type: "+Wa(Fa,ga)),Wr.push(""),Wr.push(tn?hn(Sa):_n(Sa))}return Wr.push(Xr+`--\r
`),Wr.join(`\r
`)}function Yi(Or){var Yr={};return pr(Yr,Or),Yr}function Si(Or,Yr,zr,Xr){var Wr=Xr&&Xr.unsafe;Wr||pr(Or);var $r=!Wr&&CFB.find(Or,Yr);if(!$r){var ga=Or.FullPaths[0];Yr.slice(0,ga.length)==ga?ga=Yr:(ga.slice(-1)!="/"&&(ga+="/"),ga=(ga+Yr).replace("//","/")),$r={name:Ee(Yr),type:2},Or.FileIndex.push($r),Or.FullPaths.push(ga),Wr||CFB.utils.cfb_gc(Or)}return $r.content=zr,$r.size=zr?zr.length:0,Xr&&(Xr.CLSID&&($r.clsid=Xr.CLSID),Xr.mt&&($r.mt=Xr.mt),Xr.ct&&($r.ct=Xr.ct)),$r}function bi(Or,Yr){pr(Or);var zr=CFB.find(Or,Yr);if(zr){for(var Xr=0;Xr<Or.FileIndex.length;++Xr)if(Or.FileIndex[Xr]==zr)return Or.FileIndex.splice(Xr,1),Or.FullPaths.splice(Xr,1),!0}return!1}function Ln(Or,Yr,zr){pr(Or);var Xr=CFB.find(Or,Yr);if(Xr){for(var Wr=0;Wr<Or.FileIndex.length;++Wr)if(Or.FileIndex[Wr]==Xr)return Or.FileIndex[Wr].name=Ee(zr),Or.FullPaths[Wr]=zr,!0}return!1}function $n(Or){fr(Or,!0)}return t.find=mr,t.read=hr,t.parse=Be,t.write=_r,t.writeFile=xr,t.utils={cfb_new:Yi,cfb_add:Si,cfb_del:bi,cfb_mov:Ln,cfb_gc:$n,ReadShift,CheckField,prep_blob,bconcat,use_zlib:Je,_deflateRaw:Ka,_inflateRaw:ca,consts:Ar},t})();function blobify(e){return typeof e=="string"?s2ab(e):Array.isArray(e)?a2u(e):e}function write_dl(e,t,r){if(typeof Deno<"u"){if(r&&typeof t=="string")switch(r){case"utf8":t=new TextEncoder(r).encode(t);break;case"binary":t=s2ab(t);break;default:throw new Error("Unsupported encoding "+r)}return Deno.writeFileSync(e,t)}var n=r=="utf8"?utf8write(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(n,e);if(typeof Blob<"u"){var Ee=new Blob([blobify(n)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(Ee,e);if(typeof saveAs<"u")return saveAs(Ee,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var Ce=URL.createObjectURL(Ee);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(Ce)},6e4),chrome.downloads.download({url:Ce,filename:e,saveAs:!0});var De=document.createElement("a");if(De.download!=null)return De.download=e,De.href=Ce,document.body.appendChild(De),De.click(),document.body.removeChild(De),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(Ce)},6e4),Ce}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var Me=File(e);return Me.open("w"),Me.encoding="binary",Array.isArray(t)&&(t=a2s(t)),Me.write(t),Me.close(),t}catch(ze){if(!ze.message||!ze.message.match(/onstruct/))throw ze}throw new Error("cannot save file "+e)}function read_binary(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function keys(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function evert_key(e,t){for(var r=[],n=keys(e),Ee=0;Ee!==n.length;++Ee)r[e[n[Ee]][t]]==null&&(r[e[n[Ee]][t]]=n[Ee]);return r}function evert(e){for(var t=[],r=keys(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}function evert_num(e){for(var t=[],r=keys(e),n=0;n!==r.length;++n)t[e[r[n]]]=parseInt(r[n],10);return t}function evert_arr(e){for(var t=[],r=keys(e),n=0;n!==r.length;++n)t[e[r[n]]]==null&&(t[e[r[n]]]=[]),t[e[r[n]]].push(r[n]);return t}var basedate=new Date(1899,11,30,0,0,0);function datenum(e,t){var r=e.getTime(),n=basedate.getTime()+(e.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4;return(r-n)/(1440*60*1e3)}var refdate=new Date,dnthresh=basedate.getTime()+(refdate.getTimezoneOffset()-basedate.getTimezoneOffset())*6e4,refoffset=refdate.getTimezoneOffset();function numdate(e){var t=new Date;return t.setTime(e*24*60*60*1e3+dnthresh),t.getTimezoneOffset()!==refoffset&&t.setTime(t.getTime()+(t.getTimezoneOffset()-refoffset)*6e4),t}function parse_isodur(e){var t=0,r=0,n=!1,Ee=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!Ee)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var Ce=1;Ce!=Ee.length;++Ce)if(Ee[Ce]){switch(r=1,Ce>3&&(n=!0),Ee[Ce].slice(Ee[Ce].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+Ee[Ce].slice(Ee[Ce].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(Ee[Ce],10)}return t}var good_pd_date_1=new Date("2017-02-19T19:06:09.000Z"),good_pd_date=isNaN(good_pd_date_1.getFullYear())?new Date("2/19/17"):good_pd_date_1,good_pd=good_pd_date.getFullYear()==2017;function parseDate(e,t){var r=new Date(e);if(good_pd)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(good_pd_date.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var Ee=e.match(/\d+/g)||["2017","2","19","0","0","0"],Ce=new Date(+Ee[0],+Ee[1]-1,+Ee[2],+Ee[3]||0,+Ee[4]||0,+Ee[5]||0);return e.indexOf("Z")>-1&&(Ce=new Date(Ce.getTime()-Ce.getTimezoneOffset()*60*1e3)),Ce}function cc2str(e,t){if(has_buf&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return utf8write(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return utf8write(utf16beread(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return utf8write(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return utf8write(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(Ce){return r[Ce]||Ce})}catch{}for(var n=[],Ee=0;Ee!=e.length;++Ee)n.push(String.fromCharCode(e[Ee]));return n.join("")}function dup(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=dup(e[r]));return t}function fill(e,t){for(var r="";r.length<t;)r+=e;return r}function fuzzynum(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(Ee,Ce){return r=-r,Ce}),!isNaN(t=Number(n)))?t/r:t}var lower_months=["january","february","march","april","may","june","july","august","september","october","november","december"];function fuzzydate(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),Ee=t.getMonth(),Ce=t.getDate();if(isNaN(Ce))return r;var De=e.toLowerCase();if(De.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(De=De.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),De.length>3&&lower_months.indexOf(De)==-1)return r}else if(De.match(/[a-z]/))return r;return n<0||n>8099?r:(Ee>0||Ce>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var split_regex=(function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,Ee){if(e||typeof n=="string")return r.split(n);for(var Ce=r.split(n),De=[Ce[0]],Me=1;Me<Ce.length;++Me)De.push(Ee),De.push(Ce[Me]);return De}})();function getdatastr(e){return e?e.content&&e.type?cc2str(e.content,!0):e.data?debom(e.data):e.asNodeBuffer&&has_buf?debom(e.asNodeBuffer().toString("binary")):e.asBinary?debom(e.asBinary()):e._data&&e._data.getContent?debom(cc2str(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function getdatabin(e){if(!e)return null;if(e.data)return char_codes(e.data);if(e.asNodeBuffer&&has_buf)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?char_codes(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function getdata(e){return e&&e.name.slice(-4)===".bin"?getdatabin(e):getdatastr(e)}function safegetzipfile(e,t){for(var r=e.FullPaths||keys(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),Ee=n.replace(/\\/g,"/"),Ce=0;Ce<r.length;++Ce){var De=r[Ce].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==De||Ee==De)return e.files?e.files[r[Ce]]:e.FileIndex[Ce]}return null}function getzipfile(e,t){var r=safegetzipfile(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function getzipdata(e,t,r){if(!r)return getdata(getzipfile(e,t));if(!t)return null;try{return getzipdata(e,t)}catch{return null}}function getzipstr(e,t,r){if(!r)return getdatastr(getzipfile(e,t));if(!t)return null;try{return getzipstr(e,t)}catch{return null}}function getzipbin(e,t,r){return getdatabin(getzipfile(e,t))}function zipentries(e){for(var t=e.FullPaths||keys(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function zip_add_file(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return has_buf?n=Buffer_from(r):n=utf8decode(r),CFB.utils.cfb_add(e,t,n)}CFB.utils.cfb_add(e,t,r)}else e.file(t,r)}function zip_new(){return CFB.utils.cfb_new()}function zip_read(e,t){switch(t.type){case"base64":return CFB.read(e,{type:"base64"});case"binary":return CFB.read(e,{type:"binary"});case"buffer":case"array":return CFB.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function resolve_path(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var Ee=n.shift();Ee===".."?r.pop():Ee!=="."&&r.push(Ee)}return r.join("/")}var XML_HEADER=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,attregexg=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,tagregex1=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,tagregex2=/<[^>]*>/g,tagregex=XML_HEADER.match(tagregex1)?tagregex1:tagregex2,nsregex=/<\w*:/,nsregex2=/<(\/?)\w+:/;function parsexmltag(e,t,r){for(var n={},Ee=0,Ce=0;Ee!==e.length&&!((Ce=e.charCodeAt(Ee))===32||Ce===10||Ce===13);++Ee);if(t||(n[0]=e.slice(0,Ee)),Ee===e.length)return n;var De=e.match(attregexg),Me=0,ze="",Oe=0,Be="",He="",Ve=1;if(De)for(Oe=0;Oe!=De.length;++Oe){for(He=De[Oe],Ce=0;Ce!=He.length&&He.charCodeAt(Ce)!==61;++Ce);for(Be=He.slice(0,Ce).trim();He.charCodeAt(Ce+1)==32;)++Ce;for(Ve=(Ee=He.charCodeAt(Ce+1))==34||Ee==39?1:0,ze=He.slice(Ce+1+Ve,He.length-Ve),Me=0;Me!=Be.length&&Be.charCodeAt(Me)!==58;++Me);if(Me===Be.length)Be.indexOf("_")>0&&(Be=Be.slice(0,Be.indexOf("_"))),n[Be]=ze,n[Be.toLowerCase()]=ze;else{var Xe=(Me===5&&Be.slice(0,5)==="xmlns"?"xmlns":"")+Be.slice(Me+1);if(n[Xe]&&Be.slice(Me-3,Me)=="ext")continue;n[Xe]=ze,n[Xe.toLowerCase()]=ze}}return n}function strip_ns(e){return e.replace(nsregex2,"<$1")}var encodings={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},rencoding=evert(encodings),unescapexml=(function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var Ee=n+"",Ce=Ee.indexOf("<![CDATA[");if(Ce==-1)return Ee.replace(e,function(Me,ze){return encodings[Me]||String.fromCharCode(parseInt(ze,Me.indexOf("x")>-1?16:10))||Me}).replace(t,function(Me,ze){return String.fromCharCode(parseInt(ze,16))});var De=Ee.indexOf("]]>");return r(Ee.slice(0,Ce))+Ee.slice(Ce+9,De)+r(Ee.slice(De+3))}})(),decregex=/[&<>'"]/g,charegex=/[\u0000-\u0008\u000b-\u001f]/g;function escapexml(e){var t=e+"";return t.replace(decregex,function(r){return rencoding[r]}).replace(charegex,function(r){return"_x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+"_"})}function escapexmltag(e){return escapexml(e).replace(/ /g,"_x0020_")}var htmlcharegex=/[\u0000-\u001f]/g;function escapehtml(e){var t=e+"";return t.replace(decregex,function(r){return rencoding[r]}).replace(/\n/g,"<br/>").replace(htmlcharegex,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}function escapexlml(e){var t=e+"";return t.replace(decregex,function(r){return rencoding[r]}).replace(htmlcharegex,function(r){return"&#x"+r.charCodeAt(0).toString(16).toUpperCase()+";"})}var xlml_fixstr=(function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}})();function xlml_unfixstr(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function parsexmlbool(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function utf8reada(e){for(var t="",r=0,n=0,Ee=0,Ce=0,De=0,Me=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(Ee=e.charCodeAt(r++),n>191&&n<224){De=(n&31)<<6,De|=Ee&63,t+=String.fromCharCode(De);continue}if(Ce=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(Ee&63)<<6|Ce&63);continue}De=e.charCodeAt(r++),Me=((n&7)<<18|(Ee&63)<<12|(Ce&63)<<6|De&63)-65536,t+=String.fromCharCode(55296+(Me>>>10&1023)),t+=String.fromCharCode(56320+(Me&1023))}return t}function utf8readb(e){var t=new_raw_buf(2*e.length),r,n,Ee=1,Ce=0,De=0,Me;for(n=0;n<e.length;n+=Ee)Ee=1,(Me=e.charCodeAt(n))<128?r=Me:Me<224?(r=(Me&31)*64+(e.charCodeAt(n+1)&63),Ee=2):Me<240?(r=(Me&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),Ee=3):(Ee=4,r=(Me&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,De=55296+(r>>>10&1023),r=56320+(r&1023)),De!==0&&(t[Ce++]=De&255,t[Ce++]=De>>>8,De=0),t[Ce++]=r%256,t[Ce++]=r>>>8;return t.slice(0,Ce).toString("ucs2")}function utf8readc(e){return Buffer_from(e,"binary").toString("utf8")}var utf8corpus="foo bar baz",utf8read=has_buf&&(utf8readc(utf8corpus)==utf8reada(utf8corpus)&&utf8readc||utf8readb(utf8corpus)==utf8reada(utf8corpus)&&utf8readb)||utf8reada,utf8write=has_buf?function(e){return Buffer_from(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,Ee=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,Ee=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(Ee>>18&7))),t.push(String.fromCharCode(144+(Ee>>12&63))),t.push(String.fromCharCode(128+(Ee>>6&63))),t.push(String.fromCharCode(128+(Ee&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},matchtag=(function(){var e={};return function(r,n){var Ee=r+"|"+(n||"");return e[Ee]?e[Ee]:e[Ee]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}})(),htmldecode=(function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),Ee=0;Ee<e.length;++Ee)n=n.replace(e[Ee][0],e[Ee][1]);return n}})(),vtregex=(function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}})(),vtvregex=/<\/?(?:vt:)?variant>/g,vtmregex=/<(?:vt:)([^>]*)>([\s\S]*)</;function parseVector(e,t){var r=parsexmltag(e),n=e.match(vtregex(r.baseType))||[],Ee=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return Ee}return n.forEach(function(Ce){var De=Ce.replace(vtvregex,"").match(vtmregex);De&&Ee.push({v:utf8read(De[2]),t:De[1]})}),Ee}var wtregex=/(^\s|\s$|\n)/;function writetag(e,t){return"<"+e+(t.match(wtregex)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function wxt_helper(e){return keys(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function writextag(e,t,r){return"<"+e+(r!=null?wxt_helper(r):"")+(t!=null?(t.match(wtregex)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function write_w3cdtf(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(r){if(t)throw r}return""}function write_vt(e,t){switch(typeof e){case"string":var r=writextag("vt:lpwstr",escapexml(e));return r=r.replace(/&quot;/g,"_x0022_"),r;case"number":return writextag((e|0)==e?"vt:i4":"vt:r8",escapexml(String(e)));case"boolean":return writextag("vt:bool",e?"true":"false")}if(e instanceof Date)return writextag("vt:filetime",write_w3cdtf(e));throw new Error("Unable to serialize "+e)}function xlml_normalize(e){if(has_buf&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return utf8read(a2s(ab2a(e)));throw new Error("Bad input format: expected Buffer or string")}var xlmlregex=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,XMLNS={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},XMLNS_main=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],XLMLNS={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function read_double_le(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),Ee=e[t+6]&15,Ce=5;Ce>=0;--Ce)Ee=Ee*256+e[t+Ce];return n==2047?Ee==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,Ee+=Math.pow(2,52)),r*Math.pow(2,n-52)*Ee)}function write_double_le(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,Ee=0,Ce=0,De=n?-t:t;isFinite(De)?De==0?Ee=Ce=0:(Ee=Math.floor(Math.log(De)/Math.LN2),Ce=De*Math.pow(2,52-Ee),Ee<=-1023&&(!isFinite(Ce)||Ce<Math.pow(2,52))?Ee=-1022:(Ce-=Math.pow(2,52),Ee+=1023)):(Ee=2047,Ce=isNaN(t)?26985:0);for(var Me=0;Me<=5;++Me,Ce/=256)e[r+Me]=Ce&255;e[r+6]=(Ee&15)<<4|Ce&15,e[r+7]=Ee>>4|n}var ___toBuffer=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var Ee=0,Ce=e[0][n].length;Ee<Ce;Ee+=r)t.push.apply(t,e[0][n].slice(Ee,Ee+r));return t},__toBuffer=has_buf?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:Buffer_from(t)})):___toBuffer(e)}:___toBuffer,___utf16le=function(e,t,r){for(var n=[],Ee=t;Ee<r;Ee+=2)n.push(String.fromCharCode(__readUInt16LE(e,Ee)));return n.join("").replace(chr0,"")},__utf16le=has_buf?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(chr0,""):___utf16le(e,t,r)}:___utf16le,___hexlify=function(e,t,r){for(var n=[],Ee=t;Ee<t+r;++Ee)n.push(("0"+e[Ee].toString(16)).slice(-2));return n.join("")},__hexlify=has_buf?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):___hexlify(e,t,r)}:___hexlify,___utf8=function(e,t,r){for(var n=[],Ee=t;Ee<r;Ee++)n.push(String.fromCharCode(__readUInt8(e,Ee)));return n.join("")},__utf8=has_buf?function e(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):___utf8(t,r,n)}:___utf8,___lpstr=function(e,t){var r=__readUInt32LE(e,t);return r>0?__utf8(e,t+4,t+4+r-1):""},__lpstr=___lpstr,___cpstr=function(e,t){var r=__readUInt32LE(e,t);return r>0?__utf8(e,t+4,t+4+r-1):""},__cpstr=___cpstr,___lpwstr=function(e,t){var r=2*__readUInt32LE(e,t);return r>0?__utf8(e,t+4,t+4+r-1):""},__lpwstr=___lpwstr,___lpp4=function e(t,r){var n=__readUInt32LE(t,r);return n>0?__utf16le(t,r+4,r+4+n):""},__lpp4=___lpp4,___8lpp4=function(e,t){var r=__readUInt32LE(e,t);return r>0?__utf8(e,t+4,t+4+r):""},__8lpp4=___8lpp4,___double=function(e,t){return read_double_le(e,t)},__double=___double,is_buf=function e(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};has_buf&&(__lpstr=function(t,r){if(!Buffer.isBuffer(t))return ___lpstr(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},__cpstr=function(t,r){if(!Buffer.isBuffer(t))return ___cpstr(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},__lpwstr=function(t,r){if(!Buffer.isBuffer(t))return ___lpwstr(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},__lpp4=function(t,r){if(!Buffer.isBuffer(t))return ___lpp4(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},__8lpp4=function(t,r){if(!Buffer.isBuffer(t))return ___8lpp4(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},__double=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):___double(t,r)},is_buf=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var __readUInt8=function(e,t){return e[t]},__readUInt16LE=function(e,t){return e[t+1]*256+e[t]},__readInt16LE=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},__readUInt32LE=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},__readInt32LE=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},__readInt32BE=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function ReadShift(e,t){var r="",n,Ee,Ce=[],De,Me,ze,Oe;switch(t){case"dbcs":if(Oe=this.l,has_buf&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(ze=0;ze<e;++ze)r+=String.fromCharCode(__readUInt16LE(this,Oe)),Oe+=2;e*=2;break;case"utf8":r=__utf8(this,this.l,this.l+e);break;case"utf16le":e*=2,r=__utf16le(this,this.l,this.l+e);break;case"wstr":return ReadShift.call(this,e,"dbcs");case"lpstr-ansi":r=__lpstr(this,this.l),e=4+__readUInt32LE(this,this.l);break;case"lpstr-cp":r=__cpstr(this,this.l),e=4+__readUInt32LE(this,this.l);break;case"lpwstr":r=__lpwstr(this,this.l),e=4+2*__readUInt32LE(this,this.l);break;case"lpp4":e=4+__readUInt32LE(this,this.l),r=__lpp4(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+__readUInt32LE(this,this.l),r=__8lpp4(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(De=__readUInt8(this,this.l+e++))!==0;)Ce.push(_getchar(De));r=Ce.join("");break;case"_wstr":for(e=0,r="";(De=__readUInt16LE(this,this.l+e))!==0;)Ce.push(_getchar(De)),e+=2;e+=2,r=Ce.join("");break;case"dbcs-cont":for(r="",Oe=this.l,ze=0;ze<e;++ze){if(this.lens&&this.lens.indexOf(Oe)!==-1)return De=__readUInt8(this,Oe),this.l=Oe+1,Me=ReadShift.call(this,e-ze,De?"dbcs-cont":"sbcs-cont"),Ce.join("")+Me;Ce.push(_getchar(__readUInt16LE(this,Oe))),Oe+=2}r=Ce.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",Oe=this.l,ze=0;ze!=e;++ze){if(this.lens&&this.lens.indexOf(Oe)!==-1)return De=__readUInt8(this,Oe),this.l=Oe+1,Me=ReadShift.call(this,e-ze,De?"dbcs-cont":"sbcs-cont"),Ce.join("")+Me;Ce.push(_getchar(__readUInt8(this,Oe))),Oe+=1}r=Ce.join("");break;default:switch(e){case 1:return n=__readUInt8(this,this.l),this.l++,n;case 2:return n=(t==="i"?__readInt16LE:__readUInt16LE)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||(this[this.l+3]&128)===0?(n=(e>0?__readInt32LE:__readInt32BE)(this,this.l),this.l+=4,n):(Ee=__readUInt32LE(this,this.l),this.l+=4,Ee);case 8:case-8:if(t==="f")return e==8?Ee=__double(this,this.l):Ee=__double([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,Ee;e=8;case 16:r=__hexlify(this,this.l,e);break}}return this.l+=e,r}var __writeUInt32LE=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},__writeInt32LE=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},__writeUInt16LE=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function WriteShift(e,t,r){var n=0,Ee=0;if(r==="dbcs"){for(Ee=0;Ee!=t.length;++Ee)__writeUInt16LE(this,t.charCodeAt(Ee),this.l+2*Ee);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),Ee=0;Ee!=t.length;++Ee)this[this.l+Ee]=t.charCodeAt(Ee)&255;n=t.length}else if(r==="hex"){for(;Ee<e;++Ee)this[this.l++]=parseInt(t.slice(2*Ee,2*Ee+2),16)||0;return this}else if(r==="utf16le"){var Ce=Math.min(this.l+e,this.length);for(Ee=0;Ee<Math.min(t.length,e);++Ee){var De=t.charCodeAt(Ee);this[this.l++]=De&255,this[this.l++]=De>>8}for(;this.l<Ce;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,__writeUInt32LE(this,t,this.l);break;case 8:if(n=8,r==="f"){write_double_le(this,t,this.l);break}case 16:break;case-4:n=4,__writeInt32LE(this,t,this.l);break}return this.l+=n,this}function CheckField(e,t){var r=__hexlify(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function prep_blob(e,t){e.l=t,e.read_shift=ReadShift,e.chk=CheckField,e.write_shift=WriteShift}function parsenoop(e,t){e.l+=t}function new_buf(e){var t=new_raw_buf(e);return prep_blob(t,0),t}function recordhopper(e,t,r){if(e){var n,Ee,Ce;prep_blob(e,e.l||0);for(var De=e.length,Me=0,ze=0;e.l<De;){Me=e.read_shift(1),Me&128&&(Me=(Me&127)+((e.read_shift(1)&127)<<7));var Oe=XLSBRecordEnum[Me]||XLSBRecordEnum[65535];for(n=e.read_shift(1),Ce=n&127,Ee=1;Ee<4&&n&128;++Ee)Ce+=((n=e.read_shift(1))&127)<<7*Ee;ze=e.l+Ce;var Be=Oe.f&&Oe.f(e,Ce,r);if(e.l=ze,t(Be,Oe,Me))return}}}function buf_array(){var e=[],t=has_buf?256:2048,r=function(Oe){var Be=new_buf(Oe);return prep_blob(Be,0),Be},n=r(t),Ee=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},Ce=function(Oe){return n&&Oe<n.length-n.l?n:(Ee(),n=r(Math.max(Oe+1,t)))},De=function(){return Ee(),bconcat(e)},Me=function(Oe){Ee(),n=Oe,n.l==null&&(n.l=n.length),Ce(t)};return{next:Ce,push:Me,end:De,_bufs:e}}function write_record(e,t,r,n){var Ee=+t,Ce;if(!isNaN(Ee)){n||(n=XLSBRecordEnum[Ee].p||(r||[]).length||0),Ce=1+(Ee>=128?1:0)+1,n>=128&&++Ce,n>=16384&&++Ce,n>=2097152&&++Ce;var De=e.next(Ce);Ee<=127?De.write_shift(1,Ee):(De.write_shift(1,(Ee&127)+128),De.write_shift(1,Ee>>7));for(var Me=0;Me!=4;++Me)if(n>=128)De.write_shift(1,(n&127)+128),n>>=7;else{De.write_shift(1,n);break}n>0&&is_buf(r)&&e.push(r)}}function shift_cell_xls(e,t,r){var n=dup(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function shift_range_xls(e,t,r){var n=dup(e);return n.s=shift_cell_xls(n.s,t.s,r),n.e=shift_cell_xls(n.e,t.s,r),n}function encode_cell_xls(e,t){if(e.cRel&&e.c<0)for(e=dup(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=dup(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=encode_cell(e);return!e.cRel&&e.cRel!=null&&(r=fix_col(r)),!e.rRel&&e.rRel!=null&&(r=fix_row(r)),r}function encode_range_xls(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+encode_col(e.s.c)+":"+(e.e.cRel?"":"$")+encode_col(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+encode_row(e.s.r)+":"+(e.e.rRel?"":"$")+encode_row(e.e.r):encode_cell_xls(e.s,t.biff)+":"+encode_cell_xls(e.e,t.biff)}function decode_row(e){return parseInt(unfix_row(e),10)-1}function encode_row(e){return""+(e+1)}function fix_row(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function unfix_row(e){return e.replace(/\$(\d+)$/,"$1")}function decode_col(e){for(var t=unfix_col(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function encode_col(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function fix_col(e){return e.replace(/^([A-Z])/,"$$$1")}function unfix_col(e){return e.replace(/^\$([A-Z])/,"$1")}function split_cell(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function decode_cell(e){for(var t=0,r=0,n=0;n<e.length;++n){var Ee=e.charCodeAt(n);Ee>=48&&Ee<=57?t=10*t+(Ee-48):Ee>=65&&Ee<=90&&(r=26*r+(Ee-64))}return{c:r-1,r:t-1}}function encode_cell(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function decode_range(e){var t=e.indexOf(":");return t==-1?{s:decode_cell(e),e:decode_cell(e)}:{s:decode_cell(e.slice(0,t)),e:decode_cell(e.slice(t+1))}}function encode_range(e,t){return typeof t>"u"||typeof t=="number"?encode_range(e.s,e.e):(typeof e!="string"&&(e=encode_cell(e)),typeof t!="string"&&(t=encode_cell(t)),e==t?e:e+":"+t)}function safe_decode_range(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,Ee=0,Ce=e.length;for(r=0;n<Ce&&!((Ee=e.charCodeAt(n)-64)<1||Ee>26);++n)r=26*r+Ee;for(t.s.c=--r,r=0;n<Ce&&!((Ee=e.charCodeAt(n)-48)<0||Ee>9);++n)r=10*r+Ee;if(t.s.r=--r,n===Ce||Ee!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=Ce&&!((Ee=e.charCodeAt(n)-64)<1||Ee>26);++n)r=26*r+Ee;for(t.e.c=--r,r=0;n!=Ce&&!((Ee=e.charCodeAt(n)-48)<0||Ee>9);++n)r=10*r+Ee;return t.e.r=--r,t}function safe_format_cell(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=SSF_format(e.z,r?datenum(t):t)}catch{}try{return e.w=SSF_format((e.XF||{}).numFmtId||(r?14:0),r?datenum(t):t)}catch{return""+t}}function format_cell(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?BErr[e.v]||e.v:t==null?safe_format_cell(e,e.v):safe_format_cell(e,t))}function sheet_to_workbook(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function sheet_add_aoa(e,t,r){var n=r||{},Ee=e?Array.isArray(e):n.dense,Ce=e||(Ee?[]:{}),De=0,Me=0;if(Ce&&n.origin!=null){if(typeof n.origin=="number")De=n.origin;else{var ze=typeof n.origin=="string"?decode_cell(n.origin):n.origin;De=ze.r,Me=ze.c}Ce["!ref"]||(Ce["!ref"]="A1:A1")}var Oe={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(Ce["!ref"]){var Be=safe_decode_range(Ce["!ref"]);Oe.s.c=Be.s.c,Oe.s.r=Be.s.r,Oe.e.c=Math.max(Oe.e.c,Be.e.c),Oe.e.r=Math.max(Oe.e.r,Be.e.r),De==-1&&(Oe.e.r=De=Be.e.r+1)}for(var He=0;He!=t.length;++He)if(t[He]){if(!Array.isArray(t[He]))throw new Error("aoa_to_sheet expects an array of arrays");for(var Ve=0;Ve!=t[He].length;++Ve)if(!(typeof t[He][Ve]>"u")){var Xe={v:t[He][Ve]},We=De+He,Ge=Me+Ve;if(Oe.s.r>We&&(Oe.s.r=We),Oe.s.c>Ge&&(Oe.s.c=Ge),Oe.e.r<We&&(Oe.e.r=We),Oe.e.c<Ge&&(Oe.e.c=Ge),t[He][Ve]&&typeof t[He][Ve]=="object"&&!Array.isArray(t[He][Ve])&&!(t[He][Ve]instanceof Date))Xe=t[He][Ve];else if(Array.isArray(Xe.v)&&(Xe.f=t[He][Ve][1],Xe.v=Xe.v[0]),Xe.v===null)if(Xe.f)Xe.t="n";else if(n.nullError)Xe.t="e",Xe.v=0;else if(n.sheetStubs)Xe.t="z";else continue;else typeof Xe.v=="number"?Xe.t="n":typeof Xe.v=="boolean"?Xe.t="b":Xe.v instanceof Date?(Xe.z=n.dateNF||table_fmt[14],n.cellDates?(Xe.t="d",Xe.w=SSF_format(Xe.z,datenum(Xe.v))):(Xe.t="n",Xe.v=datenum(Xe.v),Xe.w=SSF_format(Xe.z,Xe.v))):Xe.t="s";if(Ee)Ce[We]||(Ce[We]=[]),Ce[We][Ge]&&Ce[We][Ge].z&&(Xe.z=Ce[We][Ge].z),Ce[We][Ge]=Xe;else{var $e=encode_cell({c:Ge,r:We});Ce[$e]&&Ce[$e].z&&(Xe.z=Ce[$e].z),Ce[$e]=Xe}}}return Oe.s.c<1e7&&(Ce["!ref"]=encode_range(Oe)),Ce}function aoa_to_sheet(e,t){return sheet_add_aoa(null,e,t)}function parse_Int32LE(e){return e.read_shift(4,"i")}function write_UInt32LE(e,t){return t||(t=new_buf(4)),t.write_shift(4,e),t}function parse_XLWideString(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function write_XLWideString(e,t){var r=!1;return t==null&&(r=!0,t=new_buf(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}function parse_StrRun(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function write_StrRun(e,t){return t||(t=new_buf(4)),t.write_shift(2,0),t.write_shift(2,0),t}function parse_RichStr(e,t){var r=e.l,n=e.read_shift(1),Ee=parse_XLWideString(e),Ce=[],De={t:Ee,h:Ee};if((n&1)!==0){for(var Me=e.read_shift(4),ze=0;ze!=Me;++ze)Ce.push(parse_StrRun(e));De.r=Ce}else De.r=[{ich:0,ifnt:0}];return e.l=r+t,De}function write_RichStr(e,t){var r=!1;return t==null&&(r=!0,t=new_buf(15+4*e.t.length)),t.write_shift(1,0),write_XLWideString(e.t,t),r?t.slice(0,t.l):t}var parse_BrtCommentText=parse_RichStr;function write_BrtCommentText(e,t){var r=!1;return t==null&&(r=!0,t=new_buf(23+4*e.t.length)),t.write_shift(1,1),write_XLWideString(e.t,t),t.write_shift(4,1),write_StrRun({},t),r?t.slice(0,t.l):t}function parse_XLSBCell(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function write_XLSBCell(e,t){return t==null&&(t=new_buf(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function parse_XLSBShortCell(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function write_XLSBShortCell(e,t){return t==null&&(t=new_buf(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var parse_XLSBCodeName=parse_XLWideString,write_XLSBCodeName=write_XLWideString;function parse_XLNullableWideString(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function write_XLNullableWideString(e,t){var r=!1;return t==null&&(r=!0,t=new_buf(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),r?t.slice(0,t.l):t}var parse_XLNameWideString=parse_XLWideString,parse_RelID=parse_XLNullableWideString,write_RelID=write_XLNullableWideString;function parse_RkNumber(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var Ee=n===0?__double([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):__readInt32LE(t,0)>>2;return r?Ee/100:Ee}function write_RkNumber(e,t){t==null&&(t=new_buf(4));var r=0,n=0,Ee=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?n=1:Ee==(Ee|0)&&Ee>=-536870912&&Ee<1<<29&&(n=1,r=1),n)t.write_shift(-4,((r?Ee:e)<<2)+(r+2));else throw new Error("unsupported RkNumber "+e)}function parse_RfX(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function write_RfX(e,t){return t||(t=new_buf(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var parse_UncheckedRfX=parse_RfX,write_UncheckedRfX=write_RfX;function parse_Xnum(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function write_Xnum(e,t){return(t||new_buf(8)).write_shift(8,e,"f")}function parse_BrtColor(e){var t={},r=e.read_shift(1),n=r>>>1,Ee=e.read_shift(1),Ce=e.read_shift(2,"i"),De=e.read_shift(1),Me=e.read_shift(1),ze=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=Ee;var Oe=XLSIcv[Ee];Oe&&(t.rgb=rgb2Hex(Oe));break;case 2:t.rgb=rgb2Hex([De,Me,ze]);break;case 3:t.theme=Ee;break}return Ce!=0&&(t.tint=Ce>0?Ce/32767:Ce/32768),t}function write_BrtColor(e,t){if(t||(t=new_buf(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var r=e.tint||0;if(r>0?r*=32767:r<0&&(r*=32768),t.write_shift(2,r),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var n=e.rgb||"FFFFFF";typeof n=="number"&&(n=("000000"+n.toString(16)).slice(-6)),t.write_shift(1,parseInt(n.slice(0,2),16)),t.write_shift(1,parseInt(n.slice(2,4),16)),t.write_shift(1,parseInt(n.slice(4,6),16)),t.write_shift(1,255)}return t}function parse_FontFlags(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function write_FontFlags(e,t){t||(t=new_buf(2));var r=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,r),t.write_shift(1,0),t}function parse_ClipboardFormatOrString(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function parse_ClipboardFormatOrAnsiString(e){return parse_ClipboardFormatOrString(e,1)}function parse_ClipboardFormatOrUnicodeString(e){return parse_ClipboardFormatOrString(e,2)}var VT_I2=2,VT_I4=3,VT_BOOL=11,VT_VARIANT=12,VT_UI4=19,VT_FILETIME=64,VT_BLOB=65,VT_CF=71,VT_VECTOR_VARIANT=4108,VT_VECTOR_LPSTR=4126,VT_STRING=80,VT_USTR=81,VT_CUSTOM=[VT_STRING,VT_USTR],DocSummaryPIDDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Category",t:VT_STRING},3:{n:"PresentationFormat",t:VT_STRING},4:{n:"ByteCount",t:VT_I4},5:{n:"LineCount",t:VT_I4},6:{n:"ParagraphCount",t:VT_I4},7:{n:"SlideCount",t:VT_I4},8:{n:"NoteCount",t:VT_I4},9:{n:"HiddenCount",t:VT_I4},10:{n:"MultimediaClipCount",t:VT_I4},11:{n:"ScaleCrop",t:VT_BOOL},12:{n:"HeadingPairs",t:VT_VECTOR_VARIANT},13:{n:"TitlesOfParts",t:VT_VECTOR_LPSTR},14:{n:"Manager",t:VT_STRING},15:{n:"Company",t:VT_STRING},16:{n:"LinksUpToDate",t:VT_BOOL},17:{n:"CharacterCount",t:VT_I4},19:{n:"SharedDoc",t:VT_BOOL},22:{n:"HyperlinksChanged",t:VT_BOOL},23:{n:"AppVersion",t:VT_I4,p:"version"},24:{n:"DigSig",t:VT_BLOB},26:{n:"ContentType",t:VT_STRING},27:{n:"ContentStatus",t:VT_STRING},28:{n:"Language",t:VT_STRING},29:{n:"Version",t:VT_STRING},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},SummaryPIDSI={1:{n:"CodePage",t:VT_I2},2:{n:"Title",t:VT_STRING},3:{n:"Subject",t:VT_STRING},4:{n:"Author",t:VT_STRING},5:{n:"Keywords",t:VT_STRING},6:{n:"Comments",t:VT_STRING},7:{n:"Template",t:VT_STRING},8:{n:"LastAuthor",t:VT_STRING},9:{n:"RevNumber",t:VT_STRING},10:{n:"EditTime",t:VT_FILETIME},11:{n:"LastPrinted",t:VT_FILETIME},12:{n:"CreatedDate",t:VT_FILETIME},13:{n:"ModifiedDate",t:VT_FILETIME},14:{n:"PageCount",t:VT_I4},15:{n:"WordCount",t:VT_I4},16:{n:"CharCount",t:VT_I4},17:{n:"Thumbnail",t:VT_CF},18:{n:"Application",t:VT_STRING},19:{n:"DocSecurity",t:VT_I4},255:{},2147483648:{n:"Locale",t:VT_UI4},2147483651:{n:"Behavior",t:VT_UI4},1919054434:{}},CountryEnum={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},XLSFillPattern=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function rgbify(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var _XLSIcv=rgbify([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),XLSIcv=dup(_XLSIcv),BErr={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},RBErr={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},ct2type={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},CT_LIST={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function new_ct(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function parse_ct(e){var t=new_ct();if(!e||!e.match)return t;var r={};if((e.match(tagregex)||[]).forEach(function(n){var Ee=parsexmltag(n);switch(Ee[0].replace(nsregex,"<")){case"<?xml":break;case"<Types":t.xmlns=Ee["xmlns"+(Ee[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[Ee.Extension]=Ee.ContentType;break;case"<Override":t[ct2type[Ee.ContentType]]!==void 0&&t[ct2type[Ee.ContentType]].push(Ee.PartName);break}}),t.xmlns!==XMLNS.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}function write_ct(e,t){var r=evert_arr(ct2type),n=[],Ee;n[n.length]=XML_HEADER,n[n.length]=writextag("Types",null,{xmlns:XMLNS.CT,"xmlns:xsd":XMLNS.xsd,"xmlns:xsi":XMLNS.xsi}),n=n.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(ze){return writextag("Default",null,{Extension:ze[0],ContentType:ze[1]})}));var Ce=function(ze){e[ze]&&e[ze].length>0&&(Ee=e[ze][0],n[n.length]=writextag("Override",null,{PartName:(Ee[0]=="/"?"":"/")+Ee,ContentType:CT_LIST[ze][t.bookType]||CT_LIST[ze].xlsx}))},De=function(ze){(e[ze]||[]).forEach(function(Oe){n[n.length]=writextag("Override",null,{PartName:(Oe[0]=="/"?"":"/")+Oe,ContentType:CT_LIST[ze][t.bookType]||CT_LIST[ze].xlsx})})},Me=function(ze){(e[ze]||[]).forEach(function(Oe){n[n.length]=writextag("Override",null,{PartName:(Oe[0]=="/"?"":"/")+Oe,ContentType:r[ze][0]})})};return Ce("workbooks"),De("sheets"),De("charts"),Me("themes"),["strs","styles"].forEach(Ce),["coreprops","extprops","custprops"].forEach(Me),Me("vba"),Me("comments"),Me("threadedcomments"),Me("drawings"),De("metadata"),Me("people"),n.length>2&&(n[n.length]="</Types>",n[1]=n[1].replace("/>",">")),n.join("")}var RELS={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function get_rels_path(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function parse_rels(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(tagregex)||[]).forEach(function(Ee){var Ce=parsexmltag(Ee);if(Ce[0]==="<Relationship"){var De={};De.Type=Ce.Type,De.Target=Ce.Target,De.Id=Ce.Id,Ce.TargetMode&&(De.TargetMode=Ce.TargetMode);var Me=Ce.TargetMode==="External"?Ce.Target:resolve_path(Ce.Target,t);r[Me]=De,n[Ce.Id]=De}}),r["!id"]=n,r}function write_rels(e){var t=[XML_HEADER,writextag("Relationships",null,{xmlns:XMLNS.RELS})];return keys(e["!id"]).forEach(function(r){t[t.length]=writextag("Relationship",null,e["!id"][r])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function add_rels(e,t,r,n,Ee,Ce){if(Ee||(Ee={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,Ee.Id="rId"+t,Ee.Type=n,Ee.Target=r,[RELS.HLINK,RELS.XPATH,RELS.XMISS].indexOf(Ee.Type)>-1&&(Ee.TargetMode="External"),e["!id"][Ee.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][Ee.Id]=Ee,e[("/"+Ee.Target).replace("//","/")]=Ee,t}var CT_ODS="application/vnd.oasis.opendocument.spreadsheet";function parse_manifest(e,t){for(var r=xlml_normalize(e),n,Ee;n=xlmlregex.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(Ee=parsexmltag(n[0],!1),Ee.path=="/"&&Ee.type!==CT_ODS)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}function write_manifest(e){var t=[XML_HEADER];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var r=0;r<e.length;++r)t.push('  <manifest:file-entry manifest:full-path="'+e[r][0]+'" manifest:media-type="'+e[r][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function write_rdf_type(e,t,r){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(r||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf_has(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function write_rdf(e){var t=[XML_HEADER];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var r=0;r!=e.length;++r)t.push(write_rdf_type(e[r][0],e[r][1])),t.push(write_rdf_has("",e[r][0]));return t.push(write_rdf_type("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function write_meta_ods(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+XLSX.version+"</meta:generator></office:meta></office:document-meta>"}var CORE_PROPS=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],CORE_PROPS_REGEX=(function(){for(var e=new Array(CORE_PROPS.length),t=0;t<CORE_PROPS.length;++t){var r=CORE_PROPS[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e})();function parse_core_props(e){var t={};e=utf8read(e);for(var r=0;r<CORE_PROPS.length;++r){var n=CORE_PROPS[r],Ee=e.match(CORE_PROPS_REGEX[r]);Ee!=null&&Ee.length>0&&(t[n[1]]=unescapexml(Ee[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=parseDate(t[n[1]]))}return t}function cp_doit(e,t,r,n,Ee){Ee[e]!=null||t==null||t===""||(Ee[e]=t,t=escapexml(t),n[n.length]=r?writextag(e,t,r):writetag(e,t))}function write_core_props(e,t){var r=t||{},n=[XML_HEADER,writextag("cp:coreProperties",null,{"xmlns:cp":XMLNS.CORE_PROPS,"xmlns:dc":XMLNS.dc,"xmlns:dcterms":XMLNS.dcterms,"xmlns:dcmitype":XMLNS.dcmitype,"xmlns:xsi":XMLNS.xsi})],Ee={};if(!e&&!r.Props)return n.join("");e&&(e.CreatedDate!=null&&cp_doit("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:write_w3cdtf(e.CreatedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,Ee),e.ModifiedDate!=null&&cp_doit("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:write_w3cdtf(e.ModifiedDate,r.WTF),{"xsi:type":"dcterms:W3CDTF"},n,Ee));for(var Ce=0;Ce!=CORE_PROPS.length;++Ce){var De=CORE_PROPS[Ce],Me=r.Props&&r.Props[De[1]]!=null?r.Props[De[1]]:e?e[De[1]]:null;Me===!0?Me="1":Me===!1?Me="0":typeof Me=="number"&&(Me=String(Me)),Me!=null&&cp_doit(De[0],Me,null,n,Ee)}return n.length>2&&(n[n.length]="</cp:coreProperties>",n[1]=n[1].replace("/>",">")),n.join("")}var EXT_PROPS=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],PseudoPropsPairs=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function load_props_pairs(e,t,r,n){var Ee=[];if(typeof e=="string")Ee=parseVector(e,n);else for(var Ce=0;Ce<e.length;++Ce)Ee=Ee.concat(e[Ce].map(function(Be){return{v:Be}}));var De=typeof t=="string"?parseVector(t,n).map(function(Be){return Be.v}):t,Me=0,ze=0;if(De.length>0)for(var Oe=0;Oe!==Ee.length;Oe+=2){switch(ze=+Ee[Oe+1].v,Ee[Oe].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":r.Worksheets=ze,r.SheetNames=De.slice(Me,Me+ze);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":r.NamedRanges=ze,r.DefinedNames=De.slice(Me,Me+ze);break;case"Charts":case"Diagramme":r.Chartsheets=ze,r.ChartNames=De.slice(Me,Me+ze);break}Me+=ze}}function parse_ext_props(e,t,r){var n={};return t||(t={}),e=utf8read(e),EXT_PROPS.forEach(function(Ee){var Ce=(e.match(matchtag(Ee[0]))||[])[1];switch(Ee[2]){case"string":Ce&&(t[Ee[1]]=unescapexml(Ce));break;case"bool":t[Ee[1]]=Ce==="true";break;case"raw":var De=e.match(new RegExp("<"+Ee[0]+"[^>]*>([\\s\\S]*?)</"+Ee[0]+">"));De&&De.length>0&&(n[Ee[1]]=De[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&load_props_pairs(n.HeadingPairs,n.TitlesOfParts,t,r),t}function write_ext_props(e){var t=[],r=writextag;return e||(e={}),e.Application="SheetJS",t[t.length]=XML_HEADER,t[t.length]=writextag("Properties",null,{xmlns:XMLNS.EXT_PROPS,"xmlns:vt":XMLNS.vt}),EXT_PROPS.forEach(function(n){if(e[n[1]]!==void 0){var Ee;switch(n[2]){case"string":Ee=escapexml(String(e[n[1]]));break;case"bool":Ee=e[n[1]]?"true":"false";break}Ee!==void 0&&(t[t.length]=r(n[0],Ee))}}),t[t.length]=r("HeadingPairs",r("vt:vector",r("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+r("vt:variant",r("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=r("TitlesOfParts",r("vt:vector",e.SheetNames.map(function(n){return"<vt:lpstr>"+escapexml(n)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var custregex=/<[^>]+>[^<]*/g;function parse_cust_props(e,t){var r={},n="",Ee=e.match(custregex);if(Ee)for(var Ce=0;Ce!=Ee.length;++Ce){var De=Ee[Ce],Me=parsexmltag(De);switch(Me[0]){case"<?xml":break;case"<Properties":break;case"<property":n=unescapexml(Me.name);break;case"</property>":n=null;break;default:if(De.indexOf("<vt:")===0){var ze=De.split(">"),Oe=ze[0].slice(4),Be=ze[1];switch(Oe){case"lpstr":case"bstr":case"lpwstr":r[n]=unescapexml(Be);break;case"bool":r[n]=parsexmlbool(Be);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(Be,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(Be);break;case"filetime":case"date":r[n]=parseDate(Be);break;case"cy":case"error":r[n]=unescapexml(Be);break;default:if(Oe.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",De,Oe,ze)}}else if(De.slice(0,2)!=="</"){if(t.WTF)throw new Error(De)}}}return r}function write_cust_props(e){var t=[XML_HEADER,writextag("Properties",null,{xmlns:XMLNS.CUST_PROPS,"xmlns:vt":XMLNS.vt})];if(!e)return t.join("");var r=1;return keys(e).forEach(function(Ee){++r,t[t.length]=writextag("property",write_vt(e[Ee]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:r,name:escapexml(Ee)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var XLMLDocPropsMap={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},evert_XLMLDPM;function xlml_set_prop(e,t,r){evert_XLMLDPM||(evert_XLMLDPM=evert(XLMLDocPropsMap)),t=evert_XLMLDPM[t]||t,e[t]=r}function xlml_write_docprops(e,t){var r=[];return keys(XLMLDocPropsMap).map(function(n){for(var Ee=0;Ee<CORE_PROPS.length;++Ee)if(CORE_PROPS[Ee][1]==n)return CORE_PROPS[Ee];for(Ee=0;Ee<EXT_PROPS.length;++Ee)if(EXT_PROPS[Ee][1]==n)return EXT_PROPS[Ee];throw n}).forEach(function(n){if(e[n[1]]!=null){var Ee=t&&t.Props&&t.Props[n[1]]!=null?t.Props[n[1]]:e[n[1]];switch(n[2]){case"date":Ee=new Date(Ee).toISOString().replace(/\.\d*Z/,"Z");break}typeof Ee=="number"?Ee=String(Ee):Ee===!0||Ee===!1?Ee=Ee?"1":"0":Ee instanceof Date&&(Ee=new Date(Ee).toISOString().replace(/\.\d*Z/,"")),r.push(writetag(XLMLDocPropsMap[n[1]]||n[1],Ee))}}),writextag("DocumentProperties",r.join(""),{xmlns:XLMLNS.o})}function xlml_write_custprops(e,t){var r=["Worksheets","SheetNames"],n="CustomDocumentProperties",Ee=[];return e&&keys(e).forEach(function(Ce){if(Object.prototype.hasOwnProperty.call(e,Ce)){for(var De=0;De<CORE_PROPS.length;++De)if(Ce==CORE_PROPS[De][1])return;for(De=0;De<EXT_PROPS.length;++De)if(Ce==EXT_PROPS[De][1])return;for(De=0;De<r.length;++De)if(Ce==r[De])return;var Me=e[Ce],ze="string";typeof Me=="number"?(ze="float",Me=String(Me)):Me===!0||Me===!1?(ze="boolean",Me=Me?"1":"0"):Me=String(Me),Ee.push(writextag(escapexmltag(Ce),Me,{"dt:dt":ze}))}}),t&&keys(t).forEach(function(Ce){if(Object.prototype.hasOwnProperty.call(t,Ce)&&!(e&&Object.prototype.hasOwnProperty.call(e,Ce))){var De=t[Ce],Me="string";typeof De=="number"?(Me="float",De=String(De)):De===!0||De===!1?(Me="boolean",De=De?"1":"0"):De instanceof Date?(Me="dateTime.tz",De=De.toISOString()):De=String(De),Ee.push(writextag(escapexmltag(Ce),De,{"dt:dt":Me}))}}),"<"+n+' xmlns="'+XLMLNS.o+'">'+Ee.join("")+"</"+n+">"}function parse_FILETIME(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function write_FILETIME(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,r=t.getTime()/1e3+11644473600,n=r%Math.pow(2,32),Ee=(r-n)/Math.pow(2,32);n*=1e7,Ee*=1e7;var Ce=n/Math.pow(2,32)|0;Ce>0&&(n=n%Math.pow(2,32),Ee+=Ce);var De=new_buf(8);return De.write_shift(4,n),De.write_shift(4,Ee),De}function parse_lpstr(e,t,r){var n=e.l,Ee=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return Ee}function parse_lpwstr(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function parse_VtStringBase(e,t,r){return t===31?parse_lpwstr(e):parse_lpstr(e,t,r)}function parse_VtString(e,t,r){return parse_VtStringBase(e,t,r===!1?0:4)}function parse_VtUnalignedString(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return parse_VtStringBase(e,t,0)}function parse_VtVecLpwstrValue(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var Ee=e.l;r[n]=e.read_shift(0,"lpwstr").replace(chr0,""),e.l-Ee&2&&(e.l+=2)}return r}function parse_VtVecUnalignedLpstrValue(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(chr0,"");return r}function parse_VtHeadingPair(e){var t=e.l,r=parse_TypedPropertyValue(e,VT_USTR);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=parse_TypedPropertyValue(e,VT_I4);return[r,n]}function parse_VtVecHeadingPairValue(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(parse_VtHeadingPair(e));return r}function parse_dictionary(e,t){for(var r=e.read_shift(4),n={},Ee=0;Ee!=r;++Ee){var Ce=e.read_shift(4),De=e.read_shift(4);n[Ce]=e.read_shift(De,t===1200?"utf16le":"utf8").replace(chr0,"").replace(chr1,"!"),t===1200&&De%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function parse_BLOB(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function parse_ClipboardData(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function parse_TypedPropertyValue(e,t,r){var n=e.read_shift(2),Ee,Ce=r||{};if(e.l+=2,t!==VT_VARIANT&&n!==t&&VT_CUSTOM.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===VT_VARIANT?n:t){case 2:return Ee=e.read_shift(2,"i"),Ce.raw||(e.l+=2),Ee;case 3:return Ee=e.read_shift(4,"i"),Ee;case 11:return e.read_shift(4)!==0;case 19:return Ee=e.read_shift(4),Ee;case 30:return parse_lpstr(e,n,4).replace(chr0,"");case 31:return parse_lpwstr(e);case 64:return parse_FILETIME(e);case 65:return parse_BLOB(e);case 71:return parse_ClipboardData(e);case 80:return parse_VtString(e,n,!Ce.raw).replace(chr0,"");case 81:return parse_VtUnalignedString(e,n).replace(chr0,"");case 4108:return parse_VtVecHeadingPairValue(e);case 4126:case 4127:return n==4127?parse_VtVecLpwstrValue(e):parse_VtVecUnalignedLpstrValue(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function write_TypedPropertyValue(e,t){var r=new_buf(4),n=new_buf(4);switch(r.write_shift(4,e==80?31:e),e){case 3:n.write_shift(-4,t);break;case 5:n=new_buf(8),n.write_shift(8,t,"f");break;case 11:n.write_shift(4,t?1:0);break;case 64:n=write_FILETIME(t);break;case 31:case 80:for(n=new_buf(4+2*(t.length+1)+(t.length%2?0:2)),n.write_shift(4,t.length+1),n.write_shift(0,t,"dbcs");n.l!=n.length;)n.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return bconcat([r,n])}function parse_PropertySet(e,t){var r=e.l,n=e.read_shift(4),Ee=e.read_shift(4),Ce=[],De=0,Me=0,ze=-1,Oe={};for(De=0;De!=Ee;++De){var Be=e.read_shift(4),He=e.read_shift(4);Ce[De]=[Be,He+r]}Ce.sort(function(rr,tr){return rr[1]-tr[1]});var Ve={};for(De=0;De!=Ee;++De){if(e.l!==Ce[De][1]){var Xe=!0;if(De>0&&t)switch(t[Ce[De-1][0]].t){case 2:e.l+2===Ce[De][1]&&(e.l+=2,Xe=!1);break;case 80:e.l<=Ce[De][1]&&(e.l=Ce[De][1],Xe=!1);break;case 4108:e.l<=Ce[De][1]&&(e.l=Ce[De][1],Xe=!1);break}if((!t||De==0)&&e.l<=Ce[De][1]&&(Xe=!1,e.l=Ce[De][1]),Xe)throw new Error("Read Error: Expected address "+Ce[De][1]+" at "+e.l+" :"+De)}if(t){var We=t[Ce[De][0]];if(Ve[We.n]=parse_TypedPropertyValue(e,We.t,{raw:!0}),We.p==="version"&&(Ve[We.n]=String(Ve[We.n]>>16)+"."+("0000"+String(Ve[We.n]&65535)).slice(-4)),We.n=="CodePage")switch(Ve[We.n]){case 0:Ve[We.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:set_cp(Me=Ve[We.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+Ve[We.n])}}else if(Ce[De][0]===1){if(Me=Ve.CodePage=parse_TypedPropertyValue(e,VT_I2),set_cp(Me),ze!==-1){var Ge=e.l;e.l=Ce[ze][1],Oe=parse_dictionary(e,Me),e.l=Ge}}else if(Ce[De][0]===0){if(Me===0){ze=De,e.l=Ce[De+1][1];continue}Oe=parse_dictionary(e,Me)}else{var $e=Oe[Ce[De][0]],Ke;switch(e[e.l]){case 65:e.l+=4,Ke=parse_BLOB(e);break;case 30:e.l+=4,Ke=parse_VtString(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,Ke=parse_VtString(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,Ke=e.read_shift(4,"i");break;case 19:e.l+=4,Ke=e.read_shift(4);break;case 5:e.l+=4,Ke=e.read_shift(8,"f");break;case 11:e.l+=4,Ke=parsebool(e,4);break;case 64:e.l+=4,Ke=parseDate(parse_FILETIME(e));break;default:throw new Error("unparsed value: "+e[e.l])}Ve[$e]=Ke}}return e.l=r+n,Ve}var XLSPSSkip=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function guess_property_type(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function write_PropertySet(e,t,r){var n=new_buf(8),Ee=[],Ce=[],De=8,Me=0,ze=new_buf(8),Oe=new_buf(8);if(ze.write_shift(4,2),ze.write_shift(4,1200),Oe.write_shift(4,1),Ce.push(ze),Ee.push(Oe),De+=8+ze.length,!t){Oe=new_buf(8),Oe.write_shift(4,0),Ee.unshift(Oe);var Be=[new_buf(4)];for(Be[0].write_shift(4,e.length),Me=0;Me<e.length;++Me){var He=e[Me][0];for(ze=new_buf(8+2*(He.length+1)+(He.length%2?0:2)),ze.write_shift(4,Me+2),ze.write_shift(4,He.length+1),ze.write_shift(0,He,"dbcs");ze.l!=ze.length;)ze.write_shift(1,0);Be.push(ze)}ze=bconcat(Be),Ce.unshift(ze),De+=8+ze.length}for(Me=0;Me<e.length;++Me)if(!(t&&!t[e[Me][0]])&&!(XLSPSSkip.indexOf(e[Me][0])>-1||PseudoPropsPairs.indexOf(e[Me][0])>-1)&&e[Me][1]!=null){var Ve=e[Me][1],Xe=0;if(t){Xe=+t[e[Me][0]];var We=r[Xe];if(We.p=="version"&&typeof Ve=="string"){var Ge=Ve.split(".");Ve=(+Ge[0]<<16)+(+Ge[1]||0)}ze=write_TypedPropertyValue(We.t,Ve)}else{var $e=guess_property_type(Ve);$e==-1&&($e=31,Ve=String(Ve)),ze=write_TypedPropertyValue($e,Ve)}Ce.push(ze),Oe=new_buf(8),Oe.write_shift(4,t?Xe:2+Me),Ee.push(Oe),De+=8+ze.length}var Ke=8*(Ce.length+1);for(Me=0;Me<Ce.length;++Me)Ee[Me].write_shift(4,Ke),Ke+=Ce[Me].length;return n.write_shift(4,De),n.write_shift(4,Ce.length),bconcat([n].concat(Ee).concat(Ce))}function parse_PropertySetStream(e,t,r){var n=e.content;if(!n)return{};prep_blob(n,0);var Ee,Ce,De,Me,ze=0;n.chk("feff","Byte Order: "),n.read_shift(2);var Oe=n.read_shift(4),Be=n.read_shift(16);if(Be!==CFB.utils.consts.HEADER_CLSID&&Be!==r)throw new Error("Bad PropertySet CLSID "+Be);if(Ee=n.read_shift(4),Ee!==1&&Ee!==2)throw new Error("Unrecognized #Sets: "+Ee);if(Ce=n.read_shift(16),Me=n.read_shift(4),Ee===1&&Me!==n.l)throw new Error("Length mismatch: "+Me+" !== "+n.l);Ee===2&&(De=n.read_shift(16),ze=n.read_shift(4));var He=parse_PropertySet(n,t),Ve={SystemIdentifier:Oe};for(var Xe in He)Ve[Xe]=He[Xe];if(Ve.FMTID=Ce,Ee===1)return Ve;if(ze-n.l==2&&(n.l+=2),n.l!==ze)throw new Error("Length mismatch 2: "+n.l+" !== "+ze);var We;try{We=parse_PropertySet(n,null)}catch{}for(Xe in We)Ve[Xe]=We[Xe];return Ve.FMTID=[Ce,De],Ve}function write_PropertySetStream(e,t,r,n,Ee,Ce){var De=new_buf(Ee?68:48),Me=[De];De.write_shift(2,65534),De.write_shift(2,0),De.write_shift(4,842412599),De.write_shift(16,CFB.utils.consts.HEADER_CLSID,"hex"),De.write_shift(4,Ee?2:1),De.write_shift(16,t,"hex"),De.write_shift(4,Ee?68:48);var ze=write_PropertySet(e,r,n);if(Me.push(ze),Ee){var Oe=write_PropertySet(Ee,null,null);De.write_shift(16,Ce,"hex"),De.write_shift(4,68+ze.length),Me.push(Oe)}return bconcat(Me)}function parsenoop2(e,t){return e.read_shift(t),null}function writezeroes(e,t){t||(t=new_buf(e));for(var r=0;r<e;++r)t.write_shift(1,0);return t}function parslurp(e,t,r){for(var n=[],Ee=e.l+t;e.l<Ee;)n.push(r(e,Ee-e.l));if(Ee!==e.l)throw new Error("Slurp error");return n}function parsebool(e,t){return e.read_shift(t)===1}function writebool(e,t){return t||(t=new_buf(2)),t.write_shift(2,+!!e),t}function parseuint16(e){return e.read_shift(2,"u")}function writeuint16(e,t){return t||(t=new_buf(2)),t.write_shift(2,e),t}function parseuint16a(e,t){return parslurp(e,t,parseuint16)}function parse_Bes(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function write_Bes(e,t,r){return r||(r=new_buf(2)),r.write_shift(1,t=="e"?+e:+!!e),r.write_shift(1,t=="e"?1:0),r}function parse_ShortXLUnicodeString(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),Ee="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var Ce=e.read_shift(1);Ce&&(Ee="dbcs-cont")}else r.biff==12&&(Ee="wstr");r.biff>=2&&r.biff<=5&&(Ee="cpstr");var De=n?e.read_shift(n,Ee):"";return De}function parse_XLUnicodeRichExtendedString(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,Ee=r&8,Ce=1+(r&1),De=0,Me,ze={};Ee&&(De=e.read_shift(2)),n&&(Me=e.read_shift(4));var Oe=Ce==2?"dbcs-cont":"sbcs-cont",Be=t===0?"":e.read_shift(t,Oe);return Ee&&(e.l+=4*De),n&&(e.l+=Me),ze.t=Be,Ee||(ze.raw="<t>"+ze.t+"</t>",ze.r=ze.t),ze}function write_XLUnicodeRichExtendedString(e){var t=e.t||"",r=new_buf(3);r.write_shift(2,t.length),r.write_shift(1,1);var n=new_buf(2*t.length);n.write_shift(2*t.length,t,"utf16le");var Ee=[r,n];return bconcat(Ee)}function parse_XLUnicodeStringNoCch(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var Ee=e.read_shift(1);return Ee===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function parse_XLUnicodeString(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):parse_XLUnicodeStringNoCch(e,n,r)}function parse_XLUnicodeString2(e,t,r){if(r.biff>5)return parse_XLUnicodeString(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function write_XLUnicodeString(e,t,r){return r||(r=new_buf(3+2*e.length)),r.write_shift(2,e.length),r.write_shift(1,1),r.write_shift(31,e,"utf16le"),r}function parse_ControlInfo(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function parse_URLMoniker(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var Ee=e.read_shift((n?t-24:t)>>1,"utf16le").replace(chr0,"");return n&&(e.l+=24),Ee}function parse_FileMoniker(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var Ee=e.read_shift(4);if(Ee===0)return r+n.replace(/\\/g,"/");var Ce=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var De=e.read_shift(Ce>>1,"utf16le").replace(chr0,"");return r+De}function parse_HyperlinkMoniker(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return parse_URLMoniker(e);case"0303000000000000c000000000000046":return parse_FileMoniker(e);default:throw new Error("Unsupported Moniker "+r)}}function parse_HyperlinkString(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(chr0,""):"";return r}function write_HyperlinkString(e,t){t||(t=new_buf(6+e.length*2)),t.write_shift(4,1+e.length);for(var r=0;r<e.length;++r)t.write_shift(2,e.charCodeAt(r));return t.write_shift(2,0),t}function parse_Hyperlink(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var Ee=e.read_shift(2);e.l+=2;var Ce,De,Me,ze,Oe="",Be,He;Ee&16&&(Ce=parse_HyperlinkString(e,r-e.l)),Ee&128&&(De=parse_HyperlinkString(e,r-e.l)),(Ee&257)===257&&(Me=parse_HyperlinkString(e,r-e.l)),(Ee&257)===1&&(ze=parse_HyperlinkMoniker(e,r-e.l)),Ee&8&&(Oe=parse_HyperlinkString(e,r-e.l)),Ee&32&&(Be=e.read_shift(16)),Ee&64&&(He=parse_FILETIME(e)),e.l=r;var Ve=De||Me||ze||"";Ve&&Oe&&(Ve+="#"+Oe),Ve||(Ve="#"+Oe),Ee&2&&Ve.charAt(0)=="/"&&Ve.charAt(1)!="/"&&(Ve="file://"+Ve);var Xe={Target:Ve};return Be&&(Xe.guid=Be),He&&(Xe.time=He),Ce&&(Xe.Tooltip=Ce),Xe}function write_Hyperlink(e){var t=new_buf(512),r=0,n=e.Target;n.slice(0,7)=="file://"&&(n=n.slice(7));var Ee=n.indexOf("#"),Ce=Ee>-1?31:23;switch(n.charAt(0)){case"#":Ce=28;break;case".":Ce&=-3;break}t.write_shift(4,2),t.write_shift(4,Ce);var De=[8,6815827,6619237,4849780,83];for(r=0;r<De.length;++r)t.write_shift(4,De[r]);if(Ce==28)n=n.slice(1),write_HyperlinkString(n,t);else if(Ce&2){for(De="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),r=0;r<De.length;++r)t.write_shift(1,parseInt(De[r],16));var Me=Ee>-1?n.slice(0,Ee):n;for(t.write_shift(4,2*(Me.length+1)),r=0;r<Me.length;++r)t.write_shift(2,Me.charCodeAt(r));t.write_shift(2,0),Ce&8&&write_HyperlinkString(Ee>-1?n.slice(Ee+1):"",t)}else{for(De="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),r=0;r<De.length;++r)t.write_shift(1,parseInt(De[r],16));for(var ze=0;n.slice(ze*3,ze*3+3)=="../"||n.slice(ze*3,ze*3+3)=="..\\";)++ze;for(t.write_shift(2,ze),t.write_shift(4,n.length-3*ze+1),r=0;r<n.length-3*ze;++r)t.write_shift(1,n.charCodeAt(r+3*ze)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),r=0;r<6;++r)t.write_shift(4,0)}return t.slice(0,t.l)}function parse_LongRGBA(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),Ee=e.read_shift(1);return[t,r,n,Ee]}function parse_LongRGB(e,t){var r=parse_LongRGBA(e);return r[3]=0,r}function parse_XLSCell(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function write_XLSCell(e,t,r,n){return n||(n=new_buf(6)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,r||0),n}function parse_frtHeader(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function parse_OptXLUnicodeString(e,t,r){return t===0?"":parse_XLUnicodeString2(e,t,r)}function parse_XTI(e,t,r){var n=r.biff>8?4:2,Ee=e.read_shift(n),Ce=e.read_shift(n,"i"),De=e.read_shift(n,"i");return[Ee,Ce,De]}function parse_RkRec(e){var t=e.read_shift(2),r=parse_RkNumber(e);return[t,r]}function parse_AddinUdf(e,t,r){e.l+=4,t-=4;var n=e.l+t,Ee=parse_ShortXLUnicodeString(e,t,r),Ce=e.read_shift(2);if(n-=e.l,Ce!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+Ce);return e.l+=Ce,Ee}function parse_Ref8U(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),Ee=e.read_shift(2);return{s:{c:n,r:t},e:{c:Ee,r}}}function write_Ref8U(e,t){return t||(t=new_buf(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function parse_RefU(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),Ee=e.read_shift(1);return{s:{c:n,r:t},e:{c:Ee,r}}}var parse_Ref=parse_RefU;function parse_FtCmo(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function parse_FtNts(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function parse_FtCf(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function parse_FtSkip(e){e.l+=2,e.l+=e.read_shift(2)}var FtTab={0:parse_FtSkip,4:parse_FtSkip,5:parse_FtSkip,6:parse_FtSkip,7:parse_FtCf,8:parse_FtSkip,9:parse_FtSkip,10:parse_FtSkip,11:parse_FtSkip,12:parse_FtSkip,13:parse_FtNts,14:parse_FtSkip,15:parse_FtSkip,16:parse_FtSkip,17:parse_FtSkip,18:parse_FtSkip,19:parse_FtSkip,20:parse_FtSkip,21:parse_FtCmo};function parse_FtArray(e,t){for(var r=e.l+t,n=[];e.l<r;){var Ee=e.read_shift(2);e.l-=2;try{n.push(FtTab[Ee](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function parse_BOF(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function write_BOF(e,t,r){var n=1536,Ee=16;switch(r.bookType){case"biff8":break;case"biff5":n=1280,Ee=8;break;case"biff4":n=4,Ee=6;break;case"biff3":n=3,Ee=6;break;case"biff2":n=2,Ee=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var Ce=new_buf(Ee);return Ce.write_shift(2,n),Ce.write_shift(2,t),Ee>4&&Ce.write_shift(2,29282),Ee>6&&Ce.write_shift(2,1997),Ee>8&&(Ce.write_shift(2,49161),Ce.write_shift(2,1),Ce.write_shift(2,1798),Ce.write_shift(2,0)),Ce}function parse_InterfaceHdr(e,t){return t===0||e.read_shift(2),1200}function parse_WriteAccess(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,Ee=parse_XLUnicodeString2(e,0,r);return e.read_shift(t+n-e.l),Ee}function write_WriteAccess(e,t){var r=!t||t.biff==8,n=new_buf(r?112:54);for(n.write_shift(t.biff==8?2:1,7),r&&n.write_shift(1,0),n.write_shift(4,859007059),n.write_shift(4,5458548|(r?0:536870912));n.l<n.length;)n.write_shift(1,r?0:32);return n}function parse_WsBool(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function parse_BoundSheet8(e,t,r){var n=e.read_shift(4),Ee=e.read_shift(1)&3,Ce=e.read_shift(1);switch(Ce){case 0:Ce="Worksheet";break;case 1:Ce="Macrosheet";break;case 2:Ce="Chartsheet";break;case 6:Ce="VBAModule";break}var De=parse_ShortXLUnicodeString(e,0,r);return De.length===0&&(De="Sheet1"),{pos:n,hs:Ee,dt:Ce,name:De}}function write_BoundSheet8(e,t){var r=!t||t.biff>=8?2:1,n=new_buf(8+r*e.name.length);n.write_shift(4,e.pos),n.write_shift(1,e.hs||0),n.write_shift(1,e.dt),n.write_shift(1,e.name.length),t.biff>=8&&n.write_shift(1,1),n.write_shift(r*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var Ee=n.slice(0,n.l);return Ee.l=n.l,Ee}function parse_SST(e,t){for(var r=e.l+t,n=e.read_shift(4),Ee=e.read_shift(4),Ce=[],De=0;De!=Ee&&e.l<r;++De)Ce.push(parse_XLUnicodeRichExtendedString(e));return Ce.Count=n,Ce.Unique=Ee,Ce}function write_SST(e,t){var r=new_buf(8);r.write_shift(4,e.Count),r.write_shift(4,e.Unique);for(var n=[],Ee=0;Ee<e.length;++Ee)n[Ee]=write_XLUnicodeRichExtendedString(e[Ee]);var Ce=bconcat([r].concat(n));return Ce.parts=[r.length].concat(n.map(function(De){return De.length})),Ce}function parse_ExtSST(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function parse_Row(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function parse_ForceFullCalculation(e){var t=parse_frtHeader(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function parse_RecalcId(e){return e.read_shift(2),e.read_shift(4)}function parse_DefaultRowHeight(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var Ee=e.read_shift(2);r&&r.biff==2&&(n=1-(Ee>>15),Ee&=32767);var Ce={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[Ce,Ee]}function parse_Window1(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),Ee=e.read_shift(2),Ce=e.read_shift(2),De=e.read_shift(2),Me=e.read_shift(2),ze=e.read_shift(2),Oe=e.read_shift(2);return{Pos:[t,r],Dim:[n,Ee],Flags:Ce,CurTab:De,FirstTab:Me,Selected:ze,TabRatio:Oe}}function write_Window1(){var e=new_buf(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function parse_Window2(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function write_Window2(e){var t=new_buf(18),r=1718;return e&&e.RTL&&(r|=64),t.write_shift(2,r),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function parse_Pane(){}function parse_Font(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=parse_ShortXLUnicodeString(e,0,r),n}function write_Font(e,t){var r=e.name||"Arial",n=t&&t.biff==5,Ee=n?15+r.length:16+2*r.length,Ce=new_buf(Ee);return Ce.write_shift(2,e.sz*20),Ce.write_shift(4,0),Ce.write_shift(2,400),Ce.write_shift(4,0),Ce.write_shift(2,0),Ce.write_shift(1,r.length),n||Ce.write_shift(1,1),Ce.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le"),Ce}function parse_LabelSst(e){var t=parse_XLSCell(e);return t.isst=e.read_shift(4),t}function write_LabelSst(e,t,r,n){var Ee=new_buf(10);return write_XLSCell(e,t,n,Ee),Ee.write_shift(4,r),Ee}function parse_Label(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,Ee=parse_XLSCell(e);r.biff==2&&e.l++;var Ce=parse_XLUnicodeString(e,n-e.l,r);return Ee.val=Ce,Ee}function write_Label(e,t,r,n,Ee){var Ce=!Ee||Ee.biff==8,De=new_buf(8+ +Ce+(1+Ce)*r.length);return write_XLSCell(e,t,n,De),De.write_shift(2,r.length),Ce&&De.write_shift(1,1),De.write_shift((1+Ce)*r.length,r,Ce?"utf16le":"sbcs"),De}function parse_Format(e,t,r){var n=e.read_shift(2),Ee=parse_XLUnicodeString2(e,0,r);return[n,Ee]}function write_Format(e,t,r,n){var Ee=r&&r.biff==5;n||(n=new_buf(Ee?3+t.length:5+2*t.length)),n.write_shift(2,e),n.write_shift(Ee?1:2,t.length),Ee||n.write_shift(1,1),n.write_shift((Ee?1:2)*t.length,t,Ee?"sbcs":"utf16le");var Ce=n.length>n.l?n.slice(0,n.l):n;return Ce.l==null&&(Ce.l=Ce.length),Ce}var parse_BIFF2Format=parse_XLUnicodeString2;function parse_Dimensions(e,t,r){var n=e.l+t,Ee=r.biff==8||!r.biff?4:2,Ce=e.read_shift(Ee),De=e.read_shift(Ee),Me=e.read_shift(2),ze=e.read_shift(2);return e.l=n,{s:{r:Ce,c:Me},e:{r:De,c:ze}}}function write_Dimensions(e,t){var r=t.biff==8||!t.biff?4:2,n=new_buf(2*r+6);return n.write_shift(r,e.s.r),n.write_shift(r,e.e.r+1),n.write_shift(2,e.s.c),n.write_shift(2,e.e.c+1),n.write_shift(2,0),n}function parse_RK(e){var t=e.read_shift(2),r=e.read_shift(2),n=parse_RkRec(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function parse_MulRk(e,t){for(var r=e.l+t-2,n=e.read_shift(2),Ee=e.read_shift(2),Ce=[];e.l<r;)Ce.push(parse_RkRec(e));if(e.l!==r)throw new Error("MulRK read error");var De=e.read_shift(2);if(Ce.length!=De-Ee+1)throw new Error("MulRK length mismatch");return{r:n,c:Ee,C:De,rkrec:Ce}}function parse_MulBlank(e,t){for(var r=e.l+t-2,n=e.read_shift(2),Ee=e.read_shift(2),Ce=[];e.l<r;)Ce.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var De=e.read_shift(2);if(Ce.length!=De-Ee+1)throw new Error("MulBlank length mismatch");return{r:n,c:Ee,C:De,ixfe:Ce}}function parse_CellStyleXF(e,t,r,n){var Ee={},Ce=e.read_shift(4),De=e.read_shift(4),Me=e.read_shift(4),ze=e.read_shift(2);return Ee.patternType=XLSFillPattern[Me>>26],n.cellStyles&&(Ee.alc=Ce&7,Ee.fWrap=Ce>>3&1,Ee.alcV=Ce>>4&7,Ee.fJustLast=Ce>>7&1,Ee.trot=Ce>>8&255,Ee.cIndent=Ce>>16&15,Ee.fShrinkToFit=Ce>>20&1,Ee.iReadOrder=Ce>>22&2,Ee.fAtrNum=Ce>>26&1,Ee.fAtrFnt=Ce>>27&1,Ee.fAtrAlc=Ce>>28&1,Ee.fAtrBdr=Ce>>29&1,Ee.fAtrPat=Ce>>30&1,Ee.fAtrProt=Ce>>31&1,Ee.dgLeft=De&15,Ee.dgRight=De>>4&15,Ee.dgTop=De>>8&15,Ee.dgBottom=De>>12&15,Ee.icvLeft=De>>16&127,Ee.icvRight=De>>23&127,Ee.grbitDiag=De>>30&3,Ee.icvTop=Me&127,Ee.icvBottom=Me>>7&127,Ee.icvDiag=Me>>14&127,Ee.dgDiag=Me>>21&15,Ee.icvFore=ze&127,Ee.icvBack=ze>>7&127,Ee.fsxButton=ze>>14&1),Ee}function parse_XF(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=parse_CellStyleXF(e,t,n.fStyle,r),n}function write_XF(e,t,r,n){var Ee=r&&r.biff==5;n||(n=new_buf(Ee?16:20)),n.write_shift(2,0),e.style?(n.write_shift(2,e.numFmtId||0),n.write_shift(2,65524)):(n.write_shift(2,e.numFmtId||0),n.write_shift(2,t<<4));var Ce=0;return e.numFmtId>0&&Ee&&(Ce|=1024),n.write_shift(4,Ce),n.write_shift(4,0),Ee||n.write_shift(4,0),n.write_shift(2,0),n}function parse_Guts(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function write_Guts(e){var t=new_buf(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function parse_BoolErr(e,t,r){var n=parse_XLSCell(e);(r.biff==2||t==9)&&++e.l;var Ee=parse_Bes(e);return n.val=Ee,n.t=Ee===!0||Ee===!1?"b":"e",n}function write_BoolErr(e,t,r,n,Ee,Ce){var De=new_buf(8);return write_XLSCell(e,t,n,De),write_Bes(r,Ce,De),De}function parse_Number(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=parse_XLSCell(e),Ee=parse_Xnum(e);return n.val=Ee,n}function write_Number(e,t,r,n){var Ee=new_buf(14);return write_XLSCell(e,t,n,Ee),write_Xnum(r,Ee),Ee}var parse_XLHeaderFooter=parse_OptXLUnicodeString;function parse_SupBook(e,t,r){var n=e.l+t,Ee=e.read_shift(2),Ce=e.read_shift(2);if(r.sbcch=Ce,Ce==1025||Ce==14849)return[Ce,Ee];if(Ce<1||Ce>255)throw new Error("Unexpected SupBook type: "+Ce);for(var De=parse_XLUnicodeStringNoCch(e,Ce),Me=[];n>e.l;)Me.push(parse_XLUnicodeString(e));return[Ce,Ee,De,Me]}function parse_ExternName(e,t,r){var n=e.read_shift(2),Ee,Ce={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(Ee=parse_AddinUdf(e,t-2,r)),Ce.body=Ee||e.read_shift(t-2),typeof Ee=="string"&&(Ce.Name=Ee),Ce}var XLSLblBuiltIn=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function parse_Lbl(e,t,r){var n=e.l+t,Ee=e.read_shift(2),Ce=e.read_shift(1),De=e.read_shift(1),Me=e.read_shift(r&&r.biff==2?1:2),ze=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),ze=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var Oe=parse_XLUnicodeStringNoCch(e,De,r);Ee&32&&(Oe=XLSLblBuiltIn[Oe.charCodeAt(0)]);var Be=n-e.l;r&&r.biff==2&&--Be;var He=n==e.l||Me===0||!(Be>0)?[]:parse_NameParsedFormula(e,Be,r,Me);return{chKey:Ce,Name:Oe,itab:ze,rgce:He}}function parse_ExternSheet(e,t,r){if(r.biff<8)return parse_BIFF5ExternSheet(e,t,r);for(var n=[],Ee=e.l+t,Ce=e.read_shift(r.biff>8?4:2);Ce--!==0;)n.push(parse_XTI(e,r.biff>8?12:6,r));if(e.l!=Ee)throw new Error("Bad ExternSheet: "+e.l+" != "+Ee);return n}function parse_BIFF5ExternSheet(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=parse_ShortXLUnicodeString(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function parse_NameCmt(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),Ee=e.read_shift(2),Ce=parse_XLUnicodeStringNoCch(e,n,r),De=parse_XLUnicodeStringNoCch(e,Ee,r);return[Ce,De]}function parse_ShrFmla(e,t,r){var n=parse_RefU(e);e.l++;var Ee=e.read_shift(1);return t-=8,[parse_SharedParsedFormula(e,t,r),Ee,n]}function parse_Array(e,t,r){var n=parse_Ref(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,parse_ArrayParsedFormula(e,t,r)]}function parse_MTRSettings(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function parse_NoteSh(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),Ee=e.read_shift(2),Ce=e.read_shift(2),De=e.read_shift(2),Me=parse_XLUnicodeString2(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:Ee},Me,De,Ce]}}function parse_Note(e,t,r){return parse_NoteSh(e,t,r)}function parse_MergeCells(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(parse_Ref8U(e));return r}function write_MergeCells(e){var t=new_buf(2+e.length*8);t.write_shift(2,e.length);for(var r=0;r<e.length;++r)write_Ref8U(e[r],t);return t}function parse_Obj(e,t,r){if(r&&r.biff<8)return parse_BIFF5Obj(e,t,r);var n=parse_FtCmo(e),Ee=parse_FtArray(e,t-22,n[1]);return{cmo:n,ft:Ee}}var parse_BIFF5OT={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var Ee=e.read_shift(1);return e.l+=Ee,e.l=r,{fmt:n}}};function parse_BIFF5Obj(e,t,r){e.l+=4;var n=e.read_shift(2),Ee=e.read_shift(2),Ce=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var De=[];return De.push((parse_BIFF5OT[n]||parsenoop)(e,t,r)),{cmo:[Ee,n,Ce],ft:De}}function parse_TxO(e,t,r){var n=e.l,Ee="";try{e.l+=4;var Ce=(r.lastobj||{cmo:[0,0]}).cmo[1],De;[0,5,7,11,12,14].indexOf(Ce)==-1?e.l+=6:De=parse_ControlInfo(e,6,r);var Me=e.read_shift(2);e.read_shift(2),parseuint16(e,2);var ze=e.read_shift(2);e.l+=ze;for(var Oe=1;Oe<e.lens.length-1;++Oe){if(e.l-n!=e.lens[Oe])throw new Error("TxO: bad continue record");var Be=e[e.l],He=parse_XLUnicodeStringNoCch(e,e.lens[Oe+1]-e.lens[Oe]-1);if(Ee+=He,Ee.length>=(Be?Me:2*Me))break}if(Ee.length!==Me&&Ee.length!==Me*2)throw new Error("cchText: "+Me+" != "+Ee.length);return e.l=n+t,{t:Ee}}catch{return e.l=n+t,{t:Ee}}}function parse_HLink(e,t){var r=parse_Ref8U(e);e.l+=16;var n=parse_Hyperlink(e,t-24);return[r,n]}function write_HLink(e){var t=new_buf(24),r=decode_cell(e[0]);t.write_shift(2,r.r),t.write_shift(2,r.r),t.write_shift(2,r.c),t.write_shift(2,r.c);for(var n="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),Ee=0;Ee<16;++Ee)t.write_shift(1,parseInt(n[Ee],16));return bconcat([t,write_Hyperlink(e[1])])}function parse_HLinkTooltip(e,t){e.read_shift(2);var r=parse_Ref8U(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(chr0,""),[r,n]}function write_HLinkTooltip(e){var t=e[1].Tooltip,r=new_buf(10+2*(t.length+1));r.write_shift(2,2048);var n=decode_cell(e[0]);r.write_shift(2,n.r),r.write_shift(2,n.r),r.write_shift(2,n.c),r.write_shift(2,n.c);for(var Ee=0;Ee<t.length;++Ee)r.write_shift(2,t.charCodeAt(Ee));return r.write_shift(2,0),r}function parse_Country(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=CountryEnum[r]||r,r=e.read_shift(2),t[1]=CountryEnum[r]||r,t}function write_Country(e){return e||(e=new_buf(4)),e.write_shift(2,1),e.write_shift(2,1),e}function parse_ClrtClient(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(parse_LongRGB(e));return r}function parse_Palette(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(parse_LongRGB(e));return r}function parse_XFCRC(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function parse_ColInfo(e,t,r){if(!r.cellStyles)return parsenoop(e,t);var n=r&&r.biff>=12?4:2,Ee=e.read_shift(n),Ce=e.read_shift(n),De=e.read_shift(n),Me=e.read_shift(n),ze=e.read_shift(2);n==2&&(e.l+=2);var Oe={s:Ee,e:Ce,w:De,ixfe:Me,flags:ze};return(r.biff>=5||!r.biff)&&(Oe.level=ze>>8&7),Oe}function write_ColInfo(e,t){var r=new_buf(12);r.write_shift(2,t),r.write_shift(2,t),r.write_shift(2,e.width*256),r.write_shift(2,0);var n=0;return e.hidden&&(n|=1),r.write_shift(1,n),n=e.level||0,r.write_shift(1,n),r.write_shift(2,0),r}function parse_Setup(e,t){var r={};return t<32||(e.l+=16,r.header=parse_Xnum(e),r.footer=parse_Xnum(e),e.l+=2),r}function parse_ShtProps(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var Ee=e.read_shift(1);return e.l+=3,Ee&16&&(n.area=!0),n}function write_RRTabId(e){for(var t=new_buf(2*e),r=0;r<e;++r)t.write_shift(2,r+1);return t}var parse_Blank=parse_XLSCell,parse_Scl=parseuint16a,parse_String=parse_XLUnicodeString;function parse_ImData(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),Ee={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,Ee}function parse_BIFF2STR(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=parse_XLSCell(e);++e.l;var Ee=parse_XLUnicodeString2(e,t-7,r);return n.t="str",n.val=Ee,n}function parse_BIFF2NUM(e){var t=parse_XLSCell(e);++e.l;var r=parse_Xnum(e);return t.t="n",t.val=r,t}function write_BIFF2NUM(e,t,r){var n=new_buf(15);return write_BIFF2Cell(n,e,t),n.write_shift(8,r,"f"),n}function parse_BIFF2INT(e){var t=parse_XLSCell(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function write_BIFF2INT(e,t,r){var n=new_buf(9);return write_BIFF2Cell(n,e,t),n.write_shift(2,r),n}function parse_BIFF2STRING(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function parse_BIFF2FONTXTRA(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function parse_RString(e,t,r){var n=e.l+t,Ee=parse_XLSCell(e),Ce=e.read_shift(2),De=parse_XLUnicodeStringNoCch(e,Ce,r);return e.l=n,Ee.t="str",Ee.val=De,Ee}var DBF_SUPPORTED_VERSIONS=[2,3,48,49,131,139,140,245],DBF=(function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=evert({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(Me,ze){var Oe=[],Be=new_raw_buf(1);switch(ze.type){case"base64":Be=s2a(Base64_decode(Me));break;case"binary":Be=s2a(Me);break;case"buffer":case"array":Be=Me;break}prep_blob(Be,0);var He=Be.read_shift(1),Ve=!!(He&136),Xe=!1,We=!1;switch(He){case 2:break;case 3:break;case 48:Xe=!0,Ve=!0;break;case 49:Xe=!0,Ve=!0;break;case 131:break;case 139:break;case 140:We=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+He.toString(16))}var Ge=0,$e=521;He==2&&(Ge=Be.read_shift(2)),Be.l+=3,He!=2&&(Ge=Be.read_shift(4)),Ge>1048576&&(Ge=1e6),He!=2&&($e=Be.read_shift(2));var Ke=Be.read_shift(2),rr=ze.codepage||1252;He!=2&&(Be.l+=16,Be.read_shift(1),Be[Be.l]!==0&&(rr=e[Be[Be.l]]),Be.l+=1,Be.l+=2),We&&(Be.l+=36);for(var tr=[],sr={},ar=Math.min(Be.length,He==2?521:$e-10-(Xe?264:0)),hr=We?32:11;Be.l<ar&&Be[Be.l]!=13;)switch(sr={},sr.name=$cptable.utils.decode(rr,Be.slice(Be.l,Be.l+hr)).replace(/[\u0000\r\n].*$/g,""),Be.l+=hr,sr.type=String.fromCharCode(Be.read_shift(1)),He!=2&&!We&&(sr.offset=Be.read_shift(4)),sr.len=Be.read_shift(1),He==2&&(sr.offset=Be.read_shift(2)),sr.dec=Be.read_shift(1),sr.name.length&&tr.push(sr),He!=2&&(Be.l+=We?13:14),sr.type){case"B":(!Xe||sr.len!=8)&&ze.WTF&&console.log("Skipping "+sr.name+":"+sr.type);break;case"G":case"P":ze.WTF&&console.log("Skipping "+sr.name+":"+sr.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+sr.type)}if(Be[Be.l]!==13&&(Be.l=$e-1),Be.read_shift(1)!==13)throw new Error("DBF Terminator not found "+Be.l+" "+Be[Be.l]);Be.l=$e;var pr=0,yr=0;for(Oe[0]=[],yr=0;yr!=tr.length;++yr)Oe[0][yr]=tr[yr].name;for(;Ge-- >0;){if(Be[Be.l]===42){Be.l+=Ke;continue}for(++Be.l,Oe[++pr]=[],yr=0,yr=0;yr!=tr.length;++yr){var fr=Be.slice(Be.l,Be.l+tr[yr].len);Be.l+=tr[yr].len,prep_blob(fr,0);var Rr=$cptable.utils.decode(rr,fr);switch(tr[yr].type){case"C":Rr.trim().length&&(Oe[pr][yr]=Rr.replace(/\s+$/,""));break;case"D":Rr.length===8?Oe[pr][yr]=new Date(+Rr.slice(0,4),+Rr.slice(4,6)-1,+Rr.slice(6,8)):Oe[pr][yr]=Rr;break;case"F":Oe[pr][yr]=parseFloat(Rr.trim());break;case"+":case"I":Oe[pr][yr]=We?fr.read_shift(-4,"i")^2147483648:fr.read_shift(4,"i");break;case"L":switch(Rr.trim().toUpperCase()){case"Y":case"T":Oe[pr][yr]=!0;break;case"N":case"F":Oe[pr][yr]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+Rr+"|")}break;case"M":if(!Ve)throw new Error("DBF Unexpected MEMO for type "+He.toString(16));Oe[pr][yr]="##MEMO##"+(We?parseInt(Rr.trim(),10):fr.read_shift(4));break;case"N":Rr=Rr.replace(/\u0000/g,"").trim(),Rr&&Rr!="."&&(Oe[pr][yr]=+Rr||0);break;case"@":Oe[pr][yr]=new Date(fr.read_shift(-8,"f")-621356832e5);break;case"T":Oe[pr][yr]=new Date((fr.read_shift(4)-2440588)*864e5+fr.read_shift(4));break;case"Y":Oe[pr][yr]=fr.read_shift(4,"i")/1e4+fr.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":Oe[pr][yr]=-fr.read_shift(-8,"f");break;case"B":if(Xe&&tr[yr].len==8){Oe[pr][yr]=fr.read_shift(8,"f");break}case"G":case"P":fr.l+=tr[yr].len;break;case"0":if(tr[yr].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+tr[yr].type)}}}if(He!=2&&Be.l<Be.length&&Be[Be.l++]!=26)throw new Error("DBF EOF Marker missing "+(Be.l-1)+" of "+Be.length+" "+Be[Be.l-1].toString(16));return ze&&ze.sheetRows&&(Oe=Oe.slice(0,ze.sheetRows)),ze.DBF=tr,Oe}function n(Me,ze){var Oe=ze||{};Oe.dateNF||(Oe.dateNF="yyyymmdd");var Be=aoa_to_sheet(r(Me,Oe),Oe);return Be["!cols"]=Oe.DBF.map(function(He){return{wch:He.len,DBF:He}}),delete Oe.DBF,Be}function Ee(Me,ze){try{return sheet_to_workbook(n(Me,ze),ze)}catch(Oe){if(ze&&ze.WTF)throw Oe}return{SheetNames:[],Sheets:{}}}var Ce={B:8,C:250,L:1,D:8,"?":0,"":0};function De(Me,ze){var Oe=ze||{};if(+Oe.codepage>=0&&set_cp(+Oe.codepage),Oe.type=="string")throw new Error("Cannot write DBF to JS string");var Be=buf_array(),He=sheet_to_json(Me,{header:1,raw:!0,cellDates:!0}),Ve=He[0],Xe=He.slice(1),We=Me["!cols"]||[],Ge=0,$e=0,Ke=0,rr=1;for(Ge=0;Ge<Ve.length;++Ge){if(((We[Ge]||{}).DBF||{}).name){Ve[Ge]=We[Ge].DBF.name,++Ke;continue}if(Ve[Ge]!=null){if(++Ke,typeof Ve[Ge]=="number"&&(Ve[Ge]=Ve[Ge].toString(10)),typeof Ve[Ge]!="string")throw new Error("DBF Invalid column name "+Ve[Ge]+" |"+typeof Ve[Ge]+"|");if(Ve.indexOf(Ve[Ge])!==Ge){for($e=0;$e<1024;++$e)if(Ve.indexOf(Ve[Ge]+"_"+$e)==-1){Ve[Ge]+="_"+$e;break}}}}var tr=safe_decode_range(Me["!ref"]),sr=[],ar=[],hr=[];for(Ge=0;Ge<=tr.e.c-tr.s.c;++Ge){var pr="",yr="",fr=0,Rr=[];for($e=0;$e<Xe.length;++$e)Xe[$e][Ge]!=null&&Rr.push(Xe[$e][Ge]);if(Rr.length==0||Ve[Ge]==null){sr[Ge]="?";continue}for($e=0;$e<Rr.length;++$e){switch(typeof Rr[$e]){case"number":yr="B";break;case"string":yr="C";break;case"boolean":yr="L";break;case"object":yr=Rr[$e]instanceof Date?"D":"C";break;default:yr="C"}fr=Math.max(fr,String(Rr[$e]).length),pr=pr&&pr!=yr?"C":yr}fr>250&&(fr=250),yr=((We[Ge]||{}).DBF||{}).type,yr=="C"&&We[Ge].DBF.len>fr&&(fr=We[Ge].DBF.len),pr=="B"&&yr=="N"&&(pr="N",hr[Ge]=We[Ge].DBF.dec,fr=We[Ge].DBF.len),ar[Ge]=pr=="C"||yr=="N"?fr:Ce[pr]||0,rr+=ar[Ge],sr[Ge]=pr}var mr=Be.next(32);for(mr.write_shift(4,318902576),mr.write_shift(4,Xe.length),mr.write_shift(2,296+32*Ke),mr.write_shift(2,rr),Ge=0;Ge<4;++Ge)mr.write_shift(4,0);for(mr.write_shift(4,0|(+t[current_ansi]||3)<<8),Ge=0,$e=0;Ge<Ve.length;++Ge)if(Ve[Ge]!=null){var wr=Be.next(32),Fr=(Ve[Ge].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);wr.write_shift(1,Fr,"sbcs"),wr.write_shift(1,sr[Ge]=="?"?"C":sr[Ge],"sbcs"),wr.write_shift(4,$e),wr.write_shift(1,ar[Ge]||Ce[sr[Ge]]||0),wr.write_shift(1,hr[Ge]||0),wr.write_shift(1,2),wr.write_shift(4,0),wr.write_shift(1,0),wr.write_shift(4,0),wr.write_shift(4,0),$e+=ar[Ge]||Ce[sr[Ge]]||0}var Mr=Be.next(264);for(Mr.write_shift(4,13),Ge=0;Ge<65;++Ge)Mr.write_shift(4,0);for(Ge=0;Ge<Xe.length;++Ge){var Hr=Be.next(rr);for(Hr.write_shift(1,0),$e=0;$e<Ve.length;++$e)if(Ve[$e]!=null)switch(sr[$e]){case"L":Hr.write_shift(1,Xe[Ge][$e]==null?63:Xe[Ge][$e]?84:70);break;case"B":Hr.write_shift(8,Xe[Ge][$e]||0,"f");break;case"N":var Nr="0";for(typeof Xe[Ge][$e]=="number"&&(Nr=Xe[Ge][$e].toFixed(hr[$e]||0)),Ke=0;Ke<ar[$e]-Nr.length;++Ke)Hr.write_shift(1,32);Hr.write_shift(1,Nr,"sbcs");break;case"D":Xe[Ge][$e]?(Hr.write_shift(4,("0000"+Xe[Ge][$e].getFullYear()).slice(-4),"sbcs"),Hr.write_shift(2,("00"+(Xe[Ge][$e].getMonth()+1)).slice(-2),"sbcs"),Hr.write_shift(2,("00"+Xe[Ge][$e].getDate()).slice(-2),"sbcs")):Hr.write_shift(8,"00000000","sbcs");break;case"C":var Ar=String(Xe[Ge][$e]!=null?Xe[Ge][$e]:"").slice(0,ar[$e]);for(Hr.write_shift(1,Ar,"sbcs"),Ke=0;Ke<ar[$e]-Ar.length;++Ke)Hr.write_shift(1,32);break}}return Be.next(1).write_shift(1,26),Be.end()}return{to_workbook:Ee,to_sheet:n,from_sheet:De}})(),SYLK=(function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+keys(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(Ve,Xe){var We=e[Xe];return typeof We=="number"?_getansi(We):We},n=function(Ve,Xe,We){var Ge=Xe.charCodeAt(0)-32<<4|We.charCodeAt(0)-48;return Ge==59?Ve:_getansi(Ge)};e["|"]=254;function Ee(Ve,Xe){switch(Xe.type){case"base64":return Ce(Base64_decode(Ve),Xe);case"binary":return Ce(Ve,Xe);case"buffer":return Ce(has_buf&&Buffer.isBuffer(Ve)?Ve.toString("binary"):a2s(Ve),Xe);case"array":return Ce(cc2str(Ve),Xe)}throw new Error("Unrecognized type "+Xe.type)}function Ce(Ve,Xe){var We=Ve.split(/[\n\r]+/),Ge=-1,$e=-1,Ke=0,rr=0,tr=[],sr=[],ar=null,hr={},pr=[],yr=[],fr=[],Rr=0,mr;for(+Xe.codepage>=0&&set_cp(+Xe.codepage);Ke!==We.length;++Ke){Rr=0;var wr=We[Ke].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),Fr=wr.replace(/;;/g,"\0").split(";").map(function(lr){return lr.replace(/\u0000/g,";")}),Mr=Fr[0],Hr;if(wr.length>0)switch(Mr){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Fr[1].charAt(0)=="P"&&sr.push(wr.slice(3).replace(/;;/g,";"));break;case"C":var Nr=!1,Ar=!1,xr=!1,ir=!1,_r=-1,ur=-1;for(rr=1;rr<Fr.length;++rr)switch(Fr[rr].charAt(0)){case"A":break;case"X":$e=parseInt(Fr[rr].slice(1))-1,Ar=!0;break;case"Y":for(Ge=parseInt(Fr[rr].slice(1))-1,Ar||($e=0),mr=tr.length;mr<=Ge;++mr)tr[mr]=[];break;case"K":Hr=Fr[rr].slice(1),Hr.charAt(0)==='"'?Hr=Hr.slice(1,Hr.length-1):Hr==="TRUE"?Hr=!0:Hr==="FALSE"?Hr=!1:isNaN(fuzzynum(Hr))?isNaN(fuzzydate(Hr).getDate())||(Hr=parseDate(Hr)):(Hr=fuzzynum(Hr),ar!==null&&fmt_is_date(ar)&&(Hr=numdate(Hr))),Nr=!0;break;case"E":ir=!0;var Je=rc_to_a1(Fr[rr].slice(1),{r:Ge,c:$e});tr[Ge][$e]=[tr[Ge][$e],Je];break;case"S":xr=!0,tr[Ge][$e]=[tr[Ge][$e],"S5S"];break;case"G":break;case"R":_r=parseInt(Fr[rr].slice(1))-1;break;case"C":ur=parseInt(Fr[rr].slice(1))-1;break;default:if(Xe&&Xe.WTF)throw new Error("SYLK bad record "+wr)}if(Nr&&(tr[Ge][$e]&&tr[Ge][$e].length==2?tr[Ge][$e][0]=Hr:tr[Ge][$e]=Hr,ar=null),xr){if(ir)throw new Error("SYLK shared formula cannot have own formula");var nr=_r>-1&&tr[_r][ur];if(!nr||!nr[1])throw new Error("SYLK shared formula cannot find base");tr[Ge][$e][1]=shift_formula_str(nr[1],{r:Ge-_r,c:$e-ur})}break;case"F":var or=0;for(rr=1;rr<Fr.length;++rr)switch(Fr[rr].charAt(0)){case"X":$e=parseInt(Fr[rr].slice(1))-1,++or;break;case"Y":for(Ge=parseInt(Fr[rr].slice(1))-1,mr=tr.length;mr<=Ge;++mr)tr[mr]=[];break;case"M":Rr=parseInt(Fr[rr].slice(1))/20;break;case"F":break;case"G":break;case"P":ar=sr[parseInt(Fr[rr].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(fr=Fr[rr].slice(1).split(" "),mr=parseInt(fr[0],10);mr<=parseInt(fr[1],10);++mr)Rr=parseInt(fr[2],10),yr[mr-1]=Rr===0?{hidden:!0}:{wch:Rr},process_col(yr[mr-1]);break;case"C":$e=parseInt(Fr[rr].slice(1))-1,yr[$e]||(yr[$e]={});break;case"R":Ge=parseInt(Fr[rr].slice(1))-1,pr[Ge]||(pr[Ge]={}),Rr>0?(pr[Ge].hpt=Rr,pr[Ge].hpx=pt2px(Rr)):Rr===0&&(pr[Ge].hidden=!0);break;default:if(Xe&&Xe.WTF)throw new Error("SYLK bad record "+wr)}or<1&&(ar=null);break;default:if(Xe&&Xe.WTF)throw new Error("SYLK bad record "+wr)}}return pr.length>0&&(hr["!rows"]=pr),yr.length>0&&(hr["!cols"]=yr),Xe&&Xe.sheetRows&&(tr=tr.slice(0,Xe.sheetRows)),[tr,hr]}function De(Ve,Xe){var We=Ee(Ve,Xe),Ge=We[0],$e=We[1],Ke=aoa_to_sheet(Ge,Xe);return keys($e).forEach(function(rr){Ke[rr]=$e[rr]}),Ke}function Me(Ve,Xe){return sheet_to_workbook(De(Ve,Xe),Xe)}function ze(Ve,Xe,We,Ge){var $e="C;Y"+(We+1)+";X"+(Ge+1)+";K";switch(Ve.t){case"n":$e+=Ve.v||0,Ve.f&&!Ve.F&&($e+=";E"+a1_to_rc(Ve.f,{r:We,c:Ge}));break;case"b":$e+=Ve.v?"TRUE":"FALSE";break;case"e":$e+=Ve.w||Ve.v;break;case"d":$e+='"'+(Ve.w||Ve.v)+'"';break;case"s":$e+='"'+Ve.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return $e}function Oe(Ve,Xe){Xe.forEach(function(We,Ge){var $e="F;W"+(Ge+1)+" "+(Ge+1)+" ";We.hidden?$e+="0":(typeof We.width=="number"&&!We.wpx&&(We.wpx=width2px(We.width)),typeof We.wpx=="number"&&!We.wch&&(We.wch=px2char(We.wpx)),typeof We.wch=="number"&&($e+=Math.round(We.wch))),$e.charAt($e.length-1)!=" "&&Ve.push($e)})}function Be(Ve,Xe){Xe.forEach(function(We,Ge){var $e="F;";We.hidden?$e+="M0;":We.hpt?$e+="M"+20*We.hpt+";":We.hpx&&($e+="M"+20*px2pt(We.hpx)+";"),$e.length>2&&Ve.push($e+"R"+(Ge+1))})}function He(Ve,Xe){var We=["ID;PWXL;N;E"],Ge=[],$e=safe_decode_range(Ve["!ref"]),Ke,rr=Array.isArray(Ve),tr=`\r
`;We.push("P;PGeneral"),We.push("F;P0;DG0G8;M255"),Ve["!cols"]&&Oe(We,Ve["!cols"]),Ve["!rows"]&&Be(We,Ve["!rows"]),We.push("B;Y"+($e.e.r-$e.s.r+1)+";X"+($e.e.c-$e.s.c+1)+";D"+[$e.s.c,$e.s.r,$e.e.c,$e.e.r].join(" "));for(var sr=$e.s.r;sr<=$e.e.r;++sr)for(var ar=$e.s.c;ar<=$e.e.c;++ar){var hr=encode_cell({r:sr,c:ar});Ke=rr?(Ve[sr]||[])[ar]:Ve[hr],!(!Ke||Ke.v==null&&(!Ke.f||Ke.F))&&Ge.push(ze(Ke,Ve,sr,ar))}return We.join(tr)+tr+Ge.join(tr)+tr+"E"+tr}return{to_workbook:Me,to_sheet:De,from_sheet:He}})(),DIF=(function(){function e(Ce,De){switch(De.type){case"base64":return t(Base64_decode(Ce),De);case"binary":return t(Ce,De);case"buffer":return t(has_buf&&Buffer.isBuffer(Ce)?Ce.toString("binary"):a2s(Ce),De);case"array":return t(cc2str(Ce),De)}throw new Error("Unrecognized type "+De.type)}function t(Ce,De){for(var Me=Ce.split(`
`),ze=-1,Oe=-1,Be=0,He=[];Be!==Me.length;++Be){if(Me[Be].trim()==="BOT"){He[++ze]=[],Oe=0;continue}if(!(ze<0)){var Ve=Me[Be].trim().split(","),Xe=Ve[0],We=Ve[1];++Be;for(var Ge=Me[Be]||"";(Ge.match(/["]/g)||[]).length&1&&Be<Me.length-1;)Ge+=`
`+Me[++Be];switch(Ge=Ge.trim(),+Xe){case-1:if(Ge==="BOT"){He[++ze]=[],Oe=0;continue}else if(Ge!=="EOD")throw new Error("Unrecognized DIF special command "+Ge);break;case 0:Ge==="TRUE"?He[ze][Oe]=!0:Ge==="FALSE"?He[ze][Oe]=!1:isNaN(fuzzynum(We))?isNaN(fuzzydate(We).getDate())?He[ze][Oe]=We:He[ze][Oe]=parseDate(We):He[ze][Oe]=fuzzynum(We),++Oe;break;case 1:Ge=Ge.slice(1,Ge.length-1),Ge=Ge.replace(/""/g,'"'),Ge&&Ge.match(/^=".*"$/)&&(Ge=Ge.slice(2,-1)),He[ze][Oe++]=Ge!==""?Ge:null;break}if(Ge==="EOD")break}}return De&&De.sheetRows&&(He=He.slice(0,De.sheetRows)),He}function r(Ce,De){return aoa_to_sheet(e(Ce,De),De)}function n(Ce,De){return sheet_to_workbook(r(Ce,De),De)}var Ee=(function(){var Ce=function(ze,Oe,Be,He,Ve){ze.push(Oe),ze.push(Be+","+He),ze.push('"'+Ve.replace(/"/g,'""')+'"')},De=function(ze,Oe,Be,He){ze.push(Oe+","+Be),ze.push(Oe==1?'"'+He.replace(/"/g,'""')+'"':He)};return function(ze){var Oe=[],Be=safe_decode_range(ze["!ref"]),He,Ve=Array.isArray(ze);Ce(Oe,"TABLE",0,1,"sheetjs"),Ce(Oe,"VECTORS",0,Be.e.r-Be.s.r+1,""),Ce(Oe,"TUPLES",0,Be.e.c-Be.s.c+1,""),Ce(Oe,"DATA",0,0,"");for(var Xe=Be.s.r;Xe<=Be.e.r;++Xe){De(Oe,-1,0,"BOT");for(var We=Be.s.c;We<=Be.e.c;++We){var Ge=encode_cell({r:Xe,c:We});if(He=Ve?(ze[Xe]||[])[We]:ze[Ge],!He){De(Oe,1,0,"");continue}switch(He.t){case"n":var $e=He.w;!$e&&He.v!=null&&($e=He.v),$e==null?He.f&&!He.F?De(Oe,1,0,"="+He.f):De(Oe,1,0,""):De(Oe,0,$e,"V");break;case"b":De(Oe,0,He.v?1:0,He.v?"TRUE":"FALSE");break;case"s":De(Oe,1,0,isNaN(He.v)?He.v:'="'+He.v+'"');break;case"d":He.w||(He.w=SSF_format(He.z||table_fmt[14],datenum(parseDate(He.v)))),De(Oe,0,He.w,"V");break;default:De(Oe,1,0,"")}}}De(Oe,-1,0,"EOD");var Ke=`\r
`,rr=Oe.join(Ke);return rr}})();return{to_workbook:n,to_sheet:r,from_sheet:Ee}})(),ETH=(function(){function e(He){return He.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(He){return He.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(He,Ve){for(var Xe=He.split(`
`),We=-1,Ge=-1,$e=0,Ke=[];$e!==Xe.length;++$e){var rr=Xe[$e].trim().split(":");if(rr[0]==="cell"){var tr=decode_cell(rr[1]);if(Ke.length<=tr.r)for(We=Ke.length;We<=tr.r;++We)Ke[We]||(Ke[We]=[]);switch(We=tr.r,Ge=tr.c,rr[2]){case"t":Ke[We][Ge]=e(rr[3]);break;case"v":Ke[We][Ge]=+rr[3];break;case"vtf":var sr=rr[rr.length-1];case"vtc":switch(rr[3]){case"nl":Ke[We][Ge]=!!+rr[4];break;default:Ke[We][Ge]=+rr[4];break}rr[2]=="vtf"&&(Ke[We][Ge]=[Ke[We][Ge],sr])}}}return Ve&&Ve.sheetRows&&(Ke=Ke.slice(0,Ve.sheetRows)),Ke}function n(He,Ve){return aoa_to_sheet(r(He,Ve),Ve)}function Ee(He,Ve){return sheet_to_workbook(n(He,Ve),Ve)}var Ce=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),De=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,Me=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),ze="--SocialCalcSpreadsheetControlSave--";function Oe(He){if(!He||!He["!ref"])return"";for(var Ve=[],Xe=[],We,Ge="",$e=decode_range(He["!ref"]),Ke=Array.isArray(He),rr=$e.s.r;rr<=$e.e.r;++rr)for(var tr=$e.s.c;tr<=$e.e.c;++tr)if(Ge=encode_cell({r:rr,c:tr}),We=Ke?(He[rr]||[])[tr]:He[Ge],!(!We||We.v==null||We.t==="z")){switch(Xe=["cell",Ge,"t"],We.t){case"s":case"str":Xe.push(t(We.v));break;case"n":We.f?(Xe[2]="vtf",Xe[3]="n",Xe[4]=We.v,Xe[5]=t(We.f)):(Xe[2]="v",Xe[3]=We.v);break;case"b":Xe[2]="vt"+(We.f?"f":"c"),Xe[3]="nl",Xe[4]=We.v?"1":"0",Xe[5]=t(We.f||(We.v?"TRUE":"FALSE"));break;case"d":var sr=datenum(parseDate(We.v));Xe[2]="vtc",Xe[3]="nd",Xe[4]=""+sr,Xe[5]=We.w||SSF_format(We.z||table_fmt[14],sr);break;case"e":continue}Ve.push(Xe.join(":"))}return Ve.push("sheet:c:"+($e.e.c-$e.s.c+1)+":r:"+($e.e.r-$e.s.r+1)+":tvf:1"),Ve.push("valueformat:1:text-wiki"),Ve.join(`
`)}function Be(He){return[Ce,De,Me,De,Oe(He),ze].join(`
`)}return{to_workbook:Ee,to_sheet:n,from_sheet:Be}})(),PRN=(function(){function e(Be,He,Ve,Xe,We){We.raw?He[Ve][Xe]=Be:Be===""||(Be==="TRUE"?He[Ve][Xe]=!0:Be==="FALSE"?He[Ve][Xe]=!1:isNaN(fuzzynum(Be))?isNaN(fuzzydate(Be).getDate())?He[Ve][Xe]=Be:He[Ve][Xe]=parseDate(Be):He[Ve][Xe]=fuzzynum(Be))}function t(Be,He){var Ve=He||{},Xe=[];if(!Be||Be.length===0)return Xe;for(var We=Be.split(/[\r\n]/),Ge=We.length-1;Ge>=0&&We[Ge].length===0;)--Ge;for(var $e=10,Ke=0,rr=0;rr<=Ge;++rr)Ke=We[rr].indexOf(" "),Ke==-1?Ke=We[rr].length:Ke++,$e=Math.max($e,Ke);for(rr=0;rr<=Ge;++rr){Xe[rr]=[];var tr=0;for(e(We[rr].slice(0,$e).trim(),Xe,rr,tr,Ve),tr=1;tr<=(We[rr].length-$e)/10+1;++tr)e(We[rr].slice($e+(tr-1)*10,$e+tr*10).trim(),Xe,rr,tr,Ve)}return Ve.sheetRows&&(Xe=Xe.slice(0,Ve.sheetRows)),Xe}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function Ee(Be){for(var He={},Ve=!1,Xe=0,We=0;Xe<Be.length;++Xe)(We=Be.charCodeAt(Xe))==34?Ve=!Ve:!Ve&&We in r&&(He[We]=(He[We]||0)+1);We=[];for(Xe in He)Object.prototype.hasOwnProperty.call(He,Xe)&&We.push([He[Xe],Xe]);if(!We.length){He=n;for(Xe in He)Object.prototype.hasOwnProperty.call(He,Xe)&&We.push([He[Xe],Xe])}return We.sort(function(Ge,$e){return Ge[0]-$e[0]||n[Ge[1]]-n[$e[1]]}),r[We.pop()[1]]||44}function Ce(Be,He){var Ve=He||{},Xe="",We=Ve.dense?[]:{},Ge={s:{c:0,r:0},e:{c:0,r:0}};Be.slice(0,4)=="sep="?Be.charCodeAt(5)==13&&Be.charCodeAt(6)==10?(Xe=Be.charAt(4),Be=Be.slice(7)):Be.charCodeAt(5)==13||Be.charCodeAt(5)==10?(Xe=Be.charAt(4),Be=Be.slice(6)):Xe=Ee(Be.slice(0,1024)):Ve&&Ve.FS?Xe=Ve.FS:Xe=Ee(Be.slice(0,1024));var $e=0,Ke=0,rr=0,tr=0,sr=0,ar=Xe.charCodeAt(0),hr=!1,pr=0,yr=Be.charCodeAt(0);Be=Be.replace(/\r\n/mg,`
`);var fr=Ve.dateNF!=null?dateNF_regex(Ve.dateNF):null;function Rr(){var mr=Be.slice(tr,sr),wr={};if(mr.charAt(0)=='"'&&mr.charAt(mr.length-1)=='"'&&(mr=mr.slice(1,-1).replace(/""/g,'"')),mr.length===0)wr.t="z";else if(Ve.raw)wr.t="s",wr.v=mr;else if(mr.trim().length===0)wr.t="s",wr.v=mr;else if(mr.charCodeAt(0)==61)mr.charCodeAt(1)==34&&mr.charCodeAt(mr.length-1)==34?(wr.t="s",wr.v=mr.slice(2,-1).replace(/""/g,'"')):fuzzyfmla(mr)?(wr.t="n",wr.f=mr.slice(1)):(wr.t="s",wr.v=mr);else if(mr=="TRUE")wr.t="b",wr.v=!0;else if(mr=="FALSE")wr.t="b",wr.v=!1;else if(!isNaN(rr=fuzzynum(mr)))wr.t="n",Ve.cellText!==!1&&(wr.w=mr),wr.v=rr;else if(!isNaN(fuzzydate(mr).getDate())||fr&&mr.match(fr)){wr.z=Ve.dateNF||table_fmt[14];var Fr=0;fr&&mr.match(fr)&&(mr=dateNF_fix(mr,Ve.dateNF,mr.match(fr)||[]),Fr=1),Ve.cellDates?(wr.t="d",wr.v=parseDate(mr,Fr)):(wr.t="n",wr.v=datenum(parseDate(mr,Fr))),Ve.cellText!==!1&&(wr.w=SSF_format(wr.z,wr.v instanceof Date?datenum(wr.v):wr.v)),Ve.cellNF||delete wr.z}else wr.t="s",wr.v=mr;if(wr.t=="z"||(Ve.dense?(We[$e]||(We[$e]=[]),We[$e][Ke]=wr):We[encode_cell({c:Ke,r:$e})]=wr),tr=sr+1,yr=Be.charCodeAt(tr),Ge.e.c<Ke&&(Ge.e.c=Ke),Ge.e.r<$e&&(Ge.e.r=$e),pr==ar)++Ke;else if(Ke=0,++$e,Ve.sheetRows&&Ve.sheetRows<=$e)return!0}e:for(;sr<Be.length;++sr)switch(pr=Be.charCodeAt(sr)){case 34:yr===34&&(hr=!hr);break;case ar:case 10:case 13:if(!hr&&Rr())break e;break}return sr-tr>0&&Rr(),We["!ref"]=encode_range(Ge),We}function De(Be,He){return!(He&&He.PRN)||He.FS||Be.slice(0,4)=="sep="||Be.indexOf("	")>=0||Be.indexOf(",")>=0||Be.indexOf(";")>=0?Ce(Be,He):aoa_to_sheet(t(Be,He),He)}function Me(Be,He){var Ve="",Xe=He.type=="string"?[0,0,0,0]:firstbyte(Be,He);switch(He.type){case"base64":Ve=Base64_decode(Be);break;case"binary":Ve=Be;break;case"buffer":He.codepage==65001?Ve=Be.toString("utf8"):He.codepage&&typeof $cptable<"u"||(Ve=has_buf&&Buffer.isBuffer(Be)?Be.toString("binary"):a2s(Be));break;case"array":Ve=cc2str(Be);break;case"string":Ve=Be;break;default:throw new Error("Unrecognized type "+He.type)}return Xe[0]==239&&Xe[1]==187&&Xe[2]==191?Ve=utf8read(Ve.slice(3)):He.type!="string"&&He.type!="buffer"&&He.codepage==65001?Ve=utf8read(Ve):He.type=="binary"&&typeof $cptable<"u",Ve.slice(0,19)=="socialcalc:version:"?ETH.to_sheet(He.type=="string"?Ve:utf8read(Ve),He):De(Ve,He)}function ze(Be,He){return sheet_to_workbook(Me(Be,He),He)}function Oe(Be){for(var He=[],Ve=safe_decode_range(Be["!ref"]),Xe,We=Array.isArray(Be),Ge=Ve.s.r;Ge<=Ve.e.r;++Ge){for(var $e=[],Ke=Ve.s.c;Ke<=Ve.e.c;++Ke){var rr=encode_cell({r:Ge,c:Ke});if(Xe=We?(Be[Ge]||[])[Ke]:Be[rr],!Xe||Xe.v==null){$e.push("          ");continue}for(var tr=(Xe.w||(format_cell(Xe),Xe.w)||"").slice(0,10);tr.length<10;)tr+=" ";$e.push(tr+(Ke===0?" ":""))}He.push($e.join(""))}return He.join(`
`)}return{to_workbook:ze,to_sheet:Me,from_sheet:Oe}})();function read_wb_ID(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var Ee=SYLK.to_workbook(e,r);return r.WTF=n,Ee}catch(Ce){if(r.WTF=n,!Ce.message.match(/SYLK bad record ID/)&&n)throw Ce;return PRN.to_workbook(e,t)}}var WK_=(function(){function e(Je,nr,or){if(Je){prep_blob(Je,Je.l||0);for(var lr=or.Enum||_r;Je.l<Je.length;){var St=Je.read_shift(2),dr=lr[St]||lr[65535],vr=Je.read_shift(2),br=Je.l+vr,kr=dr.f&&dr.f(Je,vr,or);if(Je.l=br,nr(kr,dr,St))return}}}function t(Je,nr){switch(nr.type){case"base64":return r(s2a(Base64_decode(Je)),nr);case"binary":return r(s2a(Je),nr);case"buffer":case"array":return r(Je,nr)}throw"Unsupported type "+nr.type}function r(Je,nr){if(!Je)return Je;var or=nr||{},lr=or.dense?[]:{},St="Sheet1",dr="",vr=0,br={},kr=[],Pr=[],Er={s:{r:0,c:0},e:{r:0,c:0}},Zr=or.sheetRows||0;if(Je[2]==0&&(Je[3]==8||Je[3]==9)&&Je.length>=16&&Je[14]==5&&Je[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(Je[2]==2)or.Enum=_r,e(Je,function(Qr,oa,ta){switch(ta){case 0:or.vers=Qr,Qr>=4096&&(or.qpro=!0);break;case 6:Er=Qr;break;case 204:Qr&&(dr=Qr);break;case 222:dr=Qr;break;case 15:case 51:or.qpro||(Qr[1].v=Qr[1].v.slice(1));case 13:case 14:case 16:ta==14&&(Qr[2]&112)==112&&(Qr[2]&15)>1&&(Qr[2]&15)<15&&(Qr[1].z=or.dateNF||table_fmt[14],or.cellDates&&(Qr[1].t="d",Qr[1].v=numdate(Qr[1].v))),or.qpro&&Qr[3]>vr&&(lr["!ref"]=encode_range(Er),br[St]=lr,kr.push(St),lr=or.dense?[]:{},Er={s:{r:0,c:0},e:{r:0,c:0}},vr=Qr[3],St=dr||"Sheet"+(vr+1),dr="");var Na=or.dense?(lr[Qr[0].r]||[])[Qr[0].c]:lr[encode_cell(Qr[0])];if(Na){Na.t=Qr[1].t,Na.v=Qr[1].v,Qr[1].z!=null&&(Na.z=Qr[1].z),Qr[1].f!=null&&(Na.f=Qr[1].f);break}or.dense?(lr[Qr[0].r]||(lr[Qr[0].r]=[]),lr[Qr[0].r][Qr[0].c]=Qr[1]):lr[encode_cell(Qr[0])]=Qr[1];break}},or);else if(Je[2]==26||Je[2]==14)or.Enum=ur,Je[2]==14&&(or.qpro=!0,Je.l=0),e(Je,function(Qr,oa,ta){switch(ta){case 204:St=Qr;break;case 22:Qr[1].v=Qr[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Qr[3]>vr&&(lr["!ref"]=encode_range(Er),br[St]=lr,kr.push(St),lr=or.dense?[]:{},Er={s:{r:0,c:0},e:{r:0,c:0}},vr=Qr[3],St="Sheet"+(vr+1)),Zr>0&&Qr[0].r>=Zr)break;or.dense?(lr[Qr[0].r]||(lr[Qr[0].r]=[]),lr[Qr[0].r][Qr[0].c]=Qr[1]):lr[encode_cell(Qr[0])]=Qr[1],Er.e.c<Qr[0].c&&(Er.e.c=Qr[0].c),Er.e.r<Qr[0].r&&(Er.e.r=Qr[0].r);break;case 27:Qr[14e3]&&(Pr[Qr[14e3][0]]=Qr[14e3][1]);break;case 1537:Pr[Qr[0]]=Qr[1],Qr[0]==vr&&(St=Qr[1]);break}},or);else throw new Error("Unrecognized LOTUS BOF "+Je[2]);if(lr["!ref"]=encode_range(Er),br[dr||St]=lr,kr.push(dr||St),!Pr.length)return{SheetNames:kr,Sheets:br};for(var ua={},Cr=[],Jr=0;Jr<Pr.length;++Jr)br[kr[Jr]]?(Cr.push(Pr[Jr]||kr[Jr]),ua[Pr[Jr]]=br[Pr[Jr]]||br[kr[Jr]]):(Cr.push(Pr[Jr]),ua[Pr[Jr]]={"!ref":"A1"});return{SheetNames:Cr,Sheets:ua}}function n(Je,nr){var or=nr||{};if(+or.codepage>=0&&set_cp(+or.codepage),or.type=="string")throw new Error("Cannot write WK1 to JS string");var lr=buf_array(),St=safe_decode_range(Je["!ref"]),dr=Array.isArray(Je),vr=[];write_biff_rec(lr,0,Ce(1030)),write_biff_rec(lr,6,ze(St));for(var br=Math.min(St.e.r,8191),kr=St.s.r;kr<=br;++kr)for(var Pr=encode_row(kr),Er=St.s.c;Er<=St.e.c;++Er){kr===St.s.r&&(vr[Er]=encode_col(Er));var Zr=vr[Er]+Pr,ua=dr?(Je[kr]||[])[Er]:Je[Zr];if(!(!ua||ua.t=="z"))if(ua.t=="n")(ua.v|0)==ua.v&&ua.v>=-32768&&ua.v<=32767?write_biff_rec(lr,13,Xe(kr,Er,ua.v)):write_biff_rec(lr,14,Ge(kr,Er,ua.v));else{var Cr=format_cell(ua);write_biff_rec(lr,15,He(kr,Er,Cr.slice(0,239)))}}return write_biff_rec(lr,1),lr.end()}function Ee(Je,nr){var or=nr||{};if(+or.codepage>=0&&set_cp(+or.codepage),or.type=="string")throw new Error("Cannot write WK3 to JS string");var lr=buf_array();write_biff_rec(lr,0,De(Je));for(var St=0,dr=0;St<Je.SheetNames.length;++St)(Je.Sheets[Je.SheetNames[St]]||{})["!ref"]&&write_biff_rec(lr,27,ir(Je.SheetNames[St],dr++));var vr=0;for(St=0;St<Je.SheetNames.length;++St){var br=Je.Sheets[Je.SheetNames[St]];if(!(!br||!br["!ref"])){for(var kr=safe_decode_range(br["!ref"]),Pr=Array.isArray(br),Er=[],Zr=Math.min(kr.e.r,8191),ua=kr.s.r;ua<=Zr;++ua)for(var Cr=encode_row(ua),Jr=kr.s.c;Jr<=kr.e.c;++Jr){ua===kr.s.r&&(Er[Jr]=encode_col(Jr));var Qr=Er[Jr]+Cr,oa=Pr?(br[ua]||[])[Jr]:br[Qr];if(!(!oa||oa.t=="z"))if(oa.t=="n")write_biff_rec(lr,23,Rr(ua,Jr,vr,oa.v));else{var ta=format_cell(oa);write_biff_rec(lr,22,pr(ua,Jr,vr,ta.slice(0,239)))}}++vr}}return write_biff_rec(lr,1),lr.end()}function Ce(Je){var nr=new_buf(2);return nr.write_shift(2,Je),nr}function De(Je){var nr=new_buf(26);nr.write_shift(2,4096),nr.write_shift(2,4),nr.write_shift(4,0);for(var or=0,lr=0,St=0,dr=0;dr<Je.SheetNames.length;++dr){var vr=Je.SheetNames[dr],br=Je.Sheets[vr];if(!(!br||!br["!ref"])){++St;var kr=decode_range(br["!ref"]);or<kr.e.r&&(or=kr.e.r),lr<kr.e.c&&(lr=kr.e.c)}}return or>8191&&(or=8191),nr.write_shift(2,or),nr.write_shift(1,St),nr.write_shift(1,lr),nr.write_shift(2,0),nr.write_shift(2,0),nr.write_shift(1,1),nr.write_shift(1,2),nr.write_shift(4,0),nr.write_shift(4,0),nr}function Me(Je,nr,or){var lr={s:{c:0,r:0},e:{c:0,r:0}};return nr==8&&or.qpro?(lr.s.c=Je.read_shift(1),Je.l++,lr.s.r=Je.read_shift(2),lr.e.c=Je.read_shift(1),Je.l++,lr.e.r=Je.read_shift(2),lr):(lr.s.c=Je.read_shift(2),lr.s.r=Je.read_shift(2),nr==12&&or.qpro&&(Je.l+=2),lr.e.c=Je.read_shift(2),lr.e.r=Je.read_shift(2),nr==12&&or.qpro&&(Je.l+=2),lr.s.c==65535&&(lr.s.c=lr.e.c=lr.s.r=lr.e.r=0),lr)}function ze(Je){var nr=new_buf(8);return nr.write_shift(2,Je.s.c),nr.write_shift(2,Je.s.r),nr.write_shift(2,Je.e.c),nr.write_shift(2,Je.e.r),nr}function Oe(Je,nr,or){var lr=[{c:0,r:0},{t:"n",v:0},0,0];return or.qpro&&or.vers!=20768?(lr[0].c=Je.read_shift(1),lr[3]=Je.read_shift(1),lr[0].r=Je.read_shift(2),Je.l+=2):(lr[2]=Je.read_shift(1),lr[0].c=Je.read_shift(2),lr[0].r=Je.read_shift(2)),lr}function Be(Je,nr,or){var lr=Je.l+nr,St=Oe(Je,nr,or);if(St[1].t="s",or.vers==20768){Je.l++;var dr=Je.read_shift(1);return St[1].v=Je.read_shift(dr,"utf8"),St}return or.qpro&&Je.l++,St[1].v=Je.read_shift(lr-Je.l,"cstr"),St}function He(Je,nr,or){var lr=new_buf(7+or.length);lr.write_shift(1,255),lr.write_shift(2,nr),lr.write_shift(2,Je),lr.write_shift(1,39);for(var St=0;St<lr.length;++St){var dr=or.charCodeAt(St);lr.write_shift(1,dr>=128?95:dr)}return lr.write_shift(1,0),lr}function Ve(Je,nr,or){var lr=Oe(Je,nr,or);return lr[1].v=Je.read_shift(2,"i"),lr}function Xe(Je,nr,or){var lr=new_buf(7);return lr.write_shift(1,255),lr.write_shift(2,nr),lr.write_shift(2,Je),lr.write_shift(2,or,"i"),lr}function We(Je,nr,or){var lr=Oe(Je,nr,or);return lr[1].v=Je.read_shift(8,"f"),lr}function Ge(Je,nr,or){var lr=new_buf(13);return lr.write_shift(1,255),lr.write_shift(2,nr),lr.write_shift(2,Je),lr.write_shift(8,or,"f"),lr}function $e(Je,nr,or){var lr=Je.l+nr,St=Oe(Je,nr,or);if(St[1].v=Je.read_shift(8,"f"),or.qpro)Je.l=lr;else{var dr=Je.read_shift(2);sr(Je.slice(Je.l,Je.l+dr),St),Je.l+=dr}return St}function Ke(Je,nr,or){var lr=nr&32768;return nr&=-32769,nr=(lr?Je:0)+(nr>=8192?nr-16384:nr),(lr?"":"$")+(or?encode_col(nr):encode_row(nr))}var rr={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},tr=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function sr(Je,nr){prep_blob(Je,0);for(var or=[],lr=0,St="",dr="",vr="",br="";Je.l<Je.length;){var kr=Je[Je.l++];switch(kr){case 0:or.push(Je.read_shift(8,"f"));break;case 1:dr=Ke(nr[0].c,Je.read_shift(2),!0),St=Ke(nr[0].r,Je.read_shift(2),!1),or.push(dr+St);break;case 2:{var Pr=Ke(nr[0].c,Je.read_shift(2),!0),Er=Ke(nr[0].r,Je.read_shift(2),!1);dr=Ke(nr[0].c,Je.read_shift(2),!0),St=Ke(nr[0].r,Je.read_shift(2),!1),or.push(Pr+Er+":"+dr+St)}break;case 3:if(Je.l<Je.length){console.error("WK1 premature formula end");return}break;case 4:or.push("("+or.pop()+")");break;case 5:or.push(Je.read_shift(2));break;case 6:{for(var Zr="";kr=Je[Je.l++];)Zr+=String.fromCharCode(kr);or.push('"'+Zr.replace(/"/g,'""')+'"')}break;case 8:or.push("-"+or.pop());break;case 23:or.push("+"+or.pop());break;case 22:or.push("NOT("+or.pop()+")");break;case 20:case 21:br=or.pop(),vr=or.pop(),or.push(["AND","OR"][kr-20]+"("+vr+","+br+")");break;default:if(kr<32&&tr[kr])br=or.pop(),vr=or.pop(),or.push(vr+tr[kr]+br);else if(rr[kr]){if(lr=rr[kr][1],lr==69&&(lr=Je[Je.l++]),lr>or.length){console.error("WK1 bad formula parse 0x"+kr.toString(16)+":|"+or.join("|")+"|");return}var ua=or.slice(-lr);or.length-=lr,or.push(rr[kr][0]+"("+ua.join(",")+")")}else return kr<=7?console.error("WK1 invalid opcode "+kr.toString(16)):kr<=24?console.error("WK1 unsupported op "+kr.toString(16)):kr<=30?console.error("WK1 invalid opcode "+kr.toString(16)):kr<=115?console.error("WK1 unsupported function opcode "+kr.toString(16)):console.error("WK1 unrecognized opcode "+kr.toString(16))}}or.length==1?nr[1].f=""+or[0]:console.error("WK1 bad formula parse |"+or.join("|")+"|")}function ar(Je){var nr=[{c:0,r:0},{t:"n",v:0},0];return nr[0].r=Je.read_shift(2),nr[3]=Je[Je.l++],nr[0].c=Je[Je.l++],nr}function hr(Je,nr){var or=ar(Je);return or[1].t="s",or[1].v=Je.read_shift(nr-4,"cstr"),or}function pr(Je,nr,or,lr){var St=new_buf(6+lr.length);St.write_shift(2,Je),St.write_shift(1,or),St.write_shift(1,nr),St.write_shift(1,39);for(var dr=0;dr<lr.length;++dr){var vr=lr.charCodeAt(dr);St.write_shift(1,vr>=128?95:vr)}return St.write_shift(1,0),St}function yr(Je,nr){var or=ar(Je);or[1].v=Je.read_shift(2);var lr=or[1].v>>1;if(or[1].v&1)switch(lr&7){case 0:lr=(lr>>3)*5e3;break;case 1:lr=(lr>>3)*500;break;case 2:lr=(lr>>3)/20;break;case 3:lr=(lr>>3)/200;break;case 4:lr=(lr>>3)/2e3;break;case 5:lr=(lr>>3)/2e4;break;case 6:lr=(lr>>3)/16;break;case 7:lr=(lr>>3)/64;break}return or[1].v=lr,or}function fr(Je,nr){var or=ar(Je),lr=Je.read_shift(4),St=Je.read_shift(4),dr=Je.read_shift(2);if(dr==65535)return lr===0&&St===3221225472?(or[1].t="e",or[1].v=15):lr===0&&St===3489660928?(or[1].t="e",or[1].v=42):or[1].v=0,or;var vr=dr&32768;return dr=(dr&32767)-16446,or[1].v=(1-vr*2)*(St*Math.pow(2,dr+32)+lr*Math.pow(2,dr)),or}function Rr(Je,nr,or,lr){var St=new_buf(14);if(St.write_shift(2,Je),St.write_shift(1,or),St.write_shift(1,nr),lr==0)return St.write_shift(4,0),St.write_shift(4,0),St.write_shift(2,65535),St;var dr=0,vr=0,br=0,kr=0;return lr<0&&(dr=1,lr=-lr),vr=Math.log2(lr)|0,lr/=Math.pow(2,vr-31),kr=lr>>>0,(kr&2147483648)==0&&(lr/=2,++vr,kr=lr>>>0),lr-=kr,kr|=2147483648,kr>>>=0,lr*=Math.pow(2,32),br=lr>>>0,St.write_shift(4,br),St.write_shift(4,kr),vr+=16383+(dr?32768:0),St.write_shift(2,vr),St}function mr(Je,nr){var or=fr(Je);return Je.l+=nr-14,or}function wr(Je,nr){var or=ar(Je),lr=Je.read_shift(4);return or[1].v=lr>>6,or}function Fr(Je,nr){var or=ar(Je),lr=Je.read_shift(8,"f");return or[1].v=lr,or}function Mr(Je,nr){var or=Fr(Je);return Je.l+=nr-10,or}function Hr(Je,nr){return Je[Je.l+nr-1]==0?Je.read_shift(nr,"cstr"):""}function Nr(Je,nr){var or=Je[Je.l++];or>nr-1&&(or=nr-1);for(var lr="";lr.length<or;)lr+=String.fromCharCode(Je[Je.l++]);return lr}function Ar(Je,nr,or){if(!(!or.qpro||nr<21)){var lr=Je.read_shift(1);Je.l+=17,Je.l+=1,Je.l+=2;var St=Je.read_shift(nr-21,"cstr");return[lr,St]}}function xr(Je,nr){for(var or={},lr=Je.l+nr;Je.l<lr;){var St=Je.read_shift(2);if(St==14e3){for(or[St]=[0,""],or[St][0]=Je.read_shift(2);Je[Je.l];)or[St][1]+=String.fromCharCode(Je[Je.l]),Je.l++;Je.l++}}return or}function ir(Je,nr){var or=new_buf(5+Je.length);or.write_shift(2,14e3),or.write_shift(2,nr);for(var lr=0;lr<Je.length;++lr){var St=Je.charCodeAt(lr);or[or.l++]=St>127?95:St}return or[or.l++]=0,or}var _r={0:{n:"BOF",f:parseuint16},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:Me},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:Ve},14:{n:"NUMBER",f:We},15:{n:"LABEL",f:Be},16:{n:"FORMULA",f:$e},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:Be},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Hr},222:{n:"SHEETNAMELP",f:Nr},65535:{n:""}},ur={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:hr},23:{n:"NUMBER17",f:fr},24:{n:"NUMBER18",f:yr},25:{n:"FORMULA19",f:mr},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:xr},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:wr},38:{n:"??"},39:{n:"NUMBER27",f:Fr},40:{n:"FORMULA28",f:Mr},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Hr},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:Ar},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:Ee,to_workbook:t}})();function parse_rpr(e){var t={},r=e.match(tagregex),n=0,Ee=!1;if(r)for(;n!=r.length;++n){var Ce=parsexmltag(r[n]);switch(Ce[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!Ce.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(Ce.val=="1")break;t.cp=CS2CP[parseInt(Ce.val,10)];break;case"<outline":if(!Ce.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=Ce.val;break;case"<sz":t.sz=Ce.val;break;case"<strike":if(!Ce.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!Ce.val)break;switch(Ce.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(Ce.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(Ce.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":Ce.rgb&&(t.color=Ce.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=Ce.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=Ce.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":Ee=!0;break;case"</ext>":Ee=!1;break;default:if(Ce[0].charCodeAt(1)!==47&&!Ee)throw new Error("Unrecognized rich format "+Ce[0])}}return t}var parse_rs=(function(){var e=matchtag("t"),t=matchtag("rPr");function r(Ce){var De=Ce.match(e);if(!De)return{t:"s",v:""};var Me={t:"s",v:unescapexml(De[1])},ze=Ce.match(t);return ze&&(Me.s=parse_rpr(ze[1])),Me}var n=/<(?:\w+:)?r>/g,Ee=/<\/(?:\w+:)?r>/;return function(De){return De.replace(n,"").split(Ee).map(r).filter(function(Me){return Me.v})}})(),rs_to_html=(function e(){var t=/(\r\n|\n)/g;function r(Ee,Ce,De){var Me=[];Ee.u&&Me.push("text-decoration: underline;"),Ee.uval&&Me.push("text-underline-style:"+Ee.uval+";"),Ee.sz&&Me.push("font-size:"+Ee.sz+"pt;"),Ee.outline&&Me.push("text-effect: outline;"),Ee.shadow&&Me.push("text-shadow: auto;"),Ce.push('<span style="'+Me.join("")+'">'),Ee.b&&(Ce.push("<b>"),De.push("</b>")),Ee.i&&(Ce.push("<i>"),De.push("</i>")),Ee.strike&&(Ce.push("<s>"),De.push("</s>"));var ze=Ee.valign||"";return ze=="superscript"||ze=="super"?ze="sup":ze=="subscript"&&(ze="sub"),ze!=""&&(Ce.push("<"+ze+">"),De.push("</"+ze+">")),De.push("</span>"),Ee}function n(Ee){var Ce=[[],Ee.v,[]];return Ee.v?(Ee.s&&r(Ee.s,Ce[0],Ce[2]),Ce[0].join("")+Ce[1].replace(t,"<br/>")+Ce[2].join("")):""}return function(Ce){return Ce.map(n).join("")}})(),sitregex=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,sirregex=/<(?:\w+:)?r>/,sirphregex=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function parse_si(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=unescapexml(utf8read(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=utf8read(e),r&&(n.h=escapehtml(n.t))):e.match(sirregex)&&(n.r=utf8read(e),n.t=unescapexml(utf8read((e.replace(sirphregex,"").match(sitregex)||[]).join("").replace(tagregex,""))),r&&(n.h=rs_to_html(parse_rs(n.r)))),n):{t:""}}var sstr0=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,sstr1=/<(?:\w+:)?(?:si|sstItem)>/g,sstr2=/<\/(?:\w+:)?(?:si|sstItem)>/;function parse_sst_xml(e,t){var r=[],n="";if(!e)return r;var Ee=e.match(sstr0);if(Ee){n=Ee[2].replace(sstr1,"").split(sstr2);for(var Ce=0;Ce!=n.length;++Ce){var De=parse_si(n[Ce].trim(),t);De!=null&&(r[r.length]=De)}Ee=parsexmltag(Ee[1]),r.Count=Ee.count,r.Unique=Ee.uniqueCount}return r}var straywsregex=/^\s|\s$|[\t\n\r]/;function write_sst_xml(e,t){if(!t.bookSST)return"";var r=[XML_HEADER];r[r.length]=writextag("sst",null,{xmlns:XMLNS_main[0],count:e.Count,uniqueCount:e.Unique});for(var n=0;n!=e.length;++n)if(e[n]!=null){var Ee=e[n],Ce="<si>";Ee.r?Ce+=Ee.r:(Ce+="<t",Ee.t||(Ee.t=""),Ee.t.match(straywsregex)&&(Ce+=' xml:space="preserve"'),Ce+=">"+escapexml(Ee.t)+"</t>"),Ce+="</si>",r[r.length]=Ce}return r.length>2&&(r[r.length]="</sst>",r[1]=r[1].replace("/>",">")),r.join("")}function parse_BrtBeginSst(e){return[e.read_shift(4),e.read_shift(4)]}function parse_sst_bin(e,t){var r=[],n=!1;return recordhopper(e,function(Ce,De,Me){switch(Me){case 159:r.Count=Ce[0],r.Unique=Ce[1];break;case 19:r.push(Ce);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(De.T,!n||t.WTF)throw new Error("Unexpected record 0x"+Me.toString(16))}}),r}function write_BrtBeginSst(e,t){return t||(t=new_buf(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var write_BrtSSTItem=write_RichStr;function write_sst_bin(e){var t=buf_array();write_record(t,159,write_BrtBeginSst(e));for(var r=0;r<e.length;++r)write_record(t,19,write_BrtSSTItem(e[r]));return write_record(t,160),t.end()}function _JS2ANSI(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function parse_CRYPTOVersion(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function parse_DataSpaceVersionInfo(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=parse_CRYPTOVersion(e,4),t.U=parse_CRYPTOVersion(e,4),t.W=parse_CRYPTOVersion(e,4),t}function parse_DataSpaceMapEntry(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},Ee=e.read_shift(4),Ce=[];Ee-- >0;)Ce.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=Ce,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function parse_DataSpaceMap(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(parse_DataSpaceMapEntry(e));return t}function parse_DataSpaceDefinition(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function parse_TransformInfoHeader(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=parse_CRYPTOVersion(e,4),t.U=parse_CRYPTOVersion(e,4),t.W=parse_CRYPTOVersion(e,4),t}function parse_Primary(e){var t=parse_TransformInfoHeader(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function parse_EncryptionHeader(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var Ee=!1;switch(n.AlgID){case 26126:case 26127:case 26128:Ee=n.Flags==36;break;case 26625:Ee=n.Flags==4;break;case 0:Ee=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!Ee)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function parse_EncryptionVerifier(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function parse_EncryptionInfo(e){var t=parse_CRYPTOVersion(e);switch(t.Minor){case 2:return[t.Minor,parse_EncInfoStd(e)];case 3:return[t.Minor,parse_EncInfoExt()];case 4:return[t.Minor,parse_EncInfoAgl(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function parse_EncInfoStd(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=parse_EncryptionHeader(e,r),Ee=parse_EncryptionVerifier(e,e.length-e.l);return{t:"Std",h:n,v:Ee}}function parse_EncInfoExt(){throw new Error("File is password-protected: ECMA-376 Extensible")}function parse_EncInfoAgl(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(tagregex,function(Ce){var De=parsexmltag(Ce);switch(strip_ns(De[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(Me){n[Me]=De[Me]});break;case"<dataIntegrity":n.encryptedHmacKey=De.encryptedHmacKey,n.encryptedHmacValue=De.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=De.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(De);break;default:throw De[0]}}),n}function parse_RC4CryptoHeader(e,t){var r={},n=r.EncryptionVersionInfo=parse_CRYPTOVersion(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var Ee=e.read_shift(4);return t-=4,r.EncryptionHeader=parse_EncryptionHeader(e,Ee),t-=Ee,r.EncryptionVerifier=parse_EncryptionVerifier(e,t),r}function parse_RC4Header(e){var t={},r=t.EncryptionVersionInfo=parse_CRYPTOVersion(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function crypto_CreatePasswordVerifier_Method1(e){var t=0,r,n=_JS2ANSI(e),Ee=n.length+1,Ce,De,Me,ze,Oe;for(r=new_raw_buf(Ee),r[0]=n.length,Ce=1;Ce!=Ee;++Ce)r[Ce]=n[Ce-1];for(Ce=Ee-1;Ce>=0;--Ce)De=r[Ce],Me=(t&16384)===0?0:1,ze=t<<1&32767,Oe=Me|ze,t=Oe^De;return t^52811}var crypto_CreateXorArray_Method1=(function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(De){return(De/2|De*128)&255},Ee=function(De,Me){return n(De^Me)},Ce=function(De){for(var Me=t[De.length-1],ze=104,Oe=De.length-1;Oe>=0;--Oe)for(var Be=De[Oe],He=0;He!=7;++He)Be&64&&(Me^=r[ze]),Be*=2,--ze;return Me};return function(De){for(var Me=_JS2ANSI(De),ze=Ce(Me),Oe=Me.length,Be=new_raw_buf(16),He=0;He!=16;++He)Be[He]=0;var Ve,Xe,We;for((Oe&1)===1&&(Ve=ze>>8,Be[Oe]=Ee(e[0],Ve),--Oe,Ve=ze&255,Xe=Me[Me.length-1],Be[Oe]=Ee(Xe,Ve));Oe>0;)--Oe,Ve=ze>>8,Be[Oe]=Ee(Me[Oe],Ve),--Oe,Ve=ze&255,Be[Oe]=Ee(Me[Oe],Ve);for(Oe=15,We=15-Me.length;We>0;)Ve=ze>>8,Be[Oe]=Ee(e[We],Ve),--Oe,--We,Ve=ze&255,Be[Oe]=Ee(Me[Oe],Ve),--Oe,--We;return Be}})(),crypto_DecryptData_Method1=function(e,t,r,n,Ee){Ee||(Ee=t),n||(n=crypto_CreateXorArray_Method1(e));var Ce,De;for(Ce=0;Ce!=t.length;++Ce)De=t[Ce],De^=n[r],De=(De>>5|De<<3)&255,Ee[Ce]=De,++r;return[Ee,r,n]},crypto_MakeXorDecryptor=function(e){var t=0,r=crypto_CreateXorArray_Method1(e);return function(n){var Ee=crypto_DecryptData_Method1("",n,t,r);return t=Ee[1],Ee[0]}};function parse_XORObfuscation(e,t,r,n){var Ee={key:parseuint16(e),verificationBytes:parseuint16(e)};return r.password&&(Ee.verifier=crypto_CreatePasswordVerifier_Method1(r.password)),n.valid=Ee.verificationBytes===Ee.verifier,n.valid&&(n.insitu=crypto_MakeXorDecryptor(r.password)),Ee}function parse_FilePassHeader(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=parse_RC4Header(e):n.Data=parse_RC4CryptoHeader(e,t),n}function parse_FilePass(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?parse_FilePassHeader(e,t-2,n):parse_XORObfuscation(e,r.biff>=8?t:t-2,r,n),n}var RTF=(function(){function e(Ee,Ce){switch(Ce.type){case"base64":return t(Base64_decode(Ee),Ce);case"binary":return t(Ee,Ce);case"buffer":return t(has_buf&&Buffer.isBuffer(Ee)?Ee.toString("binary"):a2s(Ee),Ce);case"array":return t(cc2str(Ee),Ce)}throw new Error("Unrecognized type "+Ce.type)}function t(Ee,Ce){var De=Ce||{},Me=De.dense?[]:{},ze=Ee.match(/\\trowd.*?\\row\b/g);if(!ze.length)throw new Error("RTF missing table");var Oe={s:{c:0,r:0},e:{c:0,r:ze.length-1}};return ze.forEach(function(Be,He){Array.isArray(Me)&&(Me[He]=[]);for(var Ve=/\\\w+\b/g,Xe=0,We,Ge=-1;We=Ve.exec(Be);){switch(We[0]){case"\\cell":var $e=Be.slice(Xe,Ve.lastIndex-We[0].length);if($e[0]==" "&&($e=$e.slice(1)),++Ge,$e.length){var Ke={v:$e,t:"s"};Array.isArray(Me)?Me[He][Ge]=Ke:Me[encode_cell({r:He,c:Ge})]=Ke}break}Xe=Ve.lastIndex}Ge>Oe.e.c&&(Oe.e.c=Ge)}),Me["!ref"]=encode_range(Oe),Me}function r(Ee,Ce){return sheet_to_workbook(e(Ee,Ce),Ce)}function n(Ee){for(var Ce=["{\\rtf1\\ansi"],De=safe_decode_range(Ee["!ref"]),Me,ze=Array.isArray(Ee),Oe=De.s.r;Oe<=De.e.r;++Oe){Ce.push("\\trowd\\trautofit1");for(var Be=De.s.c;Be<=De.e.c;++Be)Ce.push("\\cellx"+(Be+1));for(Ce.push("\\pard\\intbl"),Be=De.s.c;Be<=De.e.c;++Be){var He=encode_cell({r:Oe,c:Be});Me=ze?(Ee[Oe]||[])[Be]:Ee[He],!(!Me||Me.v==null&&(!Me.f||Me.F))&&(Ce.push(" "+(Me.w||(format_cell(Me),Me.w))),Ce.push("\\cell"))}Ce.push("\\pard\\intbl\\row")}return Ce.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}})();function hex2RGB(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function rgb2Hex(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function rgb2HSL(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,Ee=Math.max(t,r,n),Ce=Math.min(t,r,n),De=Ee-Ce;if(De===0)return[0,0,t];var Me=0,ze=0,Oe=Ee+Ce;switch(ze=De/(Oe>1?2-Oe:Oe),Ee){case t:Me=((r-n)/De+6)%6;break;case r:Me=(n-t)/De+2;break;case n:Me=(t-r)/De+4;break}return[Me/6,ze,Oe/2]}function hsl2RGB(e){var t=e[0],r=e[1],n=e[2],Ee=r*2*(n<.5?n:1-n),Ce=n-Ee/2,De=[Ce,Ce,Ce],Me=6*t,ze;if(r!==0)switch(Me|0){case 0:case 6:ze=Ee*Me,De[0]+=Ee,De[1]+=ze;break;case 1:ze=Ee*(2-Me),De[0]+=ze,De[1]+=Ee;break;case 2:ze=Ee*(Me-2),De[1]+=Ee,De[2]+=ze;break;case 3:ze=Ee*(4-Me),De[1]+=ze,De[2]+=Ee;break;case 4:ze=Ee*(Me-4),De[2]+=Ee,De[0]+=ze;break;case 5:ze=Ee*(6-Me),De[2]+=ze,De[0]+=Ee;break}for(var Oe=0;Oe!=3;++Oe)De[Oe]=Math.round(De[Oe]*255);return De}function rgb_tint(e,t){if(t===0)return e;var r=rgb2HSL(hex2RGB(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),rgb2Hex(hsl2RGB(r))}var DEF_MDW=6,MAX_MDW=15,MIN_MDW=1,MDW=DEF_MDW;function width2px(e){return Math.floor((e+Math.round(128/MDW)/256)*MDW)}function px2char(e){return Math.floor((e-5)/MDW*100+.5)/100}function char2width(e){return Math.round((e*MDW+5)/MDW*256)/256}function cycle_width(e){return char2width(px2char(width2px(e)))}function find_mdw_colw(e){var t=Math.abs(e-cycle_width(e)),r=MDW;if(t>.005)for(MDW=MIN_MDW;MDW<MAX_MDW;++MDW)Math.abs(e-cycle_width(e))<=t&&(t=Math.abs(e-cycle_width(e)),r=MDW);MDW=r}function process_col(e){e.width?(e.wpx=width2px(e.width),e.wch=px2char(e.wpx),e.MDW=MDW):e.wpx?(e.wch=px2char(e.wpx),e.width=char2width(e.wch),e.MDW=MDW):typeof e.wch=="number"&&(e.width=char2width(e.wch),e.wpx=width2px(e.width),e.MDW=MDW),e.customWidth&&delete e.customWidth}var DEF_PPI=96,PPI=DEF_PPI;function px2pt(e){return e*96/PPI}function pt2px(e){return e*PPI/96}var XLMLPatternTypeMap={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function parse_borders(e,t,r,n){t.Borders=[];var Ee={},Ce=!1;(e[0].match(tagregex)||[]).forEach(function(De){var Me=parsexmltag(De);switch(strip_ns(Me[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":Ee={},Me.diagonalUp&&(Ee.diagonalUp=parsexmlbool(Me.diagonalUp)),Me.diagonalDown&&(Ee.diagonalDown=parsexmlbool(Me.diagonalDown)),t.Borders.push(Ee);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":Ce=!0;break;case"</ext>":Ce=!1;break;default:if(n&&n.WTF&&!Ce)throw new Error("unrecognized "+Me[0]+" in borders")}})}function parse_fills(e,t,r,n){t.Fills=[];var Ee={},Ce=!1;(e[0].match(tagregex)||[]).forEach(function(De){var Me=parsexmltag(De);switch(strip_ns(Me[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":Ee={},t.Fills.push(Ee);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(Ee),Ee={};break;case"<patternFill":case"<patternFill>":Me.patternType&&(Ee.patternType=Me.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":Ee.bgColor||(Ee.bgColor={}),Me.indexed&&(Ee.bgColor.indexed=parseInt(Me.indexed,10)),Me.theme&&(Ee.bgColor.theme=parseInt(Me.theme,10)),Me.tint&&(Ee.bgColor.tint=parseFloat(Me.tint)),Me.rgb&&(Ee.bgColor.rgb=Me.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":Ee.fgColor||(Ee.fgColor={}),Me.theme&&(Ee.fgColor.theme=parseInt(Me.theme,10)),Me.tint&&(Ee.fgColor.tint=parseFloat(Me.tint)),Me.rgb!=null&&(Ee.fgColor.rgb=Me.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":Ce=!0;break;case"</ext>":Ce=!1;break;default:if(n&&n.WTF&&!Ce)throw new Error("unrecognized "+Me[0]+" in fills")}})}function parse_fonts(e,t,r,n){t.Fonts=[];var Ee={},Ce=!1;(e[0].match(tagregex)||[]).forEach(function(De){var Me=parsexmltag(De);switch(strip_ns(Me[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(Ee),Ee={};break;case"<name":Me.val&&(Ee.name=utf8read(Me.val));break;case"<name/>":case"</name>":break;case"<b":Ee.bold=Me.val?parsexmlbool(Me.val):1;break;case"<b/>":Ee.bold=1;break;case"<i":Ee.italic=Me.val?parsexmlbool(Me.val):1;break;case"<i/>":Ee.italic=1;break;case"<u":switch(Me.val){case"none":Ee.underline=0;break;case"single":Ee.underline=1;break;case"double":Ee.underline=2;break;case"singleAccounting":Ee.underline=33;break;case"doubleAccounting":Ee.underline=34;break}break;case"<u/>":Ee.underline=1;break;case"<strike":Ee.strike=Me.val?parsexmlbool(Me.val):1;break;case"<strike/>":Ee.strike=1;break;case"<outline":Ee.outline=Me.val?parsexmlbool(Me.val):1;break;case"<outline/>":Ee.outline=1;break;case"<shadow":Ee.shadow=Me.val?parsexmlbool(Me.val):1;break;case"<shadow/>":Ee.shadow=1;break;case"<condense":Ee.condense=Me.val?parsexmlbool(Me.val):1;break;case"<condense/>":Ee.condense=1;break;case"<extend":Ee.extend=Me.val?parsexmlbool(Me.val):1;break;case"<extend/>":Ee.extend=1;break;case"<sz":Me.val&&(Ee.sz=+Me.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":Me.val&&(Ee.vertAlign=Me.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":Me.val&&(Ee.family=parseInt(Me.val,10));break;case"<family/>":case"</family>":break;case"<scheme":Me.val&&(Ee.scheme=Me.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(Me.val=="1")break;Me.codepage=CS2CP[parseInt(Me.val,10)];break;case"<color":if(Ee.color||(Ee.color={}),Me.auto&&(Ee.color.auto=parsexmlbool(Me.auto)),Me.rgb)Ee.color.rgb=Me.rgb.slice(-6);else if(Me.indexed){Ee.color.index=parseInt(Me.indexed,10);var ze=XLSIcv[Ee.color.index];Ee.color.index==81&&(ze=XLSIcv[1]),ze||(ze=XLSIcv[1]),Ee.color.rgb=ze[0].toString(16)+ze[1].toString(16)+ze[2].toString(16)}else Me.theme&&(Ee.color.theme=parseInt(Me.theme,10),Me.tint&&(Ee.color.tint=parseFloat(Me.tint)),Me.theme&&r.themeElements&&r.themeElements.clrScheme&&(Ee.color.rgb=rgb_tint(r.themeElements.clrScheme[Ee.color.theme].rgb,Ee.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":Ce=!0;break;case"</AlternateContent>":Ce=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":Ce=!0;break;case"</ext>":Ce=!1;break;default:if(n&&n.WTF&&!Ce)throw new Error("unrecognized "+Me[0]+" in fonts")}})}function parse_numFmts(e,t,r){t.NumberFmt=[];for(var n=keys(table_fmt),Ee=0;Ee<n.length;++Ee)t.NumberFmt[n[Ee]]=table_fmt[n[Ee]];var Ce=e[0].match(tagregex);if(Ce)for(Ee=0;Ee<Ce.length;++Ee){var De=parsexmltag(Ce[Ee]);switch(strip_ns(De[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var Me=unescapexml(utf8read(De.formatCode)),ze=parseInt(De.numFmtId,10);if(t.NumberFmt[ze]=Me,ze>0){if(ze>392){for(ze=392;ze>60&&t.NumberFmt[ze]!=null;--ze);t.NumberFmt[ze]=Me}SSF_load(Me,ze)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+De[0]+" in numFmts")}}}function write_numFmts(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var n=r[0];n<=r[1];++n)e[n]!=null&&(t[t.length]=writextag("numFmt",null,{numFmtId:n,formatCode:escapexml(e[n])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=writextag("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var cellXF_uint=["numFmtId","fillId","fontId","borderId","xfId"],cellXF_bool=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function parse_cellXfs(e,t,r){t.CellXf=[];var n,Ee=!1;(e[0].match(tagregex)||[]).forEach(function(Ce){var De=parsexmltag(Ce),Me=0;switch(strip_ns(De[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=De,delete n[0],Me=0;Me<cellXF_uint.length;++Me)n[cellXF_uint[Me]]&&(n[cellXF_uint[Me]]=parseInt(n[cellXF_uint[Me]],10));for(Me=0;Me<cellXF_bool.length;++Me)n[cellXF_bool[Me]]&&(n[cellXF_bool[Me]]=parsexmlbool(n[cellXF_bool[Me]]));if(t.NumberFmt&&n.numFmtId>392){for(Me=392;Me>60;--Me)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[Me]){n.numFmtId=Me;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var ze={};De.vertical&&(ze.vertical=De.vertical),De.horizontal&&(ze.horizontal=De.horizontal),De.textRotation!=null&&(ze.textRotation=De.textRotation),De.indent&&(ze.indent=De.indent),De.wrapText&&(ze.wrapText=parsexmlbool(De.wrapText)),n.alignment=ze;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":Ee=!0;break;case"</AlternateContent>":Ee=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":Ee=!0;break;case"</ext>":Ee=!1;break;default:if(r&&r.WTF&&!Ee)throw new Error("unrecognized "+De[0]+" in cellXfs")}})}function write_cellXfs(e){var t=[];return t[t.length]=writextag("cellXfs",null),e.forEach(function(r){t[t.length]=writextag("xf",null,r)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=writextag("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var parse_sty_xml=(function e(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,Ee=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,Ce=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(Me,ze,Oe){var Be={};if(!Me)return Be;Me=Me.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var He;return(He=Me.match(t))&&parse_numFmts(He,Be,Oe),(He=Me.match(Ee))&&parse_fonts(He,Be,ze,Oe),(He=Me.match(n))&&parse_fills(He,Be,ze,Oe),(He=Me.match(Ce))&&parse_borders(He,Be,ze,Oe),(He=Me.match(r))&&parse_cellXfs(He,Be,Oe),Be}})();function write_sty_xml(e,t){var r=[XML_HEADER,writextag("styleSheet",null,{xmlns:XMLNS_main[0],"xmlns:vt":XMLNS.vt})],n;return e.SSF&&(n=write_numFmts(e.SSF))!=null&&(r[r.length]=n),r[r.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',r[r.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',r[r.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',r[r.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(n=write_cellXfs(t.cellXfs))&&(r[r.length]=n),r[r.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',r[r.length]='<dxfs count="0"/>',r[r.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',r.length>2&&(r[r.length]="</styleSheet>",r[1]=r[1].replace("/>",">")),r.join("")}function parse_BrtFmt(e,t){var r=e.read_shift(2),n=parse_XLWideString(e);return[r,n]}function write_BrtFmt(e,t,r){r||(r=new_buf(6+4*t.length)),r.write_shift(2,e),write_XLWideString(t,r);var n=r.length>r.l?r.slice(0,r.l):r;return r.l==null&&(r.l=r.length),n}function parse_BrtFont(e,t,r){var n={};n.sz=e.read_shift(2)/20;var Ee=parse_FontFlags(e);Ee.fItalic&&(n.italic=1),Ee.fCondense&&(n.condense=1),Ee.fExtend&&(n.extend=1),Ee.fShadow&&(n.shadow=1),Ee.fOutline&&(n.outline=1),Ee.fStrikeout&&(n.strike=1);var Ce=e.read_shift(2);switch(Ce===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var De=e.read_shift(1);De!=0&&(n.underline=De);var Me=e.read_shift(1);Me>0&&(n.family=Me);var ze=e.read_shift(1);switch(ze>0&&(n.charset=ze),e.l++,n.color=parse_BrtColor(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=parse_XLWideString(e),n}function write_BrtFont(e,t){t||(t=new_buf(153)),t.write_shift(2,e.sz*20),write_FontFlags(e,t),t.write_shift(2,e.bold?700:400);var r=0;e.vertAlign=="superscript"?r=1:e.vertAlign=="subscript"&&(r=2),t.write_shift(2,r),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),write_BrtColor(e.color,t);var n=0;return n=2,t.write_shift(1,n),write_XLWideString(e.name,t),t.length>t.l?t.slice(0,t.l):t}var XLSBFillPTNames=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],rev_XLSBFillPTNames,parse_BrtFill=parsenoop;function write_BrtFill(e,t){t||(t=new_buf(84)),rev_XLSBFillPTNames||(rev_XLSBFillPTNames=evert(XLSBFillPTNames));var r=rev_XLSBFillPTNames[e.patternType];r==null&&(r=40),t.write_shift(4,r);var n=0;if(r!=40)for(write_BrtColor({auto:1},t),write_BrtColor({auto:1},t);n<12;++n)t.write_shift(4,0);else{for(;n<4;++n)t.write_shift(4,0);for(;n<12;++n)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function parse_BrtXF(e,t){var r=e.l+t,n=e.read_shift(2),Ee=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:Ee}}function write_BrtXF(e,t,r){r||(r=new_buf(16)),r.write_shift(2,t||0),r.write_shift(2,e.numFmtId||0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);var n=0;return r.write_shift(1,n),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(1,0),r}function write_Blxf(e,t){return t||(t=new_buf(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var parse_BrtBorder=parsenoop;function write_BrtBorder(e,t){return t||(t=new_buf(51)),t.write_shift(1,0),write_Blxf(null,t),write_Blxf(null,t),write_Blxf(null,t),write_Blxf(null,t),write_Blxf(null,t),t.length>t.l?t.slice(0,t.l):t}function write_BrtStyle(e,t){return t||(t=new_buf(52)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),write_XLNullableWideString(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function write_BrtBeginTableStyles(e,t,r){var n=new_buf(2052);return n.write_shift(4,e),write_XLNullableWideString(t,n),write_XLNullableWideString(r,n),n.length>n.l?n.slice(0,n.l):n}function parse_sty_bin(e,t,r){var n={};n.NumberFmt=[];for(var Ee in table_fmt)n.NumberFmt[Ee]=table_fmt[Ee];n.CellXf=[],n.Fonts=[];var Ce=[],De=!1;return recordhopper(e,function(ze,Oe,Be){switch(Be){case 44:n.NumberFmt[ze[0]]=ze[1],SSF_load(ze[1],ze[0]);break;case 43:n.Fonts.push(ze),ze.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(ze.color.rgb=rgb_tint(t.themeElements.clrScheme[ze.color.theme].rgb,ze.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:Ce[Ce.length-1]==617&&n.CellXf.push(ze);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:De=!0;break;case 36:De=!1;break;case 37:Ce.push(Be),De=!0;break;case 38:Ce.pop(),De=!1;break;default:if(Oe.T>0)Ce.push(Be);else if(Oe.T<0)Ce.pop();else if(!De||r.WTF&&Ce[Ce.length-1]!=37)throw new Error("Unexpected record 0x"+Be.toString(16))}}),n}function write_FMTS_bin(e,t){if(t){var r=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var Ee=n[0];Ee<=n[1];++Ee)t[Ee]!=null&&++r}),r!=0&&(write_record(e,615,write_UInt32LE(r)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var Ee=n[0];Ee<=n[1];++Ee)t[Ee]!=null&&write_record(e,44,write_BrtFmt(Ee,t[Ee]))}),write_record(e,616))}}function write_FONTS_bin(e){var t=1;write_record(e,611,write_UInt32LE(t)),write_record(e,43,write_BrtFont({sz:12,color:{theme:1},name:"Calibri",family:2})),write_record(e,612)}function write_FILLS_bin(e){var t=2;write_record(e,603,write_UInt32LE(t)),write_record(e,45,write_BrtFill({patternType:"none"})),write_record(e,45,write_BrtFill({patternType:"gray125"})),write_record(e,604)}function write_BORDERS_bin(e){var t=1;write_record(e,613,write_UInt32LE(t)),write_record(e,46,write_BrtBorder()),write_record(e,614)}function write_CELLSTYLEXFS_bin(e){var t=1;write_record(e,626,write_UInt32LE(t)),write_record(e,47,write_BrtXF({numFmtId:0},65535)),write_record(e,627)}function write_CELLXFS_bin(e,t){write_record(e,617,write_UInt32LE(t.length)),t.forEach(function(r){write_record(e,47,write_BrtXF(r,0))}),write_record(e,618)}function write_STYLES_bin(e){var t=1;write_record(e,619,write_UInt32LE(t)),write_record(e,48,write_BrtStyle({xfId:0,name:"Normal"})),write_record(e,620)}function write_DXFS_bin(e){var t=0;write_record(e,505,write_UInt32LE(t)),write_record(e,506)}function write_TABLESTYLES_bin(e){var t=0;write_record(e,508,write_BrtBeginTableStyles(t,"TableStyleMedium9","PivotStyleMedium4")),write_record(e,509)}function write_sty_bin(e,t){var r=buf_array();return write_record(r,278),write_FMTS_bin(r,e.SSF),write_FONTS_bin(r),write_FILLS_bin(r),write_BORDERS_bin(r),write_CELLSTYLEXFS_bin(r),write_CELLXFS_bin(r,t.cellXfs),write_STYLES_bin(r),write_DXFS_bin(r),write_TABLESTYLES_bin(r),write_record(r,279),r.end()}var XLSXThemeClrScheme=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function parse_clrScheme(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(tagregex)||[]).forEach(function(Ee){var Ce=parsexmltag(Ee);switch(Ce[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=Ce.val;break;case"<a:sysClr":n.rgb=Ce.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":Ce[0].charAt(1)==="/"?(t.themeElements.clrScheme[XLSXThemeClrScheme.indexOf(Ce[0])]=n,n={}):n.name=Ce[0].slice(3,Ce[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+Ce[0]+" in clrScheme")}})}function parse_fontScheme(){}function parse_fmtScheme(){}var clrsregex=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,fntsregex=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,fmtsregex=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function parse_themeElements(e,t,r){t.themeElements={};var n;[["clrScheme",clrsregex,parse_clrScheme],["fontScheme",fntsregex,parse_fontScheme],["fmtScheme",fmtsregex,parse_fmtScheme]].forEach(function(Ee){if(!(n=e.match(Ee[1])))throw new Error(Ee[0]+" not found in themeElements");Ee[2](n,t,r)})}var themeltregex=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function parse_theme_xml(e,t){(!e||e.length===0)&&(e=write_theme());var r,n={};if(!(r=e.match(themeltregex)))throw new Error("themeElements not found in theme");return parse_themeElements(r[0],n,t),n.raw=e,n}function write_theme(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var r=[XML_HEADER];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface=" "/>',r[r.length]='<a:font script="Hang" typeface=" "/>',r[r.length]='<a:font script="Hans" typeface=""/>',r[r.length]='<a:font script="Hant" typeface=""/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function parse_Theme(e,t,r){var n=e.l+t,Ee=e.read_shift(4);if(Ee!==124226){if(!r.cellStyles){e.l=n;return}var Ce=e.slice(e.l);e.l=n;var De;try{De=zip_read(Ce,{type:"array"})}catch{return}var Me=getzipstr(De,"theme/theme/theme1.xml",!0);if(Me)return parse_theme_xml(Me,r)}}function parse_ColorTheme(e){return e.read_shift(4)}function parse_FullColorExt(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=parse_IcvXF(e,4);break;case 2:t.xclrValue=parse_LongRGBA(e);break;case 3:t.xclrValue=parse_ColorTheme(e);break;case 4:e.l+=4;break}return e.l+=8,t}function parse_IcvXF(e,t){return parsenoop(e,t)}function parse_XFExtGradient(e,t){return parsenoop(e,t)}function parse_ExtProp(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=parse_FullColorExt(e);break;case 6:n[1]=parse_XFExtGradient(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function parse_XFExt(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var Ee=e.read_shift(2),Ce=[];Ee-- >0;)Ce.push(parse_ExtProp(e,r-e.l));return{ixfe:n,ext:Ce}}function update_xfext(e,t){t.forEach(function(r){r[0]})}function parse_BrtMdtinfo(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:parse_XLWideString(e)}}function write_BrtMdtinfo(e){var t=new_buf(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),write_XLWideString(e.name,t),t.slice(0,t.l)}function parse_BrtMdb(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function write_BrtMdb(e){var t=new_buf(4+8*e.length);t.write_shift(4,e.length);for(var r=0;r<e.length;++r)t.write_shift(4,e[r][0]),t.write_shift(4,e[r][1]);return t}function write_BrtBeginEsfmd(e,t){var r=new_buf(8+2*t.length);return r.write_shift(4,e),write_XLWideString(t,r),r.slice(0,r.l)}function parse_BrtBeginEsmdb(e){return e.l+=4,e.read_shift(4)!=0}function write_BrtBeginEsmdb(e,t){var r=new_buf(8);return r.write_shift(4,e),r.write_shift(4,1),r}function parse_xlmeta_bin(e,t,r){var n={Types:[],Cell:[],Value:[]},Ee=r||{},Ce=[],De=!1,Me=2;return recordhopper(e,function(ze,Oe,Be){switch(Be){case 335:n.Types.push({name:ze.name});break;case 51:ze.forEach(function(He){Me==1?n.Cell.push({type:n.Types[He[0]-1].name,index:He[1]}):Me==0&&n.Value.push({type:n.Types[He[0]-1].name,index:He[1]})});break;case 337:Me=ze?1:0;break;case 338:Me=2;break;case 35:Ce.push(Be),De=!0;break;case 36:Ce.pop(),De=!1;break;default:if(!Oe.T){if(!De||Ee.WTF&&Ce[Ce.length-1]!=35)throw new Error("Unexpected record 0x"+Be.toString(16))}}}),n}function write_xlmeta_bin(){var e=buf_array();return write_record(e,332),write_record(e,334,write_UInt32LE(1)),write_record(e,335,write_BrtMdtinfo({name:"XLDAPR",version:12e4,flags:3496657072})),write_record(e,336),write_record(e,339,write_BrtBeginEsfmd(1,"XLDAPR")),write_record(e,52),write_record(e,35,write_UInt32LE(514)),write_record(e,4096,write_UInt32LE(0)),write_record(e,4097,writeuint16(1)),write_record(e,36),write_record(e,53),write_record(e,340),write_record(e,337,write_BrtBeginEsmdb(1)),write_record(e,51,write_BrtMdb([[1,0]])),write_record(e,338),write_record(e,333),e.end()}function parse_xlmeta_xml(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var Ee=!1,Ce=2,De;return e.replace(tagregex,function(Me){var ze=parsexmltag(Me);switch(strip_ns(ze[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:ze.name});break;case"</metadataType>":break;case"<futureMetadata":for(var Oe=0;Oe<n.Types.length;++Oe)n.Types[Oe].name==ze.name&&(De=n.Types[Oe]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":Ce==1?n.Cell.push({type:n.Types[ze.t-1].name,index:+ze.v}):Ce==0&&n.Value.push({type:n.Types[ze.t-1].name,index:+ze.v});break;case"</rc>":break;case"<cellMetadata":Ce=1;break;case"</cellMetadata>":Ce=2;break;case"<valueMetadata":Ce=0;break;case"</valueMetadata>":Ce=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":Ee=!0;break;case"</ext>":Ee=!1;break;case"<rvb":if(!De)break;De.offsets||(De.offsets=[]),De.offsets.push(+ze.i);break;default:if(!Ee&&r.WTF)throw new Error("unrecognized "+ze[0]+" in metadata")}return Me}),n}function write_xlmeta_xml(){var e=[XML_HEADER];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function parse_cc_xml(e){var t=[];if(!e)return t;var r=1;return(e.match(tagregex)||[]).forEach(function(n){var Ee=parsexmltag(n);switch(Ee[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete Ee[0],Ee.i?r=Ee.i:Ee.i=r,t.push(Ee);break}}),t}function parse_BrtCalcChainItem$(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=encode_cell(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function parse_cc_bin(e,t,r){var n=[];return recordhopper(e,function(Ce,De,Me){switch(Me){case 63:n.push(Ce);break;default:if(!De.T)throw new Error("Unexpected record 0x"+Me.toString(16))}}),n}function parse_xlink_xml(){}function parse_xlink_bin(e,t,r,n){if(!e)return e;var Ee=n||{},Ce=!1;recordhopper(e,function(Me,ze,Oe){switch(Oe){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:Ce=!0;break;case 36:Ce=!1;break;default:if(!ze.T){if(!Ce||Ee.WTF)throw new Error("Unexpected record 0x"+Oe.toString(16))}}},Ee)}function parse_drawing(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}var _shapeid=1024;function write_comments_vml(e,t){for(var r=[21600,21600],n=["m0,0l0",r[1],r[0],r[1],r[0],"0xe"].join(","),Ee=[writextag("xml",null,{"xmlns:v":XLMLNS.v,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:mv":XLMLNS.mv}).replace(/\/>/,">"),writextag("o:shapelayout",writextag("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),writextag("v:shapetype",[writextag("v:stroke",null,{joinstyle:"miter"}),writextag("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:r.join(","),path:n})];_shapeid<e*1e3;)_shapeid+=1e3;return t.forEach(function(Ce){var De=decode_cell(Ce[0]),Me={color2:"#BEFF82",type:"gradient"};Me.type=="gradient"&&(Me.angle="-180");var ze=Me.type=="gradient"?writextag("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,Oe=writextag("v:fill",ze,Me),Be={on:"t",obscured:"t"};++_shapeid,Ee=Ee.concat(["<v:shape"+wxt_helper({id:"_x0000_s"+_shapeid,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(Ce[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",Oe,writextag("v:shadow",null,Be),writextag("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",writetag("x:Anchor",[De.c+1,0,De.r+1,0,De.c+3,20,De.r+5,20].join(",")),writetag("x:AutoFill","False"),writetag("x:Row",String(De.r)),writetag("x:Column",String(De.c)),Ce[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),Ee.push("</xml>"),Ee.join("")}function sheet_insert_comments(e,t,r,n){var Ee=Array.isArray(e),Ce;t.forEach(function(De){var Me=decode_cell(De.ref);if(Ee?(e[Me.r]||(e[Me.r]=[]),Ce=e[Me.r][Me.c]):Ce=e[De.ref],!Ce){Ce={t:"z"},Ee?e[Me.r][Me.c]=Ce:e[De.ref]=Ce;var ze=safe_decode_range(e["!ref"]||"BDWGO1000001:A1");ze.s.r>Me.r&&(ze.s.r=Me.r),ze.e.r<Me.r&&(ze.e.r=Me.r),ze.s.c>Me.c&&(ze.s.c=Me.c),ze.e.c<Me.c&&(ze.e.c=Me.c);var Oe=encode_range(ze);Oe!==e["!ref"]&&(e["!ref"]=Oe)}Ce.c||(Ce.c=[]);var Be={a:De.author,t:De.t,r:De.r,T:r};De.h&&(Be.h=De.h);for(var He=Ce.c.length-1;He>=0;--He){if(!r&&Ce.c[He].T)return;r&&!Ce.c[He].T&&Ce.c.splice(He,1)}if(r&&n){for(He=0;He<n.length;++He)if(Be.a==n[He].id){Be.a=n[He].name||Be.a;break}}Ce.c.push(Be)})}function parse_comments_xml(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],Ee=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);Ee&&Ee[1]&&Ee[1].split(/<\/\w*:?author>/).forEach(function(De){if(!(De===""||De.trim()==="")){var Me=De.match(/<(?:\w+:)?author[^>]*>(.*)/);Me&&r.push(Me[1])}});var Ce=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return Ce&&Ce[1]&&Ce[1].split(/<\/\w*:?comment>/).forEach(function(De){if(!(De===""||De.trim()==="")){var Me=De.match(/<(?:\w+:)?comment[^>]*>/);if(Me){var ze=parsexmltag(Me[0]),Oe={author:ze.authorId&&r[ze.authorId]||"sheetjsghost",ref:ze.ref,guid:ze.guid},Be=decode_cell(ze.ref);if(!(t.sheetRows&&t.sheetRows<=Be.r)){var He=De.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),Ve=!!He&&!!He[1]&&parse_si(He[1])||{r:"",t:"",h:""};Oe.r=Ve.r,Ve.r=="<t></t>"&&(Ve.t=Ve.h=""),Oe.t=(Ve.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(Oe.h=Ve.h),n.push(Oe)}}}}),n}function write_comments_xml(e){var t=[XML_HEADER,writextag("comments",null,{xmlns:XMLNS_main[0]})],r=[];return t.push("<authors>"),e.forEach(function(n){n[1].forEach(function(Ee){var Ce=escapexml(Ee.a);r.indexOf(Ce)==-1&&(r.push(Ce),t.push("<author>"+Ce+"</author>")),Ee.T&&Ee.ID&&r.indexOf("tc="+Ee.ID)==-1&&(r.push("tc="+Ee.ID),t.push("<author>tc="+Ee.ID+"</author>"))})}),r.length==0&&(r.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(n){var Ee=0,Ce=[];if(n[1][0]&&n[1][0].T&&n[1][0].ID?Ee=r.indexOf("tc="+n[1][0].ID):n[1].forEach(function(ze){ze.a&&(Ee=r.indexOf(escapexml(ze.a))),Ce.push(ze.t||"")}),t.push('<comment ref="'+n[0]+'" authorId="'+Ee+'"><text>'),Ce.length<=1)t.push(writetag("t",escapexml(Ce[0]||"")));else{for(var De=`Comment:
    `+Ce[0]+`
`,Me=1;Me<Ce.length;++Me)De+=`Reply:
    `+Ce[Me]+`
`;t.push(writetag("t",escapexml(De)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function parse_tcmnt_xml(e,t){var r=[],n=!1,Ee={},Ce=0;return e.replace(tagregex,function(Me,ze){var Oe=parsexmltag(Me);switch(strip_ns(Oe[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":Ee={author:Oe.personId,guid:Oe.id,ref:Oe.ref,T:1};break;case"</threadedComment>":Ee.t!=null&&r.push(Ee);break;case"<text>":case"<text":Ce=ze+Me.length;break;case"</text>":Ee.t=e.slice(Ce,ze).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+Oe[0]+" in threaded comments")}return Me}),r}function write_tcmnt_xml(e,t,r){var n=[XML_HEADER,writextag("ThreadedComments",null,{xmlns:XMLNS.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(Ee){var Ce="";(Ee[1]||[]).forEach(function(De,Me){if(!De.T){delete De.ID;return}De.a&&t.indexOf(De.a)==-1&&t.push(De.a);var ze={ref:Ee[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+r.tcid++).slice(-12)+"}"};Me==0?Ce=ze.id:ze.parentId=Ce,De.ID=ze.id,De.a&&(ze.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(De.a)).slice(-12)+"}"),n.push(writextag("threadedComment",writetag("text",De.t||""),ze))})}),n.push("</ThreadedComments>"),n.join("")}function parse_people_xml(e,t){var r=[],n=!1;return e.replace(tagregex,function(Ce){var De=parsexmltag(Ce);switch(strip_ns(De[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:De.displayname,id:De.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+De[0]+" in threaded comments")}return Ce}),r}function write_people_xml(e){var t=[XML_HEADER,writextag("personList",null,{xmlns:XMLNS.TCMNT,"xmlns:x":XMLNS_main[0]}).replace(/[\/]>/,">")];return e.forEach(function(r,n){t.push(writextag("person",null,{displayName:r,id:"{54EE7950-7262-4200-6969-"+("000000000000"+n).slice(-12)+"}",userId:r,providerId:"None"}))}),t.push("</personList>"),t.join("")}function parse_BrtBeginComment(e){var t={};t.iauthor=e.read_shift(4);var r=parse_UncheckedRfX(e);return t.rfx=r.s,t.ref=encode_cell(r.s),e.l+=16,t}function write_BrtBeginComment(e,t){return t==null&&(t=new_buf(36)),t.write_shift(4,e[1].iauthor),write_UncheckedRfX(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var parse_BrtCommentAuthor=parse_XLWideString;function write_BrtCommentAuthor(e){return write_XLWideString(e.slice(0,54))}function parse_comments_bin(e,t){var r=[],n=[],Ee={},Ce=!1;return recordhopper(e,function(Me,ze,Oe){switch(Oe){case 632:n.push(Me);break;case 635:Ee=Me;break;case 637:Ee.t=Me.t,Ee.h=Me.h,Ee.r=Me.r;break;case 636:if(Ee.author=n[Ee.iauthor],delete Ee.iauthor,t.sheetRows&&Ee.rfx&&t.sheetRows<=Ee.rfx.r)break;Ee.t||(Ee.t=""),delete Ee.rfx,r.push(Ee);break;case 3072:break;case 35:Ce=!0;break;case 36:Ce=!1;break;case 37:break;case 38:break;default:if(!ze.T){if(!Ce||t.WTF)throw new Error("Unexpected record 0x"+Oe.toString(16))}}}),r}function write_comments_bin(e){var t=buf_array(),r=[];return write_record(t,628),write_record(t,630),e.forEach(function(n){n[1].forEach(function(Ee){r.indexOf(Ee.a)>-1||(r.push(Ee.a.slice(0,54)),write_record(t,632,write_BrtCommentAuthor(Ee.a)))})}),write_record(t,631),write_record(t,633),e.forEach(function(n){n[1].forEach(function(Ee){Ee.iauthor=r.indexOf(Ee.a);var Ce={s:decode_cell(n[0]),e:decode_cell(n[0])};write_record(t,635,write_BrtBeginComment([Ce,Ee])),Ee.t&&Ee.t.length>0&&write_record(t,637,write_BrtCommentText(Ee)),write_record(t,636),delete Ee.iauthor})}),write_record(t,634),write_record(t,629),t.end()}var CT_VBA="application/vnd.ms-office.vbaProject";function make_vba_xls(e){var t=CFB.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var Ee=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");CFB.utils.cfb_add(t,Ee,e.FileIndex[n].content)}}),CFB.write(t)}function fill_vba_xls(e,t){t.FullPaths.forEach(function(r,n){if(n!=0){var Ee=r.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");Ee.slice(-1)!=="/"&&CFB.utils.cfb_add(e,Ee,t.FileIndex[n].content)}})}var VBAFMTS=["xlsb","xlsm","xlam","biff8","xla"];function parse_ds_bin(){return{"!type":"dialog"}}function parse_ds_xml(){return{"!type":"dialog"}}function parse_ms_bin(){return{"!type":"macro"}}function parse_ms_xml(){return{"!type":"macro"}}var rc_to_a1=(function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,Ee,Ce,De){var Me=!1,ze=!1;Ce.length==0?ze=!0:Ce.charAt(0)=="["&&(ze=!0,Ce=Ce.slice(1,-1)),De.length==0?Me=!0:De.charAt(0)=="["&&(Me=!0,De=De.slice(1,-1));var Oe=Ce.length>0?parseInt(Ce,10)|0:0,Be=De.length>0?parseInt(De,10)|0:0;return Me?Be+=t.c:--Be,ze?Oe+=t.r:--Oe,Ee+(Me?"":"$")+encode_col(Be)+(ze?"":"$")+encode_row(Oe)}return function(Ee,Ce){return t=Ce,Ee.replace(e,r)}})(),crefregex=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,a1_to_rc=(function(){return function(t,r){return t.replace(crefregex,function(n,Ee,Ce,De,Me,ze){var Oe=decode_col(De)-(Ce?0:r.c),Be=decode_row(ze)-(Me?0:r.r),He=Be==0?"":Me?Be+1:"["+Be+"]",Ve=Oe==0?"":Ce?Oe+1:"["+Oe+"]";return Ee+"R"+He+"C"+Ve})}})();function shift_formula_str(e,t){return e.replace(crefregex,function(r,n,Ee,Ce,De,Me){return n+(Ee=="$"?Ee+Ce:encode_col(decode_col(Ce)+t.c))+(De=="$"?De+Me:encode_row(decode_row(Me)+t.r))})}function shift_formula_xlsx(e,t,r){var n=decode_range(t),Ee=n.s,Ce=decode_cell(r),De={r:Ce.r-Ee.r,c:Ce.c-Ee.c};return shift_formula_str(e,De)}function fuzzyfmla(e){return e.length!=1}function _xlfn(e){return e.replace(/_xlfn\./g,"")}function parseread1(e){e.l+=1}function parse_ColRelU(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function parse_RgceArea(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return parse_RgceArea_BIFF2(e);r.biff==12&&(n=4)}var Ee=e.read_shift(n),Ce=e.read_shift(n),De=parse_ColRelU(e),Me=parse_ColRelU(e);return{s:{r:Ee,c:De[0],cRel:De[1],rRel:De[2]},e:{r:Ce,c:Me[0],cRel:Me[1],rRel:Me[2]}}}function parse_RgceArea_BIFF2(e){var t=parse_ColRelU(e),r=parse_ColRelU(e),n=e.read_shift(1),Ee=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:Ee,cRel:r[1],rRel:r[2]}}}function parse_RgceAreaRel(e,t,r){if(r.biff<8)return parse_RgceArea_BIFF2(e);var n=e.read_shift(r.biff==12?4:2),Ee=e.read_shift(r.biff==12?4:2),Ce=parse_ColRelU(e),De=parse_ColRelU(e);return{s:{r:n,c:Ce[0],cRel:Ce[1],rRel:Ce[2]},e:{r:Ee,c:De[0],cRel:De[1],rRel:De[2]}}}function parse_RgceLoc(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return parse_RgceLoc_BIFF2(e);var n=e.read_shift(r&&r.biff==12?4:2),Ee=parse_ColRelU(e);return{r:n,c:Ee[0],cRel:Ee[1],rRel:Ee[2]}}function parse_RgceLoc_BIFF2(e){var t=parse_ColRelU(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function parse_RgceElfLoc(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function parse_RgceLocRel(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return parse_RgceLocRel_BIFF2(e);var Ee=e.read_shift(n>=12?4:2),Ce=e.read_shift(2),De=(Ce&16384)>>14,Me=(Ce&32768)>>15;if(Ce&=16383,Me==1)for(;Ee>524287;)Ee-=1048576;if(De==1)for(;Ce>8191;)Ce=Ce-16384;return{r:Ee,c:Ce,cRel:De,rRel:Me}}function parse_RgceLocRel_BIFF2(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,Ee=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),Ee==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:Ee,rRel:n}}function parse_PtgArea(e,t,r){var n=(e[e.l++]&96)>>5,Ee=parse_RgceArea(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,Ee]}function parse_PtgArea3d(e,t,r){var n=(e[e.l++]&96)>>5,Ee=e.read_shift(2,"i"),Ce=8;if(r)switch(r.biff){case 5:e.l+=12,Ce=6;break;case 12:Ce=12;break}var De=parse_RgceArea(e,Ce,r);return[n,Ee,De]}function parse_PtgAreaErr(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function parse_PtgAreaErr3d(e,t,r){var n=(e[e.l++]&96)>>5,Ee=e.read_shift(2),Ce=8;if(r)switch(r.biff){case 5:e.l+=12,Ce=6;break;case 12:Ce=12;break}return e.l+=Ce,[n,Ee]}function parse_PtgAreaN(e,t,r){var n=(e[e.l++]&96)>>5,Ee=parse_RgceAreaRel(e,t-1,r);return[n,Ee]}function parse_PtgArray(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function parse_PtgAttrBaxcel(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function parse_PtgAttrChoose(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),Ee=[],Ce=0;Ce<=n;++Ce)Ee.push(e.read_shift(r&&r.biff==2?1:2));return Ee}function parse_PtgAttrGoto(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function parse_PtgAttrIf(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function parse_PtgAttrIfError(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function parse_PtgAttrSemi(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function parse_PtgAttrSpaceType(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function parse_PtgAttrSpace(e){return e.read_shift(2),parse_PtgAttrSpaceType(e)}function parse_PtgAttrSpaceSemi(e){return e.read_shift(2),parse_PtgAttrSpaceType(e)}function parse_PtgRef(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var Ee=parse_RgceLoc(e,0,r);return[n,Ee]}function parse_PtgRefN(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var Ee=parse_RgceLocRel(e,0,r);return[n,Ee]}function parse_PtgRef3d(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var Ee=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var Ce=parse_RgceLoc(e,0,r);return[n,Ee,Ce]}function parse_PtgFunc(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var Ee=e.read_shift(r&&r.biff<=3?1:2);return[FtabArgc[Ee],Ftab[Ee],n]}function parse_PtgFuncVar(e,t,r){var n=e[e.l++],Ee=e.read_shift(1),Ce=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:parsetab(e);return[Ee,(Ce[0]===0?Ftab:Cetab)[Ce[1]]]}function parsetab(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function parse_PtgAttrSum(e,t,r){e.l+=r&&r.biff==2?3:4}function parse_PtgExp(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),Ee=e.read_shift(r&&r.biff==2?1:2);return[n,Ee]}function parse_PtgErr(e){return e.l++,BErr[e.read_shift(1)]}function parse_PtgInt(e){return e.l++,e.read_shift(2)}function parse_PtgBool(e){return e.l++,e.read_shift(1)!==0}function parse_PtgNum(e){return e.l++,parse_Xnum(e)}function parse_PtgStr(e,t,r){return e.l++,parse_ShortXLUnicodeString(e,t-1,r)}function parse_SerAr(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=parsebool(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=BErr[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=parse_Xnum(e);break;case 2:r[1]=parse_XLUnicodeString2(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function parse_PtgExtraMem(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),Ee=[],Ce=0;Ce!=n;++Ce)Ee.push((r.biff==12?parse_UncheckedRfX:parse_Ref8U)(e));return Ee}function parse_PtgExtraArray(e,t,r){var n=0,Ee=0;r.biff==12?(n=e.read_shift(4),Ee=e.read_shift(4)):(Ee=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--Ee==0&&(Ee=256));for(var Ce=0,De=[];Ce!=n&&(De[Ce]=[]);++Ce)for(var Me=0;Me!=Ee;++Me)De[Ce][Me]=parse_SerAr(e,r.biff);return De}function parse_PtgName(e,t,r){var n=e.read_shift(1)>>>5&3,Ee=!r||r.biff>=8?4:2,Ce=e.read_shift(Ee);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,Ce]}function parse_PtgNameX(e,t,r){if(r.biff==5)return parse_PtgNameX_BIFF5(e);var n=e.read_shift(1)>>>5&3,Ee=e.read_shift(2),Ce=e.read_shift(4);return[n,Ee,Ce]}function parse_PtgNameX_BIFF5(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function parse_PtgMemArea(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var Ee=e.read_shift(r&&r.biff==2?1:2);return[n,Ee]}function parse_PtgMemFunc(e,t,r){var n=e.read_shift(1)>>>5&3,Ee=e.read_shift(r&&r.biff==2?1:2);return[n,Ee]}function parse_PtgRefErr(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function parse_PtgRefErr3d(e,t,r){var n=(e[e.l++]&96)>>5,Ee=e.read_shift(2),Ce=4;if(r)switch(r.biff){case 5:Ce=15;break;case 12:Ce=6;break}return e.l+=Ce,[n,Ee]}var parse_PtgMemErr=parsenoop,parse_PtgMemNoMem=parsenoop,parse_PtgTbl=parsenoop;function parse_PtgElfLoc(e,t,r){return e.l+=2,[parse_RgceElfLoc(e)]}function parse_PtgElfNoop(e){return e.l+=6,[]}var parse_PtgElfCol=parse_PtgElfLoc,parse_PtgElfColS=parse_PtgElfNoop,parse_PtgElfColSV=parse_PtgElfNoop,parse_PtgElfColV=parse_PtgElfLoc;function parse_PtgElfLel(e){return e.l+=2,[parseuint16(e),e.read_shift(2)&1]}var parse_PtgElfRadical=parse_PtgElfLoc,parse_PtgElfRadicalLel=parse_PtgElfLel,parse_PtgElfRadicalS=parse_PtgElfNoop,parse_PtgElfRw=parse_PtgElfLoc,parse_PtgElfRwV=parse_PtgElfLoc,PtgListRT=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function parse_PtgList(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),Ee=e.read_shift(2),Ce=e.read_shift(2),De=PtgListRT[r>>2&31];return{ixti:t,coltype:r&3,rt:De,idx:n,c:Ee,C:Ce}}function parse_PtgSxName(e){return e.l+=2,[e.read_shift(4)]}function parse_PtgSheet(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function parse_PtgEndSheet(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function parse_PtgMemAreaN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function parse_PtgMemNoMemN(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function parse_PtgAttrNoop(e){return e.l+=4,[0,0]}var PtgTypes={1:{n:"PtgExp",f:parse_PtgExp},2:{n:"PtgTbl",f:parse_PtgTbl},3:{n:"PtgAdd",f:parseread1},4:{n:"PtgSub",f:parseread1},5:{n:"PtgMul",f:parseread1},6:{n:"PtgDiv",f:parseread1},7:{n:"PtgPower",f:parseread1},8:{n:"PtgConcat",f:parseread1},9:{n:"PtgLt",f:parseread1},10:{n:"PtgLe",f:parseread1},11:{n:"PtgEq",f:parseread1},12:{n:"PtgGe",f:parseread1},13:{n:"PtgGt",f:parseread1},14:{n:"PtgNe",f:parseread1},15:{n:"PtgIsect",f:parseread1},16:{n:"PtgUnion",f:parseread1},17:{n:"PtgRange",f:parseread1},18:{n:"PtgUplus",f:parseread1},19:{n:"PtgUminus",f:parseread1},20:{n:"PtgPercent",f:parseread1},21:{n:"PtgParen",f:parseread1},22:{n:"PtgMissArg",f:parseread1},23:{n:"PtgStr",f:parse_PtgStr},26:{n:"PtgSheet",f:parse_PtgSheet},27:{n:"PtgEndSheet",f:parse_PtgEndSheet},28:{n:"PtgErr",f:parse_PtgErr},29:{n:"PtgBool",f:parse_PtgBool},30:{n:"PtgInt",f:parse_PtgInt},31:{n:"PtgNum",f:parse_PtgNum},32:{n:"PtgArray",f:parse_PtgArray},33:{n:"PtgFunc",f:parse_PtgFunc},34:{n:"PtgFuncVar",f:parse_PtgFuncVar},35:{n:"PtgName",f:parse_PtgName},36:{n:"PtgRef",f:parse_PtgRef},37:{n:"PtgArea",f:parse_PtgArea},38:{n:"PtgMemArea",f:parse_PtgMemArea},39:{n:"PtgMemErr",f:parse_PtgMemErr},40:{n:"PtgMemNoMem",f:parse_PtgMemNoMem},41:{n:"PtgMemFunc",f:parse_PtgMemFunc},42:{n:"PtgRefErr",f:parse_PtgRefErr},43:{n:"PtgAreaErr",f:parse_PtgAreaErr},44:{n:"PtgRefN",f:parse_PtgRefN},45:{n:"PtgAreaN",f:parse_PtgAreaN},46:{n:"PtgMemAreaN",f:parse_PtgMemAreaN},47:{n:"PtgMemNoMemN",f:parse_PtgMemNoMemN},57:{n:"PtgNameX",f:parse_PtgNameX},58:{n:"PtgRef3d",f:parse_PtgRef3d},59:{n:"PtgArea3d",f:parse_PtgArea3d},60:{n:"PtgRefErr3d",f:parse_PtgRefErr3d},61:{n:"PtgAreaErr3d",f:parse_PtgAreaErr3d},255:{}},PtgDupes={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ptg18={1:{n:"PtgElfLel",f:parse_PtgElfLel},2:{n:"PtgElfRw",f:parse_PtgElfRw},3:{n:"PtgElfCol",f:parse_PtgElfCol},6:{n:"PtgElfRwV",f:parse_PtgElfRwV},7:{n:"PtgElfColV",f:parse_PtgElfColV},10:{n:"PtgElfRadical",f:parse_PtgElfRadical},11:{n:"PtgElfRadicalS",f:parse_PtgElfRadicalS},13:{n:"PtgElfColS",f:parse_PtgElfColS},15:{n:"PtgElfColSV",f:parse_PtgElfColSV},16:{n:"PtgElfRadicalLel",f:parse_PtgElfRadicalLel},25:{n:"PtgList",f:parse_PtgList},29:{n:"PtgSxName",f:parse_PtgSxName},255:{}},Ptg19={0:{n:"PtgAttrNoop",f:parse_PtgAttrNoop},1:{n:"PtgAttrSemi",f:parse_PtgAttrSemi},2:{n:"PtgAttrIf",f:parse_PtgAttrIf},4:{n:"PtgAttrChoose",f:parse_PtgAttrChoose},8:{n:"PtgAttrGoto",f:parse_PtgAttrGoto},16:{n:"PtgAttrSum",f:parse_PtgAttrSum},32:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},33:{n:"PtgAttrBaxcel",f:parse_PtgAttrBaxcel},64:{n:"PtgAttrSpace",f:parse_PtgAttrSpace},65:{n:"PtgAttrSpaceSemi",f:parse_PtgAttrSpaceSemi},128:{n:"PtgAttrIfError",f:parse_PtgAttrIfError},255:{}};function parse_RgbExtra(e,t,r,n){if(n.biff<8)return parsenoop(e,t);for(var Ee=e.l+t,Ce=[],De=0;De!==r.length;++De)switch(r[De][0]){case"PtgArray":r[De][1]=parse_PtgExtraArray(e,0,n),Ce.push(r[De][1]);break;case"PtgMemArea":r[De][2]=parse_PtgExtraMem(e,r[De][1],n),Ce.push(r[De][2]);break;case"PtgExp":n&&n.biff==12&&(r[De][1][1]=e.read_shift(4),Ce.push(r[De][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[De][0]}return t=Ee-e.l,t!==0&&Ce.push(parsenoop(e,t)),Ce}function parse_Rgce(e,t,r){for(var n=e.l+t,Ee,Ce,De=[];n!=e.l;)t=n-e.l,Ce=e[e.l],Ee=PtgTypes[Ce]||PtgTypes[PtgDupes[Ce]],(Ce===24||Ce===25)&&(Ee=(Ce===24?Ptg18:Ptg19)[e[e.l+1]]),!Ee||!Ee.f?parsenoop(e,t):De.push([Ee.n,Ee.f(e,t,r)]);return De}function stringify_array(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],Ee=[],Ce=0;Ce<n.length;++Ce){var De=n[Ce];if(De)switch(De[0]){case 2:Ee.push('"'+De[1].replace(/"/g,'""')+'"');break;default:Ee.push(De[1])}else Ee.push("")}t.push(Ee.join(","))}return t.join(";")}var PtgBinOp={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function formula_quote_sheet_name(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function get_ixti_raw(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var Ee="";if(r.biff>8)switch(e[n[0]][0]){case 357:return Ee=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?Ee:Ee+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return Ee=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?Ee:Ee+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(Ce){return Ce.Name}).join(";;");default:return e[n[0]][0][3]?(Ee=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?Ee:Ee+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function get_ixti(e,t,r){var n=get_ixti_raw(e,t,r);return n=="#REF"?n:formula_quote_sheet_name(n,r)}function stringify_formula(e,t,r,n,Ee){var Ce=Ee&&Ee.biff||8,De={s:{c:0,r:0}},Me=[],ze,Oe,Be,He=0,Ve=0,Xe,We="";if(!e[0]||!e[0][0])return"";for(var Ge=-1,$e="",Ke=0,rr=e[0].length;Ke<rr;++Ke){var tr=e[0][Ke];switch(tr[0]){case"PtgUminus":Me.push("-"+Me.pop());break;case"PtgUplus":Me.push("+"+Me.pop());break;case"PtgPercent":Me.push(Me.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(ze=Me.pop(),Oe=Me.pop(),Ge>=0){switch(e[0][Ge][1][0]){case 0:$e=fill(" ",e[0][Ge][1][1]);break;case 1:$e=fill("\r",e[0][Ge][1][1]);break;default:if($e="",Ee.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][Ge][1][0])}Oe=Oe+$e,Ge=-1}Me.push(Oe+PtgBinOp[tr[0]]+ze);break;case"PtgIsect":ze=Me.pop(),Oe=Me.pop(),Me.push(Oe+" "+ze);break;case"PtgUnion":ze=Me.pop(),Oe=Me.pop(),Me.push(Oe+","+ze);break;case"PtgRange":ze=Me.pop(),Oe=Me.pop(),Me.push(Oe+":"+ze);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":Be=shift_cell_xls(tr[1][1],De,Ee),Me.push(encode_cell_xls(Be,Ce));break;case"PtgRefN":Be=r?shift_cell_xls(tr[1][1],r,Ee):tr[1][1],Me.push(encode_cell_xls(Be,Ce));break;case"PtgRef3d":He=tr[1][1],Be=shift_cell_xls(tr[1][2],De,Ee),We=get_ixti(n,He,Ee),Me.push(We+"!"+encode_cell_xls(Be,Ce));break;case"PtgFunc":case"PtgFuncVar":var sr=tr[1][0],ar=tr[1][1];sr||(sr=0),sr&=127;var hr=sr==0?[]:Me.slice(-sr);Me.length-=sr,ar==="User"&&(ar=hr.shift()),Me.push(ar+"("+hr.join(",")+")");break;case"PtgBool":Me.push(tr[1]?"TRUE":"FALSE");break;case"PtgInt":Me.push(tr[1]);break;case"PtgNum":Me.push(String(tr[1]));break;case"PtgStr":Me.push('"'+tr[1].replace(/"/g,'""')+'"');break;case"PtgErr":Me.push(tr[1]);break;case"PtgAreaN":Xe=shift_range_xls(tr[1][1],r?{s:r}:De,Ee),Me.push(encode_range_xls(Xe,Ee));break;case"PtgArea":Xe=shift_range_xls(tr[1][1],De,Ee),Me.push(encode_range_xls(Xe,Ee));break;case"PtgArea3d":He=tr[1][1],Xe=tr[1][2],We=get_ixti(n,He,Ee),Me.push(We+"!"+encode_range_xls(Xe,Ee));break;case"PtgAttrSum":Me.push("SUM("+Me.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":Ve=tr[1][2];var pr=(n.names||[])[Ve-1]||(n[0]||[])[Ve],yr=pr?pr.Name:"SH33TJSNAME"+String(Ve);yr&&yr.slice(0,6)=="_xlfn."&&!Ee.xlfn&&(yr=yr.slice(6)),Me.push(yr);break;case"PtgNameX":var fr=tr[1][1];Ve=tr[1][2];var Rr;if(Ee.biff<=5)fr<0&&(fr=-fr),n[fr]&&(Rr=n[fr][Ve]);else{var mr="";if(((n[fr]||[])[0]||[])[0]==14849||(((n[fr]||[])[0]||[])[0]==1025?n[fr][Ve]&&n[fr][Ve].itab>0&&(mr=n.SheetNames[n[fr][Ve].itab-1]+"!"):mr=n.SheetNames[Ve-1]+"!"),n[fr]&&n[fr][Ve])mr+=n[fr][Ve].Name;else if(n[0]&&n[0][Ve])mr+=n[0][Ve].Name;else{var wr=(get_ixti_raw(n,fr,Ee)||"").split(";;");wr[Ve-1]?mr=wr[Ve-1]:mr+="SH33TJSERRX"}Me.push(mr);break}Rr||(Rr={Name:"SH33TJSERRY"}),Me.push(Rr.Name);break;case"PtgParen":var Fr="(",Mr=")";if(Ge>=0){switch($e="",e[0][Ge][1][0]){case 2:Fr=fill(" ",e[0][Ge][1][1])+Fr;break;case 3:Fr=fill("\r",e[0][Ge][1][1])+Fr;break;case 4:Mr=fill(" ",e[0][Ge][1][1])+Mr;break;case 5:Mr=fill("\r",e[0][Ge][1][1])+Mr;break;default:if(Ee.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][Ge][1][0])}Ge=-1}Me.push(Fr+Me.pop()+Mr);break;case"PtgRefErr":Me.push("#REF!");break;case"PtgRefErr3d":Me.push("#REF!");break;case"PtgExp":Be={c:tr[1][1],r:tr[1][0]};var Hr={c:r.c,r:r.r};if(n.sharedf[encode_cell(Be)]){var Nr=n.sharedf[encode_cell(Be)];Me.push(stringify_formula(Nr,De,Hr,n,Ee))}else{var Ar=!1;for(ze=0;ze!=n.arrayf.length;++ze)if(Oe=n.arrayf[ze],!(Be.c<Oe[0].s.c||Be.c>Oe[0].e.c)&&!(Be.r<Oe[0].s.r||Be.r>Oe[0].e.r)){Me.push(stringify_formula(Oe[1],De,Hr,n,Ee)),Ar=!0;break}Ar||Me.push(tr[1])}break;case"PtgArray":Me.push("{"+stringify_array(tr[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":Ge=Ke;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":Me.push("");break;case"PtgAreaErr":Me.push("#REF!");break;case"PtgAreaErr3d":Me.push("#REF!");break;case"PtgList":Me.push("Table"+tr[1].idx+"[#"+tr[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(tr));default:throw new Error("Unrecognized Formula Token: "+String(tr))}var xr=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(Ee.biff!=3&&Ge>=0&&xr.indexOf(e[0][Ke][0])==-1){tr=e[0][Ge];var ir=!0;switch(tr[1][0]){case 4:ir=!1;case 0:$e=fill(" ",tr[1][1]);break;case 5:ir=!1;case 1:$e=fill("\r",tr[1][1]);break;default:if($e="",Ee.WTF)throw new Error("Unexpected PtgAttrSpaceType "+tr[1][0])}Me.push((ir?$e:"")+Me.pop()+(ir?"":$e)),Ge=-1}}if(Me.length>1&&Ee.WTF)throw new Error("bad formula stack");return Me[0]}function parse_ArrayParsedFormula(e,t,r){var n=e.l+t,Ee=r.biff==2?1:2,Ce,De=e.read_shift(Ee);if(De==65535)return[[],parsenoop(e,t-2)];var Me=parse_Rgce(e,De,r);return t!==De+Ee&&(Ce=parse_RgbExtra(e,t-De-Ee,Me,r)),e.l=n,[Me,Ce]}function parse_XLSCellParsedFormula(e,t,r){var n=e.l+t,Ee=r.biff==2?1:2,Ce,De=e.read_shift(Ee);if(De==65535)return[[],parsenoop(e,t-2)];var Me=parse_Rgce(e,De,r);return t!==De+Ee&&(Ce=parse_RgbExtra(e,t-De-Ee,Me,r)),e.l=n,[Me,Ce]}function parse_NameParsedFormula(e,t,r,n){var Ee=e.l+t,Ce=parse_Rgce(e,n,r),De;return Ee!==e.l&&(De=parse_RgbExtra(e,Ee-e.l,Ce,r)),[Ce,De]}function parse_SharedParsedFormula(e,t,r){var n=e.l+t,Ee,Ce=e.read_shift(2),De=parse_Rgce(e,Ce,r);return Ce==65535?[[],parsenoop(e,t-2)]:(t!==Ce+2&&(Ee=parse_RgbExtra(e,n-Ce-2,De,r)),[De,Ee])}function parse_FormulaValue(e){var t;if(__readUInt16LE(e,e.l+6)!==65535)return[parse_Xnum(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function write_FormulaValue(e){if(e==null){var t=new_buf(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return write_Xnum(e);return write_Xnum(0)}function parse_Formula(e,t,r){var n=e.l+t,Ee=parse_XLSCell(e);r.biff==2&&++e.l;var Ce=parse_FormulaValue(e),De=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var Me=parse_XLSCellParsedFormula(e,n-e.l,r);return{cell:Ee,val:Ce[0],formula:Me,shared:De>>3&1,tt:Ce[1]}}function write_Formula(e,t,r,n,Ee){var Ce=write_XLSCell(t,r,Ee),De=write_FormulaValue(e.v),Me=new_buf(6),ze=33;Me.write_shift(2,ze),Me.write_shift(4,0);for(var Oe=new_buf(e.bf.length),Be=0;Be<e.bf.length;++Be)Oe[Be]=e.bf[Be];var He=bconcat([Ce,De,Me,Oe]);return He}function parse_XLSBParsedFormula(e,t,r){var n=e.read_shift(4),Ee=parse_Rgce(e,n,r),Ce=e.read_shift(4),De=Ce>0?parse_RgbExtra(e,Ce,Ee,r):null;return[Ee,De]}var parse_XLSBArrayParsedFormula=parse_XLSBParsedFormula,parse_XLSBCellParsedFormula=parse_XLSBParsedFormula,parse_XLSBNameParsedFormula=parse_XLSBParsedFormula,parse_XLSBSharedParsedFormula=parse_XLSBParsedFormula,Cetab={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ftab={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},FtabArgc={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function ods_to_csf_formula(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function csf_to_ods_formula(e){var t="of:="+e.replace(crefregex,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function ods_to_csf_3D(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function csf_to_ods_3D(e){return e.replace(/\./,"!")}var strs={},_ssfopts={},browser_has_Map=typeof Map<"u";function get_sst_id(e,t,r){var n=0,Ee=e.length;if(r){if(browser_has_Map?r.has(t):Object.prototype.hasOwnProperty.call(r,t)){for(var Ce=browser_has_Map?r.get(t):r[t];n<Ce.length;++n)if(e[Ce[n]].t===t)return e.Count++,Ce[n]}}else for(;n<Ee;++n)if(e[n].t===t)return e.Count++,n;return e[Ee]={t},e.Count++,e.Unique++,r&&(browser_has_Map?(r.has(t)||r.set(t,[]),r.get(t).push(Ee)):(Object.prototype.hasOwnProperty.call(r,t)||(r[t]=[]),r[t].push(Ee))),Ee}function col_obj_w(e,t){var r={min:e+1,max:e+1},n=-1;return t.MDW&&(MDW=t.MDW),t.width!=null?r.customWidth=1:t.wpx!=null?n=px2char(t.wpx):t.wch!=null&&(n=t.wch),n>-1?(r.width=char2width(n),r.customWidth=1):t.width!=null&&(r.width=t.width),t.hidden&&(r.hidden=!0),t.level!=null&&(r.outlineLevel=r.level=t.level),r}function default_margins(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function get_cell_style(e,t,r){var n=r.revssf[t.z!=null?t.z:"General"],Ee=60,Ce=e.length;if(n==null&&r.ssf){for(;Ee<392;++Ee)if(r.ssf[Ee]==null){SSF_load(t.z,Ee),r.ssf[Ee]=t.z,r.revssf[t.z]=n=Ee;break}}for(Ee=0;Ee!=Ce;++Ee)if(e[Ee].numFmtId===n)return Ee;return e[Ce]={numFmtId:n,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},Ce}function safe_format(e,t,r,n,Ee,Ce){try{n.cellNF&&(e.z=table_fmt[t])}catch(Me){if(n.WTF)throw Me}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=parseDate(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(table_fmt[t]==null&&SSF_load(SSFImplicit[t]||"General",t),e.t==="e")e.w=e.w||BErr[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v);else if(e.t==="d"){var De=datenum(e.v);(De|0)===De?e.w=De.toString(10):e.w=SSF_general_num(De)}else{if(e.v===void 0)return"";e.w=SSF_general(e.v,_ssfopts)}else e.t==="d"?e.w=SSF_format(t,datenum(e.v),_ssfopts):e.w=SSF_format(t,e.v,_ssfopts)}catch(Me){if(n.WTF)throw Me}if(n.cellStyles&&r!=null)try{e.s=Ce.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=rgb_tint(Ee.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=Ee.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=rgb_tint(Ee.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=Ee.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(Me){if(n.WTF&&Ce.Fills)throw Me}}}function check_ws(e,t,r){if(e&&e["!ref"]){var n=safe_decode_range(e["!ref"]);if(n.e.c<n.s.c||n.e.r<n.s.r)throw new Error("Bad range ("+r+"): "+e["!ref"])}}function parse_ws_xml_dim(e,t){var r=safe_decode_range(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=encode_range(r))}var mergecregex=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,sheetdataregex=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hlinkregex=/<(?:\w:)?hyperlink [^>]*>/mg,dimregex=/"(\w*:\w*)"/,colregex=/<(?:\w:)?col\b[^>]*[\/]?>/g,afregex=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,marginregex=/<(?:\w:)?pageMargins[^>]*\/>/g,sheetprregex=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,sheetprregex2=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,svsregex=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function parse_ws_xml(e,t,r,n,Ee,Ce,De){if(!e)return e;n||(n={"!id":{}});var Me=t.dense?[]:{},ze={s:{r:2e6,c:2e6},e:{r:0,c:0}},Oe="",Be="",He=e.match(sheetdataregex);He?(Oe=e.slice(0,He.index),Be=e.slice(He.index+He[0].length)):Oe=Be=e;var Ve=Oe.match(sheetprregex);Ve?parse_ws_xml_sheetpr(Ve[0],Me,Ee,r):(Ve=Oe.match(sheetprregex2))&&parse_ws_xml_sheetpr2(Ve[0],Ve[1]||"",Me,Ee,r);var Xe=(Oe.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(Xe>0){var We=Oe.slice(Xe,Xe+50).match(dimregex);We&&parse_ws_xml_dim(Me,We[1])}var Ge=Oe.match(svsregex);Ge&&Ge[1]&&parse_ws_xml_sheetviews(Ge[1],Ee);var $e=[];if(t.cellStyles){var Ke=Oe.match(colregex);Ke&&parse_ws_xml_cols($e,Ke)}He&&parse_ws_xml_data(He[1],Me,t,ze,Ce,De);var rr=Be.match(afregex);rr&&(Me["!autofilter"]=parse_ws_xml_autofilter(rr[0]));var tr=[],sr=Be.match(mergecregex);if(sr)for(Xe=0;Xe!=sr.length;++Xe)tr[Xe]=safe_decode_range(sr[Xe].slice(sr[Xe].indexOf('"')+1));var ar=Be.match(hlinkregex);ar&&parse_ws_xml_hlinks(Me,ar,n);var hr=Be.match(marginregex);if(hr&&(Me["!margins"]=parse_ws_xml_margins(parsexmltag(hr[0]))),!Me["!ref"]&&ze.e.c>=ze.s.c&&ze.e.r>=ze.s.r&&(Me["!ref"]=encode_range(ze)),t.sheetRows>0&&Me["!ref"]){var pr=safe_decode_range(Me["!ref"]);t.sheetRows<=+pr.e.r&&(pr.e.r=t.sheetRows-1,pr.e.r>ze.e.r&&(pr.e.r=ze.e.r),pr.e.r<pr.s.r&&(pr.s.r=pr.e.r),pr.e.c>ze.e.c&&(pr.e.c=ze.e.c),pr.e.c<pr.s.c&&(pr.s.c=pr.e.c),Me["!fullref"]=Me["!ref"],Me["!ref"]=encode_range(pr))}return $e.length>0&&(Me["!cols"]=$e),tr.length>0&&(Me["!merges"]=tr),Me}function write_ws_xml_merges(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',r=0;r!=e.length;++r)t+='<mergeCell ref="'+encode_range(e[r])+'"/>';return t+"</mergeCells>"}function parse_ws_xml_sheetpr(e,t,r,n){var Ee=parsexmltag(e);r.Sheets[n]||(r.Sheets[n]={}),Ee.codeName&&(r.Sheets[n].CodeName=unescapexml(utf8read(Ee.codeName)))}function parse_ws_xml_sheetpr2(e,t,r,n,Ee){parse_ws_xml_sheetpr(e.slice(0,e.indexOf(">")),r,n,Ee)}function write_ws_xml_sheetpr(e,t,r,n,Ee){var Ce=!1,De={},Me=null;if(n.bookType!=="xlsx"&&t.vbaraw){var ze=t.SheetNames[r];try{t.Workbook&&(ze=t.Workbook.Sheets[r].CodeName||ze)}catch{}Ce=!0,De.codeName=utf8write(escapexml(ze))}if(e&&e["!outline"]){var Oe={summaryBelow:1,summaryRight:1};e["!outline"].above&&(Oe.summaryBelow=0),e["!outline"].left&&(Oe.summaryRight=0),Me=(Me||"")+writextag("outlinePr",null,Oe)}!Ce&&!Me||(Ee[Ee.length]=writextag("sheetPr",Me,De))}var sheetprot_deffalse=["objects","scenarios","selectLockedCells","selectUnlockedCells"],sheetprot_deftrue=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function write_ws_xml_protection(e){var t={sheet:1};return sheetprot_deffalse.forEach(function(r){e[r]!=null&&e[r]&&(t[r]="1")}),sheetprot_deftrue.forEach(function(r){e[r]!=null&&!e[r]&&(t[r]="0")}),e.password&&(t.password=crypto_CreatePasswordVerifier_Method1(e.password).toString(16).toUpperCase()),writextag("sheetProtection",null,t)}function parse_ws_xml_hlinks(e,t,r){for(var n=Array.isArray(e),Ee=0;Ee!=t.length;++Ee){var Ce=parsexmltag(utf8read(t[Ee]),!0);if(!Ce.ref)return;var De=((r||{})["!id"]||[])[Ce.id];De?(Ce.Target=De.Target,Ce.location&&(Ce.Target+="#"+unescapexml(Ce.location))):(Ce.Target="#"+unescapexml(Ce.location),De={Target:Ce.Target,TargetMode:"Internal"}),Ce.Rel=De,Ce.tooltip&&(Ce.Tooltip=Ce.tooltip,delete Ce.tooltip);for(var Me=safe_decode_range(Ce.ref),ze=Me.s.r;ze<=Me.e.r;++ze)for(var Oe=Me.s.c;Oe<=Me.e.c;++Oe){var Be=encode_cell({c:Oe,r:ze});n?(e[ze]||(e[ze]=[]),e[ze][Oe]||(e[ze][Oe]={t:"z",v:void 0}),e[ze][Oe].l=Ce):(e[Be]||(e[Be]={t:"z",v:void 0}),e[Be].l=Ce)}}}function parse_ws_xml_margins(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function write_ws_xml_margins(e){return default_margins(e),writextag("pageMargins",null,e)}function parse_ws_xml_cols(e,t){for(var r=!1,n=0;n!=t.length;++n){var Ee=parsexmltag(t[n],!0);Ee.hidden&&(Ee.hidden=parsexmlbool(Ee.hidden));var Ce=parseInt(Ee.min,10)-1,De=parseInt(Ee.max,10)-1;for(Ee.outlineLevel&&(Ee.level=+Ee.outlineLevel||0),delete Ee.min,delete Ee.max,Ee.width=+Ee.width,!r&&Ee.width&&(r=!0,find_mdw_colw(Ee.width)),process_col(Ee);Ce<=De;)e[Ce++]=dup(Ee)}}function write_ws_xml_cols(e,t){for(var r=["<cols>"],n,Ee=0;Ee!=t.length;++Ee)(n=t[Ee])&&(r[r.length]=writextag("col",null,col_obj_w(Ee,n)));return r[r.length]="</cols>",r.join("")}function parse_ws_xml_autofilter(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function write_ws_xml_autofilter(e,t,r,n){var Ee=typeof e.ref=="string"?e.ref:encode_range(e.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var Ce=r.Workbook.Names,De=decode_range(Ee);De.s.r==De.e.r&&(De.e.r=decode_range(t["!ref"]).e.r,Ee=encode_range(De));for(var Me=0;Me<Ce.length;++Me){var ze=Ce[Me];if(ze.Name=="_xlnm._FilterDatabase"&&ze.Sheet==n){ze.Ref="'"+r.SheetNames[n]+"'!"+Ee;break}}return Me==Ce.length&&Ce.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+Ee}),writextag("autoFilter",null,{ref:Ee})}var sviewregex=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function parse_ws_xml_sheetviews(e,t){t.Views||(t.Views=[{}]),(e.match(sviewregex)||[]).forEach(function(r,n){var Ee=parsexmltag(r);t.Views[n]||(t.Views[n]={}),+Ee.zoomScale&&(t.Views[n].zoom=+Ee.zoomScale),parsexmlbool(Ee.rightToLeft)&&(t.Views[n].RTL=!0)})}function write_ws_xml_sheetviews(e,t,r,n){var Ee={workbookViewId:"0"};return(((n||{}).Workbook||{}).Views||[])[0]&&(Ee.rightToLeft=n.Workbook.Views[0].RTL?"1":"0"),writextag("sheetViews",writextag("sheetView",null,Ee),{})}function write_ws_xml_cell(e,t,r,n){if(e.c&&r["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var Ee="",Ce=e.t,De=e.v;if(e.t!=="z")switch(e.t){case"b":Ee=e.v?"1":"0";break;case"n":Ee=""+e.v;break;case"e":Ee=BErr[e.v];break;case"d":n&&n.cellDates?Ee=parseDate(e.v,-1).toISOString():(e=dup(e),e.t="n",Ee=""+(e.v=datenum(parseDate(e.v)))),typeof e.z>"u"&&(e.z=table_fmt[14]);break;default:Ee=e.v;break}var Me=writetag("v",escapexml(Ee)),ze={r:t},Oe=get_cell_style(n.cellXfs,e,n);switch(Oe!==0&&(ze.s=Oe),e.t){case"n":break;case"d":ze.t="d";break;case"b":ze.t="b";break;case"e":ze.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(n&&n.bookSST){Me=writetag("v",""+get_sst_id(n.Strings,e.v,n.revStrings)),ze.t="s";break}ze.t="str";break}if(e.t!=Ce&&(e.t=Ce,e.v=De),typeof e.f=="string"&&e.f){var Be=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;Me=writextag("f",escapexml(e.f),Be)+(e.v!=null?Me:"")}return e.l&&r["!links"].push([t,e.l]),e.D&&(ze.cm=1),writextag("c",Me,ze)}var parse_ws_xml_data=(function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,Ee=/ref=["']([^"']*)["']/,Ce=matchtag("v"),De=matchtag("f");return function(ze,Oe,Be,He,Ve,Xe){for(var We=0,Ge="",$e=[],Ke=[],rr=0,tr=0,sr=0,ar="",hr,pr,yr=0,fr=0,Rr,mr,wr=0,Fr=0,Mr=Array.isArray(Xe.CellXf),Hr,Nr=[],Ar=[],xr=Array.isArray(Oe),ir=[],_r={},ur=!1,Je=!!Be.sheetStubs,nr=ze.split(t),or=0,lr=nr.length;or!=lr;++or){Ge=nr[or].trim();var St=Ge.length;if(St!==0){var dr=0;e:for(We=0;We<St;++We)switch(Ge[We]){case">":if(Ge[We-1]!="/"){++We;break e}if(Be&&Be.cellStyles){if(pr=parsexmltag(Ge.slice(dr,We),!0),yr=pr.r!=null?parseInt(pr.r,10):yr+1,fr=-1,Be.sheetRows&&Be.sheetRows<yr)continue;_r={},ur=!1,pr.ht&&(ur=!0,_r.hpt=parseFloat(pr.ht),_r.hpx=pt2px(_r.hpt)),pr.hidden=="1"&&(ur=!0,_r.hidden=!0),pr.outlineLevel!=null&&(ur=!0,_r.level=+pr.outlineLevel),ur&&(ir[yr-1]=_r)}break;case"<":dr=We;break}if(dr>=We)break;if(pr=parsexmltag(Ge.slice(dr,We),!0),yr=pr.r!=null?parseInt(pr.r,10):yr+1,fr=-1,!(Be.sheetRows&&Be.sheetRows<yr)){He.s.r>yr-1&&(He.s.r=yr-1),He.e.r<yr-1&&(He.e.r=yr-1),Be&&Be.cellStyles&&(_r={},ur=!1,pr.ht&&(ur=!0,_r.hpt=parseFloat(pr.ht),_r.hpx=pt2px(_r.hpt)),pr.hidden=="1"&&(ur=!0,_r.hidden=!0),pr.outlineLevel!=null&&(ur=!0,_r.level=+pr.outlineLevel),ur&&(ir[yr-1]=_r)),$e=Ge.slice(We).split(e);for(var vr=0;vr!=$e.length&&$e[vr].trim().charAt(0)=="<";++vr);for($e=$e.slice(vr),We=0;We!=$e.length;++We)if(Ge=$e[We].trim(),Ge.length!==0){if(Ke=Ge.match(r),rr=We,tr=0,sr=0,Ge="<c "+(Ge.slice(0,1)=="<"?">":"")+Ge,Ke!=null&&Ke.length===2){for(rr=0,ar=Ke[1],tr=0;tr!=ar.length&&!((sr=ar.charCodeAt(tr)-64)<1||sr>26);++tr)rr=26*rr+sr;--rr,fr=rr}else++fr;for(tr=0;tr!=Ge.length&&Ge.charCodeAt(tr)!==62;++tr);if(++tr,pr=parsexmltag(Ge.slice(0,tr),!0),pr.r||(pr.r=encode_cell({r:yr-1,c:fr})),ar=Ge.slice(tr),hr={t:""},(Ke=ar.match(Ce))!=null&&Ke[1]!==""&&(hr.v=unescapexml(Ke[1])),Be.cellFormula){if((Ke=ar.match(De))!=null&&Ke[1]!==""){if(hr.f=unescapexml(utf8read(Ke[1])).replace(/\r\n/g,`
`),Be.xlfn||(hr.f=_xlfn(hr.f)),Ke[0].indexOf('t="array"')>-1)hr.F=(ar.match(Ee)||[])[1],hr.F.indexOf(":")>-1&&Nr.push([safe_decode_range(hr.F),hr.F]);else if(Ke[0].indexOf('t="shared"')>-1){mr=parsexmltag(Ke[0]);var br=unescapexml(utf8read(Ke[1]));Be.xlfn||(br=_xlfn(br)),Ar[parseInt(mr.si,10)]=[mr,br,pr.r]}}else(Ke=ar.match(/<f[^>]*\/>/))&&(mr=parsexmltag(Ke[0]),Ar[mr.si]&&(hr.f=shift_formula_xlsx(Ar[mr.si][1],Ar[mr.si][2],pr.r)));var kr=decode_cell(pr.r);for(tr=0;tr<Nr.length;++tr)kr.r>=Nr[tr][0].s.r&&kr.r<=Nr[tr][0].e.r&&kr.c>=Nr[tr][0].s.c&&kr.c<=Nr[tr][0].e.c&&(hr.F=Nr[tr][1])}if(pr.t==null&&hr.v===void 0)if(hr.f||hr.F)hr.v=0,hr.t="n";else if(Je)hr.t="z";else continue;else hr.t=pr.t||"n";switch(He.s.c>fr&&(He.s.c=fr),He.e.c<fr&&(He.e.c=fr),hr.t){case"n":if(hr.v==""||hr.v==null){if(!Je)continue;hr.t="z"}else hr.v=parseFloat(hr.v);break;case"s":if(typeof hr.v>"u"){if(!Je)continue;hr.t="z"}else Rr=strs[parseInt(hr.v,10)],hr.v=Rr.t,hr.r=Rr.r,Be.cellHTML&&(hr.h=Rr.h);break;case"str":hr.t="s",hr.v=hr.v!=null?utf8read(hr.v):"",Be.cellHTML&&(hr.h=escapehtml(hr.v));break;case"inlineStr":Ke=ar.match(n),hr.t="s",Ke!=null&&(Rr=parse_si(Ke[1]))?(hr.v=Rr.t,Be.cellHTML&&(hr.h=Rr.h)):hr.v="";break;case"b":hr.v=parsexmlbool(hr.v);break;case"d":Be.cellDates?hr.v=parseDate(hr.v,1):(hr.v=datenum(parseDate(hr.v,1)),hr.t="n");break;case"e":(!Be||Be.cellText!==!1)&&(hr.w=hr.v),hr.v=RBErr[hr.v];break}if(wr=Fr=0,Hr=null,Mr&&pr.s!==void 0&&(Hr=Xe.CellXf[pr.s],Hr!=null&&(Hr.numFmtId!=null&&(wr=Hr.numFmtId),Be.cellStyles&&Hr.fillId!=null&&(Fr=Hr.fillId))),safe_format(hr,wr,Fr,Be,Ve,Xe),Be.cellDates&&Mr&&hr.t=="n"&&fmt_is_date(table_fmt[wr])&&(hr.t="d",hr.v=numdate(hr.v)),pr.cm&&Be.xlmeta){var Pr=(Be.xlmeta.Cell||[])[+pr.cm-1];Pr&&Pr.type=="XLDAPR"&&(hr.D=!0)}if(xr){var Er=decode_cell(pr.r);Oe[Er.r]||(Oe[Er.r]=[]),Oe[Er.r][Er.c]=hr}else Oe[pr.r]=hr}}}}ir.length>0&&(Oe["!rows"]=ir)}})();function write_ws_xml_data(e,t,r,n){var Ee=[],Ce=[],De=safe_decode_range(e["!ref"]),Me="",ze,Oe="",Be=[],He=0,Ve=0,Xe=e["!rows"],We=Array.isArray(e),Ge={r:Oe},$e,Ke=-1;for(Ve=De.s.c;Ve<=De.e.c;++Ve)Be[Ve]=encode_col(Ve);for(He=De.s.r;He<=De.e.r;++He){for(Ce=[],Oe=encode_row(He),Ve=De.s.c;Ve<=De.e.c;++Ve){ze=Be[Ve]+Oe;var rr=We?(e[He]||[])[Ve]:e[ze];rr!==void 0&&(Me=write_ws_xml_cell(rr,ze,e,t))!=null&&Ce.push(Me)}(Ce.length>0||Xe&&Xe[He])&&(Ge={r:Oe},Xe&&Xe[He]&&($e=Xe[He],$e.hidden&&(Ge.hidden=1),Ke=-1,$e.hpx?Ke=px2pt($e.hpx):$e.hpt&&(Ke=$e.hpt),Ke>-1&&(Ge.ht=Ke,Ge.customHeight=1),$e.level&&(Ge.outlineLevel=$e.level)),Ee[Ee.length]=writextag("row",Ce.join(""),Ge))}if(Xe)for(;He<Xe.length;++He)Xe&&Xe[He]&&(Ge={r:He+1},$e=Xe[He],$e.hidden&&(Ge.hidden=1),Ke=-1,$e.hpx?Ke=px2pt($e.hpx):$e.hpt&&(Ke=$e.hpt),Ke>-1&&(Ge.ht=Ke,Ge.customHeight=1),$e.level&&(Ge.outlineLevel=$e.level),Ee[Ee.length]=writextag("row","",Ge));return Ee.join("")}function write_ws_xml(e,t,r,n){var Ee=[XML_HEADER,writextag("worksheet",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r})],Ce=r.SheetNames[e],De=0,Me="",ze=r.Sheets[Ce];ze==null&&(ze={});var Oe=ze["!ref"]||"A1",Be=safe_decode_range(Oe);if(Be.e.c>16383||Be.e.r>1048575){if(t.WTF)throw new Error("Range "+Oe+" exceeds format limit A1:XFD1048576");Be.e.c=Math.min(Be.e.c,16383),Be.e.r=Math.min(Be.e.c,1048575),Oe=encode_range(Be)}n||(n={}),ze["!comments"]=[];var He=[];write_ws_xml_sheetpr(ze,r,e,t,Ee),Ee[Ee.length]=writextag("dimension",null,{ref:Oe}),Ee[Ee.length]=write_ws_xml_sheetviews(ze,t,e,r),t.sheetFormat&&(Ee[Ee.length]=writextag("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),ze["!cols"]!=null&&ze["!cols"].length>0&&(Ee[Ee.length]=write_ws_xml_cols(ze,ze["!cols"])),Ee[De=Ee.length]="<sheetData/>",ze["!links"]=[],ze["!ref"]!=null&&(Me=write_ws_xml_data(ze,t),Me.length>0&&(Ee[Ee.length]=Me)),Ee.length>De+1&&(Ee[Ee.length]="</sheetData>",Ee[De]=Ee[De].replace("/>",">")),ze["!protect"]&&(Ee[Ee.length]=write_ws_xml_protection(ze["!protect"])),ze["!autofilter"]!=null&&(Ee[Ee.length]=write_ws_xml_autofilter(ze["!autofilter"],ze,r,e)),ze["!merges"]!=null&&ze["!merges"].length>0&&(Ee[Ee.length]=write_ws_xml_merges(ze["!merges"]));var Ve=-1,Xe,We=-1;return ze["!links"].length>0&&(Ee[Ee.length]="<hyperlinks>",ze["!links"].forEach(function(Ge){Ge[1].Target&&(Xe={ref:Ge[0]},Ge[1].Target.charAt(0)!="#"&&(We=add_rels(n,-1,escapexml(Ge[1].Target).replace(/#.*$/,""),RELS.HLINK),Xe["r:id"]="rId"+We),(Ve=Ge[1].Target.indexOf("#"))>-1&&(Xe.location=escapexml(Ge[1].Target.slice(Ve+1))),Ge[1].Tooltip&&(Xe.tooltip=escapexml(Ge[1].Tooltip)),Ee[Ee.length]=writextag("hyperlink",null,Xe))}),Ee[Ee.length]="</hyperlinks>"),delete ze["!links"],ze["!margins"]!=null&&(Ee[Ee.length]=write_ws_xml_margins(ze["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(Ee[Ee.length]=writetag("ignoredErrors",writextag("ignoredError",null,{numberStoredAsText:1,sqref:Oe}))),He.length>0&&(We=add_rels(n,-1,"../drawings/drawing"+(e+1)+".xml",RELS.DRAW),Ee[Ee.length]=writextag("drawing",null,{"r:id":"rId"+We}),ze["!drawing"]=He),ze["!comments"].length>0&&(We=add_rels(n,-1,"../drawings/vmlDrawing"+(e+1)+".vml",RELS.VML),Ee[Ee.length]=writextag("legacyDrawing",null,{"r:id":"rId"+We}),ze["!legacy"]=We),Ee.length>1&&(Ee[Ee.length]="</worksheet>",Ee[1]=Ee[1].replace("/>",">")),Ee.join("")}function parse_BrtRowHdr(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var Ee=e.read_shift(2);e.l+=1;var Ce=e.read_shift(1);return e.l=n,Ce&7&&(r.level=Ce&7),Ce&16&&(r.hidden=!0),Ce&32&&(r.hpt=Ee/20),r}function write_BrtRowHdr(e,t,r){var n=new_buf(145),Ee=(r["!rows"]||[])[e]||{};n.write_shift(4,e),n.write_shift(4,0);var Ce=320;Ee.hpx?Ce=px2pt(Ee.hpx)*20:Ee.hpt&&(Ce=Ee.hpt*20),n.write_shift(2,Ce),n.write_shift(1,0);var De=0;Ee.level&&(De|=Ee.level),Ee.hidden&&(De|=16),(Ee.hpx||Ee.hpt)&&(De|=32),n.write_shift(1,De),n.write_shift(1,0);var Me=0,ze=n.l;n.l+=4;for(var Oe={r:e,c:0},Be=0;Be<16;++Be)if(!(t.s.c>Be+1<<10||t.e.c<Be<<10)){for(var He=-1,Ve=-1,Xe=Be<<10;Xe<Be+1<<10;++Xe){Oe.c=Xe;var We=Array.isArray(r)?(r[Oe.r]||[])[Oe.c]:r[encode_cell(Oe)];We&&(He<0&&(He=Xe),Ve=Xe)}He<0||(++Me,n.write_shift(4,He),n.write_shift(4,Ve))}var Ge=n.l;return n.l=ze,n.write_shift(4,Me),n.l=Ge,n.length>n.l?n.slice(0,n.l):n}function write_row_header(e,t,r,n){var Ee=write_BrtRowHdr(n,r,t);(Ee.length>17||(t["!rows"]||[])[n])&&write_record(e,0,Ee)}var parse_BrtWsDim=parse_UncheckedRfX,write_BrtWsDim=write_UncheckedRfX;function parse_BrtWsFmtInfo(){}function parse_BrtWsProp(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=parse_XLSBCodeName(e),r}function write_BrtWsProp(e,t,r){r==null&&(r=new_buf(84+4*e.length));var n=192;t&&(t.above&&(n&=-65),t.left&&(n&=-129)),r.write_shift(1,n);for(var Ee=1;Ee<3;++Ee)r.write_shift(1,0);return write_BrtColor({auto:1},r),r.write_shift(-4,-1),r.write_shift(-4,-1),write_XLSBCodeName(e,r),r.slice(0,r.l)}function parse_BrtCellBlank(e){var t=parse_XLSBCell(e);return[t]}function write_BrtCellBlank(e,t,r){return r==null&&(r=new_buf(8)),write_XLSBCell(t,r)}function parse_BrtShortBlank(e){var t=parse_XLSBShortCell(e);return[t]}function write_BrtShortBlank(e,t,r){return r==null&&(r=new_buf(4)),write_XLSBShortCell(t,r)}function parse_BrtCellBool(e){var t=parse_XLSBCell(e),r=e.read_shift(1);return[t,r,"b"]}function write_BrtCellBool(e,t,r){return r==null&&(r=new_buf(9)),write_XLSBCell(t,r),r.write_shift(1,e.v?1:0),r}function parse_BrtShortBool(e){var t=parse_XLSBShortCell(e),r=e.read_shift(1);return[t,r,"b"]}function write_BrtShortBool(e,t,r){return r==null&&(r=new_buf(5)),write_XLSBShortCell(t,r),r.write_shift(1,e.v?1:0),r}function parse_BrtCellError(e){var t=parse_XLSBCell(e),r=e.read_shift(1);return[t,r,"e"]}function write_BrtCellError(e,t,r){return r==null&&(r=new_buf(9)),write_XLSBCell(t,r),r.write_shift(1,e.v),r}function parse_BrtShortError(e){var t=parse_XLSBShortCell(e),r=e.read_shift(1);return[t,r,"e"]}function write_BrtShortError(e,t,r){return r==null&&(r=new_buf(8)),write_XLSBShortCell(t,r),r.write_shift(1,e.v),r.write_shift(2,0),r.write_shift(1,0),r}function parse_BrtCellIsst(e){var t=parse_XLSBCell(e),r=e.read_shift(4);return[t,r,"s"]}function write_BrtCellIsst(e,t,r){return r==null&&(r=new_buf(12)),write_XLSBCell(t,r),r.write_shift(4,t.v),r}function parse_BrtShortIsst(e){var t=parse_XLSBShortCell(e),r=e.read_shift(4);return[t,r,"s"]}function write_BrtShortIsst(e,t,r){return r==null&&(r=new_buf(8)),write_XLSBShortCell(t,r),r.write_shift(4,t.v),r}function parse_BrtCellReal(e){var t=parse_XLSBCell(e),r=parse_Xnum(e);return[t,r,"n"]}function write_BrtCellReal(e,t,r){return r==null&&(r=new_buf(16)),write_XLSBCell(t,r),write_Xnum(e.v,r),r}function parse_BrtShortReal(e){var t=parse_XLSBShortCell(e),r=parse_Xnum(e);return[t,r,"n"]}function write_BrtShortReal(e,t,r){return r==null&&(r=new_buf(12)),write_XLSBShortCell(t,r),write_Xnum(e.v,r),r}function parse_BrtCellRk(e){var t=parse_XLSBCell(e),r=parse_RkNumber(e);return[t,r,"n"]}function write_BrtCellRk(e,t,r){return r==null&&(r=new_buf(12)),write_XLSBCell(t,r),write_RkNumber(e.v,r),r}function parse_BrtShortRk(e){var t=parse_XLSBShortCell(e),r=parse_RkNumber(e);return[t,r,"n"]}function write_BrtShortRk(e,t,r){return r==null&&(r=new_buf(8)),write_XLSBShortCell(t,r),write_RkNumber(e.v,r),r}function parse_BrtCellRString(e){var t=parse_XLSBCell(e),r=parse_RichStr(e);return[t,r,"is"]}function parse_BrtCellSt(e){var t=parse_XLSBCell(e),r=parse_XLWideString(e);return[t,r,"str"]}function write_BrtCellSt(e,t,r){return r==null&&(r=new_buf(12+4*e.v.length)),write_XLSBCell(t,r),write_XLWideString(e.v,r),r.length>r.l?r.slice(0,r.l):r}function parse_BrtShortSt(e){var t=parse_XLSBShortCell(e),r=parse_XLWideString(e);return[t,r,"str"]}function write_BrtShortSt(e,t,r){return r==null&&(r=new_buf(8+4*e.v.length)),write_XLSBShortCell(t,r),write_XLWideString(e.v,r),r.length>r.l?r.slice(0,r.l):r}function parse_BrtFmlaBool(e,t,r){var n=e.l+t,Ee=parse_XLSBCell(e);Ee.r=r["!row"];var Ce=e.read_shift(1),De=[Ee,Ce,"b"];if(r.cellFormula){e.l+=2;var Me=parse_XLSBCellParsedFormula(e,n-e.l,r);De[3]=stringify_formula(Me,null,Ee,r.supbooks,r)}else e.l=n;return De}function parse_BrtFmlaError(e,t,r){var n=e.l+t,Ee=parse_XLSBCell(e);Ee.r=r["!row"];var Ce=e.read_shift(1),De=[Ee,Ce,"e"];if(r.cellFormula){e.l+=2;var Me=parse_XLSBCellParsedFormula(e,n-e.l,r);De[3]=stringify_formula(Me,null,Ee,r.supbooks,r)}else e.l=n;return De}function parse_BrtFmlaNum(e,t,r){var n=e.l+t,Ee=parse_XLSBCell(e);Ee.r=r["!row"];var Ce=parse_Xnum(e),De=[Ee,Ce,"n"];if(r.cellFormula){e.l+=2;var Me=parse_XLSBCellParsedFormula(e,n-e.l,r);De[3]=stringify_formula(Me,null,Ee,r.supbooks,r)}else e.l=n;return De}function parse_BrtFmlaString(e,t,r){var n=e.l+t,Ee=parse_XLSBCell(e);Ee.r=r["!row"];var Ce=parse_XLWideString(e),De=[Ee,Ce,"str"];if(r.cellFormula){e.l+=2;var Me=parse_XLSBCellParsedFormula(e,n-e.l,r);De[3]=stringify_formula(Me,null,Ee,r.supbooks,r)}else e.l=n;return De}var parse_BrtMergeCell=parse_UncheckedRfX,write_BrtMergeCell=write_UncheckedRfX;function write_BrtBeginMergeCells(e,t){return t==null&&(t=new_buf(4)),t.write_shift(4,e),t}function parse_BrtHLink(e,t){var r=e.l+t,n=parse_UncheckedRfX(e),Ee=parse_XLNullableWideString(e),Ce=parse_XLWideString(e),De=parse_XLWideString(e),Me=parse_XLWideString(e);e.l=r;var ze={rfx:n,relId:Ee,loc:Ce,display:Me};return De&&(ze.Tooltip=De),ze}function write_BrtHLink(e,t){var r=new_buf(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));write_UncheckedRfX({s:decode_cell(e[0]),e:decode_cell(e[0])},r),write_RelID("rId"+t,r);var n=e[1].Target.indexOf("#"),Ee=n==-1?"":e[1].Target.slice(n+1);return write_XLWideString(Ee||"",r),write_XLWideString(e[1].Tooltip||"",r),write_XLWideString("",r),r.slice(0,r.l)}function parse_BrtPane(){}function parse_BrtArrFmla(e,t,r){var n=e.l+t,Ee=parse_RfX(e),Ce=e.read_shift(1),De=[Ee];if(De[2]=Ce,r.cellFormula){var Me=parse_XLSBArrayParsedFormula(e,n-e.l,r);De[1]=Me}else e.l=n;return De}function parse_BrtShrFmla(e,t,r){var n=e.l+t,Ee=parse_UncheckedRfX(e),Ce=[Ee];if(r.cellFormula){var De=parse_XLSBSharedParsedFormula(e,n-e.l,r);Ce[1]=De,e.l=n}else e.l=n;return Ce}function write_BrtColInfo(e,t,r){r==null&&(r=new_buf(18));var n=col_obj_w(e,t);r.write_shift(-4,e),r.write_shift(-4,e),r.write_shift(4,(n.width||10)*256),r.write_shift(4,0);var Ee=0;return t.hidden&&(Ee|=1),typeof n.width=="number"&&(Ee|=2),t.level&&(Ee|=t.level<<8),r.write_shift(2,Ee),r}var BrtMarginKeys=["left","right","top","bottom","header","footer"];function parse_BrtMargins(e){var t={};return BrtMarginKeys.forEach(function(r){t[r]=parse_Xnum(e)}),t}function write_BrtMargins(e,t){return t==null&&(t=new_buf(48)),default_margins(e),BrtMarginKeys.forEach(function(r){write_Xnum(e[r],t)}),t}function parse_BrtBeginWsView(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function write_BrtBeginWsView(e,t,r){r==null&&(r=new_buf(30));var n=924;return(((t||{}).Views||[])[0]||{}).RTL&&(n|=32),r.write_shift(2,n),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,100),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(4,0),r}function write_BrtCellIgnoreEC(e){var t=new_buf(24);return t.write_shift(4,4),t.write_shift(4,1),write_UncheckedRfX(e,t),t}function write_BrtSheetProtection(e,t){return t==null&&(t=new_buf(66)),t.write_shift(2,e.password?crypto_CreatePasswordVerifier_Method1(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(r){r[1]?t.write_shift(4,e[r[0]]!=null&&!e[r[0]]?1:0):t.write_shift(4,e[r[0]]!=null&&e[r[0]]?0:1)}),t}function parse_BrtDVal(){}function parse_BrtDVal14(){}function parse_ws_bin(e,t,r,n,Ee,Ce,De){if(!e)return e;var Me=t||{};n||(n={"!id":{}});var ze=Me.dense?[]:{},Oe,Be={s:{r:2e6,c:2e6},e:{r:0,c:0}},He=!1,Ve=!1,Xe,We,Ge,$e,Ke,rr,tr,sr,ar,hr=[];Me.biff=12,Me["!row"]=0;var pr=0,yr=!1,fr=[],Rr={},mr=Me.supbooks||Ee.supbooks||[[]];if(mr.sharedf=Rr,mr.arrayf=fr,mr.SheetNames=Ee.SheetNames||Ee.Sheets.map(function(xr){return xr.name}),!Me.supbooks&&(Me.supbooks=mr,Ee.Names))for(var wr=0;wr<Ee.Names.length;++wr)mr[0][wr+1]=Ee.Names[wr];var Fr=[],Mr=[],Hr=!1;XLSBRecordEnum[16]={n:"BrtShortReal",f:parse_BrtShortReal};var Nr;if(recordhopper(e,function(ir,_r,ur){if(!Ve)switch(ur){case 148:Oe=ir;break;case 0:Xe=ir,Me.sheetRows&&Me.sheetRows<=Xe.r&&(Ve=!0),sr=encode_row($e=Xe.r),Me["!row"]=Xe.r,(ir.hidden||ir.hpt||ir.level!=null)&&(ir.hpt&&(ir.hpx=pt2px(ir.hpt)),Mr[ir.r]=ir);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(We={t:ir[2]},ir[2]){case"n":We.v=ir[1];break;case"s":tr=strs[ir[1]],We.v=tr.t,We.r=tr.r;break;case"b":We.v=!!ir[1];break;case"e":We.v=ir[1],Me.cellText!==!1&&(We.w=BErr[We.v]);break;case"str":We.t="s",We.v=ir[1];break;case"is":We.t="s",We.v=ir[1].t;break}if((Ge=De.CellXf[ir[0].iStyleRef])&&safe_format(We,Ge.numFmtId,null,Me,Ce,De),Ke=ir[0].c==-1?Ke+1:ir[0].c,Me.dense?(ze[$e]||(ze[$e]=[]),ze[$e][Ke]=We):ze[encode_col(Ke)+sr]=We,Me.cellFormula){for(yr=!1,pr=0;pr<fr.length;++pr){var Je=fr[pr];Xe.r>=Je[0].s.r&&Xe.r<=Je[0].e.r&&Ke>=Je[0].s.c&&Ke<=Je[0].e.c&&(We.F=encode_range(Je[0]),yr=!0)}!yr&&ir.length>3&&(We.f=ir[3])}if(Be.s.r>Xe.r&&(Be.s.r=Xe.r),Be.s.c>Ke&&(Be.s.c=Ke),Be.e.r<Xe.r&&(Be.e.r=Xe.r),Be.e.c<Ke&&(Be.e.c=Ke),Me.cellDates&&Ge&&We.t=="n"&&fmt_is_date(table_fmt[Ge.numFmtId])){var nr=SSF_parse_date_code(We.v);nr&&(We.t="d",We.v=new Date(nr.y,nr.m-1,nr.d,nr.H,nr.M,nr.S,nr.u))}Nr&&(Nr.type=="XLDAPR"&&(We.D=!0),Nr=void 0);break;case 1:case 12:if(!Me.sheetStubs||He)break;We={t:"z",v:void 0},Ke=ir[0].c==-1?Ke+1:ir[0].c,Me.dense?(ze[$e]||(ze[$e]=[]),ze[$e][Ke]=We):ze[encode_col(Ke)+sr]=We,Be.s.r>Xe.r&&(Be.s.r=Xe.r),Be.s.c>Ke&&(Be.s.c=Ke),Be.e.r<Xe.r&&(Be.e.r=Xe.r),Be.e.c<Ke&&(Be.e.c=Ke),Nr&&(Nr.type=="XLDAPR"&&(We.D=!0),Nr=void 0);break;case 176:hr.push(ir);break;case 49:Nr=((Me.xlmeta||{}).Cell||[])[ir-1];break;case 494:var or=n["!id"][ir.relId];for(or?(ir.Target=or.Target,ir.loc&&(ir.Target+="#"+ir.loc),ir.Rel=or):ir.relId==""&&(ir.Target="#"+ir.loc),$e=ir.rfx.s.r;$e<=ir.rfx.e.r;++$e)for(Ke=ir.rfx.s.c;Ke<=ir.rfx.e.c;++Ke)Me.dense?(ze[$e]||(ze[$e]=[]),ze[$e][Ke]||(ze[$e][Ke]={t:"z",v:void 0}),ze[$e][Ke].l=ir):(rr=encode_cell({c:Ke,r:$e}),ze[rr]||(ze[rr]={t:"z",v:void 0}),ze[rr].l=ir);break;case 426:if(!Me.cellFormula)break;fr.push(ir),ar=Me.dense?ze[$e][Ke]:ze[encode_col(Ke)+sr],ar.f=stringify_formula(ir[1],Be,{r:Xe.r,c:Ke},mr,Me),ar.F=encode_range(ir[0]);break;case 427:if(!Me.cellFormula)break;Rr[encode_cell(ir[0].s)]=ir[1],ar=Me.dense?ze[$e][Ke]:ze[encode_col(Ke)+sr],ar.f=stringify_formula(ir[1],Be,{r:Xe.r,c:Ke},mr,Me);break;case 60:if(!Me.cellStyles)break;for(;ir.e>=ir.s;)Fr[ir.e--]={width:ir.w/256,hidden:!!(ir.flags&1),level:ir.level},Hr||(Hr=!0,find_mdw_colw(ir.w/256)),process_col(Fr[ir.e+1]);break;case 161:ze["!autofilter"]={ref:encode_range(ir)};break;case 476:ze["!margins"]=ir;break;case 147:Ee.Sheets[r]||(Ee.Sheets[r]={}),ir.name&&(Ee.Sheets[r].CodeName=ir.name),(ir.above||ir.left)&&(ze["!outline"]={above:ir.above,left:ir.left});break;case 137:Ee.Views||(Ee.Views=[{}]),Ee.Views[0]||(Ee.Views[0]={}),ir.RTL&&(Ee.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:He=!0;break;case 36:He=!1;break;case 37:He=!0;break;case 38:He=!1;break;default:if(!_r.T){if(!He||Me.WTF)throw new Error("Unexpected record 0x"+ur.toString(16))}}},Me),delete Me.supbooks,delete Me["!row"],!ze["!ref"]&&(Be.s.r<2e6||Oe&&(Oe.e.r>0||Oe.e.c>0||Oe.s.r>0||Oe.s.c>0))&&(ze["!ref"]=encode_range(Oe||Be)),Me.sheetRows&&ze["!ref"]){var Ar=safe_decode_range(ze["!ref"]);Me.sheetRows<=+Ar.e.r&&(Ar.e.r=Me.sheetRows-1,Ar.e.r>Be.e.r&&(Ar.e.r=Be.e.r),Ar.e.r<Ar.s.r&&(Ar.s.r=Ar.e.r),Ar.e.c>Be.e.c&&(Ar.e.c=Be.e.c),Ar.e.c<Ar.s.c&&(Ar.s.c=Ar.e.c),ze["!fullref"]=ze["!ref"],ze["!ref"]=encode_range(Ar))}return hr.length>0&&(ze["!merges"]=hr),Fr.length>0&&(ze["!cols"]=Fr),Mr.length>0&&(ze["!rows"]=Mr),ze}function write_ws_bin_cell(e,t,r,n,Ee,Ce,De){if(t.v===void 0)return!1;var Me="";switch(t.t){case"b":Me=t.v?"1":"0";break;case"d":t=dup(t),t.z=t.z||table_fmt[14],t.v=datenum(parseDate(t.v)),t.t="n";break;case"n":case"e":Me=""+t.v;break;default:Me=t.v;break}var ze={r,c:n};switch(ze.s=get_cell_style(Ee.cellXfs,t,Ee),t.l&&Ce["!links"].push([encode_cell(ze),t.l]),t.c&&Ce["!comments"].push([encode_cell(ze),t.c]),t.t){case"s":case"str":return Ee.bookSST?(Me=get_sst_id(Ee.Strings,t.v,Ee.revStrings),ze.t="s",ze.v=Me,De?write_record(e,18,write_BrtShortIsst(t,ze)):write_record(e,7,write_BrtCellIsst(t,ze))):(ze.t="str",De?write_record(e,17,write_BrtShortSt(t,ze)):write_record(e,6,write_BrtCellSt(t,ze))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?De?write_record(e,13,write_BrtShortRk(t,ze)):write_record(e,2,write_BrtCellRk(t,ze)):De?write_record(e,16,write_BrtShortReal(t,ze)):write_record(e,5,write_BrtCellReal(t,ze)),!0;case"b":return ze.t="b",De?write_record(e,15,write_BrtShortBool(t,ze)):write_record(e,4,write_BrtCellBool(t,ze)),!0;case"e":return ze.t="e",De?write_record(e,14,write_BrtShortError(t,ze)):write_record(e,3,write_BrtCellError(t,ze)),!0}return De?write_record(e,12,write_BrtShortBlank(t,ze)):write_record(e,1,write_BrtCellBlank(t,ze)),!0}function write_CELLTABLE(e,t,r,n){var Ee=safe_decode_range(t["!ref"]||"A1"),Ce,De="",Me=[];write_record(e,145);var ze=Array.isArray(t),Oe=Ee.e.r;t["!rows"]&&(Oe=Math.max(Ee.e.r,t["!rows"].length-1));for(var Be=Ee.s.r;Be<=Oe;++Be){De=encode_row(Be),write_row_header(e,t,Ee,Be);var He=!1;if(Be<=Ee.e.r)for(var Ve=Ee.s.c;Ve<=Ee.e.c;++Ve){Be===Ee.s.r&&(Me[Ve]=encode_col(Ve)),Ce=Me[Ve]+De;var Xe=ze?(t[Be]||[])[Ve]:t[Ce];if(!Xe){He=!1;continue}He=write_ws_bin_cell(e,Xe,Be,Ve,n,t,He)}}write_record(e,146)}function write_MERGECELLS(e,t){!t||!t["!merges"]||(write_record(e,177,write_BrtBeginMergeCells(t["!merges"].length)),t["!merges"].forEach(function(r){write_record(e,176,write_BrtMergeCell(r))}),write_record(e,178))}function write_COLINFOS(e,t){!t||!t["!cols"]||(write_record(e,390),t["!cols"].forEach(function(r,n){r&&write_record(e,60,write_BrtColInfo(n,r))}),write_record(e,391))}function write_IGNOREECS(e,t){!t||!t["!ref"]||(write_record(e,648),write_record(e,649,write_BrtCellIgnoreEC(safe_decode_range(t["!ref"]))),write_record(e,650))}function write_HLINKS(e,t,r){t["!links"].forEach(function(n){if(n[1].Target){var Ee=add_rels(r,-1,n[1].Target.replace(/#.*$/,""),RELS.HLINK);write_record(e,494,write_BrtHLink(n,Ee))}}),delete t["!links"]}function write_LEGACYDRAWING(e,t,r,n){if(t["!comments"].length>0){var Ee=add_rels(n,-1,"../drawings/vmlDrawing"+(r+1)+".vml",RELS.VML);write_record(e,551,write_RelID("rId"+Ee)),t["!legacy"]=Ee}}function write_AUTOFILTER(e,t,r,n){if(t["!autofilter"]){var Ee=t["!autofilter"],Ce=typeof Ee.ref=="string"?Ee.ref:encode_range(Ee.ref);r.Workbook||(r.Workbook={Sheets:[]}),r.Workbook.Names||(r.Workbook.Names=[]);var De=r.Workbook.Names,Me=decode_range(Ce);Me.s.r==Me.e.r&&(Me.e.r=decode_range(t["!ref"]).e.r,Ce=encode_range(Me));for(var ze=0;ze<De.length;++ze){var Oe=De[ze];if(Oe.Name=="_xlnm._FilterDatabase"&&Oe.Sheet==n){Oe.Ref="'"+r.SheetNames[n]+"'!"+Ce;break}}ze==De.length&&De.push({Name:"_xlnm._FilterDatabase",Sheet:n,Ref:"'"+r.SheetNames[n]+"'!"+Ce}),write_record(e,161,write_UncheckedRfX(safe_decode_range(Ce))),write_record(e,162)}}function write_WSVIEWS2(e,t,r){write_record(e,133),write_record(e,137,write_BrtBeginWsView(t,r)),write_record(e,138),write_record(e,134)}function write_SHEETPROTECT(e,t){t["!protect"]&&write_record(e,535,write_BrtSheetProtection(t["!protect"]))}function write_ws_bin(e,t,r,n){var Ee=buf_array(),Ce=r.SheetNames[e],De=r.Sheets[Ce]||{},Me=Ce;try{r&&r.Workbook&&(Me=r.Workbook.Sheets[e].CodeName||Me)}catch{}var ze=safe_decode_range(De["!ref"]||"A1");if(ze.e.c>16383||ze.e.r>1048575){if(t.WTF)throw new Error("Range "+(De["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");ze.e.c=Math.min(ze.e.c,16383),ze.e.r=Math.min(ze.e.c,1048575)}return De["!links"]=[],De["!comments"]=[],write_record(Ee,129),(r.vbaraw||De["!outline"])&&write_record(Ee,147,write_BrtWsProp(Me,De["!outline"])),write_record(Ee,148,write_BrtWsDim(ze)),write_WSVIEWS2(Ee,De,r.Workbook),write_COLINFOS(Ee,De),write_CELLTABLE(Ee,De,e,t),write_SHEETPROTECT(Ee,De),write_AUTOFILTER(Ee,De,r,e),write_MERGECELLS(Ee,De),write_HLINKS(Ee,De,n),De["!margins"]&&write_record(Ee,476,write_BrtMargins(De["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&write_IGNOREECS(Ee,De),write_LEGACYDRAWING(Ee,De,e,n),write_record(Ee,130),Ee.end()}function parse_Cache(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(Ce){var De=Ce.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);De&&(t[+De[1]]=r?+De[2]:De[2])});var Ee=unescapexml((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(Ce){n=Ce.replace(/<.*?>/g,"")}),[t,Ee,n]}function parse_chart(e,t,r,n,Ee,Ce){var De=Ce||{"!type":"chart"};if(!e)return Ce;var Me=0,ze=0,Oe="A",Be={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(He){var Ve=parse_Cache(He);Be.s.r=Be.s.c=0,Be.e.c=Me,Oe=encode_col(Me),Ve[0].forEach(function(Xe,We){De[Oe+encode_row(We)]={t:"n",v:Xe,z:Ve[1]},ze=We}),Be.e.r<ze&&(Be.e.r=ze),++Me}),Me>0&&(De["!ref"]=encode_range(Be)),De}function parse_cs_xml(e,t,r,n,Ee){if(!e)return e;n||(n={"!id":{}});var Ce={"!type":"chart","!drawel":null,"!rel":""},De,Me=e.match(sheetprregex);return Me&&parse_ws_xml_sheetpr(Me[0],Ce,Ee,r),(De=e.match(/drawing r:id="(.*?)"/))&&(Ce["!rel"]=De[1]),n["!id"][Ce["!rel"]]&&(Ce["!drawel"]=n["!id"][Ce["!rel"]]),Ce}function parse_BrtCsProp(e,t){e.l+=10;var r=parse_XLWideString(e);return{name:r}}function parse_cs_bin(e,t,r,n,Ee){if(!e)return e;n||(n={"!id":{}});var Ce={"!type":"chart","!drawel":null,"!rel":""},De=!1;return recordhopper(e,function(ze,Oe,Be){switch(Be){case 550:Ce["!rel"]=ze;break;case 651:Ee.Sheets[r]||(Ee.Sheets[r]={}),ze.name&&(Ee.Sheets[r].CodeName=ze.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:De=!0;break;case 36:De=!1;break;case 37:break;case 38:break;default:if(!(Oe.T>0)){if(!(Oe.T<0)){if(!De||t.WTF)throw new Error("Unexpected record 0x"+Be.toString(16))}}}},t),n["!id"][Ce["!rel"]]&&(Ce["!drawel"]=n["!id"][Ce["!rel"]]),Ce}var WBPropsDef=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],WBViewDef=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],SheetDef=[],CalcPrDef=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function push_defaults_array(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],Ee=0;Ee!=t.length;++Ee){var Ce=t[Ee];if(n[Ce[0]]==null)n[Ce[0]]=Ce[1];else switch(Ce[2]){case"bool":typeof n[Ce[0]]=="string"&&(n[Ce[0]]=parsexmlbool(n[Ce[0]]));break;case"int":typeof n[Ce[0]]=="string"&&(n[Ce[0]]=parseInt(n[Ce[0]],10));break}}}function push_defaults(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=parsexmlbool(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function parse_wb_defaults(e){push_defaults(e.WBProps,WBPropsDef),push_defaults(e.CalcPr,CalcPrDef),push_defaults_array(e.WBView,WBViewDef),push_defaults_array(e.Sheets,SheetDef),_ssfopts.date1904=parsexmlbool(e.WBProps.date1904)}function safe1904(e){return!e.Workbook||!e.Workbook.WBProps?"false":parsexmlbool(e.Workbook.WBProps.date1904)?"true":"false"}var badchars="][*?/\\".split("");function check_ws_name(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return badchars.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}function check_wb_names(e,t,r){e.forEach(function(n,Ee){check_ws_name(n);for(var Ce=0;Ce<Ee;++Ce)if(n==e[Ce])throw new Error("Duplicate Sheet Name: "+n);if(r){var De=t&&t[Ee]&&t[Ee].CodeName||n;if(De.charCodeAt(0)==95&&De.length>22)throw new Error("Bad Code Name: Worksheet"+De)}})}function check_wb(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];check_wb_names(e.SheetNames,t,!!e.vbaraw);for(var r=0;r<e.SheetNames.length;++r)check_ws(e.Sheets[e.SheetNames[r]],e.SheetNames[r],r)}var wbnsregex=/<\w+:workbook/;function parse_wb_xml(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,Ee="xmlns",Ce={},De=0;if(e.replace(tagregex,function(ze,Oe){var Be=parsexmltag(ze);switch(strip_ns(Be[0])){case"<?xml":break;case"<workbook":ze.match(wbnsregex)&&(Ee="xmlns"+ze.match(/<(\w+):/)[1]),r.xmlns=Be[Ee];break;case"</workbook>":break;case"<fileVersion":delete Be[0],r.AppVersion=Be;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":WBPropsDef.forEach(function(He){if(Be[He[0]]!=null)switch(He[2]){case"bool":r.WBProps[He[0]]=parsexmlbool(Be[He[0]]);break;case"int":r.WBProps[He[0]]=parseInt(Be[He[0]],10);break;default:r.WBProps[He[0]]=Be[He[0]]}}),Be.codeName&&(r.WBProps.CodeName=utf8read(Be.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete Be[0],r.WBView.push(Be);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(Be.state){case"hidden":Be.Hidden=1;break;case"veryHidden":Be.Hidden=2;break;default:Be.Hidden=0}delete Be.state,Be.name=unescapexml(utf8read(Be.name)),delete Be[0],r.Sheets.push(Be);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":Ce={},Ce.Name=utf8read(Be.name),Be.comment&&(Ce.Comment=Be.comment),Be.localSheetId&&(Ce.Sheet=+Be.localSheetId),parsexmlbool(Be.hidden||"0")&&(Ce.Hidden=!0),De=Oe+ze.length;break;case"</definedName>":Ce.Ref=unescapexml(utf8read(e.slice(De,Oe))),r.Names.push(Ce);break;case"<definedName/>":break;case"<calcPr":delete Be[0],r.CalcPr=Be;break;case"<calcPr/>":delete Be[0],r.CalcPr=Be;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+Be[0]+" in workbook")}return ze}),XMLNS_main.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return parse_wb_defaults(r),r}function write_wb_xml(e){var t=[XML_HEADER];t[t.length]=writextag("workbook",null,{xmlns:XMLNS_main[0],"xmlns:r":XMLNS.r});var r=e.Workbook&&(e.Workbook.Names||[]).length>0,n={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(WBPropsDef.forEach(function(Me){e.Workbook.WBProps[Me[0]]!=null&&e.Workbook.WBProps[Me[0]]!=Me[1]&&(n[Me[0]]=e.Workbook.WBProps[Me[0]])}),e.Workbook.WBProps.CodeName&&(n.codeName=e.Workbook.WBProps.CodeName,delete n.CodeName)),t[t.length]=writextag("workbookPr",null,n);var Ee=e.Workbook&&e.Workbook.Sheets||[],Ce=0;if(Ee&&Ee[0]&&Ee[0].Hidden){for(t[t.length]="<bookViews>",Ce=0;Ce!=e.SheetNames.length&&!(!Ee[Ce]||!Ee[Ce].Hidden);++Ce);Ce==e.SheetNames.length&&(Ce=0),t[t.length]='<workbookView firstSheet="'+Ce+'" activeTab="'+Ce+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",Ce=0;Ce!=e.SheetNames.length;++Ce){var De={name:escapexml(e.SheetNames[Ce].slice(0,31))};if(De.sheetId=""+(Ce+1),De["r:id"]="rId"+(Ce+1),Ee[Ce])switch(Ee[Ce].Hidden){case 1:De.state="hidden";break;case 2:De.state="veryHidden";break}t[t.length]=writextag("sheet",null,De)}return t[t.length]="</sheets>",r&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(Me){var ze={name:Me.Name};Me.Comment&&(ze.comment=Me.Comment),Me.Sheet!=null&&(ze.localSheetId=""+Me.Sheet),Me.Hidden&&(ze.hidden="1"),Me.Ref&&(t[t.length]=writextag("definedName",escapexml(Me.Ref),ze))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function parse_BrtBundleSh(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=parse_RelID(e),r.name=parse_XLWideString(e),r}function write_BrtBundleSh(e,t){return t||(t=new_buf(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),write_RelID(e.strRelID,t),write_XLWideString(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function parse_BrtWbProp(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var Ee=t>8?parse_XLWideString(e):"";return Ee.length>0&&(r.CodeName=Ee),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function write_BrtWbProp(e,t){t||(t=new_buf(72));var r=0;return e&&e.filterPrivacy&&(r|=8),t.write_shift(4,r),t.write_shift(4,0),write_XLSBCodeName(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function parse_BrtFRTArchID$(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function parse_BrtName(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var Ee=e.read_shift(4),Ce=parse_XLNameWideString(e),De=parse_XLSBNameParsedFormula(e,0,r),Me=parse_XLNullableWideString(e);e.l=n;var ze={Name:Ce,Ptg:De};return Ee<268435455&&(ze.Sheet=Ee),Me&&(ze.Comment=Me),ze}function parse_wb_bin(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],Ee=!1;t||(t={}),t.biff=12;var Ce=[],De=[[]];return De.SheetNames=[],De.XTI=[],XLSBRecordEnum[16]={n:"BrtFRTArchID$",f:parse_BrtFRTArchID$},recordhopper(e,function(ze,Oe,Be){switch(Be){case 156:De.SheetNames.push(ze.name),r.Sheets.push(ze);break;case 153:r.WBProps=ze;break;case 39:ze.Sheet!=null&&(t.SID=ze.Sheet),ze.Ref=stringify_formula(ze.Ptg,null,null,De,t),delete t.SID,delete ze.Ptg,Ce.push(ze);break;case 1036:break;case 357:case 358:case 355:case 667:De[0].length?De.push([Be,ze]):De[0]=[Be,ze],De[De.length-1].XTI=[];break;case 362:De.length===0&&(De[0]=[],De[0].XTI=[]),De[De.length-1].XTI=De[De.length-1].XTI.concat(ze),De.XTI=De.XTI.concat(ze);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(Be),Ee=!0;break;case 36:n.pop(),Ee=!1;break;case 37:n.push(Be),Ee=!0;break;case 38:n.pop(),Ee=!1;break;case 16:break;default:if(!Oe.T){if(!Ee||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+Be.toString(16))}}},t),parse_wb_defaults(r),r.Names=Ce,r.supbooks=De,r}function write_BUNDLESHS(e,t){write_record(e,143);for(var r=0;r!=t.SheetNames.length;++r){var n=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[r]&&t.Workbook.Sheets[r].Hidden||0,Ee={Hidden:n,iTabID:r+1,strRelID:"rId"+(r+1),name:t.SheetNames[r]};write_record(e,156,write_BrtBundleSh(Ee))}write_record(e,144)}function write_BrtFileVersion(e,t){t||(t=new_buf(127));for(var r=0;r!=4;++r)t.write_shift(4,0);return write_XLWideString("SheetJS",t),write_XLWideString(XLSX.version,t),write_XLWideString(XLSX.version,t),write_XLWideString("7262",t),t.length>t.l?t.slice(0,t.l):t}function write_BrtBookView(e,t){t||(t=new_buf(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var r=120;return t.write_shift(1,r),t.length>t.l?t.slice(0,t.l):t}function write_BOOKVIEWS(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var r=t.Workbook.Sheets,n=0,Ee=-1,Ce=-1;n<r.length;++n)!r[n]||!r[n].Hidden&&Ee==-1?Ee=n:r[n].Hidden==1&&Ce==-1&&(Ce=n);Ce>Ee||(write_record(e,135),write_record(e,158,write_BrtBookView(Ee)),write_record(e,136))}}function write_wb_bin(e,t){var r=buf_array();return write_record(r,131),write_record(r,128,write_BrtFileVersion()),write_record(r,153,write_BrtWbProp(e.Workbook&&e.Workbook.WBProps||null)),write_BOOKVIEWS(r,e),write_BUNDLESHS(r,e),write_record(r,132),r.end()}function parse_wb(e,t,r){return t.slice(-4)===".bin"?parse_wb_bin(e,r):parse_wb_xml(e,r)}function parse_ws(e,t,r,n,Ee,Ce,De,Me){return t.slice(-4)===".bin"?parse_ws_bin(e,n,r,Ee,Ce,De,Me):parse_ws_xml(e,n,r,Ee,Ce,De,Me)}function parse_cs(e,t,r,n,Ee,Ce,De,Me){return t.slice(-4)===".bin"?parse_cs_bin(e,n,r,Ee,Ce):parse_cs_xml(e,n,r,Ee,Ce)}function parse_ms(e,t,r,n,Ee,Ce,De,Me){return t.slice(-4)===".bin"?parse_ms_bin():parse_ms_xml()}function parse_ds(e,t,r,n,Ee,Ce,De,Me){return t.slice(-4)===".bin"?parse_ds_bin():parse_ds_xml()}function parse_sty(e,t,r,n){return t.slice(-4)===".bin"?parse_sty_bin(e,r,n):parse_sty_xml(e,r,n)}function parse_theme(e,t,r){return parse_theme_xml(e,r)}function parse_sst(e,t,r){return t.slice(-4)===".bin"?parse_sst_bin(e,r):parse_sst_xml(e,r)}function parse_cmnt(e,t,r){return t.slice(-4)===".bin"?parse_comments_bin(e,r):parse_comments_xml(e,r)}function parse_cc(e,t,r){return t.slice(-4)===".bin"?parse_cc_bin(e):parse_cc_xml(e)}function parse_xlink(e,t,r,n){return r.slice(-4)===".bin"?parse_xlink_bin(e,t,r,n):void 0}function parse_xlmeta(e,t,r){return t.slice(-4)===".bin"?parse_xlmeta_bin(e,t,r):parse_xlmeta_xml(e,t,r)}function write_wb(e,t,r){return(t.slice(-4)===".bin"?write_wb_bin:write_wb_xml)(e)}function write_ws(e,t,r,n,Ee){return(t.slice(-4)===".bin"?write_ws_bin:write_ws_xml)(e,r,n,Ee)}function write_sty(e,t,r){return(t.slice(-4)===".bin"?write_sty_bin:write_sty_xml)(e,r)}function write_sst(e,t,r){return(t.slice(-4)===".bin"?write_sst_bin:write_sst_xml)(e,r)}function write_cmnt(e,t,r){return(t.slice(-4)===".bin"?write_comments_bin:write_comments_xml)(e)}function write_xlmeta(e){return(e.slice(-4)===".bin"?write_xlmeta_bin:write_xlmeta_xml)()}var attregexg2=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,attregex2=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function xlml_parsexmltag(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var Ee=e.match(attregexg2),Ce,De,Me,ze;if(Ee)for(ze=0;ze!=Ee.length;++ze)Ce=Ee[ze].match(attregex2),(De=Ce[1].indexOf(":"))===-1?n[Ce[1]]=Ce[2].slice(1,Ce[2].length-1):(Ce[1].slice(0,6)==="xmlns:"?Me="xmlns"+Ce[1].slice(6):Me=Ce[1].slice(De+1),n[Me]=Ce[2].slice(1,Ce[2].length-1));return n}function xlml_parsexmltagobj(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(attregexg2),Ee,Ce,De,Me;if(n)for(Me=0;Me!=n.length;++Me)Ee=n[Me].match(attregex2),(Ce=Ee[1].indexOf(":"))===-1?r[Ee[1]]=Ee[2].slice(1,Ee[2].length-1):(Ee[1].slice(0,6)==="xmlns:"?De="xmlns"+Ee[1].slice(6):De=Ee[1].slice(Ce+1),r[De]=Ee[2].slice(1,Ee[2].length-1));return r}var XLMLFormatMap;function xlml_format(e,t){var r=XLMLFormatMap[e]||unescapexml(e);return r==="General"?SSF_general(t):SSF_format(r,t)}function xlml_set_custprop(e,t,r,n){var Ee=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":Ee=parsexmlbool(n);break;case"i2":case"int":Ee=parseInt(n,10);break;case"r4":case"float":Ee=parseFloat(n);break;case"date":case"dateTime.tz":Ee=parseDate(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[unescapexml(t)]=Ee}function safe_format_xlml(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||BErr[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v):e.w=SSF_general(e.v):e.w=xlml_format(t||"General",e.v)}catch(Ce){if(r.WTF)throw Ce}try{var n=XLMLFormatMap[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&fmt_is_date(n)){var Ee=SSF_parse_date_code(e.v);Ee&&(e.t="d",e.v=new Date(Ee.y,Ee.m-1,Ee.d,Ee.H,Ee.M,Ee.S,Ee.u))}}catch(Ce){if(r.WTF)throw Ce}}}function process_style_xlml(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=XLMLPatternTypeMap[n.Pattern]||n.Pattern)}e[t.ID]=t}function parse_xlml_data(e,t,r,n,Ee,Ce,De,Me,ze,Oe){var Be="General",He=n.StyleID,Ve={};Oe=Oe||{};var Xe=[],We=0;for(He===void 0&&Me&&(He=Me.StyleID),He===void 0&&De&&(He=De.StyleID);Ce[He]!==void 0&&(Ce[He].nf&&(Be=Ce[He].nf),Ce[He].Interior&&Xe.push(Ce[He].Interior),!!Ce[He].Parent);)He=Ce[He].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=parsexmlbool(e);break;case"String":n.t="s",n.r=xlml_fixstr(unescapexml(e)),n.v=e.indexOf("<")>-1?unescapexml(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(parseDate(e)-new Date(Date.UTC(1899,11,30)))/(1440*60*1e3),n.v!==n.v?n.v=unescapexml(e):n.v<60&&(n.v=n.v-1),(!Be||Be=="General")&&(Be="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=RBErr[e],Oe.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=xlml_fixstr(t||e));break}if(safe_format_xlml(n,Be,Oe),Oe.cellFormula!==!1)if(n.Formula){var Ge=unescapexml(n.Formula);Ge.charCodeAt(0)==61&&(Ge=Ge.slice(1)),n.f=rc_to_a1(Ge,Ee),delete n.Formula,n.ArrayRange=="RC"?n.F=rc_to_a1("RC:RC",Ee):n.ArrayRange&&(n.F=rc_to_a1(n.ArrayRange,Ee),ze.push([safe_decode_range(n.F),n.F]))}else for(We=0;We<ze.length;++We)Ee.r>=ze[We][0].s.r&&Ee.r<=ze[We][0].e.r&&Ee.c>=ze[We][0].s.c&&Ee.c<=ze[We][0].e.c&&(n.F=ze[We][1]);Oe.cellStyles&&(Xe.forEach(function($e){!Ve.patternType&&$e.patternType&&(Ve.patternType=$e.patternType)}),n.s=Ve),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function xlml_clean_comment(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function parse_xlml_xml(e,t){var r=t||{};make_ssf();var n=debom(xlml_normalize(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=utf8read(n));var Ee=n.slice(0,1024).toLowerCase(),Ce=!1;if(Ee=Ee.replace(/".*?"/g,""),(Ee.indexOf(">")&1023)>Math.min(Ee.indexOf(",")&1023,Ee.indexOf(";")&1023)){var De=dup(r);return De.type="string",PRN.to_workbook(n,De)}if(Ee.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(oa){Ee.indexOf("<"+oa)>=0&&(Ce=!0)}),Ce)return html_to_workbook(n,r);XLMLFormatMap={"General Number":"General","General Date":table_fmt[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":table_fmt[15],"Short Date":table_fmt[14],"Long Time":table_fmt[19],"Medium Time":table_fmt[18],"Short Time":table_fmt[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:table_fmt[2],Standard:table_fmt[4],Percent:table_fmt[10],Scientific:table_fmt[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var Me,ze=[],Oe,Be={},He=[],Ve=r.dense?[]:{},Xe="",We={},Ge={},$e=xlml_parsexmltag('<Data ss:Type="String">'),Ke=0,rr=0,tr=0,sr={s:{r:2e6,c:2e6},e:{r:0,c:0}},ar={},hr={},pr="",yr=0,fr=[],Rr={},mr={},wr=0,Fr=[],Mr=[],Hr={},Nr=[],Ar,xr=!1,ir=[],_r=[],ur={},Je=0,nr=0,or={Sheets:[],WBProps:{date1904:!1}},lr={};xlmlregex.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var St="";Me=xlmlregex.exec(n);)switch(Me[3]=(St=Me[3]).toLowerCase()){case"data":if(St=="data"){if(Me[1]==="/"){if((Oe=ze.pop())[0]!==Me[3])throw new Error("Bad state: "+Oe.join("|"))}else Me[0].charAt(Me[0].length-2)!=="/"&&ze.push([Me[3],!0]);break}if(ze[ze.length-1][1])break;Me[1]==="/"?parse_xlml_data(n.slice(Ke,Me.index),pr,$e,ze[ze.length-1][0]=="comment"?Hr:We,{c:rr,r:tr},ar,Nr[rr],Ge,ir,r):(pr="",$e=xlml_parsexmltag(Me[0]),Ke=Me.index+Me[0].length);break;case"cell":if(Me[1]==="/")if(Mr.length>0&&(We.c=Mr),(!r.sheetRows||r.sheetRows>tr)&&We.v!==void 0&&(r.dense?(Ve[tr]||(Ve[tr]=[]),Ve[tr][rr]=We):Ve[encode_col(rr)+encode_row(tr)]=We),We.HRef&&(We.l={Target:unescapexml(We.HRef)},We.HRefScreenTip&&(We.l.Tooltip=We.HRefScreenTip),delete We.HRef,delete We.HRefScreenTip),(We.MergeAcross||We.MergeDown)&&(Je=rr+(parseInt(We.MergeAcross,10)|0),nr=tr+(parseInt(We.MergeDown,10)|0),fr.push({s:{c:rr,r:tr},e:{c:Je,r:nr}})),!r.sheetStubs)We.MergeAcross?rr=Je+1:++rr;else if(We.MergeAcross||We.MergeDown){for(var dr=rr;dr<=Je;++dr)for(var vr=tr;vr<=nr;++vr)(dr>rr||vr>tr)&&(r.dense?(Ve[vr]||(Ve[vr]=[]),Ve[vr][dr]={t:"z"}):Ve[encode_col(dr)+encode_row(vr)]={t:"z"});rr=Je+1}else++rr;else We=xlml_parsexmltagobj(Me[0]),We.Index&&(rr=+We.Index-1),rr<sr.s.c&&(sr.s.c=rr),rr>sr.e.c&&(sr.e.c=rr),Me[0].slice(-2)==="/>"&&++rr,Mr=[];break;case"row":Me[1]==="/"||Me[0].slice(-2)==="/>"?(tr<sr.s.r&&(sr.s.r=tr),tr>sr.e.r&&(sr.e.r=tr),Me[0].slice(-2)==="/>"&&(Ge=xlml_parsexmltag(Me[0]),Ge.Index&&(tr=+Ge.Index-1)),rr=0,++tr):(Ge=xlml_parsexmltag(Me[0]),Ge.Index&&(tr=+Ge.Index-1),ur={},(Ge.AutoFitHeight=="0"||Ge.Height)&&(ur.hpx=parseInt(Ge.Height,10),ur.hpt=px2pt(ur.hpx),_r[tr]=ur),Ge.Hidden=="1"&&(ur.hidden=!0,_r[tr]=ur));break;case"worksheet":if(Me[1]==="/"){if((Oe=ze.pop())[0]!==Me[3])throw new Error("Bad state: "+Oe.join("|"));He.push(Xe),sr.s.r<=sr.e.r&&sr.s.c<=sr.e.c&&(Ve["!ref"]=encode_range(sr),r.sheetRows&&r.sheetRows<=sr.e.r&&(Ve["!fullref"]=Ve["!ref"],sr.e.r=r.sheetRows-1,Ve["!ref"]=encode_range(sr))),fr.length&&(Ve["!merges"]=fr),Nr.length>0&&(Ve["!cols"]=Nr),_r.length>0&&(Ve["!rows"]=_r),Be[Xe]=Ve}else sr={s:{r:2e6,c:2e6},e:{r:0,c:0}},tr=rr=0,ze.push([Me[3],!1]),Oe=xlml_parsexmltag(Me[0]),Xe=unescapexml(Oe.Name),Ve=r.dense?[]:{},fr=[],ir=[],_r=[],lr={name:Xe,Hidden:0},or.Sheets.push(lr);break;case"table":if(Me[1]==="/"){if((Oe=ze.pop())[0]!==Me[3])throw new Error("Bad state: "+Oe.join("|"))}else{if(Me[0].slice(-2)=="/>")break;ze.push([Me[3],!1]),Nr=[],xr=!1}break;case"style":Me[1]==="/"?process_style_xlml(ar,hr,r):hr=xlml_parsexmltag(Me[0]);break;case"numberformat":hr.nf=unescapexml(xlml_parsexmltag(Me[0]).Format||"General"),XLMLFormatMap[hr.nf]&&(hr.nf=XLMLFormatMap[hr.nf]);for(var br=0;br!=392&&table_fmt[br]!=hr.nf;++br);if(br==392){for(br=57;br!=392;++br)if(table_fmt[br]==null){SSF_load(hr.nf,br);break}}break;case"column":if(ze[ze.length-1][0]!=="table")break;if(Ar=xlml_parsexmltag(Me[0]),Ar.Hidden&&(Ar.hidden=!0,delete Ar.Hidden),Ar.Width&&(Ar.wpx=parseInt(Ar.Width,10)),!xr&&Ar.wpx>10){xr=!0,MDW=DEF_MDW;for(var kr=0;kr<Nr.length;++kr)Nr[kr]&&process_col(Nr[kr])}xr&&process_col(Ar),Nr[Ar.Index-1||Nr.length]=Ar;for(var Pr=0;Pr<+Ar.Span;++Pr)Nr[Nr.length]=dup(Ar);break;case"namedrange":if(Me[1]==="/")break;or.Names||(or.Names=[]);var Er=parsexmltag(Me[0]),Zr={Name:Er.Name,Ref:rc_to_a1(Er.RefersTo.slice(1),{r:0,c:0})};or.Sheets.length>0&&(Zr.Sheet=or.Sheets.length-1),or.Names.push(Zr);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(Me[0].slice(-2)==="/>")break;Me[1]==="/"?pr+=n.slice(yr,Me.index):yr=Me.index+Me[0].length;break;case"interior":if(!r.cellStyles)break;hr.Interior=xlml_parsexmltag(Me[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(Me[0].slice(-2)==="/>")break;Me[1]==="/"?xlml_set_prop(Rr,St,n.slice(wr,Me.index)):wr=Me.index+Me[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(Me[1]==="/"){if((Oe=ze.pop())[0]!==Me[3])throw new Error("Bad state: "+Oe.join("|"))}else ze.push([Me[3],!1]);break;case"comment":if(Me[1]==="/"){if((Oe=ze.pop())[0]!==Me[3])throw new Error("Bad state: "+Oe.join("|"));xlml_clean_comment(Hr),Mr.push(Hr)}else ze.push([Me[3],!1]),Oe=xlml_parsexmltag(Me[0]),Hr={a:Oe.Author};break;case"autofilter":if(Me[1]==="/"){if((Oe=ze.pop())[0]!==Me[3])throw new Error("Bad state: "+Oe.join("|"))}else if(Me[0].charAt(Me[0].length-2)!=="/"){var ua=xlml_parsexmltag(Me[0]);Ve["!autofilter"]={ref:rc_to_a1(ua.Range).replace(/\$/g,"")},ze.push([Me[3],!0])}break;case"name":break;case"datavalidation":if(Me[1]==="/"){if((Oe=ze.pop())[0]!==Me[3])throw new Error("Bad state: "+Oe.join("|"))}else Me[0].charAt(Me[0].length-2)!=="/"&&ze.push([Me[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(Me[1]==="/"){if((Oe=ze.pop())[0]!==Me[3])throw new Error("Bad state: "+Oe.join("|"))}else Me[0].charAt(Me[0].length-2)!=="/"&&ze.push([Me[3],!0]);break;case"null":break;default:if(ze.length==0&&Me[3]=="document"||ze.length==0&&Me[3]=="uof")return parse_fods(n,r);var Cr=!0;switch(ze[ze.length-1][0]){case"officedocumentsettings":switch(Me[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:Cr=!1}break;case"componentoptions":switch(Me[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:Cr=!1}break;case"excelworkbook":switch(Me[3]){case"date1904":or.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:Cr=!1}break;case"workbookoptions":switch(Me[3]){case"owcversion":break;case"height":break;case"width":break;default:Cr=!1}break;case"worksheetoptions":switch(Me[3]){case"visible":if(Me[0].slice(-2)!=="/>")if(Me[1]==="/")switch(n.slice(wr,Me.index)){case"SheetHidden":lr.Hidden=1;break;case"SheetVeryHidden":lr.Hidden=2;break}else wr=Me.index+Me[0].length;break;case"header":Ve["!margins"]||default_margins(Ve["!margins"]={},"xlml"),isNaN(+parsexmltag(Me[0]).Margin)||(Ve["!margins"].header=+parsexmltag(Me[0]).Margin);break;case"footer":Ve["!margins"]||default_margins(Ve["!margins"]={},"xlml"),isNaN(+parsexmltag(Me[0]).Margin)||(Ve["!margins"].footer=+parsexmltag(Me[0]).Margin);break;case"pagemargins":var Jr=parsexmltag(Me[0]);Ve["!margins"]||default_margins(Ve["!margins"]={},"xlml"),isNaN(+Jr.Top)||(Ve["!margins"].top=+Jr.Top),isNaN(+Jr.Left)||(Ve["!margins"].left=+Jr.Left),isNaN(+Jr.Right)||(Ve["!margins"].right=+Jr.Right),isNaN(+Jr.Bottom)||(Ve["!margins"].bottom=+Jr.Bottom);break;case"displayrighttoleft":or.Views||(or.Views=[]),or.Views[0]||(or.Views[0]={}),or.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":Ve["!outline"]||(Ve["!outline"]={}),Ve["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":Ve["!outline"]||(Ve["!outline"]={}),Ve["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:Cr=!1}break;case"pivottable":case"pivotcache":switch(Me[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:Cr=!1}break;case"pagebreaks":switch(Me[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:Cr=!1}break;case"autofilter":switch(Me[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:Cr=!1}break;case"querytable":switch(Me[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:Cr=!1}break;case"datavalidation":switch(Me[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:Cr=!1}break;case"sorting":case"conditionalformatting":switch(Me[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:Cr=!1}break;case"mapinfo":case"schema":case"data":switch(Me[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:Cr=!1}break;case"smarttags":break;default:Cr=!1;break}if(Cr||Me[3].match(/!\[CDATA/))break;if(!ze[ze.length-1][1])throw"Unrecognized tag: "+Me[3]+"|"+ze.join("|");if(ze[ze.length-1][0]==="customdocumentproperties"){if(Me[0].slice(-2)==="/>")break;Me[1]==="/"?xlml_set_custprop(mr,St,Fr,n.slice(wr,Me.index)):(Fr=Me,wr=Me.index+Me[0].length);break}if(r.WTF)throw"Unrecognized tag: "+Me[3]+"|"+ze.join("|")}var Qr={};return!r.bookSheets&&!r.bookProps&&(Qr.Sheets=Be),Qr.SheetNames=He,Qr.Workbook=or,Qr.SSF=dup(table_fmt),Qr.Props=Rr,Qr.Custprops=mr,Qr}function parse_xlml(e,t){switch(fix_read_opts(t=t||{}),t.type||"base64"){case"base64":return parse_xlml_xml(Base64_decode(e),t);case"binary":case"buffer":case"file":return parse_xlml_xml(e,t);case"array":return parse_xlml_xml(a2s(e),t)}}function write_props_xlml(e,t){var r=[];return e.Props&&r.push(xlml_write_docprops(e.Props,t)),e.Custprops&&r.push(xlml_write_custprops(e.Props,e.Custprops)),r.join("")}function write_wb_xlml(){return""}function write_sty_xlml(e,t){var r=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(n,Ee){var Ce=[];Ce.push(writextag("NumberFormat",null,{"ss:Format":escapexml(table_fmt[n.numFmtId])}));var De={"ss:ID":"s"+(21+Ee)};r.push(writextag("Style",Ce.join(""),De))}),writextag("Styles",r.join(""))}function write_name_xlml(e){return writextag("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+a1_to_rc(e.Ref,{r:0,c:0})})}function write_names_xlml(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,r=[],n=0;n<t.length;++n){var Ee=t[n];Ee.Sheet==null&&(Ee.Name.match(/^_xlfn\./)||r.push(write_name_xlml(Ee)))}return writextag("Names",r.join(""))}function write_ws_xlml_names(e,t,r,n){if(!e||!((n||{}).Workbook||{}).Names)return"";for(var Ee=n.Workbook.Names,Ce=[],De=0;De<Ee.length;++De){var Me=Ee[De];Me.Sheet==r&&(Me.Name.match(/^_xlfn\./)||Ce.push(write_name_xlml(Me)))}return Ce.join("")}function write_ws_xlml_wsopts(e,t,r,n){if(!e)return"";var Ee=[];if(e["!margins"]&&(Ee.push("<PageSetup>"),e["!margins"].header&&Ee.push(writextag("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&Ee.push(writextag("Footer",null,{"x:Margin":e["!margins"].footer})),Ee.push(writextag("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),Ee.push("</PageSetup>")),n&&n.Workbook&&n.Workbook.Sheets&&n.Workbook.Sheets[r])if(n.Workbook.Sheets[r].Hidden)Ee.push(writextag("Visible",n.Workbook.Sheets[r].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var Ce=0;Ce<r&&!(n.Workbook.Sheets[Ce]&&!n.Workbook.Sheets[Ce].Hidden);++Ce);Ce==r&&Ee.push("<Selected/>")}return((((n||{}).Workbook||{}).Views||[])[0]||{}).RTL&&Ee.push("<DisplayRightToLeft/>"),e["!protect"]&&(Ee.push(writetag("ProtectContents","True")),e["!protect"].objects&&Ee.push(writetag("ProtectObjects","True")),e["!protect"].scenarios&&Ee.push(writetag("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?Ee.push(writetag("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&Ee.push(writetag("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(De){e["!protect"][De[0]]&&Ee.push("<"+De[1]+"/>")})),Ee.length==0?"":writextag("WorksheetOptions",Ee.join(""),{xmlns:XLMLNS.x})}function write_ws_xlml_comment(e){return e.map(function(t){var r=xlml_unfixstr(t.t||""),n=writextag("ss:Data",r,{xmlns:"http://www.w3.org/TR/REC-html40"});return writextag("Comment",n,{"ss:Author":t.a})}).join("")}function write_ws_xlml_cell(e,t,r,n,Ee,Ce,De){if(!e||e.v==null&&e.f==null)return"";var Me={};if(e.f&&(Me["ss:Formula"]="="+escapexml(a1_to_rc(e.f,De))),e.F&&e.F.slice(0,t.length)==t){var ze=decode_cell(e.F.slice(t.length+1));Me["ss:ArrayRange"]="RC:R"+(ze.r==De.r?"":"["+(ze.r-De.r)+"]")+"C"+(ze.c==De.c?"":"["+(ze.c-De.c)+"]")}if(e.l&&e.l.Target&&(Me["ss:HRef"]=escapexml(e.l.Target),e.l.Tooltip&&(Me["x:HRefScreenTip"]=escapexml(e.l.Tooltip))),r["!merges"])for(var Oe=r["!merges"],Be=0;Be!=Oe.length;++Be)Oe[Be].s.c!=De.c||Oe[Be].s.r!=De.r||(Oe[Be].e.c>Oe[Be].s.c&&(Me["ss:MergeAcross"]=Oe[Be].e.c-Oe[Be].s.c),Oe[Be].e.r>Oe[Be].s.r&&(Me["ss:MergeDown"]=Oe[Be].e.r-Oe[Be].s.r));var He="",Ve="";switch(e.t){case"z":if(!n.sheetStubs)return"";break;case"n":He="Number",Ve=String(e.v);break;case"b":He="Boolean",Ve=e.v?"1":"0";break;case"e":He="Error",Ve=BErr[e.v];break;case"d":He="DateTime",Ve=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||table_fmt[14]);break;case"s":He="String",Ve=escapexlml(e.v||"");break}var Xe=get_cell_style(n.cellXfs,e,n);Me["ss:StyleID"]="s"+(21+Xe),Me["ss:Index"]=De.c+1;var We=e.v!=null?Ve:"",Ge=e.t=="z"?"":'<Data ss:Type="'+He+'">'+We+"</Data>";return(e.c||[]).length>0&&(Ge+=write_ws_xlml_comment(e.c)),writextag("Cell",Ge,Me)}function write_ws_xlml_row(e,t){var r='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=pt2px(t.hpt)),t.hpx&&(r+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(r+=' ss:Hidden="1"')),r+">"}function write_ws_xlml_table(e,t,r,n){if(!e["!ref"])return"";var Ee=safe_decode_range(e["!ref"]),Ce=e["!merges"]||[],De=0,Me=[];e["!cols"]&&e["!cols"].forEach(function($e,Ke){process_col($e);var rr=!!$e.width,tr=col_obj_w(Ke,$e),sr={"ss:Index":Ke+1};rr&&(sr["ss:Width"]=width2px(tr.width)),$e.hidden&&(sr["ss:Hidden"]="1"),Me.push(writextag("Column",null,sr))});for(var ze=Array.isArray(e),Oe=Ee.s.r;Oe<=Ee.e.r;++Oe){for(var Be=[write_ws_xlml_row(Oe,(e["!rows"]||[])[Oe])],He=Ee.s.c;He<=Ee.e.c;++He){var Ve=!1;for(De=0;De!=Ce.length;++De)if(!(Ce[De].s.c>He)&&!(Ce[De].s.r>Oe)&&!(Ce[De].e.c<He)&&!(Ce[De].e.r<Oe)){(Ce[De].s.c!=He||Ce[De].s.r!=Oe)&&(Ve=!0);break}if(!Ve){var Xe={r:Oe,c:He},We=encode_cell(Xe),Ge=ze?(e[Oe]||[])[He]:e[We];Be.push(write_ws_xlml_cell(Ge,We,e,t,r,n,Xe))}}Be.push("</Row>"),Be.length>2&&Me.push(Be.join(""))}return Me.join("")}function write_ws_xlml(e,t,r){var n=[],Ee=r.SheetNames[e],Ce=r.Sheets[Ee],De=Ce?write_ws_xlml_names(Ce,t,e,r):"";return De.length>0&&n.push("<Names>"+De+"</Names>"),De=Ce?write_ws_xlml_table(Ce,t,e,r):"",De.length>0&&n.push("<Table>"+De+"</Table>"),n.push(write_ws_xlml_wsopts(Ce,t,e,r)),n.join("")}function write_xlml(e,t){t||(t={}),e.SSF||(e.SSF=dup(table_fmt)),e.SSF&&(make_ssf(),SSF_load_table(e.SSF),t.revssf=evert_num(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],get_cell_style(t.cellXfs,{},{revssf:{General:0}}));var r=[];r.push(write_props_xlml(e,t)),r.push(write_wb_xlml()),r.push(""),r.push("");for(var n=0;n<e.SheetNames.length;++n)r.push(writextag("Worksheet",write_ws_xlml(n,t,e),{"ss:Name":escapexml(e.SheetNames[n])}));return r[2]=write_sty_xlml(e,t),r[3]=write_names_xlml(e),XML_HEADER+writextag("Workbook",r.join(""),{xmlns:XLMLNS.ss,"xmlns:o":XLMLNS.o,"xmlns:x":XLMLNS.x,"xmlns:ss":XLMLNS.ss,"xmlns:dt":XLMLNS.dt,"xmlns:html":XLMLNS.html})}function parse_compobj(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=parse_ClipboardFormatOrAnsiString(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=parse_ClipboardFormatOrUnicodeString(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var CONTINUE_RT=[60,1084,2066,2165,2175];function slurp(e,t,r,n,Ee){var Ce=n,De=[],Me=r.slice(r.l,r.l+Ce);if(Ee&&Ee.enc&&Ee.enc.insitu&&Me.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:Ee.enc.insitu(Me)}De.push(Me),r.l+=Ce;for(var ze=__readUInt16LE(r,r.l),Oe=XLSRecordEnum[ze],Be=0;Oe!=null&&CONTINUE_RT.indexOf(ze)>-1;)Ce=__readUInt16LE(r,r.l+2),Be=r.l+4,ze==2066?Be+=4:(ze==2165||ze==2175)&&(Be+=12),Me=r.slice(Be,r.l+4+Ce),De.push(Me),r.l+=4+Ce,Oe=XLSRecordEnum[ze=__readUInt16LE(r,r.l)];var He=bconcat(De);prep_blob(He,0);var Ve=0;He.lens=[];for(var Xe=0;Xe<De.length;++Xe)He.lens.push(Ve),Ve+=De[Xe].length;if(He.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+He.length+" < "+n;return t.f(He,He.length,Ee)}function safe_format_xf(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=table_fmt[n])}catch(Ce){if(t.WTF)throw Ce}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||BErr[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=SSF_general_num(e.v):e.w=SSF_general(e.v):e.w=SSF_format(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(Ce){if(t.WTF)throw Ce}if(t.cellDates&&n&&e.t=="n"&&fmt_is_date(table_fmt[n]||String(n))){var Ee=SSF_parse_date_code(e.v);Ee&&(e.t="d",e.v=new Date(Ee.y,Ee.m-1,Ee.d,Ee.H,Ee.M,Ee.S,Ee.u))}}}function make_cell(e,t,r){return{v:e,ixfe:t,t:r}}function parse_workbook(e,t){var r={opts:{}},n={},Ee=t.dense?[]:{},Ce={},De={},Me=null,ze=[],Oe="",Be={},He,Ve="",Xe,We,Ge,$e,Ke={},rr=[],tr,sr,ar=[],hr=[],pr={Sheets:[],WBProps:{date1904:!1},Views:[{}]},yr={},fr=function(Ka){return Ka<8?XLSIcv[Ka]:Ka<64&&hr[Ka-8]||XLSIcv[Ka]},Rr=function(Ka,en,Bn){var vn=en.XF.data;if(!(!vn||!vn.patternType||!Bn||!Bn.cellStyles)){en.s={},en.s.patternType=vn.patternType;var va;(va=rgb2Hex(fr(vn.icvFore)))&&(en.s.fgColor={rgb:va}),(va=rgb2Hex(fr(vn.icvBack)))&&(en.s.bgColor={rgb:va})}},mr=function(Ka,en,Bn){if(!(ur>1)&&!(Bn.sheetRows&&Ka.r>=Bn.sheetRows)){if(Bn.cellStyles&&en.XF&&en.XF.data&&Rr(Ka,en,Bn),delete en.ixfe,delete en.XF,He=Ka,Ve=encode_cell(Ka),(!De||!De.s||!De.e)&&(De={s:{r:0,c:0},e:{r:0,c:0}}),Ka.r<De.s.r&&(De.s.r=Ka.r),Ka.c<De.s.c&&(De.s.c=Ka.c),Ka.r+1>De.e.r&&(De.e.r=Ka.r+1),Ka.c+1>De.e.c&&(De.e.c=Ka.c+1),Bn.cellFormula&&en.f){for(var vn=0;vn<rr.length;++vn)if(!(rr[vn][0].s.c>Ka.c||rr[vn][0].s.r>Ka.r)&&!(rr[vn][0].e.c<Ka.c||rr[vn][0].e.r<Ka.r)){en.F=encode_range(rr[vn][0]),(rr[vn][0].s.c!=Ka.c||rr[vn][0].s.r!=Ka.r)&&delete en.f,en.f&&(en.f=""+stringify_formula(rr[vn][1],De,Ka,ir,wr));break}}Bn.dense?(Ee[Ka.r]||(Ee[Ka.r]=[]),Ee[Ka.r][Ka.c]=en):Ee[Ve]=en}},wr={enc:!1,sbcch:0,snames:[],sharedf:Ke,arrayf:rr,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(wr.password=t.password);var Fr,Mr=[],Hr=[],Nr=[],Ar=[],xr=!1,ir=[];ir.SheetNames=wr.snames,ir.sharedf=wr.sharedf,ir.arrayf=wr.arrayf,ir.names=[],ir.XTI=[];var _r=0,ur=0,Je=0,nr=[],or=[],lr;wr.codepage=1200,set_cp(1200);for(var St=!1;e.l<e.length-1;){var dr=e.l,vr=e.read_shift(2);if(vr===0&&_r===10)break;var br=e.l===e.length?0:e.read_shift(2),kr=XLSRecordEnum[vr];if(kr&&kr.f){if(t.bookSheets&&_r===133&&vr!==133)break;if(_r=vr,kr.r===2||kr.r==12){var Pr=e.read_shift(2);if(br-=2,!wr.enc&&Pr!==vr&&((Pr&255)<<8|Pr>>8)!==vr)throw new Error("rt mismatch: "+Pr+"!="+vr);kr.r==12&&(e.l+=10,br-=10)}var Er={};if(vr===10?Er=kr.f(e,br,wr):Er=slurp(vr,kr,e,br,wr),ur==0&&[9,521,1033,2057].indexOf(_r)===-1)continue;switch(vr){case 34:r.opts.Date1904=pr.WBProps.date1904=Er;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(wr.enc||(e.l=0),wr.enc=Er,!t.password)throw new Error("File is password-protected");if(Er.valid==null)throw new Error("Encryption scheme unsupported");if(!Er.valid)throw new Error("Password is incorrect");break;case 92:wr.lastuser=Er;break;case 66:var Zr=Number(Er);switch(Zr){case 21010:Zr=1200;break;case 32768:Zr=1e4;break;case 32769:Zr=1252;break}set_cp(wr.codepage=Zr),St=!0;break;case 317:wr.rrtabid=Er;break;case 25:wr.winlocked=Er;break;case 439:r.opts.RefreshAll=Er;break;case 12:r.opts.CalcCount=Er;break;case 16:r.opts.CalcDelta=Er;break;case 17:r.opts.CalcIter=Er;break;case 13:r.opts.CalcMode=Er;break;case 14:r.opts.CalcPrecision=Er;break;case 95:r.opts.CalcSaveRecalc=Er;break;case 15:wr.CalcRefMode=Er;break;case 2211:r.opts.FullCalc=Er;break;case 129:Er.fDialog&&(Ee["!type"]="dialog"),Er.fBelow||((Ee["!outline"]||(Ee["!outline"]={})).above=!0),Er.fRight||((Ee["!outline"]||(Ee["!outline"]={})).left=!0);break;case 224:ar.push(Er);break;case 430:ir.push([Er]),ir[ir.length-1].XTI=[];break;case 35:case 547:ir[ir.length-1].push(Er);break;case 24:case 536:lr={Name:Er.Name,Ref:stringify_formula(Er.rgce,De,null,ir,wr)},Er.itab>0&&(lr.Sheet=Er.itab-1),ir.names.push(lr),ir[0]||(ir[0]=[],ir[0].XTI=[]),ir[ir.length-1].push(Er),Er.Name=="_xlnm._FilterDatabase"&&Er.itab>0&&Er.rgce&&Er.rgce[0]&&Er.rgce[0][0]&&Er.rgce[0][0][0]=="PtgArea3d"&&(or[Er.itab-1]={ref:encode_range(Er.rgce[0][0][1][2])});break;case 22:wr.ExternCount=Er;break;case 23:ir.length==0&&(ir[0]=[],ir[0].XTI=[]),ir[ir.length-1].XTI=ir[ir.length-1].XTI.concat(Er),ir.XTI=ir.XTI.concat(Er);break;case 2196:if(wr.biff<8)break;lr!=null&&(lr.Comment=Er[1]);break;case 18:Ee["!protect"]=Er;break;case 19:Er!==0&&wr.WTF&&console.error("Password verifier: "+Er);break;case 133:Ce[Er.pos]=Er,wr.snames.push(Er.name);break;case 10:{if(--ur)break;if(De.e){if(De.e.r>0&&De.e.c>0){if(De.e.r--,De.e.c--,Ee["!ref"]=encode_range(De),t.sheetRows&&t.sheetRows<=De.e.r){var ua=De.e.r;De.e.r=t.sheetRows-1,Ee["!fullref"]=Ee["!ref"],Ee["!ref"]=encode_range(De),De.e.r=ua}De.e.r++,De.e.c++}Mr.length>0&&(Ee["!merges"]=Mr),Hr.length>0&&(Ee["!objects"]=Hr),Nr.length>0&&(Ee["!cols"]=Nr),Ar.length>0&&(Ee["!rows"]=Ar),pr.Sheets.push(yr)}Oe===""?Be=Ee:n[Oe]=Ee,Ee=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(wr.biff===8&&(wr.biff={9:2,521:3,1033:4}[vr]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[Er.BIFFVer]||8),wr.biffguess=Er.BIFFVer==0,Er.BIFFVer==0&&Er.dt==4096&&(wr.biff=5,St=!0,set_cp(wr.codepage=28591)),wr.biff==8&&Er.BIFFVer==0&&Er.dt==16&&(wr.biff=2),ur++)break;if(Ee=t.dense?[]:{},wr.biff<8&&!St&&(St=!0,set_cp(wr.codepage=t.codepage||1252)),wr.biff<5||Er.BIFFVer==0&&Er.dt==4096){Oe===""&&(Oe="Sheet1"),De={s:{r:0,c:0},e:{r:0,c:0}};var Cr={pos:e.l-br,name:Oe};Ce[Cr.pos]=Cr,wr.snames.push(Oe)}else Oe=(Ce[dr]||{name:""}).name;Er.dt==32&&(Ee["!type"]="chart"),Er.dt==64&&(Ee["!type"]="macro"),Mr=[],Hr=[],wr.arrayf=rr=[],Nr=[],Ar=[],xr=!1,yr={Hidden:(Ce[dr]||{hs:0}).hs,name:Oe}}break;case 515:case 3:case 2:Ee["!type"]=="chart"&&(t.dense?(Ee[Er.r]||[])[Er.c]:Ee[encode_cell({c:Er.c,r:Er.r})])&&++Er.c,tr={ixfe:Er.ixfe,XF:ar[Er.ixfe]||{},v:Er.val,t:"n"},Je>0&&(tr.z=nr[tr.ixfe>>8&63]),safe_format_xf(tr,t,r.opts.Date1904),mr({c:Er.c,r:Er.r},tr,t);break;case 5:case 517:tr={ixfe:Er.ixfe,XF:ar[Er.ixfe],v:Er.val,t:Er.t},Je>0&&(tr.z=nr[tr.ixfe>>8&63]),safe_format_xf(tr,t,r.opts.Date1904),mr({c:Er.c,r:Er.r},tr,t);break;case 638:tr={ixfe:Er.ixfe,XF:ar[Er.ixfe],v:Er.rknum,t:"n"},Je>0&&(tr.z=nr[tr.ixfe>>8&63]),safe_format_xf(tr,t,r.opts.Date1904),mr({c:Er.c,r:Er.r},tr,t);break;case 189:for(var Jr=Er.c;Jr<=Er.C;++Jr){var Qr=Er.rkrec[Jr-Er.c][0];tr={ixfe:Qr,XF:ar[Qr],v:Er.rkrec[Jr-Er.c][1],t:"n"},Je>0&&(tr.z=nr[tr.ixfe>>8&63]),safe_format_xf(tr,t,r.opts.Date1904),mr({c:Jr,r:Er.r},tr,t)}break;case 6:case 518:case 1030:{if(Er.val=="String"){Me=Er;break}if(tr=make_cell(Er.val,Er.cell.ixfe,Er.tt),tr.XF=ar[tr.ixfe],t.cellFormula){var oa=Er.formula;if(oa&&oa[0]&&oa[0][0]&&oa[0][0][0]=="PtgExp"){var ta=oa[0][0][1][0],Na=oa[0][0][1][1],Ca=encode_cell({r:ta,c:Na});Ke[Ca]?tr.f=""+stringify_formula(Er.formula,De,Er.cell,ir,wr):tr.F=((t.dense?(Ee[ta]||[])[Na]:Ee[Ca])||{}).F}else tr.f=""+stringify_formula(Er.formula,De,Er.cell,ir,wr)}Je>0&&(tr.z=nr[tr.ixfe>>8&63]),safe_format_xf(tr,t,r.opts.Date1904),mr(Er.cell,tr,t),Me=Er}break;case 7:case 519:if(Me)Me.val=Er,tr=make_cell(Er,Me.cell.ixfe,"s"),tr.XF=ar[tr.ixfe],t.cellFormula&&(tr.f=""+stringify_formula(Me.formula,De,Me.cell,ir,wr)),Je>0&&(tr.z=nr[tr.ixfe>>8&63]),safe_format_xf(tr,t,r.opts.Date1904),mr(Me.cell,tr,t),Me=null;else throw new Error("String record expects Formula");break;case 33:case 545:{rr.push(Er);var za=encode_cell(Er[0].s);if(Xe=t.dense?(Ee[Er[0].s.r]||[])[Er[0].s.c]:Ee[za],t.cellFormula&&Xe){if(!Me||!za||!Xe)break;Xe.f=""+stringify_formula(Er[1],De,Er[0],ir,wr),Xe.F=encode_range(Er[0])}}break;case 1212:{if(!t.cellFormula)break;if(Ve){if(!Me)break;Ke[encode_cell(Me.cell)]=Er[0],Xe=t.dense?(Ee[Me.cell.r]||[])[Me.cell.c]:Ee[encode_cell(Me.cell)],(Xe||{}).f=""+stringify_formula(Er[0],De,He,ir,wr)}}break;case 253:tr=make_cell(ze[Er.isst].t,Er.ixfe,"s"),ze[Er.isst].h&&(tr.h=ze[Er.isst].h),tr.XF=ar[tr.ixfe],Je>0&&(tr.z=nr[tr.ixfe>>8&63]),safe_format_xf(tr,t,r.opts.Date1904),mr({c:Er.c,r:Er.r},tr,t);break;case 513:t.sheetStubs&&(tr={ixfe:Er.ixfe,XF:ar[Er.ixfe],t:"z"},Je>0&&(tr.z=nr[tr.ixfe>>8&63]),safe_format_xf(tr,t,r.opts.Date1904),mr({c:Er.c,r:Er.r},tr,t));break;case 190:if(t.sheetStubs)for(var Xa=Er.c;Xa<=Er.C;++Xa){var Ya=Er.ixfe[Xa-Er.c];tr={ixfe:Ya,XF:ar[Ya],t:"z"},Je>0&&(tr.z=nr[tr.ixfe>>8&63]),safe_format_xf(tr,t,r.opts.Date1904),mr({c:Xa,r:Er.r},tr,t)}break;case 214:case 516:case 4:tr=make_cell(Er.val,Er.ixfe,"s"),tr.XF=ar[tr.ixfe],Je>0&&(tr.z=nr[tr.ixfe>>8&63]),safe_format_xf(tr,t,r.opts.Date1904),mr({c:Er.c,r:Er.r},tr,t);break;case 0:case 512:ur===1&&(De=Er);break;case 252:ze=Er;break;case 1054:if(wr.biff==4){nr[Je++]=Er[1];for(var nn=0;nn<Je+163&&table_fmt[nn]!=Er[1];++nn);nn>=163&&SSF_load(Er[1],Je+163)}else SSF_load(Er[1],Er[0]);break;case 30:{nr[Je++]=Er;for(var on=0;on<Je+163&&table_fmt[on]!=Er;++on);on>=163&&SSF_load(Er,Je+163)}break;case 229:Mr=Mr.concat(Er);break;case 93:Hr[Er.cmo[0]]=wr.lastobj=Er;break;case 438:wr.lastobj.TxO=Er;break;case 127:wr.lastobj.ImData=Er;break;case 440:for($e=Er[0].s.r;$e<=Er[0].e.r;++$e)for(Ge=Er[0].s.c;Ge<=Er[0].e.c;++Ge)Xe=t.dense?(Ee[$e]||[])[Ge]:Ee[encode_cell({c:Ge,r:$e})],Xe&&(Xe.l=Er[1]);break;case 2048:for($e=Er[0].s.r;$e<=Er[0].e.r;++$e)for(Ge=Er[0].s.c;Ge<=Er[0].e.c;++Ge)Xe=t.dense?(Ee[$e]||[])[Ge]:Ee[encode_cell({c:Ge,r:$e})],Xe&&Xe.l&&(Xe.l.Tooltip=Er[1]);break;case 28:{if(wr.biff<=5&&wr.biff>=2)break;Xe=t.dense?(Ee[Er[0].r]||[])[Er[0].c]:Ee[encode_cell(Er[0])];var yn=Hr[Er[2]];Xe||(t.dense?(Ee[Er[0].r]||(Ee[Er[0].r]=[]),Xe=Ee[Er[0].r][Er[0].c]={t:"z"}):Xe=Ee[encode_cell(Er[0])]={t:"z"},De.e.r=Math.max(De.e.r,Er[0].r),De.s.r=Math.min(De.s.r,Er[0].r),De.e.c=Math.max(De.e.c,Er[0].c),De.s.c=Math.min(De.s.c,Er[0].c)),Xe.c||(Xe.c=[]),We={a:Er[1],t:yn.TxO.t},Xe.c.push(We)}break;case 2173:update_xfext(ar[Er.ixfe],Er.ext);break;case 125:{if(!wr.cellStyles)break;for(;Er.e>=Er.s;)Nr[Er.e--]={width:Er.w/256,level:Er.level||0,hidden:!!(Er.flags&1)},xr||(xr=!0,find_mdw_colw(Er.w/256)),process_col(Nr[Er.e+1])}break;case 520:{var fn={};Er.level!=null&&(Ar[Er.r]=fn,fn.level=Er.level),Er.hidden&&(Ar[Er.r]=fn,fn.hidden=!0),Er.hpt&&(Ar[Er.r]=fn,fn.hpt=Er.hpt,fn.hpx=pt2px(Er.hpt))}break;case 38:case 39:case 40:case 41:Ee["!margins"]||default_margins(Ee["!margins"]={}),Ee["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[vr]]=Er;break;case 161:Ee["!margins"]||default_margins(Ee["!margins"]={}),Ee["!margins"].header=Er.header,Ee["!margins"].footer=Er.footer;break;case 574:Er.RTL&&(pr.Views[0].RTL=!0);break;case 146:hr=Er;break;case 2198:Fr=Er;break;case 140:sr=Er;break;case 442:Oe?yr.CodeName=Er||yr.name:pr.WBProps.CodeName=Er||"ThisWorkbook";break}}else kr||console.error("Missing Info for XLS Record 0x"+vr.toString(16)),e.l+=br}return r.SheetNames=keys(Ce).sort(function(Qa,Ka){return Number(Qa)-Number(Ka)}).map(function(Qa){return Ce[Qa].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&Be["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=Be)):r.Preamble=Be,r.Sheets&&or.forEach(function(Qa,Ka){r.Sheets[r.SheetNames[Ka]]["!autofilter"]=Qa}),r.Strings=ze,r.SSF=dup(table_fmt),wr.enc&&(r.Encryption=wr.enc),Fr&&(r.Themes=Fr),r.Metadata={},sr!==void 0&&(r.Metadata.Country=sr),ir.names.length>0&&(pr.Names=ir.names),r.Workbook=pr,r}var PSCLSID={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function parse_xls_props(e,t,r){var n=CFB.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var Ee=parse_PropertySetStream(n,DocSummaryPIDDSI,PSCLSID.DSI);for(var Ce in Ee)t[Ce]=Ee[Ce]}catch(Oe){if(r.WTF)throw Oe}var De=CFB.find(e,"/!SummaryInformation");if(De&&De.size>0)try{var Me=parse_PropertySetStream(De,SummaryPIDSI,PSCLSID.SI);for(var ze in Me)t[ze]==null&&(t[ze]=Me[ze])}catch(Oe){if(r.WTF)throw Oe}t.HeadingPairs&&t.TitlesOfParts&&(load_props_pairs(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function write_xls_props(e,t){var r=[],n=[],Ee=[],Ce=0,De,Me=evert_key(DocSummaryPIDDSI,"n"),ze=evert_key(SummaryPIDSI,"n");if(e.Props)for(De=keys(e.Props),Ce=0;Ce<De.length;++Ce)(Object.prototype.hasOwnProperty.call(Me,De[Ce])?r:Object.prototype.hasOwnProperty.call(ze,De[Ce])?n:Ee).push([De[Ce],e.Props[De[Ce]]]);if(e.Custprops)for(De=keys(e.Custprops),Ce=0;Ce<De.length;++Ce)Object.prototype.hasOwnProperty.call(e.Props||{},De[Ce])||(Object.prototype.hasOwnProperty.call(Me,De[Ce])?r:Object.prototype.hasOwnProperty.call(ze,De[Ce])?n:Ee).push([De[Ce],e.Custprops[De[Ce]]]);var Oe=[];for(Ce=0;Ce<Ee.length;++Ce)XLSPSSkip.indexOf(Ee[Ce][0])>-1||PseudoPropsPairs.indexOf(Ee[Ce][0])>-1||Ee[Ce][1]!=null&&Oe.push(Ee[Ce]);n.length&&CFB.utils.cfb_add(t,"/SummaryInformation",write_PropertySetStream(n,PSCLSID.SI,ze,SummaryPIDSI)),(r.length||Oe.length)&&CFB.utils.cfb_add(t,"/DocumentSummaryInformation",write_PropertySetStream(r,PSCLSID.DSI,Me,DocSummaryPIDDSI,Oe.length?Oe:null,PSCLSID.UDI))}function parse_xlscfb(e,t){t||(t={}),fix_read_opts(t),reset_cp(),t.codepage&&set_ansi(t.codepage);var r,n;if(e.FullPaths){if(CFB.find(e,"/encryption"))throw new Error("File is password-protected");r=CFB.find(e,"!CompObj"),n=CFB.find(e,"/Workbook")||CFB.find(e,"/Book")}else{switch(t.type){case"base64":e=s2a(Base64_decode(e));break;case"binary":e=s2a(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}prep_blob(e,0),n={content:e}}var Ee,Ce;if(r&&parse_compobj(r),t.bookProps&&!t.bookSheets)Ee={};else{var De=has_buf?"buffer":"array";if(n&&n.content)Ee=parse_workbook(n.content,t);else if((Ce=CFB.find(e,"PerfectOffice_MAIN"))&&Ce.content)Ee=WK_.to_workbook(Ce.content,(t.type=De,t));else if((Ce=CFB.find(e,"NativeContent_MAIN"))&&Ce.content)Ee=WK_.to_workbook(Ce.content,(t.type=De,t));else throw(Ce=CFB.find(e,"MN0"))&&Ce.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&CFB.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(Ee.vbaraw=make_vba_xls(e))}var Me={};return e.FullPaths&&parse_xls_props(e,Me,t),Ee.Props=Ee.Custprops=Me,t.bookFiles&&(Ee.cfb=e),Ee}function write_xlscfb(e,t){var r=t||{},n=CFB.utils.cfb_new({root:"R"}),Ee="/Workbook";switch(r.bookType||"xls"){case"xls":r.bookType="biff8";case"xla":r.bookType||(r.bookType="xla");case"biff8":Ee="/Workbook",r.biff=8;break;case"biff5":Ee="/Book",r.biff=5;break;default:throw new Error("invalid type "+r.bookType+" for XLS CFB")}return CFB.utils.cfb_add(n,Ee,write_biff_buf(e,r)),r.biff==8&&(e.Props||e.Custprops)&&write_xls_props(e,n),r.biff==8&&e.vbaraw&&fill_vba_xls(n,CFB.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),n}var XLSBRecordEnum={0:{f:parse_BrtRowHdr},1:{f:parse_BrtCellBlank},2:{f:parse_BrtCellRk},3:{f:parse_BrtCellError},4:{f:parse_BrtCellBool},5:{f:parse_BrtCellReal},6:{f:parse_BrtCellSt},7:{f:parse_BrtCellIsst},8:{f:parse_BrtFmlaString},9:{f:parse_BrtFmlaNum},10:{f:parse_BrtFmlaBool},11:{f:parse_BrtFmlaError},12:{f:parse_BrtShortBlank},13:{f:parse_BrtShortRk},14:{f:parse_BrtShortError},15:{f:parse_BrtShortBool},16:{f:parse_BrtShortReal},17:{f:parse_BrtShortSt},18:{f:parse_BrtShortIsst},19:{f:parse_RichStr},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:parse_BrtName},40:{},42:{},43:{f:parse_BrtFont},44:{f:parse_BrtFmt},45:{f:parse_BrtFill},46:{f:parse_BrtBorder},47:{f:parse_BrtXF},48:{},49:{f:parse_Int32LE},50:{},51:{f:parse_BrtMdb},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:parse_ColInfo},62:{f:parse_BrtCellRString},63:{f:parse_BrtCalcChainItem$},64:{f:parse_BrtDVal},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:parsenoop,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:parse_BrtBeginWsView},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:parse_BrtWsProp},148:{f:parse_BrtWsDim,p:16},151:{f:parse_BrtPane},152:{},153:{f:parse_BrtWbProp},154:{},155:{},156:{f:parse_BrtBundleSh},157:{},158:{},159:{T:1,f:parse_BrtBeginSst},160:{T:-1},161:{T:1,f:parse_UncheckedRfX},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:parse_BrtMergeCell},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:parse_BrtMdtinfo},336:{T:-1},337:{f:parse_BrtBeginEsmdb,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:parse_RelID},357:{},358:{},359:{},360:{T:1},361:{},362:{f:parse_ExternSheet},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:parse_BrtArrFmla},427:{f:parse_BrtShrFmla},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:parse_BrtMargins},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:parse_BrtWsFmtInfo},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:parse_BrtHLink},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:parse_RelID},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:parse_BrtCommentAuthor},633:{T:1},634:{T:-1},635:{T:1,f:parse_BrtBeginComment},636:{T:-1},637:{f:parse_BrtCommentText},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:parse_BrtCsProp},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:parse_BrtDVal14},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},XLSRecordEnum={6:{f:parse_Formula},10:{f:parsenoop2},12:{f:parseuint16},13:{f:parseuint16},14:{f:parsebool},15:{f:parsebool},16:{f:parse_Xnum},17:{f:parsebool},18:{f:parsebool},19:{f:parseuint16},20:{f:parse_XLHeaderFooter},21:{f:parse_XLHeaderFooter},23:{f:parse_ExternSheet},24:{f:parse_Lbl},25:{f:parsebool},26:{},27:{},28:{f:parse_Note},29:{},34:{f:parsebool},35:{f:parse_ExternName},38:{f:parse_Xnum},39:{f:parse_Xnum},40:{f:parse_Xnum},41:{f:parse_Xnum},42:{f:parsebool},43:{f:parsebool},47:{f:parse_FilePass},49:{f:parse_Font},51:{f:parseuint16},60:{},61:{f:parse_Window1},64:{f:parsebool},65:{f:parse_Pane},66:{f:parseuint16},77:{},80:{},81:{},82:{},85:{f:parseuint16},89:{},90:{},91:{},92:{f:parse_WriteAccess},93:{f:parse_Obj},94:{},95:{f:parsebool},96:{},97:{},99:{f:parsebool},125:{f:parse_ColInfo},128:{f:parse_Guts},129:{f:parse_WsBool},130:{f:parseuint16},131:{f:parsebool},132:{f:parsebool},133:{f:parse_BoundSheet8},134:{},140:{f:parse_Country},141:{f:parseuint16},144:{},146:{f:parse_Palette},151:{},152:{},153:{},154:{},155:{},156:{f:parseuint16},157:{},158:{},160:{f:parse_Scl},161:{f:parse_Setup},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:parse_MulRk},190:{f:parse_MulBlank},193:{f:parsenoop2},197:{},198:{},199:{},200:{},201:{},202:{f:parsebool},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:parseuint16},220:{},221:{f:parsebool},222:{},224:{f:parse_XF},225:{f:parse_InterfaceHdr},226:{f:parsenoop2},227:{},229:{f:parse_MergeCells},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:parse_SST},253:{f:parse_LabelSst},255:{f:parse_ExtSST},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:parseuint16a},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:parsebool},353:{f:parsenoop2},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:parse_SupBook},431:{f:parsebool},432:{},433:{},434:{},437:{},438:{f:parse_TxO},439:{f:parsebool},440:{f:parse_HLink},441:{},442:{f:parse_XLUnicodeString},443:{},444:{f:parseuint16},445:{},446:{},448:{f:parsenoop2},449:{f:parse_RecalcId,r:2},450:{f:parsenoop2},512:{f:parse_Dimensions},513:{f:parse_Blank},515:{f:parse_Number},516:{f:parse_Label},517:{f:parse_BoolErr},519:{f:parse_String},520:{f:parse_Row},523:{},545:{f:parse_Array},549:{f:parse_DefaultRowHeight},566:{},574:{f:parse_Window2},638:{f:parse_RK},659:{},1048:{},1054:{f:parse_Format},1084:{},1212:{f:parse_ShrFmla},2048:{f:parse_HLinkTooltip},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:parse_BOF},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:parsenoop2},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:parse_XFCRC,r:12},2173:{f:parse_XFExt,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:parsebool,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:parse_NameCmt,r:12},2197:{},2198:{f:parse_Theme,r:12},2199:{},2200:{},2201:{},2202:{f:parse_MTRSettings,r:12},2203:{f:parsenoop2},2204:{},2205:{},2206:{},2207:{},2211:{f:parse_ForceFullCalculation},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:parseuint16},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:parse_ShtProps},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:parse_ClrtClient},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:parse_Dimensions},1:{},2:{f:parse_BIFF2INT},3:{f:parse_BIFF2NUM},4:{f:parse_BIFF2STR},5:{f:parse_BoolErr},7:{f:parse_BIFF2STRING},8:{},9:{f:parse_BOF},11:{},22:{f:parseuint16},30:{f:parse_BIFF2Format},31:{},32:{},33:{f:parse_Array},36:{},37:{f:parse_DefaultRowHeight},50:{f:parse_BIFF2FONTXTRA},62:{},52:{},67:{},68:{f:parseuint16},69:{},86:{},126:{},127:{f:parse_ImData},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:parse_RString},223:{},234:{},354:{},421:{},518:{f:parse_Formula},521:{f:parse_BOF},536:{f:parse_Lbl},547:{f:parse_ExternName},561:{},579:{},1030:{f:parse_Formula},1033:{f:parse_BOF},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function write_biff_rec(e,t,r,n){var Ee=t;if(!isNaN(Ee)){var Ce=n||(r||[]).length||0,De=e.next(4);De.write_shift(2,Ee),De.write_shift(2,Ce),Ce>0&&is_buf(r)&&e.push(r)}}function write_biff_continue(e,t,r,n){var Ee=(r||[]).length||0;if(Ee<=8224)return write_biff_rec(e,t,r,Ee);var Ce=t;if(!isNaN(Ce)){for(var De=r.parts||[],Me=0,ze=0,Oe=0;Oe+(De[Me]||8224)<=8224;)Oe+=De[Me]||8224,Me++;var Be=e.next(4);for(Be.write_shift(2,Ce),Be.write_shift(2,Oe),e.push(r.slice(ze,ze+Oe)),ze+=Oe;ze<Ee;){for(Be=e.next(4),Be.write_shift(2,60),Oe=0;Oe+(De[Me]||8224)<=8224;)Oe+=De[Me]||8224,Me++;Be.write_shift(2,Oe),e.push(r.slice(ze,ze+Oe)),ze+=Oe}}}function write_BIFF2Cell(e,t,r){return e||(e=new_buf(7)),e.write_shift(2,t),e.write_shift(2,r),e.write_shift(2,0),e.write_shift(1,0),e}function write_BIFF2BERR(e,t,r,n){var Ee=new_buf(9);return write_BIFF2Cell(Ee,e,t),write_Bes(r,n||"b",Ee),Ee}function write_BIFF2LABEL(e,t,r){var n=new_buf(8+2*r.length);return write_BIFF2Cell(n,e,t),n.write_shift(1,r.length),n.write_shift(r.length,r,"sbcs"),n.l<n.length?n.slice(0,n.l):n}function write_ws_biff2_cell(e,t,r,n){if(t.v!=null)switch(t.t){case"d":case"n":var Ee=t.t=="d"?datenum(parseDate(t.v)):t.v;Ee==(Ee|0)&&Ee>=0&&Ee<65536?write_biff_rec(e,2,write_BIFF2INT(r,n,Ee)):write_biff_rec(e,3,write_BIFF2NUM(r,n,Ee));return;case"b":case"e":write_biff_rec(e,5,write_BIFF2BERR(r,n,t.v,t.t));return;case"s":case"str":write_biff_rec(e,4,write_BIFF2LABEL(r,n,(t.v||"").slice(0,255)));return}write_biff_rec(e,1,write_BIFF2Cell(null,r,n))}function write_ws_biff2(e,t,r,n){var Ee=Array.isArray(t),Ce=safe_decode_range(t["!ref"]||"A1"),De,Me="",ze=[];if(Ce.e.c>255||Ce.e.r>16383){if(n.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");Ce.e.c=Math.min(Ce.e.c,255),Ce.e.r=Math.min(Ce.e.c,16383),De=encode_range(Ce)}for(var Oe=Ce.s.r;Oe<=Ce.e.r;++Oe){Me=encode_row(Oe);for(var Be=Ce.s.c;Be<=Ce.e.c;++Be){Oe===Ce.s.r&&(ze[Be]=encode_col(Be)),De=ze[Be]+Me;var He=Ee?(t[Oe]||[])[Be]:t[De];He&&write_ws_biff2_cell(e,He,Oe,Be)}}}function write_biff2_buf(e,t){for(var r=t||{},n=buf_array(),Ee=0,Ce=0;Ce<e.SheetNames.length;++Ce)e.SheetNames[Ce]==r.sheet&&(Ee=Ce);if(Ee==0&&r.sheet&&e.SheetNames[0]!=r.sheet)throw new Error("Sheet not found: "+r.sheet);return write_biff_rec(n,r.biff==4?1033:r.biff==3?521:9,write_BOF(e,16,r)),write_ws_biff2(n,e.Sheets[e.SheetNames[Ee]],Ee,r),write_biff_rec(n,10),n.end()}function write_FONTS_biff8(e,t,r){write_biff_rec(e,49,write_Font({sz:12,name:"Arial"},r))}function write_FMTS_biff8(e,t,r){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var Ee=n[0];Ee<=n[1];++Ee)t[Ee]!=null&&write_biff_rec(e,1054,write_Format(Ee,t[Ee],r))})}function write_FEAT(e,t){var r=new_buf(19);r.write_shift(4,2151),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,1),r.write_shift(4,0),write_biff_rec(e,2151,r),r=new_buf(39),r.write_shift(4,2152),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,3),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(2,1),r.write_shift(4,4),r.write_shift(2,0),write_Ref8U(safe_decode_range(t["!ref"]||"A1"),r),r.write_shift(4,4),write_biff_rec(e,2152,r)}function write_CELLXFS_biff8(e,t){for(var r=0;r<16;++r)write_biff_rec(e,224,write_XF({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(n){write_biff_rec(e,224,write_XF(n,0,t))})}function write_ws_biff8_hlinks(e,t){for(var r=0;r<t["!links"].length;++r){var n=t["!links"][r];write_biff_rec(e,440,write_HLink(n)),n[1].Tooltip&&write_biff_rec(e,2048,write_HLinkTooltip(n))}delete t["!links"]}function write_ws_cols_biff8(e,t){if(t){var r=0;t.forEach(function(n,Ee){++r<=256&&n&&write_biff_rec(e,125,write_ColInfo(col_obj_w(Ee,n),Ee))})}}function write_ws_biff8_cell(e,t,r,n,Ee){var Ce=16+get_cell_style(Ee.cellXfs,t,Ee);if(t.v==null&&!t.bf){write_biff_rec(e,513,write_XLSCell(r,n,Ce));return}if(t.bf)write_biff_rec(e,6,write_Formula(t,r,n,Ee,Ce));else switch(t.t){case"d":case"n":var De=t.t=="d"?datenum(parseDate(t.v)):t.v;write_biff_rec(e,515,write_Number(r,n,De,Ce));break;case"b":case"e":write_biff_rec(e,517,write_BoolErr(r,n,t.v,Ce,Ee,t.t));break;case"s":case"str":if(Ee.bookSST){var Me=get_sst_id(Ee.Strings,t.v,Ee.revStrings);write_biff_rec(e,253,write_LabelSst(r,n,Me,Ce))}else write_biff_rec(e,516,write_Label(r,n,(t.v||"").slice(0,255),Ce,Ee));break;default:write_biff_rec(e,513,write_XLSCell(r,n,Ce))}}function write_ws_biff8(e,t,r){var n=buf_array(),Ee=r.SheetNames[e],Ce=r.Sheets[Ee]||{},De=(r||{}).Workbook||{},Me=(De.Sheets||[])[e]||{},ze=Array.isArray(Ce),Oe=t.biff==8,Be,He="",Ve=[],Xe=safe_decode_range(Ce["!ref"]||"A1"),We=Oe?65536:16384;if(Xe.e.c>255||Xe.e.r>=We){if(t.WTF)throw new Error("Range "+(Ce["!ref"]||"A1")+" exceeds format limit A1:IV16384");Xe.e.c=Math.min(Xe.e.c,255),Xe.e.r=Math.min(Xe.e.c,We-1)}write_biff_rec(n,2057,write_BOF(r,16,t)),write_biff_rec(n,13,writeuint16(1)),write_biff_rec(n,12,writeuint16(100)),write_biff_rec(n,15,writebool(!0)),write_biff_rec(n,17,writebool(!1)),write_biff_rec(n,16,write_Xnum(.001)),write_biff_rec(n,95,writebool(!0)),write_biff_rec(n,42,writebool(!1)),write_biff_rec(n,43,writebool(!1)),write_biff_rec(n,130,writeuint16(1)),write_biff_rec(n,128,write_Guts()),write_biff_rec(n,131,writebool(!1)),write_biff_rec(n,132,writebool(!1)),Oe&&write_ws_cols_biff8(n,Ce["!cols"]),write_biff_rec(n,512,write_Dimensions(Xe,t)),Oe&&(Ce["!links"]=[]);for(var Ge=Xe.s.r;Ge<=Xe.e.r;++Ge){He=encode_row(Ge);for(var $e=Xe.s.c;$e<=Xe.e.c;++$e){Ge===Xe.s.r&&(Ve[$e]=encode_col($e)),Be=Ve[$e]+He;var Ke=ze?(Ce[Ge]||[])[$e]:Ce[Be];Ke&&(write_ws_biff8_cell(n,Ke,Ge,$e,t),Oe&&Ke.l&&Ce["!links"].push([Be,Ke.l]))}}var rr=Me.CodeName||Me.name||Ee;return Oe&&write_biff_rec(n,574,write_Window2((De.Views||[])[0])),Oe&&(Ce["!merges"]||[]).length&&write_biff_rec(n,229,write_MergeCells(Ce["!merges"])),Oe&&write_ws_biff8_hlinks(n,Ce),write_biff_rec(n,442,write_XLUnicodeString(rr)),Oe&&write_FEAT(n,Ce),write_biff_rec(n,10),n.end()}function write_biff8_global(e,t,r){var n=buf_array(),Ee=(e||{}).Workbook||{},Ce=Ee.Sheets||[],De=Ee.WBProps||{},Me=r.biff==8,ze=r.biff==5;if(write_biff_rec(n,2057,write_BOF(e,5,r)),r.bookType=="xla"&&write_biff_rec(n,135),write_biff_rec(n,225,Me?writeuint16(1200):null),write_biff_rec(n,193,writezeroes(2)),ze&&write_biff_rec(n,191),ze&&write_biff_rec(n,192),write_biff_rec(n,226),write_biff_rec(n,92,write_WriteAccess("SheetJS",r)),write_biff_rec(n,66,writeuint16(Me?1200:1252)),Me&&write_biff_rec(n,353,writeuint16(0)),Me&&write_biff_rec(n,448),write_biff_rec(n,317,write_RRTabId(e.SheetNames.length)),Me&&e.vbaraw&&write_biff_rec(n,211),Me&&e.vbaraw){var Oe=De.CodeName||"ThisWorkbook";write_biff_rec(n,442,write_XLUnicodeString(Oe))}write_biff_rec(n,156,writeuint16(17)),write_biff_rec(n,25,writebool(!1)),write_biff_rec(n,18,writebool(!1)),write_biff_rec(n,19,writeuint16(0)),Me&&write_biff_rec(n,431,writebool(!1)),Me&&write_biff_rec(n,444,writeuint16(0)),write_biff_rec(n,61,write_Window1()),write_biff_rec(n,64,writebool(!1)),write_biff_rec(n,141,writeuint16(0)),write_biff_rec(n,34,writebool(safe1904(e)=="true")),write_biff_rec(n,14,writebool(!0)),Me&&write_biff_rec(n,439,writebool(!1)),write_biff_rec(n,218,writeuint16(0)),write_FONTS_biff8(n,e,r),write_FMTS_biff8(n,e.SSF,r),write_CELLXFS_biff8(n,r),Me&&write_biff_rec(n,352,writebool(!1));var Be=n.end(),He=buf_array();Me&&write_biff_rec(He,140,write_Country()),Me&&r.Strings&&write_biff_continue(He,252,write_SST(r.Strings)),write_biff_rec(He,10);var Ve=He.end(),Xe=buf_array(),We=0,Ge=0;for(Ge=0;Ge<e.SheetNames.length;++Ge)We+=(Me?12:11)+(Me?2:1)*e.SheetNames[Ge].length;var $e=Be.length+We+Ve.length;for(Ge=0;Ge<e.SheetNames.length;++Ge){var Ke=Ce[Ge]||{};write_biff_rec(Xe,133,write_BoundSheet8({pos:$e,hs:Ke.Hidden||0,dt:0,name:e.SheetNames[Ge]},r)),$e+=t[Ge].length}var rr=Xe.end();if(We!=rr.length)throw new Error("BS8 "+We+" != "+rr.length);var tr=[];return Be.length&&tr.push(Be),rr.length&&tr.push(rr),Ve.length&&tr.push(Ve),bconcat(tr)}function write_biff8_buf(e,t){var r=t||{},n=[];e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),r.revssf=evert_num(e.SSF),r.revssf[e.SSF[65535]]=0,r.ssf=e.SSF),r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,fix_write_opts(r),r.cellXfs=[],get_cell_style(r.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var Ee=0;Ee<e.SheetNames.length;++Ee)n[n.length]=write_ws_biff8(Ee,r,e);return n.unshift(write_biff8_global(e,n,r)),bconcat(n)}function write_biff_buf(e,t){for(var r=0;r<=e.SheetNames.length;++r){var n=e.Sheets[e.SheetNames[r]];if(!(!n||!n["!ref"])){var Ee=decode_range(n["!ref"]);Ee.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[r]+"' extends beyond column IV (255).  Data may be lost.")}}var Ce=t||{};switch(Ce.biff||2){case 8:case 5:return write_biff8_buf(e,t);case 4:case 3:case 2:return write_biff2_buf(e,t)}throw new Error("invalid type "+Ce.bookType+" for BIFF")}function html_to_sheet(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var Ee=e.match(/<table/i);if(!Ee)throw new Error("Invalid HTML: could not find <table>");var Ce=e.match(/<\/table/i),De=Ee.index,Me=Ce&&Ce.index||e.length,ze=split_regex(e.slice(De,Me),/(:?<tr[^>]*>)/i,"<tr>"),Oe=-1,Be=0,He=0,Ve=0,Xe={s:{r:1e7,c:1e7},e:{r:0,c:0}},We=[];for(De=0;De<ze.length;++De){var Ge=ze[De].trim(),$e=Ge.slice(0,3).toLowerCase();if($e=="<tr"){if(++Oe,r.sheetRows&&r.sheetRows<=Oe){--Oe;break}Be=0;continue}if(!($e!="<td"&&$e!="<th")){var Ke=Ge.split(/<\/t[dh]>/i);for(Me=0;Me<Ke.length;++Me){var rr=Ke[Me].trim();if(rr.match(/<t[dh]/i)){for(var tr=rr,sr=0;tr.charAt(0)=="<"&&(sr=tr.indexOf(">"))>-1;)tr=tr.slice(sr+1);for(var ar=0;ar<We.length;++ar){var hr=We[ar];hr.s.c==Be&&hr.s.r<Oe&&Oe<=hr.e.r&&(Be=hr.e.c+1,ar=-1)}var pr=parsexmltag(rr.slice(0,rr.indexOf(">")));Ve=pr.colspan?+pr.colspan:1,((He=+pr.rowspan)>1||Ve>1)&&We.push({s:{r:Oe,c:Be},e:{r:Oe+(He||1)-1,c:Be+Ve-1}});var yr=pr.t||pr["data-t"]||"";if(!tr.length){Be+=Ve;continue}if(tr=htmldecode(tr),Xe.s.r>Oe&&(Xe.s.r=Oe),Xe.e.r<Oe&&(Xe.e.r=Oe),Xe.s.c>Be&&(Xe.s.c=Be),Xe.e.c<Be&&(Xe.e.c=Be),!tr.length){Be+=Ve;continue}var fr={t:"s",v:tr};r.raw||!tr.trim().length||yr=="s"||(tr==="TRUE"?fr={t:"b",v:!0}:tr==="FALSE"?fr={t:"b",v:!1}:isNaN(fuzzynum(tr))?isNaN(fuzzydate(tr).getDate())||(fr={t:"d",v:parseDate(tr)},r.cellDates||(fr={t:"n",v:datenum(fr.v)}),fr.z=r.dateNF||table_fmt[14]):fr={t:"n",v:fuzzynum(tr)}),r.dense?(n[Oe]||(n[Oe]=[]),n[Oe][Be]=fr):n[encode_cell({r:Oe,c:Be})]=fr,Be+=Ve}}}}return n["!ref"]=encode_range(Xe),We.length&&(n["!merges"]=We),n}function make_html_row(e,t,r,n){for(var Ee=e["!merges"]||[],Ce=[],De=t.s.c;De<=t.e.c;++De){for(var Me=0,ze=0,Oe=0;Oe<Ee.length;++Oe)if(!(Ee[Oe].s.r>r||Ee[Oe].s.c>De)&&!(Ee[Oe].e.r<r||Ee[Oe].e.c<De)){if(Ee[Oe].s.r<r||Ee[Oe].s.c<De){Me=-1;break}Me=Ee[Oe].e.r-Ee[Oe].s.r+1,ze=Ee[Oe].e.c-Ee[Oe].s.c+1;break}if(!(Me<0)){var Be=encode_cell({r,c:De}),He=n.dense?(e[r]||[])[De]:e[Be],Ve=He&&He.v!=null&&(He.h||escapehtml(He.w||(format_cell(He),He.w)||""))||"",Xe={};Me>1&&(Xe.rowspan=Me),ze>1&&(Xe.colspan=ze),n.editable?Ve='<span contenteditable="true">'+Ve+"</span>":He&&(Xe["data-t"]=He&&He.t||"z",He.v!=null&&(Xe["data-v"]=He.v),He.z!=null&&(Xe["data-z"]=He.z),He.l&&(He.l.Target||"#").charAt(0)!="#"&&(Ve='<a href="'+He.l.Target+'">'+Ve+"</a>")),Xe.id=(n.id||"sjs")+"-"+Be,Ce.push(writextag("td",Ve,Xe))}}var We="<tr>";return We+Ce.join("")+"</tr>"}var HTML_BEGIN='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',HTML_END="</body></html>";function html_to_workbook(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return sheet_to_workbook(html_to_sheet(r[0],t),t);var n=book_new();return r.forEach(function(Ee,Ce){book_append_sheet(n,html_to_sheet(Ee,t),"Sheet"+(Ce+1))}),n}function make_html_preamble(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function sheet_to_html(e,t){var r=t||{},n=r.header!=null?r.header:HTML_BEGIN,Ee=r.footer!=null?r.footer:HTML_END,Ce=[n],De=decode_range(e["!ref"]);r.dense=Array.isArray(e),Ce.push(make_html_preamble(e,De,r));for(var Me=De.s.r;Me<=De.e.r;++Me)Ce.push(make_html_row(e,De,Me,r));return Ce.push("</table>"+Ee),Ce.join("")}function sheet_add_dom(e,t,r){var n=r||{},Ee=0,Ce=0;if(n.origin!=null)if(typeof n.origin=="number")Ee=n.origin;else{var De=typeof n.origin=="string"?decode_cell(n.origin):n.origin;Ee=De.r,Ce=De.c}var Me=t.getElementsByTagName("tr"),ze=Math.min(n.sheetRows||1e7,Me.length),Oe={s:{r:0,c:0},e:{r:Ee,c:Ce}};if(e["!ref"]){var Be=decode_range(e["!ref"]);Oe.s.r=Math.min(Oe.s.r,Be.s.r),Oe.s.c=Math.min(Oe.s.c,Be.s.c),Oe.e.r=Math.max(Oe.e.r,Be.e.r),Oe.e.c=Math.max(Oe.e.c,Be.e.c),Ee==-1&&(Oe.e.r=Ee=Be.e.r+1)}var He=[],Ve=0,Xe=e["!rows"]||(e["!rows"]=[]),We=0,Ge=0,$e=0,Ke=0,rr=0,tr=0;for(e["!cols"]||(e["!cols"]=[]);We<Me.length&&Ge<ze;++We){var sr=Me[We];if(is_dom_element_hidden(sr)){if(n.display)continue;Xe[Ge]={hidden:!0}}var ar=sr.children;for($e=Ke=0;$e<ar.length;++$e){var hr=ar[$e];if(!(n.display&&is_dom_element_hidden(hr))){var pr=hr.hasAttribute("data-v")?hr.getAttribute("data-v"):hr.hasAttribute("v")?hr.getAttribute("v"):htmldecode(hr.innerHTML),yr=hr.getAttribute("data-z")||hr.getAttribute("z");for(Ve=0;Ve<He.length;++Ve){var fr=He[Ve];fr.s.c==Ke+Ce&&fr.s.r<Ge+Ee&&Ge+Ee<=fr.e.r&&(Ke=fr.e.c+1-Ce,Ve=-1)}tr=+hr.getAttribute("colspan")||1,((rr=+hr.getAttribute("rowspan")||1)>1||tr>1)&&He.push({s:{r:Ge+Ee,c:Ke+Ce},e:{r:Ge+Ee+(rr||1)-1,c:Ke+Ce+(tr||1)-1}});var Rr={t:"s",v:pr},mr=hr.getAttribute("data-t")||hr.getAttribute("t")||"";pr!=null&&(pr.length==0?Rr.t=mr||"z":n.raw||pr.trim().length==0||mr=="s"||(pr==="TRUE"?Rr={t:"b",v:!0}:pr==="FALSE"?Rr={t:"b",v:!1}:isNaN(fuzzynum(pr))?isNaN(fuzzydate(pr).getDate())||(Rr={t:"d",v:parseDate(pr)},n.cellDates||(Rr={t:"n",v:datenum(Rr.v)}),Rr.z=n.dateNF||table_fmt[14]):Rr={t:"n",v:fuzzynum(pr)})),Rr.z===void 0&&yr!=null&&(Rr.z=yr);var wr="",Fr=hr.getElementsByTagName("A");if(Fr&&Fr.length)for(var Mr=0;Mr<Fr.length&&!(Fr[Mr].hasAttribute("href")&&(wr=Fr[Mr].getAttribute("href"),wr.charAt(0)!="#"));++Mr);wr&&wr.charAt(0)!="#"&&(Rr.l={Target:wr}),n.dense?(e[Ge+Ee]||(e[Ge+Ee]=[]),e[Ge+Ee][Ke+Ce]=Rr):e[encode_cell({c:Ke+Ce,r:Ge+Ee})]=Rr,Oe.e.c<Ke+Ce&&(Oe.e.c=Ke+Ce),Ke+=tr}}++Ge}return He.length&&(e["!merges"]=(e["!merges"]||[]).concat(He)),Oe.e.r=Math.max(Oe.e.r,Ge-1+Ee),e["!ref"]=encode_range(Oe),Ge>=ze&&(e["!fullref"]=encode_range((Oe.e.r=Me.length-We+Ge-1+Ee,Oe))),e}function parse_dom_table(e,t){var r=t||{},n=r.dense?[]:{};return sheet_add_dom(n,e,t)}function table_to_book(e,t){return sheet_to_workbook(parse_dom_table(e,t),t)}function is_dom_element_hidden(e){var t="",r=get_get_computed_style_function(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function get_get_computed_style_function(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function parse_text_p(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,Ee){return Array(parseInt(Ee,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=unescapexml(t.replace(/<[^>]*>/g,""));return[r]}var number_formats_ods={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function parse_content_xml(e,t){var r=t||{},n=xlml_normalize(e),Ee=[],Ce,De,Me={name:""},ze="",Oe=0,Be,He,Ve={},Xe=[],We=r.dense?[]:{},Ge,$e,Ke={value:""},rr="",tr=0,sr=[],ar=-1,hr=-1,pr={s:{r:1e6,c:1e7},e:{r:0,c:0}},yr=0,fr={},Rr=[],mr={},wr=0,Fr=0,Mr=[],Hr=1,Nr=1,Ar=[],xr={Names:[]},ir={},_r=["",""],ur=[],Je={},nr="",or=0,lr=!1,St=!1,dr=0;for(xlmlregex.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");Ge=xlmlregex.exec(n);)switch(Ge[3]=Ge[3].replace(/_.*$/,"")){case"table":case"":Ge[1]==="/"?(pr.e.c>=pr.s.c&&pr.e.r>=pr.s.r?We["!ref"]=encode_range(pr):We["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=pr.e.r&&(We["!fullref"]=We["!ref"],pr.e.r=r.sheetRows-1,We["!ref"]=encode_range(pr)),Rr.length&&(We["!merges"]=Rr),Mr.length&&(We["!rows"]=Mr),Be.name=Be.||Be.name,typeof JSON<"u"&&JSON.stringify(Be),Xe.push(Be.name),Ve[Be.name]=We,St=!1):Ge[0].charAt(Ge[0].length-2)!=="/"&&(Be=parsexmltag(Ge[0],!1),ar=hr=-1,pr.s.r=pr.s.c=1e7,pr.e.r=pr.e.c=0,We=r.dense?[]:{},Rr=[],Mr=[],St=!0);break;case"table-row-group":Ge[1]==="/"?--yr:++yr;break;case"table-row":case"":if(Ge[1]==="/"){ar+=Hr,Hr=1;break}if(He=parsexmltag(Ge[0],!1),He.?ar=He.-1:ar==-1&&(ar=0),Hr=+He["number-rows-repeated"]||1,Hr<10)for(dr=0;dr<Hr;++dr)yr>0&&(Mr[ar+dr]={level:yr});hr=-1;break;case"covered-table-cell":Ge[1]!=="/"&&++hr,r.sheetStubs&&(r.dense?(We[ar]||(We[ar]=[]),We[ar][hr]={t:"z"}):We[encode_cell({r:ar,c:hr})]={t:"z"}),rr="",sr=[];break;case"table-cell":case"":if(Ge[0].charAt(Ge[0].length-2)==="/")++hr,Ke=parsexmltag(Ge[0],!1),Nr=parseInt(Ke["number-columns-repeated"]||"1",10),$e={t:"z",v:null},Ke.formula&&r.cellFormula!=!1&&($e.f=ods_to_csf_formula(unescapexml(Ke.formula))),(Ke.||Ke["value-type"])=="string"&&($e.t="s",$e.v=unescapexml(Ke["string-value"]||""),r.dense?(We[ar]||(We[ar]=[]),We[ar][hr]=$e):We[encode_cell({r:ar,c:hr})]=$e),hr+=Nr-1;else if(Ge[1]!=="/"){++hr,rr="",tr=0,sr=[],Nr=1;var vr=Hr?ar+Hr-1:ar;if(hr>pr.e.c&&(pr.e.c=hr),hr<pr.s.c&&(pr.s.c=hr),ar<pr.s.r&&(pr.s.r=ar),vr>pr.e.r&&(pr.e.r=vr),Ke=parsexmltag(Ge[0],!1),ur=[],Je={},$e={t:Ke.||Ke["value-type"],v:null},r.cellFormula)if(Ke.formula&&(Ke.formula=unescapexml(Ke.formula)),Ke["number-matrix-columns-spanned"]&&Ke["number-matrix-rows-spanned"]&&(wr=parseInt(Ke["number-matrix-rows-spanned"],10)||0,Fr=parseInt(Ke["number-matrix-columns-spanned"],10)||0,mr={s:{r:ar,c:hr},e:{r:ar+wr-1,c:hr+Fr-1}},$e.F=encode_range(mr),Ar.push([mr,$e.F])),Ke.formula)$e.f=ods_to_csf_formula(Ke.formula);else for(dr=0;dr<Ar.length;++dr)ar>=Ar[dr][0].s.r&&ar<=Ar[dr][0].e.r&&hr>=Ar[dr][0].s.c&&hr<=Ar[dr][0].e.c&&($e.F=Ar[dr][1]);switch((Ke["number-columns-spanned"]||Ke["number-rows-spanned"])&&(wr=parseInt(Ke["number-rows-spanned"],10)||0,Fr=parseInt(Ke["number-columns-spanned"],10)||0,mr={s:{r:ar,c:hr},e:{r:ar+wr-1,c:hr+Fr-1}},Rr.push(mr)),Ke["number-columns-repeated"]&&(Nr=parseInt(Ke["number-columns-repeated"],10)),$e.t){case"boolean":$e.t="b",$e.v=parsexmlbool(Ke["boolean-value"]);break;case"float":$e.t="n",$e.v=parseFloat(Ke.value);break;case"percentage":$e.t="n",$e.v=parseFloat(Ke.value);break;case"currency":$e.t="n",$e.v=parseFloat(Ke.value);break;case"date":$e.t="d",$e.v=parseDate(Ke["date-value"]),r.cellDates||($e.t="n",$e.v=datenum($e.v)),$e.z="m/d/yy";break;case"time":$e.t="n",$e.v=parse_isodur(Ke["time-value"])/86400,r.cellDates&&($e.t="d",$e.v=numdate($e.v)),$e.z="HH:MM:SS";break;case"number":$e.t="n",$e.v=parseFloat(Ke.);break;default:if($e.t==="string"||$e.t==="text"||!$e.t)$e.t="s",Ke["string-value"]!=null&&(rr=unescapexml(Ke["string-value"]),sr=[]);else throw new Error("Unsupported value type "+$e.t)}}else{if(lr=!1,$e.t==="s"&&($e.v=rr||"",sr.length&&($e.R=sr),lr=tr==0),ir.Target&&($e.l=ir),ur.length>0&&($e.c=ur,ur=[]),rr&&r.cellText!==!1&&($e.w=rr),lr&&($e.t="z",delete $e.v),(!lr||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=ar))for(var br=0;br<Hr;++br){if(Nr=parseInt(Ke["number-columns-repeated"]||"1",10),r.dense)for(We[ar+br]||(We[ar+br]=[]),We[ar+br][hr]=br==0?$e:dup($e);--Nr>0;)We[ar+br][hr+Nr]=dup($e);else for(We[encode_cell({r:ar+br,c:hr})]=$e;--Nr>0;)We[encode_cell({r:ar+br,c:hr+Nr})]=dup($e);pr.e.c<=hr&&(pr.e.c=hr)}Nr=parseInt(Ke["number-columns-repeated"]||"1",10),hr+=Nr-1,Nr=0,$e={},rr="",sr=[]}ir={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(Ge[1]==="/"){if((Ce=Ee.pop())[0]!==Ge[3])throw"Bad state: "+Ce}else Ge[0].charAt(Ge[0].length-2)!=="/"&&Ee.push([Ge[3],!0]);break;case"annotation":if(Ge[1]==="/"){if((Ce=Ee.pop())[0]!==Ge[3])throw"Bad state: "+Ce;Je.t=rr,sr.length&&(Je.R=sr),Je.a=nr,ur.push(Je)}else Ge[0].charAt(Ge[0].length-2)!=="/"&&Ee.push([Ge[3],!1]);nr="",or=0,rr="",tr=0,sr=[];break;case"creator":Ge[1]==="/"?nr=n.slice(or,Ge.index):or=Ge.index+Ge[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(Ge[1]==="/"){if((Ce=Ee.pop())[0]!==Ge[3])throw"Bad state: "+Ce}else Ge[0].charAt(Ge[0].length-2)!=="/"&&Ee.push([Ge[3],!1]);rr="",tr=0,sr=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(Ge[1]==="/"){if(fr[Me.name]=ze,(Ce=Ee.pop())[0]!==Ge[3])throw"Bad state: "+Ce}else Ge[0].charAt(Ge[0].length-2)!=="/"&&(ze="",Me=parsexmltag(Ge[0],!1),Ee.push([Ge[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(Ee[Ee.length-1][0]){case"time-style":case"date-style":De=parsexmltag(Ge[0],!1),ze+=number_formats_ods[Ge[3]][De.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(Ee[Ee.length-1][0]){case"time-style":case"date-style":De=parsexmltag(Ge[0],!1),ze+=number_formats_ods[Ge[3]][De.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(Ge[0].slice(-2)==="/>")break;if(Ge[1]==="/")switch(Ee[Ee.length-1][0]){case"number-style":case"date-style":case"time-style":ze+=n.slice(Oe,Ge.index);break}else Oe=Ge.index+Ge[0].length;break;case"named-range":De=parsexmltag(Ge[0],!1),_r=ods_to_csf_3D(De["cell-range-address"]);var kr={Name:De.name,Ref:_r[0]+"!"+_r[1]};St&&(kr.Sheet=Xe.length),xr.Names.push(kr);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(Ee[Ee.length-1][0])>-1)break;if(Ge[1]==="/"&&(!Ke||!Ke["string-value"])){var Pr=parse_text_p(n.slice(tr,Ge.index));rr=(rr.length>0?rr+`
`:"")+Pr[0]}else parsexmltag(Ge[0],!1),tr=Ge.index+Ge[0].length;break;case"s":break;case"database-range":if(Ge[1]==="/")break;try{_r=ods_to_csf_3D(parsexmltag(Ge[0])["target-range-address"]),Ve[_r[0]]["!autofilter"]={ref:_r[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(Ge[1]!=="/"){if(ir=parsexmltag(Ge[0],!1),!ir.href)break;ir.Target=unescapexml(ir.href),delete ir.href,ir.Target.charAt(0)=="#"&&ir.Target.indexOf(".")>-1?(_r=ods_to_csf_3D(ir.Target.slice(1)),ir.Target="#"+_r[0]+"!"+_r[1]):ir.Target.match(/^\.\.[\\\/]/)&&(ir.Target=ir.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(Ge[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(r.WTF)throw new Error(Ge)}}var Er={Sheets:Ve,SheetNames:Xe,Workbook:xr};return r.bookSheets&&delete Er.Sheets,Er}function parse_ods(e,t){t=t||{},safegetzipfile(e,"META-INF/manifest.xml")&&parse_manifest(getzipdata(e,"META-INF/manifest.xml"),t);var r=getzipstr(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=parse_content_xml(utf8read(r),t);return safegetzipfile(e,"meta.xml")&&(n.Props=parse_core_props(getzipdata(e,"meta.xml"))),n}function parse_fods(e,t){return parse_content_xml(e,t)}var write_styles_ods=(function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return XML_HEADER+t}})(),write_content_ods=(function(){var e=function(Ce){return escapexml(Ce).replace(/  +/g,function(De){return'<text:s text:c="'+De.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,r=`          <table:covered-table-cell/>
`,n=function(Ce,De,Me){var ze=[];ze.push('      <table:table table:name="'+escapexml(De.SheetNames[Me])+`" table:style-name="ta1">
`);var Oe=0,Be=0,He=decode_range(Ce["!ref"]||"A1"),Ve=Ce["!merges"]||[],Xe=0,We=Array.isArray(Ce);if(Ce["!cols"])for(Be=0;Be<=He.e.c;++Be)ze.push("        <table:table-column"+(Ce["!cols"][Be]?' table:style-name="co'+Ce["!cols"][Be].ods+'"':"")+`></table:table-column>
`);var Ge="",$e=Ce["!rows"]||[];for(Oe=0;Oe<He.s.r;++Oe)Ge=$e[Oe]?' table:style-name="ro'+$e[Oe].ods+'"':"",ze.push("        <table:table-row"+Ge+`></table:table-row>
`);for(;Oe<=He.e.r;++Oe){for(Ge=$e[Oe]?' table:style-name="ro'+$e[Oe].ods+'"':"",ze.push("        <table:table-row"+Ge+`>
`),Be=0;Be<He.s.c;++Be)ze.push(t);for(;Be<=He.e.c;++Be){var Ke=!1,rr={},tr="";for(Xe=0;Xe!=Ve.length;++Xe)if(!(Ve[Xe].s.c>Be)&&!(Ve[Xe].s.r>Oe)&&!(Ve[Xe].e.c<Be)&&!(Ve[Xe].e.r<Oe)){(Ve[Xe].s.c!=Be||Ve[Xe].s.r!=Oe)&&(Ke=!0),rr["table:number-columns-spanned"]=Ve[Xe].e.c-Ve[Xe].s.c+1,rr["table:number-rows-spanned"]=Ve[Xe].e.r-Ve[Xe].s.r+1;break}if(Ke){ze.push(r);continue}var sr=encode_cell({r:Oe,c:Be}),ar=We?(Ce[Oe]||[])[Be]:Ce[sr];if(ar&&ar.f&&(rr["table:formula"]=escapexml(csf_to_ods_formula(ar.f)),ar.F&&ar.F.slice(0,sr.length)==sr)){var hr=decode_range(ar.F);rr["table:number-matrix-columns-spanned"]=hr.e.c-hr.s.c+1,rr["table:number-matrix-rows-spanned"]=hr.e.r-hr.s.r+1}if(!ar){ze.push(t);continue}switch(ar.t){case"b":tr=ar.v?"TRUE":"FALSE",rr["office:value-type"]="boolean",rr["office:boolean-value"]=ar.v?"true":"false";break;case"n":tr=ar.w||String(ar.v||0),rr["office:value-type"]="float",rr["office:value"]=ar.v||0;break;case"s":case"str":tr=ar.v==null?"":ar.v,rr["office:value-type"]="string";break;case"d":tr=ar.w||parseDate(ar.v).toISOString(),rr["office:value-type"]="date",rr["office:date-value"]=parseDate(ar.v).toISOString(),rr["table:style-name"]="ce1";break;default:ze.push(t);continue}var pr=e(tr);if(ar.l&&ar.l.Target){var yr=ar.l.Target;yr=yr.charAt(0)=="#"?"#"+csf_to_ods_3D(yr.slice(1)):yr,yr.charAt(0)!="#"&&!yr.match(/^\w+:/)&&(yr="../"+yr),pr=writextag("text:a",pr,{"xlink:href":yr.replace(/&/g,"&amp;")})}ze.push("          "+writextag("table:table-cell",writextag("text:p",pr,{}),rr)+`
`)}ze.push(`        </table:table-row>
`)}return ze.push(`      </table:table>
`),ze.join("")},Ee=function(Ce,De){Ce.push(` <office:automatic-styles>
`),Ce.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),Ce.push(`   <number:month number:style="long"/>
`),Ce.push(`   <number:text>/</number:text>
`),Ce.push(`   <number:day number:style="long"/>
`),Ce.push(`   <number:text>/</number:text>
`),Ce.push(`   <number:year/>
`),Ce.push(`  </number:date-style>
`);var Me=0;De.SheetNames.map(function(Oe){return De.Sheets[Oe]}).forEach(function(Oe){if(Oe&&Oe["!cols"]){for(var Be=0;Be<Oe["!cols"].length;++Be)if(Oe["!cols"][Be]){var He=Oe["!cols"][Be];if(He.width==null&&He.wpx==null&&He.wch==null)continue;process_col(He),He.ods=Me;var Ve=Oe["!cols"][Be].wpx+"px";Ce.push('  <style:style style:name="co'+Me+`" style:family="table-column">
`),Ce.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+Ve+`"/>
`),Ce.push(`  </style:style>
`),++Me}}});var ze=0;De.SheetNames.map(function(Oe){return De.Sheets[Oe]}).forEach(function(Oe){if(Oe&&Oe["!rows"]){for(var Be=0;Be<Oe["!rows"].length;++Be)if(Oe["!rows"][Be]){Oe["!rows"][Be].ods=ze;var He=Oe["!rows"][Be].hpx+"px";Ce.push('  <style:style style:name="ro'+ze+`" style:family="table-row">
`),Ce.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+He+`"/>
`),Ce.push(`  </style:style>
`),++ze}}}),Ce.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),Ce.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),Ce.push(`  </style:style>
`),Ce.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),Ce.push(` </office:automatic-styles>
`)};return function(De,Me){var ze=[XML_HEADER],Oe=wxt_helper({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),Be=wxt_helper({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});Me.bookType=="fods"?(ze.push("<office:document"+Oe+Be+`>
`),ze.push(write_meta_ods().replace(/office:document-meta/g,"office:meta"))):ze.push("<office:document-content"+Oe+`>
`),Ee(ze,De),ze.push(`  <office:body>
`),ze.push(`    <office:spreadsheet>
`);for(var He=0;He!=De.SheetNames.length;++He)ze.push(n(De.Sheets[De.SheetNames[He]],De,He));return ze.push(`    </office:spreadsheet>
`),ze.push(`  </office:body>
`),Me.bookType=="fods"?ze.push("</office:document>"):ze.push("</office:document-content>"),ze.join("")}})();function write_ods(e,t){if(t.bookType=="fods")return write_content_ods(e,t);var r=zip_new(),n="",Ee=[],Ce=[];return n="mimetype",zip_add_file(r,n,"application/vnd.oasis.opendocument.spreadsheet"),n="content.xml",zip_add_file(r,n,write_content_ods(e,t)),Ee.push([n,"text/xml"]),Ce.push([n,"ContentFile"]),n="styles.xml",zip_add_file(r,n,write_styles_ods(e,t)),Ee.push([n,"text/xml"]),Ce.push([n,"StylesFile"]),n="meta.xml",zip_add_file(r,n,XML_HEADER+write_meta_ods()),Ee.push([n,"text/xml"]),Ce.push([n,"MetadataFile"]),n="manifest.rdf",zip_add_file(r,n,write_rdf(Ce)),Ee.push([n,"application/rdf+xml"]),n="META-INF/manifest.xml",zip_add_file(r,n,write_manifest(Ee)),r}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function u8_to_dataview(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function u8str(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):utf8read(a2s(e))}function stru8(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):s2a(utf8write(e))}function u8contains(e,t){e:for(var r=0;r<=e.length-t.length;++r){for(var n=0;n<t.length;++n)if(e[r+n]!=t[n])continue e;return!0}return!1}function u8concat(e){var t=e.reduce(function(Ee,Ce){return Ee+Ce.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(Ee){r.set(Ee,n),n+=Ee.length}),r}function popcnt(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function readDecimal128LE(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,Ee=t+13;Ee>=t;--Ee)n=n*256+e[Ee];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function writeDecimal128LE(e,t,r){var n=Math.floor(r==0?0:Math.LOG10E*Math.log(Math.abs(r)))+6176-20,Ee=r/Math.pow(10,n-6176);e[t+15]|=n>>7,e[t+14]|=(n&127)<<1;for(var Ce=0;Ee>=1;++Ce,Ee/=256)e[t+Ce]=Ee&255;e[t+15]|=r>=0?0:128}function parse_varint49(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function write_varint49(e){var t=new Uint8Array(7);t[0]=e&127;var r=1;e:if(e>127){if(t[r-1]|=128,t[r]=e>>7&127,++r,e<=16383||(t[r-1]|=128,t[r]=e>>14&127,++r,e<=2097151)||(t[r-1]|=128,t[r]=e>>21&127,++r,e<=268435455)||(t[r-1]|=128,t[r]=e/256>>>21&127,++r,e<=34359738367)||(t[r-1]|=128,t[r]=e/65536>>>21&127,++r,e<=4398046511103))break e;t[r-1]|=128,t[r]=e/16777216>>>21&127,++r}return t.slice(0,r)}function varint_to_i32(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function parse_shallow(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],Ee=parse_varint49(e,r),Ce=Ee&7;Ee=Math.floor(Ee/8);var De=0,Me;if(Ee==0)break;switch(Ce){case 0:{for(var ze=r[0];e[r[0]++]>=128;);Me=e.slice(ze,r[0])}break;case 5:De=4,Me=e.slice(r[0],r[0]+De),r[0]+=De;break;case 1:De=8,Me=e.slice(r[0],r[0]+De),r[0]+=De;break;case 2:De=parse_varint49(e,r),Me=e.slice(r[0],r[0]+De),r[0]+=De;break;case 3:case 4:default:throw new Error("PB Type ".concat(Ce," for Field ").concat(Ee," at offset ").concat(n))}var Oe={data:Me,type:Ce};t[Ee]==null?t[Ee]=[Oe]:t[Ee].push(Oe)}return t}function write_shallow(e){var t=[];return e.forEach(function(r,n){r.forEach(function(Ee){Ee.data&&(t.push(write_varint49(n*8+Ee.type)),Ee.type==2&&t.push(write_varint49(Ee.data.length)),t.push(Ee.data))})}),u8concat(t)}function mappa(e,t){return e?.map(function(r){return t(r.data)})||[]}function parse_iwa_file(e){for(var t,r=[],n=[0];n[0]<e.length;){var Ee=parse_varint49(e,n),Ce=parse_shallow(e.slice(n[0],n[0]+Ee));n[0]+=Ee;var De={id:varint_to_i32(Ce[1][0].data),messages:[]};Ce[2].forEach(function(Me){var ze=parse_shallow(Me.data),Oe=varint_to_i32(ze[3][0].data);De.messages.push({meta:ze,data:e.slice(n[0],n[0]+Oe)}),n[0]+=Oe}),(t=Ce[3])!=null&&t[0]&&(De.merge=varint_to_i32(Ce[3][0].data)>>>0>0),r.push(De)}return r}function write_iwa_file(e){var t=[];return e.forEach(function(r){var n=[];n[1]=[{data:write_varint49(r.id),type:0}],n[2]=[],r.merge!=null&&(n[3]=[{data:write_varint49(+!!r.merge),type:0}]);var Ee=[];r.messages.forEach(function(De){Ee.push(De.data),De.meta[3]=[{type:0,data:write_varint49(De.data.length)}],n[2].push({data:write_shallow(De.meta),type:2})});var Ce=write_shallow(n);t.push(write_varint49(Ce.length)),t.push(Ce),Ee.forEach(function(De){return t.push(De)})}),u8concat(t)}function parse_snappy_chunk(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=parse_varint49(t,r),Ee=[];r[0]<t.length;){var Ce=t[r[0]]&3;if(Ce==0){var De=t[r[0]++]>>2;if(De<60)++De;else{var Me=De-59;De=t[r[0]],Me>1&&(De|=t[r[0]+1]<<8),Me>2&&(De|=t[r[0]+2]<<16),Me>3&&(De|=t[r[0]+3]<<24),De>>>=0,De++,r[0]+=Me}Ee.push(t.slice(r[0],r[0]+De)),r[0]+=De;continue}else{var ze=0,Oe=0;if(Ce==1?(Oe=(t[r[0]]>>2&7)+4,ze=(t[r[0]++]&224)<<3,ze|=t[r[0]++]):(Oe=(t[r[0]++]>>2)+1,Ce==2?(ze=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(ze=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),Ee=[u8concat(Ee)],ze==0)throw new Error("Invalid offset 0");if(ze>Ee[0].length)throw new Error("Invalid offset beyond length");if(Oe>=ze)for(Ee.push(Ee[0].slice(-ze)),Oe-=ze;Oe>=Ee[Ee.length-1].length;)Ee.push(Ee[Ee.length-1]),Oe-=Ee[Ee.length-1].length;Ee.push(Ee[0].slice(-ze,-ze+Oe))}}var Be=u8concat(Ee);if(Be.length!=n)throw new Error("Unexpected length: ".concat(Be.length," != ").concat(n));return Be}function decompress_iwa_file(e){for(var t=[],r=0;r<e.length;){var n=e[r++],Ee=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(parse_snappy_chunk(n,e.slice(r,r+Ee))),r+=Ee}if(r!==e.length)throw new Error("data is not a valid framed stream!");return u8concat(t)}function compress_iwa_file(e){for(var t=[],r=0;r<e.length;){var n=Math.min(e.length-r,268435455),Ee=new Uint8Array(4);t.push(Ee);var Ce=write_varint49(n),De=Ce.length;t.push(Ce),n<=60?(De++,t.push(new Uint8Array([n-1<<2]))):n<=256?(De+=2,t.push(new Uint8Array([240,n-1&255]))):n<=65536?(De+=3,t.push(new Uint8Array([244,n-1&255,n-1>>8&255]))):n<=16777216?(De+=4,t.push(new Uint8Array([248,n-1&255,n-1>>8&255,n-1>>16&255]))):n<=4294967296&&(De+=5,t.push(new Uint8Array([252,n-1&255,n-1>>8&255,n-1>>16&255,n-1>>>24&255]))),t.push(e.slice(r,r+n)),De+=n,Ee[0]=0,Ee[1]=De&255,Ee[2]=De>>8&255,Ee[3]=De>>16&255,r+=n}return u8concat(t)}function parse_old_storage(e,t,r,n){var Ee=u8_to_dataview(e),Ce=Ee.getUint32(4,!0),De=(n>1?12:8)+popcnt(Ce&(n>1?3470:398))*4,Me=-1,ze=-1,Oe=NaN,Be=new Date(2001,0,1);Ce&512&&(Me=Ee.getUint32(De,!0),De+=4),De+=popcnt(Ce&(n>1?12288:4096))*4,Ce&16&&(ze=Ee.getUint32(De,!0),De+=4),Ce&32&&(Oe=Ee.getFloat64(De,!0),De+=8),Ce&64&&(Be.setTime(Be.getTime()+Ee.getFloat64(De,!0)*1e3),De+=8);var He;switch(e[2]){case 0:break;case 2:He={t:"n",v:Oe};break;case 3:He={t:"s",v:t[ze]};break;case 5:He={t:"d",v:Be};break;case 6:He={t:"b",v:Oe>0};break;case 7:He={t:"n",v:Oe/86400};break;case 8:He={t:"e",v:0};break;case 9:if(Me>-1)He={t:"s",v:r[Me]};else if(ze>-1)He={t:"s",v:t[ze]};else if(!isNaN(Oe))He={t:"n",v:Oe};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return He}function parse_new_storage(e,t,r){var n=u8_to_dataview(e),Ee=n.getUint32(8,!0),Ce=12,De=-1,Me=-1,ze=NaN,Oe=NaN,Be=new Date(2001,0,1);Ee&1&&(ze=readDecimal128LE(e,Ce),Ce+=16),Ee&2&&(Oe=n.getFloat64(Ce,!0),Ce+=8),Ee&4&&(Be.setTime(Be.getTime()+n.getFloat64(Ce,!0)*1e3),Ce+=8),Ee&8&&(Me=n.getUint32(Ce,!0),Ce+=4),Ee&16&&(De=n.getUint32(Ce,!0),Ce+=4);var He;switch(e[1]){case 0:break;case 2:He={t:"n",v:ze};break;case 3:He={t:"s",v:t[Me]};break;case 5:He={t:"d",v:Be};break;case 6:He={t:"b",v:Oe>0};break;case 7:He={t:"n",v:Oe/86400};break;case 8:He={t:"e",v:0};break;case 9:if(De>-1)He={t:"s",v:r[De]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(Ee&31," : ").concat(e.slice(0,4)));break;case 10:He={t:"n",v:ze};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(Ee&31," : ").concat(e.slice(0,4)))}return He}function write_new_storage(e,t){var r=new Uint8Array(32),n=u8_to_dataview(r),Ee=12,Ce=0;switch(r[0]=5,e.t){case"n":r[1]=2,writeDecimal128LE(r,Ee,e.v),Ce|=1,Ee+=16;break;case"b":r[1]=6,n.setFloat64(Ee,e.v?1:0,!0),Ce|=2,Ee+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[1]=3,n.setUint32(Ee,t.indexOf(e.v),!0),Ce|=8,Ee+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(8,Ce,!0),r.slice(0,Ee)}function write_old_storage(e,t){var r=new Uint8Array(32),n=u8_to_dataview(r),Ee=12,Ce=0;switch(r[0]=3,e.t){case"n":r[2]=2,n.setFloat64(Ee,e.v,!0),Ce|=32,Ee+=8;break;case"b":r[2]=6,n.setFloat64(Ee,e.v?1:0,!0),Ce|=32,Ee+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));r[2]=3,n.setUint32(Ee,t.indexOf(e.v),!0),Ce|=16,Ee+=4;break;default:throw"unsupported cell type "+e.t}return n.setUint32(4,Ce,!0),r.slice(0,Ee)}function parse_cell_storage(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return parse_old_storage(e,t,r,e[0]);case 5:return parse_new_storage(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function parse_TSP_Reference(e){var t=parse_shallow(e);return parse_varint49(t[1][0].data)}function parse_TST_TableDataList(e,t){var r=parse_shallow(t.data),n=varint_to_i32(r[1][0].data),Ee=r[3],Ce=[];return(Ee||[]).forEach(function(De){var Me=parse_shallow(De.data),ze=varint_to_i32(Me[1][0].data)>>>0;switch(n){case 1:Ce[ze]=u8str(Me[3][0].data);break;case 8:{var Oe=e[parse_TSP_Reference(Me[9][0].data)][0],Be=parse_shallow(Oe.data),He=e[parse_TSP_Reference(Be[1][0].data)][0],Ve=varint_to_i32(He.meta[1][0].data);if(Ve!=2001)throw new Error("2000 unexpected reference to ".concat(Ve));var Xe=parse_shallow(He.data);Ce[ze]=Xe[3].map(function(We){return u8str(We.data)}).join("")}break}}),Ce}function parse_TST_TileRowInfo(e,t){var r,n,Ee,Ce,De,Me,ze,Oe,Be,He,Ve,Xe,We,Ge,$e=parse_shallow(e),Ke=varint_to_i32($e[1][0].data)>>>0,rr=varint_to_i32($e[2][0].data)>>>0,tr=((n=(r=$e[8])==null?void 0:r[0])==null?void 0:n.data)&&varint_to_i32($e[8][0].data)>0||!1,sr,ar;if((Ce=(Ee=$e[7])==null?void 0:Ee[0])!=null&&Ce.data&&t!=0)sr=(Me=(De=$e[7])==null?void 0:De[0])==null?void 0:Me.data,ar=(Oe=(ze=$e[6])==null?void 0:ze[0])==null?void 0:Oe.data;else if((He=(Be=$e[4])==null?void 0:Be[0])!=null&&He.data&&t!=1)sr=(Xe=(Ve=$e[4])==null?void 0:Ve[0])==null?void 0:Xe.data,ar=(Ge=(We=$e[3])==null?void 0:We[0])==null?void 0:Ge.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var hr=tr?4:1,pr=u8_to_dataview(sr),yr=[],fr=0;fr<sr.length/2;++fr){var Rr=pr.getUint16(fr*2,!0);Rr<65535&&yr.push([fr,Rr])}if(yr.length!=rr)throw"Expected ".concat(rr," cells, found ").concat(yr.length);var mr=[];for(fr=0;fr<yr.length-1;++fr)mr[yr[fr][0]]=ar.subarray(yr[fr][1]*hr,yr[fr+1][1]*hr);return yr.length>=1&&(mr[yr[yr.length-1][0]]=ar.subarray(yr[yr.length-1][1]*hr)),{R:Ke,cells:mr}}function parse_TST_Tile(e,t){var r,n=parse_shallow(t.data),Ee=(r=n?.[7])!=null&&r[0]?varint_to_i32(n[7][0].data)>>>0>0?1:0:-1,Ce=mappa(n[5],function(De){return parse_TST_TileRowInfo(De,Ee)});return{nrows:varint_to_i32(n[4][0].data)>>>0,data:Ce.reduce(function(De,Me){return De[Me.R]||(De[Me.R]=[]),Me.cells.forEach(function(ze,Oe){if(De[Me.R][Oe])throw new Error("Duplicate cell r=".concat(Me.R," c=").concat(Oe));De[Me.R][Oe]=ze}),De},[])}}function parse_TST_TableModelArchive(e,t,r){var n,Ee=parse_shallow(t.data),Ce={s:{r:0,c:0},e:{r:0,c:0}};if(Ce.e.r=(varint_to_i32(Ee[6][0].data)>>>0)-1,Ce.e.r<0)throw new Error("Invalid row varint ".concat(Ee[6][0].data));if(Ce.e.c=(varint_to_i32(Ee[7][0].data)>>>0)-1,Ce.e.c<0)throw new Error("Invalid col varint ".concat(Ee[7][0].data));r["!ref"]=encode_range(Ce);var De=parse_shallow(Ee[4][0].data),Me=parse_TST_TableDataList(e,e[parse_TSP_Reference(De[4][0].data)][0]),ze=(n=De[17])!=null&&n[0]?parse_TST_TableDataList(e,e[parse_TSP_Reference(De[17][0].data)][0]):[],Oe=parse_shallow(De[3][0].data),Be=0;Oe[1].forEach(function(He){var Ve=parse_shallow(He.data),Xe=e[parse_TSP_Reference(Ve[2][0].data)][0],We=varint_to_i32(Xe.meta[1][0].data);if(We!=6002)throw new Error("6001 unexpected reference to ".concat(We));var Ge=parse_TST_Tile(e,Xe);Ge.data.forEach(function($e,Ke){$e.forEach(function(rr,tr){var sr=encode_cell({r:Be+Ke,c:tr}),ar=parse_cell_storage(rr,Me,ze);ar&&(r[sr]=ar)})}),Be+=Ge.nrows})}function parse_TST_TableInfoArchive(e,t){var r=parse_shallow(t.data),n={"!ref":"A1"},Ee=e[parse_TSP_Reference(r[2][0].data)],Ce=varint_to_i32(Ee[0].meta[1][0].data);if(Ce!=6001)throw new Error("6000 unexpected reference to ".concat(Ce));return parse_TST_TableModelArchive(e,Ee[0],n),n}function parse_TN_SheetArchive(e,t){var r,n=parse_shallow(t.data),Ee={name:(r=n[1])!=null&&r[0]?u8str(n[1][0].data):"",sheets:[]},Ce=mappa(n[2],parse_TSP_Reference);return Ce.forEach(function(De){e[De].forEach(function(Me){var ze=varint_to_i32(Me.meta[1][0].data);ze==6e3&&Ee.sheets.push(parse_TST_TableInfoArchive(e,Me))})}),Ee}function parse_TN_DocumentArchive(e,t){var r=book_new(),n=parse_shallow(t.data),Ee=mappa(n[1],parse_TSP_Reference);if(Ee.forEach(function(Ce){e[Ce].forEach(function(De){var Me=varint_to_i32(De.meta[1][0].data);if(Me==2){var ze=parse_TN_SheetArchive(e,De);ze.sheets.forEach(function(Oe,Be){book_append_sheet(r,Oe,Be==0?ze.name:ze.name+"_"+Be,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function parse_numbers_iwa(e){var t,r,n,Ee,Ce={},De=[];if(e.FullPaths.forEach(function(ze){if(ze.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(ze){if(ze.name.match(/\.iwa$/)){var Oe;try{Oe=decompress_iwa_file(ze.content)}catch(He){return console.log("?? "+ze.content.length+" "+(He.message||He))}var Be;try{Be=parse_iwa_file(Oe)}catch(He){return console.log("## "+(He.message||He))}Be.forEach(function(He){Ce[He.id]=He.messages,De.push(He.id)})}}),!De.length)throw new Error("File has no messages");var Me=((Ee=(n=(r=(t=Ce?.[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:Ee[0].data)&&varint_to_i32(Ce[1][0].meta[1][0].data)==1&&Ce[1][0];if(Me||De.forEach(function(ze){Ce[ze].forEach(function(Oe){var Be=varint_to_i32(Oe.meta[1][0].data)>>>0;if(Be==1)if(!Me)Me=Oe;else throw new Error("Document has multiple roots")})}),!Me)throw new Error("Cannot find Document root");return parse_TN_DocumentArchive(Ce,Me)}function write_tile_row(e,t,r){var n,Ee,Ce,De;if(!((n=e[6])!=null&&n[0])||!((Ee=e[7])!=null&&Ee[0]))throw"Mutation only works on post-BNC storages!";var Me=((De=(Ce=e[8])==null?void 0:Ce[0])==null?void 0:De.data)&&varint_to_i32(e[8][0].data)>0||!1;if(Me)throw"Math only works with normal offsets";for(var ze=0,Oe=u8_to_dataview(e[7][0].data),Be=0,He=[],Ve=u8_to_dataview(e[4][0].data),Xe=0,We=[],Ge=0;Ge<t.length;++Ge){if(t[Ge]==null){Oe.setUint16(Ge*2,65535,!0),Ve.setUint16(Ge*2,65535);continue}Oe.setUint16(Ge*2,Be,!0),Ve.setUint16(Ge*2,Xe,!0);var $e,Ke;switch(typeof t[Ge]){case"string":$e=write_new_storage({t:"s",v:t[Ge]},r),Ke=write_old_storage({t:"s",v:t[Ge]},r);break;case"number":$e=write_new_storage({t:"n",v:t[Ge]},r),Ke=write_old_storage({t:"n",v:t[Ge]},r);break;case"boolean":$e=write_new_storage({t:"b",v:t[Ge]},r),Ke=write_old_storage({t:"b",v:t[Ge]},r);break;default:throw new Error("Unsupported value "+t[Ge])}He.push($e),Be+=$e.length,We.push(Ke),Xe+=Ke.length,++ze}for(e[2][0].data=write_varint49(ze);Ge<e[7][0].data.length/2;++Ge)Oe.setUint16(Ge*2,65535,!0),Ve.setUint16(Ge*2,65535,!0);return e[6][0].data=u8concat(He),e[3][0].data=u8concat(We),ze}function write_numbers_iwa(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var r=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var n=decode_range(r["!ref"]);n.s.r=n.s.c=0;var Ee=!1;n.e.c>9&&(Ee=!0,n.e.c=9),n.e.r>49&&(Ee=!0,n.e.r=49),Ee&&console.error("The Numbers writer is currently limited to ".concat(encode_range(n)));var Ce=sheet_to_json(r,{range:n,header:1}),De=["~Sh33tJ5~"];Ce.forEach(function(nr){return nr.forEach(function(or){typeof or=="string"&&De.push(or)})});var Me={},ze=[],Oe=CFB.read(t.numbers,{type:"base64"});Oe.FileIndex.map(function(nr,or){return[nr,Oe.FullPaths[or]]}).forEach(function(nr){var or=nr[0],lr=nr[1];if(or.type==2&&or.name.match(/\.iwa/)){var St=or.content,dr=decompress_iwa_file(St),vr=parse_iwa_file(dr);vr.forEach(function(br){ze.push(br.id),Me[br.id]={deps:[],location:lr,type:varint_to_i32(br.messages[0].meta[1][0].data)}})}}),ze.sort(function(nr,or){return nr-or});var Be=ze.filter(function(nr){return nr>1}).map(function(nr){return[nr,write_varint49(nr)]});Oe.FileIndex.map(function(nr,or){return[nr,Oe.FullPaths[or]]}).forEach(function(nr){var or=nr[0];if(nr[1],!!or.name.match(/\.iwa/)){var lr=parse_iwa_file(decompress_iwa_file(or.content));lr.forEach(function(St){St.messages.forEach(function(dr){Be.forEach(function(vr){St.messages.some(function(br){return varint_to_i32(br.meta[1][0].data)!=11006&&u8contains(br.data,vr[1])})&&Me[vr[0]].deps.push(St.id)})})})}});for(var He=CFB.find(Oe,Me[1].location),Ve=parse_iwa_file(decompress_iwa_file(He.content)),Xe,We=0;We<Ve.length;++We){var Ge=Ve[We];Ge.id==1&&(Xe=Ge)}var $e=parse_TSP_Reference(parse_shallow(Xe.messages[0].data)[1][0].data);for(He=CFB.find(Oe,Me[$e].location),Ve=parse_iwa_file(decompress_iwa_file(He.content)),We=0;We<Ve.length;++We)Ge=Ve[We],Ge.id==$e&&(Xe=Ge);for($e=parse_TSP_Reference(parse_shallow(Xe.messages[0].data)[2][0].data),He=CFB.find(Oe,Me[$e].location),Ve=parse_iwa_file(decompress_iwa_file(He.content)),We=0;We<Ve.length;++We)Ge=Ve[We],Ge.id==$e&&(Xe=Ge);for($e=parse_TSP_Reference(parse_shallow(Xe.messages[0].data)[2][0].data),He=CFB.find(Oe,Me[$e].location),Ve=parse_iwa_file(decompress_iwa_file(He.content)),We=0;We<Ve.length;++We)Ge=Ve[We],Ge.id==$e&&(Xe=Ge);var Ke=parse_shallow(Xe.messages[0].data);{Ke[6][0].data=write_varint49(n.e.r+1),Ke[7][0].data=write_varint49(n.e.c+1);var rr=parse_TSP_Reference(Ke[46][0].data),tr=CFB.find(Oe,Me[rr].location),sr=parse_iwa_file(decompress_iwa_file(tr.content));{for(var ar=0;ar<sr.length&&sr[ar].id!=rr;++ar);if(sr[ar].id!=rr)throw"Bad ColumnRowUIDMapArchive";var hr=parse_shallow(sr[ar].messages[0].data);hr[1]=[],hr[2]=[],hr[3]=[];for(var pr=0;pr<=n.e.c;++pr){var yr=[];yr[1]=yr[2]=[{type:0,data:write_varint49(pr+420690)}],hr[1].push({type:2,data:write_shallow(yr)}),hr[2].push({type:0,data:write_varint49(pr)}),hr[3].push({type:0,data:write_varint49(pr)})}hr[4]=[],hr[5]=[],hr[6]=[];for(var fr=0;fr<=n.e.r;++fr)yr=[],yr[1]=yr[2]=[{type:0,data:write_varint49(fr+726270)}],hr[4].push({type:2,data:write_shallow(yr)}),hr[5].push({type:0,data:write_varint49(fr)}),hr[6].push({type:0,data:write_varint49(fr)});sr[ar].messages[0].data=write_shallow(hr)}tr.content=compress_iwa_file(write_iwa_file(sr)),tr.size=tr.content.length,delete Ke[46];var Rr=parse_shallow(Ke[4][0].data);{Rr[7][0].data=write_varint49(n.e.r+1);var mr=parse_shallow(Rr[1][0].data),wr=parse_TSP_Reference(mr[2][0].data);tr=CFB.find(Oe,Me[wr].location),sr=parse_iwa_file(decompress_iwa_file(tr.content));{if(sr[0].id!=wr)throw"Bad HeaderStorageBucket";var Fr=parse_shallow(sr[0].messages[0].data);for(fr=0;fr<Ce.length;++fr){var Mr=parse_shallow(Fr[2][0].data);Mr[1][0].data=write_varint49(fr),Mr[4][0].data=write_varint49(Ce[fr].length),Fr[2][fr]={type:Fr[2][0].type,data:write_shallow(Mr)}}sr[0].messages[0].data=write_shallow(Fr)}tr.content=compress_iwa_file(write_iwa_file(sr)),tr.size=tr.content.length;var Hr=parse_TSP_Reference(Rr[2][0].data);tr=CFB.find(Oe,Me[Hr].location),sr=parse_iwa_file(decompress_iwa_file(tr.content));{if(sr[0].id!=Hr)throw"Bad HeaderStorageBucket";for(Fr=parse_shallow(sr[0].messages[0].data),pr=0;pr<=n.e.c;++pr)Mr=parse_shallow(Fr[2][0].data),Mr[1][0].data=write_varint49(pr),Mr[4][0].data=write_varint49(n.e.r+1),Fr[2][pr]={type:Fr[2][0].type,data:write_shallow(Mr)};sr[0].messages[0].data=write_shallow(Fr)}tr.content=compress_iwa_file(write_iwa_file(sr)),tr.size=tr.content.length;var Nr=parse_TSP_Reference(Rr[4][0].data);(function(){for(var nr=CFB.find(Oe,Me[Nr].location),or=parse_iwa_file(decompress_iwa_file(nr.content)),lr,St=0;St<or.length;++St){var dr=or[St];dr.id==Nr&&(lr=dr)}var vr=parse_shallow(lr.messages[0].data);{vr[3]=[];var br=[];De.forEach(function(Er,Zr){br[1]=[{type:0,data:write_varint49(Zr)}],br[2]=[{type:0,data:write_varint49(1)}],br[3]=[{type:2,data:stru8(Er)}],vr[3].push({type:2,data:write_shallow(br)})})}lr.messages[0].data=write_shallow(vr);var kr=write_iwa_file(or),Pr=compress_iwa_file(kr);nr.content=Pr,nr.size=nr.content.length})();var Ar=parse_shallow(Rr[3][0].data);{var xr=Ar[1][0];delete Ar[2];var ir=parse_shallow(xr.data);{var _r=parse_TSP_Reference(ir[2][0].data);(function(){for(var nr=CFB.find(Oe,Me[_r].location),or=parse_iwa_file(decompress_iwa_file(nr.content)),lr,St=0;St<or.length;++St){var dr=or[St];dr.id==_r&&(lr=dr)}var vr=parse_shallow(lr.messages[0].data);{delete vr[6],delete Ar[7];var br=new Uint8Array(vr[5][0].data);vr[5]=[];for(var kr=0,Pr=0;Pr<=n.e.r;++Pr){var Er=parse_shallow(br);kr+=write_tile_row(Er,Ce[Pr],De),Er[1][0].data=write_varint49(Pr),vr[5].push({data:write_shallow(Er),type:2})}vr[1]=[{type:0,data:write_varint49(n.e.c+1)}],vr[2]=[{type:0,data:write_varint49(n.e.r+1)}],vr[3]=[{type:0,data:write_varint49(kr)}],vr[4]=[{type:0,data:write_varint49(n.e.r+1)}]}lr.messages[0].data=write_shallow(vr);var Zr=write_iwa_file(or),ua=compress_iwa_file(Zr);nr.content=ua,nr.size=nr.content.length})()}xr.data=write_shallow(ir)}Rr[3][0].data=write_shallow(Ar)}Ke[4][0].data=write_shallow(Rr)}Xe.messages[0].data=write_shallow(Ke);var ur=write_iwa_file(Ve),Je=compress_iwa_file(ur);return He.content=Je,He.size=He.content.length,Oe}function fix_opts_func(e){return function(r){for(var n=0;n!=e.length;++n){var Ee=e[n];r[Ee[0]]===void 0&&(r[Ee[0]]=Ee[1]),Ee[2]==="n"&&(r[Ee[0]]=Number(r[Ee[0]]))}}}function fix_read_opts(e){fix_opts_func([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function fix_write_opts(e){fix_opts_func([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function get_sheet_type(e){return RELS.WS.indexOf(e)>-1?"sheet":e==RELS.CS?"chart":e==RELS.DS?"dialog":e==RELS.MS?"macro":e&&e.length?e:"sheet"}function safe_parse_wbrels(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,get_sheet_type(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function safe_parse_sheet(e,t,r,n,Ee,Ce,De,Me,ze,Oe,Be,He){try{Ce[n]=parse_rels(getzipstr(e,r,!0),t);var Ve=getzipdata(e,t),Xe;switch(Me){case"sheet":Xe=parse_ws(Ve,t,Ee,ze,Ce[n],Oe,Be,He);break;case"chart":if(Xe=parse_cs(Ve,t,Ee,ze,Ce[n],Oe,Be,He),!Xe||!Xe["!drawel"])break;var We=resolve_path(Xe["!drawel"].Target,t),Ge=get_rels_path(We),$e=parse_drawing(getzipstr(e,We,!0),parse_rels(getzipstr(e,Ge,!0),We)),Ke=resolve_path($e,We),rr=get_rels_path(Ke);Xe=parse_chart(getzipstr(e,Ke,!0),Ke,ze,parse_rels(getzipstr(e,rr,!0),Ke),Oe,Xe);break;case"macro":Xe=parse_ms(Ve,t,Ee,ze,Ce[n],Oe,Be,He);break;case"dialog":Xe=parse_ds(Ve,t,Ee,ze,Ce[n],Oe,Be,He);break;default:throw new Error("Unrecognized sheet type "+Me)}De[n]=Xe;var tr=[];Ce&&Ce[n]&&keys(Ce[n]).forEach(function(sr){var ar="";if(Ce[n][sr].Type==RELS.CMNT){ar=resolve_path(Ce[n][sr].Target,t);var hr=parse_cmnt(getzipdata(e,ar,!0),ar,ze);if(!hr||!hr.length)return;sheet_insert_comments(Xe,hr,!1)}Ce[n][sr].Type==RELS.TCMNT&&(ar=resolve_path(Ce[n][sr].Target,t),tr=tr.concat(parse_tcmnt_xml(getzipdata(e,ar,!0),ze)))}),tr&&tr.length&&sheet_insert_comments(Xe,tr,!0,ze.people||[])}catch(sr){if(ze.WTF)throw sr}}function strip_front_slash(e){return e.charAt(0)=="/"?e.slice(1):e}function parse_zip(e,t){if(make_ssf(),t=t||{},fix_read_opts(t),safegetzipfile(e,"META-INF/manifest.xml")||safegetzipfile(e,"objectdata.xml"))return parse_ods(e,t);if(safegetzipfile(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof parse_numbers_iwa<"u"){if(e.FileIndex)return parse_numbers_iwa(e);var r=CFB.utils.cfb_new();return zipentries(e).forEach(function(Mr){zip_add_file(r,Mr,getzipbin(e,Mr))}),parse_numbers_iwa(r)}throw new Error("Unsupported NUMBERS file")}if(!safegetzipfile(e,"[Content_Types].xml"))throw safegetzipfile(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):safegetzipfile(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=zipentries(e),Ee=parse_ct(getzipstr(e,"[Content_Types].xml")),Ce=!1,De,Me;if(Ee.workbooks.length===0&&(Me="xl/workbook.xml",getzipdata(e,Me,!0)&&Ee.workbooks.push(Me)),Ee.workbooks.length===0){if(Me="xl/workbook.bin",!getzipdata(e,Me,!0))throw new Error("Could not find workbook");Ee.workbooks.push(Me),Ce=!0}Ee.workbooks[0].slice(-3)=="bin"&&(Ce=!0);var ze={},Oe={};if(!t.bookSheets&&!t.bookProps){if(strs=[],Ee.sst)try{strs=parse_sst(getzipdata(e,strip_front_slash(Ee.sst)),Ee.sst,t)}catch(Mr){if(t.WTF)throw Mr}t.cellStyles&&Ee.themes.length&&(ze=parse_theme(getzipstr(e,Ee.themes[0].replace(/^\//,""),!0)||"",Ee.themes[0],t)),Ee.style&&(Oe=parse_sty(getzipdata(e,strip_front_slash(Ee.style)),Ee.style,ze,t))}Ee.links.map(function(Mr){try{var Hr=parse_rels(getzipstr(e,get_rels_path(strip_front_slash(Mr))),Mr);return parse_xlink(getzipdata(e,strip_front_slash(Mr)),Hr,Mr,t)}catch{}});var Be=parse_wb(getzipdata(e,strip_front_slash(Ee.workbooks[0])),Ee.workbooks[0],t),He={},Ve="";Ee.coreprops.length&&(Ve=getzipdata(e,strip_front_slash(Ee.coreprops[0]),!0),Ve&&(He=parse_core_props(Ve)),Ee.extprops.length!==0&&(Ve=getzipdata(e,strip_front_slash(Ee.extprops[0]),!0),Ve&&parse_ext_props(Ve,He,t)));var Xe={};(!t.bookSheets||t.bookProps)&&Ee.custprops.length!==0&&(Ve=getzipstr(e,strip_front_slash(Ee.custprops[0]),!0),Ve&&(Xe=parse_cust_props(Ve,t)));var We={};if((t.bookSheets||t.bookProps)&&(Be.Sheets?De=Be.Sheets.map(function(Hr){return Hr.name}):He.Worksheets&&He.SheetNames.length>0&&(De=He.SheetNames),t.bookProps&&(We.Props=He,We.Custprops=Xe),t.bookSheets&&typeof De<"u"&&(We.SheetNames=De),t.bookSheets?We.SheetNames:t.bookProps))return We;De={};var Ge={};t.bookDeps&&Ee.calcchain&&(Ge=parse_cc(getzipdata(e,strip_front_slash(Ee.calcchain)),Ee.calcchain));var $e=0,Ke={},rr,tr;{var sr=Be.Sheets;He.Worksheets=sr.length,He.SheetNames=[];for(var ar=0;ar!=sr.length;++ar)He.SheetNames[ar]=sr[ar].name}var hr=Ce?"bin":"xml",pr=Ee.workbooks[0].lastIndexOf("/"),yr=(Ee.workbooks[0].slice(0,pr+1)+"_rels/"+Ee.workbooks[0].slice(pr+1)+".rels").replace(/^\//,"");safegetzipfile(e,yr)||(yr="xl/_rels/workbook."+hr+".rels");var fr=parse_rels(getzipstr(e,yr,!0),yr.replace(/_rels.*/,"s5s"));(Ee.metadata||[]).length>=1&&(t.xlmeta=parse_xlmeta(getzipdata(e,strip_front_slash(Ee.metadata[0])),Ee.metadata[0],t)),(Ee.people||[]).length>=1&&(t.people=parse_people_xml(getzipdata(e,strip_front_slash(Ee.people[0])),t)),fr&&(fr=safe_parse_wbrels(fr,Be.Sheets));var Rr=getzipdata(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for($e=0;$e!=He.Worksheets;++$e){var mr="sheet";if(fr&&fr[$e]?(rr="xl/"+fr[$e][1].replace(/[\/]?xl\//,""),safegetzipfile(e,rr)||(rr=fr[$e][1]),safegetzipfile(e,rr)||(rr=yr.replace(/_rels\/.*$/,"")+fr[$e][1]),mr=fr[$e][2]):(rr="xl/worksheets/sheet"+($e+1-Rr)+"."+hr,rr=rr.replace(/sheet0\./,"sheet.")),tr=rr.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if($e!=t.sheets)continue e;break;case"string":if(He.SheetNames[$e].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var wr=!1,Fr=0;Fr!=t.sheets.length;++Fr)typeof t.sheets[Fr]=="number"&&t.sheets[Fr]==$e&&(wr=1),typeof t.sheets[Fr]=="string"&&t.sheets[Fr].toLowerCase()==He.SheetNames[$e].toLowerCase()&&(wr=1);if(!wr)continue e}}safe_parse_sheet(e,rr,tr,He.SheetNames[$e],$e,Ke,De,mr,t,Be,ze,Oe)}return We={Directory:Ee,Workbook:Be,Props:He,Custprops:Xe,Deps:Ge,Sheets:De,SheetNames:He.SheetNames,Strings:strs,Styles:Oe,Themes:ze,SSF:dup(table_fmt)},t&&t.bookFiles&&(e.files?(We.keys=n,We.files=e.files):(We.keys=[],We.files={},e.FullPaths.forEach(function(Mr,Hr){Mr=Mr.replace(/^Root Entry[\/]/,""),We.keys.push(Mr),We.files[Mr]=e.FileIndex[Hr]}))),t&&t.bookVBA&&(Ee.vba.length>0?We.vbaraw=getzipdata(e,strip_front_slash(Ee.vba[0]),!0):Ee.defaults&&Ee.defaults.bin===CT_VBA&&(We.vbaraw=getzipdata(e,"xl/vbaProject.bin",!0))),We}function parse_xlsxcfb(e,t){var r=t||{},n="Workbook",Ee=CFB.find(e,n);try{if(n="/!DataSpaces/Version",Ee=CFB.find(e,n),!Ee||!Ee.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(parse_DataSpaceVersionInfo(Ee.content),n="/!DataSpaces/DataSpaceMap",Ee=CFB.find(e,n),!Ee||!Ee.content)throw new Error("ECMA-376 Encrypted file missing "+n);var Ce=parse_DataSpaceMap(Ee.content);if(Ce.length!==1||Ce[0].comps.length!==1||Ce[0].comps[0].t!==0||Ce[0].name!=="StrongEncryptionDataSpace"||Ce[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",Ee=CFB.find(e,n),!Ee||!Ee.content)throw new Error("ECMA-376 Encrypted file missing "+n);var De=parse_DataSpaceDefinition(Ee.content);if(De.length!=1||De[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",Ee=CFB.find(e,n),!Ee||!Ee.content)throw new Error("ECMA-376 Encrypted file missing "+n);parse_Primary(Ee.content)}catch{}if(n="/EncryptionInfo",Ee=CFB.find(e,n),!Ee||!Ee.content)throw new Error("ECMA-376 Encrypted file missing "+n);var Me=parse_EncryptionInfo(Ee.content);if(n="/EncryptedPackage",Ee=CFB.find(e,n),!Ee||!Ee.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Me[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(Me[1],Ee.content,r.password||"",r);if(Me[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(Me[1],Ee.content,r.password||"",r);throw new Error("File is password-protected")}function write_zip(e,t){return t.bookType=="ods"?write_ods(e,t):t.bookType=="numbers"?write_numbers_iwa(e,t):t.bookType=="xlsb"?write_zip_xlsxb(e,t):write_zip_xlsx(e,t)}function write_zip_xlsxb(e,t){_shapeid=1024,e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),t.revssf=evert_num(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,browser_has_Map?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r=t.bookType=="xlsb"?"bin":"xml",n=VBAFMTS.indexOf(t.bookType)>-1,Ee=new_ct();fix_write_opts(t=t||{});var Ce=zip_new(),De="",Me=0;if(t.cellXfs=[],get_cell_style(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),De="docProps/core.xml",zip_add_file(Ce,De,write_core_props(e.Props,t)),Ee.coreprops.push(De),add_rels(t.rels,2,De,RELS.CORE_PROPS),De="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var ze=[],Oe=0;Oe<e.SheetNames.length;++Oe)(e.Workbook.Sheets[Oe]||{}).Hidden!=2&&ze.push(e.SheetNames[Oe]);e.Props.SheetNames=ze}for(e.Props.Worksheets=e.Props.SheetNames.length,zip_add_file(Ce,De,write_ext_props(e.Props)),Ee.extprops.push(De),add_rels(t.rels,3,De,RELS.EXT_PROPS),e.Custprops!==e.Props&&keys(e.Custprops||{}).length>0&&(De="docProps/custom.xml",zip_add_file(Ce,De,write_cust_props(e.Custprops)),Ee.custprops.push(De),add_rels(t.rels,4,De,RELS.CUST_PROPS)),Me=1;Me<=e.SheetNames.length;++Me){var Be={"!id":{}},He=e.Sheets[e.SheetNames[Me-1]],Ve=(He||{})["!type"]||"sheet";switch(Ve){case"chart":default:De="xl/worksheets/sheet"+Me+"."+r,zip_add_file(Ce,De,write_ws(Me-1,De,t,e,Be)),Ee.sheets.push(De),add_rels(t.wbrels,-1,"worksheets/sheet"+Me+"."+r,RELS.WS[0])}if(He){var Xe=He["!comments"],We=!1,Ge="";Xe&&Xe.length>0&&(Ge="xl/comments"+Me+"."+r,zip_add_file(Ce,Ge,write_cmnt(Xe,Ge)),Ee.comments.push(Ge),add_rels(Be,-1,"../comments"+Me+"."+r,RELS.CMNT),We=!0),He["!legacy"]&&We&&zip_add_file(Ce,"xl/drawings/vmlDrawing"+Me+".vml",write_comments_vml(Me,He["!comments"])),delete He["!comments"],delete He["!legacy"]}Be["!id"].rId1&&zip_add_file(Ce,get_rels_path(De),write_rels(Be))}return t.Strings!=null&&t.Strings.length>0&&(De="xl/sharedStrings."+r,zip_add_file(Ce,De,write_sst(t.Strings,De,t)),Ee.strs.push(De),add_rels(t.wbrels,-1,"sharedStrings."+r,RELS.SST)),De="xl/workbook."+r,zip_add_file(Ce,De,write_wb(e,De)),Ee.workbooks.push(De),add_rels(t.rels,1,De,RELS.WB),De="xl/theme/theme1.xml",zip_add_file(Ce,De,write_theme(e.Themes,t)),Ee.themes.push(De),add_rels(t.wbrels,-1,"theme/theme1.xml",RELS.THEME),De="xl/styles."+r,zip_add_file(Ce,De,write_sty(e,De,t)),Ee.styles.push(De),add_rels(t.wbrels,-1,"styles."+r,RELS.STY),e.vbaraw&&n&&(De="xl/vbaProject.bin",zip_add_file(Ce,De,e.vbaraw),Ee.vba.push(De),add_rels(t.wbrels,-1,"vbaProject.bin",RELS.VBA)),De="xl/metadata."+r,zip_add_file(Ce,De,write_xlmeta(De)),Ee.metadata.push(De),add_rels(t.wbrels,-1,"metadata."+r,RELS.XLMETA),zip_add_file(Ce,"[Content_Types].xml",write_ct(Ee,t)),zip_add_file(Ce,"_rels/.rels",write_rels(t.rels)),zip_add_file(Ce,"xl/_rels/workbook."+r+".rels",write_rels(t.wbrels)),delete t.revssf,delete t.ssf,Ce}function write_zip_xlsx(e,t){_shapeid=1024,e&&!e.SSF&&(e.SSF=dup(table_fmt)),e&&e.SSF&&(make_ssf(),SSF_load_table(e.SSF),t.revssf=evert_num(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,browser_has_Map?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var r="xml",n=VBAFMTS.indexOf(t.bookType)>-1,Ee=new_ct();fix_write_opts(t=t||{});var Ce=zip_new(),De="",Me=0;if(t.cellXfs=[],get_cell_style(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),De="docProps/core.xml",zip_add_file(Ce,De,write_core_props(e.Props,t)),Ee.coreprops.push(De),add_rels(t.rels,2,De,RELS.CORE_PROPS),De="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var ze=[],Oe=0;Oe<e.SheetNames.length;++Oe)(e.Workbook.Sheets[Oe]||{}).Hidden!=2&&ze.push(e.SheetNames[Oe]);e.Props.SheetNames=ze}e.Props.Worksheets=e.Props.SheetNames.length,zip_add_file(Ce,De,write_ext_props(e.Props)),Ee.extprops.push(De),add_rels(t.rels,3,De,RELS.EXT_PROPS),e.Custprops!==e.Props&&keys(e.Custprops||{}).length>0&&(De="docProps/custom.xml",zip_add_file(Ce,De,write_cust_props(e.Custprops)),Ee.custprops.push(De),add_rels(t.rels,4,De,RELS.CUST_PROPS));var Be=["SheetJ5"];for(t.tcid=0,Me=1;Me<=e.SheetNames.length;++Me){var He={"!id":{}},Ve=e.Sheets[e.SheetNames[Me-1]],Xe=(Ve||{})["!type"]||"sheet";switch(Xe){case"chart":default:De="xl/worksheets/sheet"+Me+"."+r,zip_add_file(Ce,De,write_ws_xml(Me-1,t,e,He)),Ee.sheets.push(De),add_rels(t.wbrels,-1,"worksheets/sheet"+Me+"."+r,RELS.WS[0])}if(Ve){var We=Ve["!comments"],Ge=!1,$e="";if(We&&We.length>0){var Ke=!1;We.forEach(function(rr){rr[1].forEach(function(tr){tr.T==!0&&(Ke=!0)})}),Ke&&($e="xl/threadedComments/threadedComment"+Me+"."+r,zip_add_file(Ce,$e,write_tcmnt_xml(We,Be,t)),Ee.threadedcomments.push($e),add_rels(He,-1,"../threadedComments/threadedComment"+Me+"."+r,RELS.TCMNT)),$e="xl/comments"+Me+"."+r,zip_add_file(Ce,$e,write_comments_xml(We)),Ee.comments.push($e),add_rels(He,-1,"../comments"+Me+"."+r,RELS.CMNT),Ge=!0}Ve["!legacy"]&&Ge&&zip_add_file(Ce,"xl/drawings/vmlDrawing"+Me+".vml",write_comments_vml(Me,Ve["!comments"])),delete Ve["!comments"],delete Ve["!legacy"]}He["!id"].rId1&&zip_add_file(Ce,get_rels_path(De),write_rels(He))}return t.Strings!=null&&t.Strings.length>0&&(De="xl/sharedStrings."+r,zip_add_file(Ce,De,write_sst_xml(t.Strings,t)),Ee.strs.push(De),add_rels(t.wbrels,-1,"sharedStrings."+r,RELS.SST)),De="xl/workbook."+r,zip_add_file(Ce,De,write_wb_xml(e)),Ee.workbooks.push(De),add_rels(t.rels,1,De,RELS.WB),De="xl/theme/theme1.xml",zip_add_file(Ce,De,write_theme(e.Themes,t)),Ee.themes.push(De),add_rels(t.wbrels,-1,"theme/theme1.xml",RELS.THEME),De="xl/styles."+r,zip_add_file(Ce,De,write_sty_xml(e,t)),Ee.styles.push(De),add_rels(t.wbrels,-1,"styles."+r,RELS.STY),e.vbaraw&&n&&(De="xl/vbaProject.bin",zip_add_file(Ce,De,e.vbaraw),Ee.vba.push(De),add_rels(t.wbrels,-1,"vbaProject.bin",RELS.VBA)),De="xl/metadata."+r,zip_add_file(Ce,De,write_xlmeta_xml()),Ee.metadata.push(De),add_rels(t.wbrels,-1,"metadata."+r,RELS.XLMETA),Be.length>1&&(De="xl/persons/person.xml",zip_add_file(Ce,De,write_people_xml(Be)),Ee.people.push(De),add_rels(t.wbrels,-1,"persons/person.xml",RELS.PEOPLE)),zip_add_file(Ce,"[Content_Types].xml",write_ct(Ee,t)),zip_add_file(Ce,"_rels/.rels",write_rels(t.rels)),zip_add_file(Ce,"xl/_rels/workbook."+r+".rels",write_rels(t.wbrels)),delete t.revssf,delete t.ssf,Ce}function firstbyte(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=Base64_decode(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function read_cfb(e,t){return CFB.find(e,"EncryptedPackage")?parse_xlsxcfb(e,t):parse_xlscfb(e,t)}function read_zip(e,t){var r,n=e,Ee=t||{};return Ee.type||(Ee.type=has_buf&&Buffer.isBuffer(e)?"buffer":"base64"),r=zip_read(n,Ee),parse_zip(r,Ee)}function read_plaintext(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return parse_xlml(e.slice(r),t);default:break e}return PRN.to_workbook(e,t)}function read_plaintext_raw(e,t){var r="",n=firstbyte(e,t);switch(t.type){case"base64":r=Base64_decode(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=cc2str(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=utf8read(r)),t.type="binary",read_plaintext(r,t)}function read_utf16(e,t){var r=e;return t.type=="base64"&&(r=Base64_decode(r)),r=$cptable.utils.decode(1200,r.slice(2),"str"),t.type="binary",read_plaintext(r,t)}function bstrify(e){return e.match(/[^\x00-\x7F]/)?utf8write(e):e}function read_prn(e,t,r,n){return n?(r.type="string",PRN.to_workbook(e,r)):PRN.to_workbook(t,r)}function readSync(e,t){reset_cp();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return readSync(new Uint8Array(e),(r=dup(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,Ee=[0,0,0,0],Ce=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),_ssfopts={},r.dateNF&&(_ssfopts.dateNF=r.dateNF),r.type||(r.type=has_buf&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=has_buf?"buffer":"binary",n=read_binary(e),typeof Uint8Array<"u"&&!has_buf&&(r.type="array")),r.type=="string"&&(Ce=!0,r.type="binary",r.codepage=65001,n=bstrify(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var De=new ArrayBuffer(3),Me=new Uint8Array(De);if(Me.foo="bar",!Me.foo)return r=dup(r),r.type="array",readSync(ab2a(n),r)}switch((Ee=firstbyte(n,r))[0]){case 208:if(Ee[1]===207&&Ee[2]===17&&Ee[3]===224&&Ee[4]===161&&Ee[5]===177&&Ee[6]===26&&Ee[7]===225)return read_cfb(CFB.read(n,r),r);break;case 9:if(Ee[1]<=8)return parse_xlscfb(n,r);break;case 60:return parse_xlml(n,r);case 73:if(Ee[1]===73&&Ee[2]===42&&Ee[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(Ee[1]===68)return read_wb_ID(n,r);break;case 84:if(Ee[1]===65&&Ee[2]===66&&Ee[3]===76)return DIF.to_workbook(n,r);break;case 80:return Ee[1]===75&&Ee[2]<9&&Ee[3]<9?read_zip(n,r):read_prn(e,n,r,Ce);case 239:return Ee[3]===60?parse_xlml(n,r):read_prn(e,n,r,Ce);case 255:if(Ee[1]===254)return read_utf16(n,r);if(Ee[1]===0&&Ee[2]===2&&Ee[3]===0)return WK_.to_workbook(n,r);break;case 0:if(Ee[1]===0&&(Ee[2]>=2&&Ee[3]===0||Ee[2]===0&&(Ee[3]===8||Ee[3]===9)))return WK_.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return DBF.to_workbook(n,r);case 123:if(Ee[1]===92&&Ee[2]===114&&Ee[3]===116)return RTF.to_workbook(n,r);break;case 10:case 13:case 32:return read_plaintext_raw(n,r);case 137:if(Ee[1]===80&&Ee[2]===78&&Ee[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return DBF_SUPPORTED_VERSIONS.indexOf(Ee[0])>-1&&Ee[2]<=12&&Ee[3]<=31?DBF.to_workbook(n,r):read_prn(e,n,r,Ce)}function write_cfb_ctr(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return write_dl(t.file,CFB.write(e,{type:has_buf?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return CFB.write(e,t)}function write_zip_type(e,t){var r=dup(t||{}),n=write_zip(e,r);return write_zip_denouement(n,r)}function write_zip_denouement(e,t){var r={},n=has_buf?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(r.compression="DEFLATE"),t.password)r.type=n;else switch(t.type){case"base64":r.type="base64";break;case"binary":r.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":r.type=n;break;default:throw new Error("Unrecognized type "+t.type)}var Ee=e.FullPaths?CFB.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[r.type]||r.type,compression:!!t.compression}):e.generate(r);if(typeof Deno<"u"&&typeof Ee=="string"){if(t.type=="binary"||t.type=="base64")return Ee;Ee=new Uint8Array(s2ab(Ee))}return t.password&&typeof encrypt_agile<"u"?write_cfb_ctr(encrypt_agile(Ee,t.password),t):t.type==="file"?write_dl(t.file,Ee):t.type=="string"?utf8read(Ee):Ee}function write_cfb_type(e,t){var r=t||{},n=write_xlscfb(e,r);return write_cfb_ctr(n,r)}function write_string_type(e,t,r){r||(r="");var n=r+e;switch(t.type){case"base64":return Base64_encode(utf8write(n));case"binary":return utf8write(n);case"string":return e;case"file":return write_dl(t.file,n,"utf8");case"buffer":return has_buf?Buffer_from(n,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(n):write_string_type(n,{type:"binary"}).split("").map(function(Ee){return Ee.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function write_stxt_type(e,t){switch(t.type){case"base64":return Base64_encode(e);case"binary":return e;case"string":return e;case"file":return write_dl(t.file,e,"binary");case"buffer":return has_buf?Buffer_from(e,"binary"):e.split("").map(function(r){return r.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function write_binary_type(e,t){switch(t.type){case"string":case"base64":case"binary":for(var r="",n=0;n<e.length;++n)r+=String.fromCharCode(e[n]);return t.type=="base64"?Base64_encode(r):t.type=="string"?utf8read(r):r;case"file":return write_dl(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function writeSync(e,t){reset_cp(),check_wb(e);var r=dup(t||{});if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),r.type=="array"){r.type="binary";var n=writeSync(e,r);return r.type="array",s2ab(n)}var Ee=0;if(r.sheet&&(typeof r.sheet=="number"?Ee=r.sheet:Ee=e.SheetNames.indexOf(r.sheet),!e.SheetNames[Ee]))throw new Error("Sheet not found: "+r.sheet+" : "+typeof r.sheet);switch(r.bookType||"xlsb"){case"xml":case"xlml":return write_string_type(write_xlml(e,r),r);case"slk":case"sylk":return write_string_type(SYLK.from_sheet(e.Sheets[e.SheetNames[Ee]],r),r);case"htm":case"html":return write_string_type(sheet_to_html(e.Sheets[e.SheetNames[Ee]],r),r);case"txt":return write_stxt_type(sheet_to_txt(e.Sheets[e.SheetNames[Ee]],r),r);case"csv":return write_string_type(sheet_to_csv(e.Sheets[e.SheetNames[Ee]],r),r,"\uFEFF");case"dif":return write_string_type(DIF.from_sheet(e.Sheets[e.SheetNames[Ee]],r),r);case"dbf":return write_binary_type(DBF.from_sheet(e.Sheets[e.SheetNames[Ee]],r),r);case"prn":return write_string_type(PRN.from_sheet(e.Sheets[e.SheetNames[Ee]],r),r);case"rtf":return write_string_type(RTF.from_sheet(e.Sheets[e.SheetNames[Ee]],r),r);case"eth":return write_string_type(ETH.from_sheet(e.Sheets[e.SheetNames[Ee]],r),r);case"fods":return write_string_type(write_ods(e,r),r);case"wk1":return write_binary_type(WK_.sheet_to_wk1(e.Sheets[e.SheetNames[Ee]],r),r);case"wk3":return write_binary_type(WK_.book_to_wk3(e,r),r);case"biff2":r.biff||(r.biff=2);case"biff3":r.biff||(r.biff=3);case"biff4":return r.biff||(r.biff=4),write_binary_type(write_biff_buf(e,r),r);case"biff5":r.biff||(r.biff=5);case"biff8":case"xla":case"xls":return r.biff||(r.biff=8),write_cfb_type(e,r);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return write_zip_type(e,r);default:throw new Error("Unrecognized bookType |"+r.bookType+"|")}}function resolve_book_type(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},r=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();r.match(/^\.[a-z]+$/)&&(e.bookType=r.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function writeFileSync(e,t,r){var n={};return n.type="file",n.file=t,resolve_book_type(n),writeSync(e,n)}function make_json_row(e,t,r,n,Ee,Ce,De,Me){var ze=encode_row(r),Oe=Me.defval,Be=Me.raw||!Object.prototype.hasOwnProperty.call(Me,"raw"),He=!0,Ve=Ee===1?[]:{};if(Ee!==1)if(Object.defineProperty)try{Object.defineProperty(Ve,"__rowNum__",{value:r,enumerable:!1})}catch{Ve.__rowNum__=r}else Ve.__rowNum__=r;if(!De||e[r])for(var Xe=t.s.c;Xe<=t.e.c;++Xe){var We=De?e[r][Xe]:e[n[Xe]+ze];if(We===void 0||We.t===void 0){if(Oe===void 0)continue;Ce[Xe]!=null&&(Ve[Ce[Xe]]=Oe);continue}var Ge=We.v;switch(We.t){case"z":if(Ge==null)break;continue;case"e":Ge=Ge==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+We.t)}if(Ce[Xe]!=null){if(Ge==null)if(We.t=="e"&&Ge===null)Ve[Ce[Xe]]=null;else if(Oe!==void 0)Ve[Ce[Xe]]=Oe;else if(Be&&Ge===null)Ve[Ce[Xe]]=null;else continue;else Ve[Ce[Xe]]=Be&&(We.t!=="n"||We.t==="n"&&Me.rawNumbers!==!1)?Ge:format_cell(We,Ge,Me);Ge!=null&&(He=!1)}}return{row:Ve,isempty:He}}function sheet_to_json(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,Ee=1,Ce=[],De=0,Me="",ze={s:{r:0,c:0},e:{r:0,c:0}},Oe=t||{},Be=Oe.range!=null?Oe.range:e["!ref"];switch(Oe.header===1?n=1:Oe.header==="A"?n=2:Array.isArray(Oe.header)?n=3:Oe.header==null&&(n=0),typeof Be){case"string":ze=safe_decode_range(Be);break;case"number":ze=safe_decode_range(e["!ref"]),ze.s.r=Be;break;default:ze=Be}n>0&&(Ee=0);var He=encode_row(ze.s.r),Ve=[],Xe=[],We=0,Ge=0,$e=Array.isArray(e),Ke=ze.s.r,rr=0,tr={};$e&&!e[Ke]&&(e[Ke]=[]);var sr=Oe.skipHidden&&e["!cols"]||[],ar=Oe.skipHidden&&e["!rows"]||[];for(rr=ze.s.c;rr<=ze.e.c;++rr)if(!(sr[rr]||{}).hidden)switch(Ve[rr]=encode_col(rr),r=$e?e[Ke][rr]:e[Ve[rr]+He],n){case 1:Ce[rr]=rr-ze.s.c;break;case 2:Ce[rr]=Ve[rr];break;case 3:Ce[rr]=Oe.header[rr-ze.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),Me=De=format_cell(r,null,Oe),Ge=tr[De]||0,!Ge)tr[De]=1;else{do Me=De+"_"+Ge++;while(tr[Me]);tr[De]=Ge,tr[Me]=1}Ce[rr]=Me}for(Ke=ze.s.r+Ee;Ke<=ze.e.r;++Ke)if(!(ar[Ke]||{}).hidden){var hr=make_json_row(e,ze,Ke,Ve,n,Ce,$e,Oe);(hr.isempty===!1||(n===1?Oe.blankrows!==!1:Oe.blankrows))&&(Xe[We++]=hr.row)}return Xe.length=We,Xe}var qreg=/"/g;function make_csv_row(e,t,r,n,Ee,Ce,De,Me){for(var ze=!0,Oe=[],Be="",He=encode_row(r),Ve=t.s.c;Ve<=t.e.c;++Ve)if(n[Ve]){var Xe=Me.dense?(e[r]||[])[Ve]:e[n[Ve]+He];if(Xe==null)Be="";else if(Xe.v!=null){ze=!1,Be=""+(Me.rawNumbers&&Xe.t=="n"?Xe.v:format_cell(Xe,null,Me));for(var We=0,Ge=0;We!==Be.length;++We)if((Ge=Be.charCodeAt(We))===Ee||Ge===Ce||Ge===34||Me.forceQuotes){Be='"'+Be.replace(qreg,'""')+'"';break}Be=="ID"&&(Be='"ID"')}else Xe.f!=null&&!Xe.F?(ze=!1,Be="="+Xe.f,Be.indexOf(",")>=0&&(Be='"'+Be.replace(qreg,'""')+'"')):Be="";Oe.push(Be)}return Me.blankrows===!1&&ze?null:Oe.join(De)}function sheet_to_csv(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var Ee=safe_decode_range(e["!ref"]),Ce=n.FS!==void 0?n.FS:",",De=Ce.charCodeAt(0),Me=n.RS!==void 0?n.RS:`
`,ze=Me.charCodeAt(0),Oe=new RegExp((Ce=="|"?"\\|":Ce)+"+$"),Be="",He=[];n.dense=Array.isArray(e);for(var Ve=n.skipHidden&&e["!cols"]||[],Xe=n.skipHidden&&e["!rows"]||[],We=Ee.s.c;We<=Ee.e.c;++We)(Ve[We]||{}).hidden||(He[We]=encode_col(We));for(var Ge=0,$e=Ee.s.r;$e<=Ee.e.r;++$e)(Xe[$e]||{}).hidden||(Be=make_csv_row(e,Ee,$e,He,De,ze,Ce,n),Be!=null&&(n.strip&&(Be=Be.replace(Oe,"")),(Be||n.blankrows!==!1)&&r.push((Ge++?Me:"")+Be)));return delete n.dense,r.join("")}function sheet_to_txt(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=sheet_to_csv(e,t);return r}function sheet_to_formulae(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var Ee=safe_decode_range(e["!ref"]),Ce="",De=[],Me,ze=[],Oe=Array.isArray(e);for(Me=Ee.s.c;Me<=Ee.e.c;++Me)De[Me]=encode_col(Me);for(var Be=Ee.s.r;Be<=Ee.e.r;++Be)for(Ce=encode_row(Be),Me=Ee.s.c;Me<=Ee.e.c;++Me)if(t=De[Me]+Ce,r=Oe?(e[Be]||[])[Me]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}ze[ze.length]=t+"="+n}return ze}function sheet_add_json(e,t,r){var n=r||{},Ee=+!n.skipHeader,Ce=e||{},De=0,Me=0;if(Ce&&n.origin!=null)if(typeof n.origin=="number")De=n.origin;else{var ze=typeof n.origin=="string"?decode_cell(n.origin):n.origin;De=ze.r,Me=ze.c}var Oe,Be={s:{c:0,r:0},e:{c:Me,r:De+t.length-1+Ee}};if(Ce["!ref"]){var He=safe_decode_range(Ce["!ref"]);Be.e.c=Math.max(Be.e.c,He.e.c),Be.e.r=Math.max(Be.e.r,He.e.r),De==-1&&(De=He.e.r+1,Be.e.r=De+t.length-1+Ee)}else De==-1&&(De=0,Be.e.r=t.length-1+Ee);var Ve=n.header||[],Xe=0;t.forEach(function(Ge,$e){keys(Ge).forEach(function(Ke){(Xe=Ve.indexOf(Ke))==-1&&(Ve[Xe=Ve.length]=Ke);var rr=Ge[Ke],tr="z",sr="",ar=encode_cell({c:Me+Xe,r:De+$e+Ee});Oe=ws_get_cell_stub(Ce,ar),rr&&typeof rr=="object"&&!(rr instanceof Date)?Ce[ar]=rr:(typeof rr=="number"?tr="n":typeof rr=="boolean"?tr="b":typeof rr=="string"?tr="s":rr instanceof Date?(tr="d",n.cellDates||(tr="n",rr=datenum(rr)),sr=n.dateNF||table_fmt[14]):rr===null&&n.nullError&&(tr="e",rr=0),Oe?(Oe.t=tr,Oe.v=rr,delete Oe.w,delete Oe.R,sr&&(Oe.z=sr)):Ce[ar]=Oe={t:tr,v:rr},sr&&(Oe.z=sr))})}),Be.e.c=Math.max(Be.e.c,Me+Ve.length-1);var We=encode_row(De);if(Ee)for(Xe=0;Xe<Ve.length;++Xe)Ce[encode_col(Xe+Me)+We]={t:"s",v:Ve[Xe]};return Ce["!ref"]=encode_range(Be),Ce}function json_to_sheet(e,t){return sheet_add_json(null,e,t)}function ws_get_cell_stub(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=decode_cell(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?ws_get_cell_stub(e,encode_cell(t)):ws_get_cell_stub(e,encode_cell({r:t,c:r||0}))}function wb_sheet_idx(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function book_new(){return{SheetNames:[],Sheets:{}}}function book_append_sheet(e,t,r,n){var Ee=1;if(!r)for(;Ee<=65535&&e.SheetNames.indexOf(r="Sheet"+Ee)!=-1;++Ee,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var Ce=r.match(/(^.*?)(\d+)$/);Ee=Ce&&+Ce[2]||0;var De=Ce&&Ce[1]||r;for(++Ee;Ee<=65535&&e.SheetNames.indexOf(r=De+Ee)!=-1;++Ee);}if(check_ws_name(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function book_set_sheet_visibility(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=wb_sheet_idx(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function cell_set_number_format(e,t){return e.z=t,e}function cell_set_hyperlink(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function cell_set_internal_link(e,t,r){return cell_set_hyperlink(e,"#"+t,r)}function cell_add_comment(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function sheet_set_array_formula(e,t,r,n){for(var Ee=typeof t!="string"?t:safe_decode_range(t),Ce=typeof t=="string"?t:encode_range(t),De=Ee.s.r;De<=Ee.e.r;++De)for(var Me=Ee.s.c;Me<=Ee.e.c;++Me){var ze=ws_get_cell_stub(e,De,Me);ze.t="n",ze.F=Ce,delete ze.v,De==Ee.s.r&&Me==Ee.s.c&&(ze.f=r,n&&(ze.D=!0))}return e}var utils={encode_col,encode_row,encode_cell,encode_range,decode_col,decode_row,split_cell,decode_cell,decode_range,format_cell,sheet_add_aoa,sheet_add_json,sheet_add_dom,aoa_to_sheet,json_to_sheet,table_to_sheet:parse_dom_table,table_to_book,sheet_to_csv,sheet_to_txt,sheet_to_json,sheet_to_html,sheet_to_formulae,sheet_to_row_object_array:sheet_to_json,sheet_get_cell:ws_get_cell_stub,book_new,book_append_sheet,book_set_sheet_visibility,cell_set_number_format,cell_set_hyperlink,cell_set_internal_link,cell_add_comment,sheet_set_array_formula,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const WEEKDAYS=["Pazartesi","Sal","aramba","Perembe","Cuma"],ALL_DAYS=["Pazartesi","Sal","aramba","Perembe","Cuma","Cumartesi","Pazar"],exportAllDataToExcel=(e,t,r,n,Ee,Ce,De)=>{const Me=utils.book_new(),ze=De.map(tr=>{const sr={GN:tr};return r.forEach(ar=>{sr[ar]=t[tr]?.[ar]||""}),sr["NBET DAREC"]=t[tr]?.ADMIN||"",sr}),Oe=utils.json_to_sheet(ze);utils.book_append_sheet(Me,Oe,"Nobet_Cizelgesi");const Be=[];e.forEach(tr=>{De.forEach(sr=>{(tr.schedule[sr]||[]).forEach(hr=>{hr.className&&Be.push({"retmen Ad":tr.name,Gn:sr,"Ders Saati":hr.period,"Snf/Ders":hr.className})})})});const He=utils.json_to_sheet(Be);utils.book_append_sheet(Me,He,"Ders_Programlari");const Ve=e.map(tr=>{const sr=tr.name.toLocaleUpperCase("tr-TR"),ar=Ee[sr]||new Set,hr={"retmen Ad":tr.name};return De.forEach(pr=>{hr[pr]=ar.has(pr)?"TUTMAZ":"MSAT"}),hr}),Xe=utils.json_to_sheet(Ve);utils.book_append_sheet(Me,Xe,"Ogretmen_Tercihleri");const We=Array.from(Ce).map(tr=>{const[sr,ar]=tr.split("-");return{GN:sr,"NBET YER":ar}}),Ge=utils.json_to_sheet(We);utils.book_append_sheet(Me,Ge,"Cift_Nobet_Onaylari");const $e=[{"Ayar Ad":"Okul Ad",Deer:n.schoolName},{"Ayar Ad":"Okul Mdr",Deer:n.directorName},{"Ayar Ad":"Tarih",Deer:n.dutyDate},{"Ayar Ad":"dareciler (Hari Tutulanlar)",Deer:n.ignoredTeachers.join(", ")},{"Ayar Ad":"Hafta Sonu Dahil",Deer:n.includeWeekends?"EVET":"HAYIR"}],Ke=utils.json_to_sheet($e);utils.book_append_sheet(Me,Ke,"Sistem_Ayarlari");const rr=`Nobet_Sistemi_Yedek_${new Date().toLocaleDateString("tr-TR").replace(/\./g,"_")}.xlsx`;writeFileSync(Me,rr)},importAllDataFromExcel=async e=>new Promise((t,r)=>{const n=new FileReader;n.onload=Ee=>{try{const Ce=Ee.target?.result,De=readSync(Ce,{type:"binary"}),Me=De.Sheets.Sistem_Ayarlari,ze=utils.sheet_to_json(Me),Oe={schoolName:"",directorName:"",dutyDate:"",ignoredTeachers:[],includeWeekends:!1};ze.forEach(pr=>{const yr=pr["Ayar Ad"],fr=pr.Deer||"";yr==="Okul Ad"&&(Oe.schoolName=fr),yr==="Okul Mdr"&&(Oe.directorName=fr),yr==="Tarih"&&(Oe.dutyDate=fr),yr==="Hafta Sonu Dahil"&&(Oe.includeWeekends=fr==="EVET"),yr==="dareciler (Hari Tutulanlar)"&&(Oe.ignoredTeachers=fr.split(",").map(Rr=>Rr.trim()).filter(Rr=>Rr.length>0))});const Be=Oe.includeWeekends?ALL_DAYS:WEEKDAYS,He=De.Sheets.Nobet_Cizelgesi,Ve=utils.sheet_to_json(He),Xe=Ve[0]||{},We=Object.keys(Xe).filter(pr=>pr!=="GN"&&pr!=="NBET DAREC"),Ge={};Ve.forEach(pr=>{const yr=pr.GN;yr&&(Ge[yr]={},We.forEach(fr=>{Ge[yr][fr]=pr[fr]||""}),Ge[yr].ADMIN=pr["NBET DAREC"]||"")});const $e=De.Sheets.Ders_Programlari,Ke=utils.sheet_to_json($e),rr=new Map;Ke.forEach(pr=>{const yr=pr["retmen Ad"],fr=pr.Gn,Rr=parseInt(pr["Ders Saati"]),mr=pr["Snf/Ders"];rr.has(yr)||rr.set(yr,{name:yr,schedule:{}});const wr=rr.get(yr);wr.schedule[fr]||(wr.schedule[fr]=Array(8).fill(null).map((Fr,Mr)=>({period:Mr+1,className:null,subject:null}))),Rr>=1&&Rr<=8&&(wr.schedule[fr][Rr-1]={period:Rr,className:mr,subject:null})});const tr=De.Sheets.Ogretmen_Tercihleri,sr={};tr&&utils.sheet_to_json(tr).forEach(yr=>{const fr=(yr["retmen Ad"]||"").toLocaleUpperCase("tr-TR");if(fr){const Rr=new Set;Be.forEach(mr=>{yr[mr]==="TUTMAZ"&&Rr.add(mr)}),sr[fr]=Rr}});const ar=De.Sheets.Cift_Nobet_Onaylari,hr=new Set;ar&&utils.sheet_to_json(ar).forEach(yr=>{const fr=yr.GN,Rr=yr["NBET YER"];fr&&Rr&&hr.add(`${fr}-${Rr}`)}),t({grid:Ge,locations:We,schedules:Array.from(rr.values()),settings:Oe,teacherPrefs:sr,approvedMultiDayDuties:hr})}catch(Ce){r(Ce)}},n.readAsBinaryString(e)}),scriptRel="modulepreload",assetsURL=function(e){return"/"+e},seen={},__vitePreload=function e(t,r,n){let Ee=Promise.resolve();if(r&&r.length>0){let De=function(Oe){return Promise.all(Oe.map(Be=>Promise.resolve(Be).then(He=>({status:"fulfilled",value:He}),He=>({status:"rejected",reason:He}))))};document.getElementsByTagName("link");const Me=document.querySelector("meta[property=csp-nonce]"),ze=Me?.nonce||Me?.getAttribute("nonce");Ee=De(r.map(Oe=>{if(Oe=assetsURL(Oe),Oe in seen)return;seen[Oe]=!0;const Be=Oe.endsWith(".css"),He=Be?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${Oe}"]${He}`))return;const Ve=document.createElement("link");if(Ve.rel=Be?"stylesheet":scriptRel,Be||(Ve.as="script"),Ve.crossOrigin="",Ve.href=Oe,ze&&Ve.setAttribute("nonce",ze),document.head.appendChild(Ve),Be)return new Promise((Xe,We)=>{Ve.addEventListener("load",Xe),Ve.addEventListener("error",()=>We(new Error(`Unable to preload CSS for ${Oe}`)))})}))}function Ce(De){const Me=new Event("vite:preloadError",{cancelable:!0});if(Me.payload=De,window.dispatchEvent(Me),!Me.defaultPrevented)throw De}return Ee.then(De=>{for(const Me of De||[])Me.status==="rejected"&&Ce(Me.reason);return t().catch(Ce)})};function _typeof(e){"@babel/helpers - typeof";return _typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(e)}var u8=Uint8Array,u16=Uint16Array,i32=Int32Array,fleb=new u8([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),fdeb=new u8([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),clim=new u8([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),freb=function(e,t){for(var r=new u16(31),n=0;n<31;++n)r[n]=t+=1<<e[n-1];for(var Ee=new i32(r[30]),n=1;n<30;++n)for(var Ce=r[n];Ce<r[n+1];++Ce)Ee[Ce]=Ce-r[n]<<5|n;return{b:r,r:Ee}},_a$1=freb(fleb,2),fl=_a$1.b,revfl=_a$1.r;fl[28]=258,revfl[258]=28;var _b=freb(fdeb,0),revfd=_b.r,rev=new u16(32768);for(var i$1=0;i$1<32768;++i$1){var x$1=(i$1&43690)>>1|(i$1&21845)<<1;x$1=(x$1&52428)>>2|(x$1&13107)<<2,x$1=(x$1&61680)>>4|(x$1&3855)<<4,rev[i$1]=((x$1&65280)>>8|(x$1&255)<<8)>>1}var hMap=(function(e,t,r){for(var n=e.length,Ee=0,Ce=new u16(t);Ee<n;++Ee)e[Ee]&&++Ce[e[Ee]-1];var De=new u16(t);for(Ee=1;Ee<t;++Ee)De[Ee]=De[Ee-1]+Ce[Ee-1]<<1;var Me;if(r){Me=new u16(1<<t);var ze=15-t;for(Ee=0;Ee<n;++Ee)if(e[Ee])for(var Oe=Ee<<4|e[Ee],Be=t-e[Ee],He=De[e[Ee]-1]++<<Be,Ve=He|(1<<Be)-1;He<=Ve;++He)Me[rev[He]>>ze]=Oe}else for(Me=new u16(n),Ee=0;Ee<n;++Ee)e[Ee]&&(Me[Ee]=rev[De[e[Ee]-1]++]>>15-e[Ee]);return Me}),flt=new u8(288);for(var i$1=0;i$1<144;++i$1)flt[i$1]=8;for(var i$1=144;i$1<256;++i$1)flt[i$1]=9;for(var i$1=256;i$1<280;++i$1)flt[i$1]=7;for(var i$1=280;i$1<288;++i$1)flt[i$1]=8;var fdt=new u8(32);for(var i$1=0;i$1<32;++i$1)fdt[i$1]=5;var flm=hMap(flt,9,0),fdm=hMap(fdt,5,0),shft=function(e){return(e+7)/8|0},slc=function(e,t,r){return(r==null||r>e.length)&&(r=e.length),new u8(e.subarray(t,r))},wbits=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8},wbits16=function(e,t,r){r<<=t&7;var n=t/8|0;e[n]|=r,e[n+1]|=r>>8,e[n+2]|=r>>16},hTree=function(e,t){for(var r=[],n=0;n<e.length;++n)e[n]&&r.push({s:n,f:e[n]});var Ee=r.length,Ce=r.slice();if(!Ee)return{t:et$1,l:0};if(Ee==1){var De=new u8(r[0].s+1);return De[r[0].s]=1,{t:De,l:1}}r.sort(function(ar,hr){return ar.f-hr.f}),r.push({s:-1,f:25001});var Me=r[0],ze=r[1],Oe=0,Be=1,He=2;for(r[0]={s:-1,f:Me.f+ze.f,l:Me,r:ze};Be!=Ee-1;)Me=r[r[Oe].f<r[He].f?Oe++:He++],ze=r[Oe!=Be&&r[Oe].f<r[He].f?Oe++:He++],r[Be++]={s:-1,f:Me.f+ze.f,l:Me,r:ze};for(var Ve=Ce[0].s,n=1;n<Ee;++n)Ce[n].s>Ve&&(Ve=Ce[n].s);var Xe=new u16(Ve+1),We=ln(r[Be-1],Xe,0);if(We>t){var n=0,Ge=0,$e=We-t,Ke=1<<$e;for(Ce.sort(function(hr,pr){return Xe[pr.s]-Xe[hr.s]||hr.f-pr.f});n<Ee;++n){var rr=Ce[n].s;if(Xe[rr]>t)Ge+=Ke-(1<<We-Xe[rr]),Xe[rr]=t;else break}for(Ge>>=$e;Ge>0;){var tr=Ce[n].s;Xe[tr]<t?Ge-=1<<t-Xe[tr]++-1:++n}for(;n>=0&&Ge;--n){var sr=Ce[n].s;Xe[sr]==t&&(--Xe[sr],++Ge)}We=t}return{t:new u8(Xe),l:We}},ln=function(e,t,r){return e.s==-1?Math.max(ln(e.l,t,r+1),ln(e.r,t,r+1)):t[e.s]=r},lc=function(e){for(var t=e.length;t&&!e[--t];);for(var r=new u16(++t),n=0,Ee=e[0],Ce=1,De=function(ze){r[n++]=ze},Me=1;Me<=t;++Me)if(e[Me]==Ee&&Me!=t)++Ce;else{if(!Ee&&Ce>2){for(;Ce>138;Ce-=138)De(32754);Ce>2&&(De(Ce>10?Ce-11<<5|28690:Ce-3<<5|12305),Ce=0)}else if(Ce>3){for(De(Ee),--Ce;Ce>6;Ce-=6)De(8304);Ce>2&&(De(Ce-3<<5|8208),Ce=0)}for(;Ce--;)De(Ee);Ce=1,Ee=e[Me]}return{c:r.subarray(0,n),n:t}},clen=function(e,t){for(var r=0,n=0;n<t.length;++n)r+=e[n]*t[n];return r},wfblk=function(e,t,r){var n=r.length,Ee=shft(t+2);e[Ee]=n&255,e[Ee+1]=n>>8,e[Ee+2]=e[Ee]^255,e[Ee+3]=e[Ee+1]^255;for(var Ce=0;Ce<n;++Ce)e[Ee+Ce+4]=r[Ce];return(Ee+4+n)*8},wblk=function(e,t,r,n,Ee,Ce,De,Me,ze,Oe,Be){wbits(t,Be++,r),++Ee[256];for(var He=hTree(Ee,15),Ve=He.t,Xe=He.l,We=hTree(Ce,15),Ge=We.t,$e=We.l,Ke=lc(Ve),rr=Ke.c,tr=Ke.n,sr=lc(Ge),ar=sr.c,hr=sr.n,pr=new u16(19),yr=0;yr<rr.length;++yr)++pr[rr[yr]&31];for(var yr=0;yr<ar.length;++yr)++pr[ar[yr]&31];for(var fr=hTree(pr,7),Rr=fr.t,mr=fr.l,wr=19;wr>4&&!Rr[clim[wr-1]];--wr);var Fr=Oe+5<<3,Mr=clen(Ee,flt)+clen(Ce,fdt)+De,Hr=clen(Ee,Ve)+clen(Ce,Ge)+De+14+3*wr+clen(pr,Rr)+2*pr[16]+3*pr[17]+7*pr[18];if(ze>=0&&Fr<=Mr&&Fr<=Hr)return wfblk(t,Be,e.subarray(ze,ze+Oe));var Nr,Ar,xr,ir;if(wbits(t,Be,1+(Hr<Mr)),Be+=2,Hr<Mr){Nr=hMap(Ve,Xe,0),Ar=Ve,xr=hMap(Ge,$e,0),ir=Ge;var _r=hMap(Rr,mr,0);wbits(t,Be,tr-257),wbits(t,Be+5,hr-1),wbits(t,Be+10,wr-4),Be+=14;for(var yr=0;yr<wr;++yr)wbits(t,Be+3*yr,Rr[clim[yr]]);Be+=3*wr;for(var ur=[rr,ar],Je=0;Je<2;++Je)for(var nr=ur[Je],yr=0;yr<nr.length;++yr){var or=nr[yr]&31;wbits(t,Be,_r[or]),Be+=Rr[or],or>15&&(wbits(t,Be,nr[yr]>>5&127),Be+=nr[yr]>>12)}}else Nr=flm,Ar=flt,xr=fdm,ir=fdt;for(var yr=0;yr<Me;++yr){var lr=n[yr];if(lr>255){var or=lr>>18&31;wbits16(t,Be,Nr[or+257]),Be+=Ar[or+257],or>7&&(wbits(t,Be,lr>>23&31),Be+=fleb[or]);var St=lr&31;wbits16(t,Be,xr[St]),Be+=ir[St],St>3&&(wbits16(t,Be,lr>>5&8191),Be+=fdeb[St])}else wbits16(t,Be,Nr[lr]),Be+=Ar[lr]}return wbits16(t,Be,Nr[256]),Be+Ar[256]},deo=new i32([65540,131080,131088,131104,262176,1048704,1048832,2114560,2117632]),et$1=new u8(0),dflt=function(e,t,r,n,Ee,Ce){var De=Ce.z||e.length,Me=new u8(n+De+5*(1+Math.ceil(De/7e3))+Ee),ze=Me.subarray(n,Me.length-Ee),Oe=Ce.l,Be=(Ce.r||0)&7;if(t){Be&&(ze[0]=Ce.r>>3);for(var He=deo[t-1],Ve=He>>13,Xe=He&8191,We=(1<<r)-1,Ge=Ce.p||new u16(32768),$e=Ce.h||new u16(We+1),Ke=Math.ceil(r/3),rr=2*Ke,tr=function(ua){return(e[ua]^e[ua+1]<<Ke^e[ua+2]<<rr)&We},sr=new i32(25e3),ar=new u16(288),hr=new u16(32),pr=0,yr=0,fr=Ce.i||0,Rr=0,mr=Ce.w||0,wr=0;fr+2<De;++fr){var Fr=tr(fr),Mr=fr&32767,Hr=$e[Fr];if(Ge[Mr]=Hr,$e[Fr]=Mr,mr<=fr){var Nr=De-fr;if((pr>7e3||Rr>24576)&&(Nr>423||!Oe)){Be=wblk(e,ze,0,sr,ar,hr,yr,Rr,wr,fr-wr,Be),Rr=pr=yr=0,wr=fr;for(var Ar=0;Ar<286;++Ar)ar[Ar]=0;for(var Ar=0;Ar<30;++Ar)hr[Ar]=0}var xr=2,ir=0,_r=Xe,ur=Mr-Hr&32767;if(Nr>2&&Fr==tr(fr-ur))for(var Je=Math.min(Ve,Nr)-1,nr=Math.min(32767,fr),or=Math.min(258,Nr);ur<=nr&&--_r&&Mr!=Hr;){if(e[fr+xr]==e[fr+xr-ur]){for(var lr=0;lr<or&&e[fr+lr]==e[fr+lr-ur];++lr);if(lr>xr){if(xr=lr,ir=ur,lr>Je)break;for(var St=Math.min(ur,lr-2),dr=0,Ar=0;Ar<St;++Ar){var vr=fr-ur+Ar&32767,br=Ge[vr],kr=vr-br&32767;kr>dr&&(dr=kr,Hr=vr)}}}Mr=Hr,Hr=Ge[Mr],ur+=Mr-Hr&32767}if(ir){sr[Rr++]=268435456|revfl[xr]<<18|revfd[ir];var Pr=revfl[xr]&31,Er=revfd[ir]&31;yr+=fleb[Pr]+fdeb[Er],++ar[257+Pr],++hr[Er],mr=fr+xr,++pr}else sr[Rr++]=e[fr],++ar[e[fr]]}}for(fr=Math.max(fr,mr);fr<De;++fr)sr[Rr++]=e[fr],++ar[e[fr]];Be=wblk(e,ze,Oe,sr,ar,hr,yr,Rr,wr,fr-wr,Be),Oe||(Ce.r=Be&7|ze[Be/8|0]<<3,Be-=7,Ce.h=$e,Ce.p=Ge,Ce.i=fr,Ce.w=mr)}else{for(var fr=Ce.w||0;fr<De+Oe;fr+=65535){var Zr=fr+65535;Zr>=De&&(ze[Be/8|0]=Oe,Zr=De),Be=wfblk(ze,Be+1,e.subarray(fr,Zr))}Ce.i=De}return slc(Me,0,n+shft(Be)+Ee)},adler=function(){var e=1,t=0;return{p:function(r){for(var n=e,Ee=t,Ce=r.length|0,De=0;De!=Ce;){for(var Me=Math.min(De+2655,Ce);De<Me;++De)Ee+=n+=r[De];n=(n&65535)+15*(n>>16),Ee=(Ee&65535)+15*(Ee>>16)}e=n,t=Ee},d:function(){return e%=65521,t%=65521,(e&255)<<24|(e&65280)<<8|(t&255)<<8|t>>8}}},dopt=function(e,t,r,n,Ee){if(!Ee&&(Ee={l:1},t.dictionary)){var Ce=t.dictionary.subarray(-32768),De=new u8(Ce.length+e.length);De.set(Ce),De.set(e,Ce.length),e=De,Ee.w=Ce.length}return dflt(e,t.level==null?6:t.level,t.mem==null?Ee.l?Math.ceil(Math.max(8,Math.min(13,Math.log(e.length)))*1.5):20:12+t.mem,r,n,Ee)},wbytes=function(e,t,r){for(;r;++t)e[t]=r,r>>>=8},zlh=function(e,t){var r=t.level,n=r==0?0:r<6?1:r==9?3:2;if(e[0]=120,e[1]=n<<6|(t.dictionary&&32),e[1]|=31-(e[0]<<8|e[1])%31,t.dictionary){var Ee=adler();Ee.p(t.dictionary),wbytes(e,2,Ee.d())}};function zlibSync(e,t){t||(t={});var r=adler();r.p(e);var n=dopt(e,t,t.dictionary?6:2,4);return zlh(n,t),wbytes(n,n.length-4,r.d()),n}var td=typeof TextDecoder<"u"&&new TextDecoder,tds=0;try{td.decode(et$1,{stream:!0}),tds=1}catch(e){}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _iterableToArrayLimit(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,Ee,Ce,De,Me=[],ze=!0,Oe=!1;try{if(Ce=(r=r.call(e)).next,t!==0)for(;!(ze=(n=Ce.call(r)).done)&&(Me.push(n.value),Me.length!==t);ze=!0);}catch(Be){Oe=!0,Ee=Be}finally{try{if(!ze&&r.return!=null&&(De=r.return(),Object(De)!==De))return}finally{if(Oe)throw Ee}}return Me}}function _arrayLikeToArray(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function _unsupportedIterableToArray(e,t){if(e){if(typeof e=="string")return _arrayLikeToArray(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?_arrayLikeToArray(e,t):void 0}}function _nonIterableRest(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function decode(e,t="utf8"){return new TextDecoder(t).decode(e)}const encoder=new TextEncoder;function encode(e){return encoder.encode(e)}const defaultByteLength=1024*8,hostBigEndian=(()=>{const e=new Uint8Array(4),t=new Uint32Array(e.buffer);return!((t[0]=1)&e[0])})(),typedArrays={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class IOBuffer{buffer;byteLength;byteOffset;length;offset;lastWrittenByte;littleEndian;_data;_mark;_marks;constructor(t=defaultByteLength,r={}){let n=!1;typeof t=="number"?t=new ArrayBuffer(t):(n=!0,this.lastWrittenByte=t.byteLength);const Ee=r.offset?r.offset>>>0:0,Ce=t.byteLength-Ee;let De=Ee;(ArrayBuffer.isView(t)||t instanceof IOBuffer)&&(t.byteLength!==t.buffer.byteLength&&(De=t.byteOffset+Ee),t=t.buffer),n?this.lastWrittenByte=Ce:this.lastWrittenByte=0,this.buffer=t,this.length=Ce,this.byteLength=Ce,this.byteOffset=De,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,De,Ce),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(t===void 0)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const n=(this.offset+t)*2,Ee=new Uint8Array(n);Ee.set(new Uint8Array(this.buffer)),this.buffer=Ee.buffer,this.length=n,this.byteLength=n,this._data=new DataView(this.buffer)}return this}readBoolean(){return this.readUint8()!==0}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,r){const n=typedArrays[r].BYTES_PER_ELEMENT*t,Ee=this.byteOffset+this.offset,Ce=this.buffer.slice(Ee,Ee+n);if(this.littleEndian===hostBigEndian&&r!=="uint8"&&r!=="int8"){const Me=new Uint8Array(this.buffer.slice(Ee,Ee+n));Me.reverse();const ze=new typedArrays[r](Me.buffer);return this.offset+=n,ze.reverse(),ze}const De=new typedArrays[r](Ce);return this.offset+=n,De}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let r="";for(let n=0;n<t;n++)r+=this.readChar();return r}readUtf8(t=1){return decode(this.readBytes(t))}decodeText(t=1,r="utf8"){return decode(this.readBytes(t),r)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let r=0;r<t.length;r++)this._data.setUint8(this.offset++,t[r]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let r=0;r<t.length;r++)this.writeUint8(t.charCodeAt(r));return this}writeUtf8(t){return this.writeBytes(encode(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}getWrittenByteLength(){return this.lastWrittenByte-this.byteOffset}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}function zero$1(e){let t=e.length;for(;--t>=0;)e[t]=0}const MIN_MATCH$1=3,MAX_MATCH$1=258,LENGTH_CODES$1=29,LITERALS$1=256,L_CODES$1=LITERALS$1+1+LENGTH_CODES$1,D_CODES$1=30,DIST_CODE_LEN=512,static_ltree=new Array((L_CODES$1+2)*2);zero$1(static_ltree);const static_dtree=new Array(D_CODES$1*2);zero$1(static_dtree);const _dist_code=new Array(DIST_CODE_LEN);zero$1(_dist_code);const _length_code=new Array(MAX_MATCH$1-MIN_MATCH$1+1);zero$1(_length_code);const base_length=new Array(LENGTH_CODES$1);zero$1(base_length);const base_dist=new Array(D_CODES$1);zero$1(base_dist);const adler32=(e,t,r,n)=>{let Ee=e&65535|0,Ce=e>>>16&65535|0,De=0;for(;r!==0;){De=r>2e3?2e3:r,r-=De;do Ee=Ee+t[n++]|0,Ce=Ce+Ee|0;while(--De);Ee%=65521,Ce%=65521}return Ee|Ce<<16|0};var adler32_1=adler32;const makeTable=()=>{let e,t=[];for(var r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t},crcTable$1=new Uint32Array(makeTable()),crc32=(e,t,r,n)=>{const Ee=crcTable$1,Ce=n+r;e^=-1;for(let De=n;De<Ce;De++)e=e>>>8^Ee[(e^t[De])&255];return e^-1};var crc32_1=crc32,messages={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},constants$2={Z_NO_FLUSH:0,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_DEFLATED:8};const _has=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var assign$1=function(e){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const r=t.shift();if(r){if(typeof r!="object")throw new TypeError(r+"must be non-object");for(const n in r)_has(r,n)&&(e[n]=r[n])}}return e},flattenChunks=e=>{let t=0;for(let n=0,Ee=e.length;n<Ee;n++)t+=e[n].length;const r=new Uint8Array(t);for(let n=0,Ee=0,Ce=e.length;n<Ce;n++){let De=e[n];r.set(De,Ee),Ee+=De.length}return r},common={assign:assign$1,flattenChunks};let STR_APPLY_UIA_OK=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){STR_APPLY_UIA_OK=!1}const _utf8len=new Uint8Array(256);for(let e=0;e<256;e++)_utf8len[e]=e>=252?6:e>=248?5:e>=240?4:e>=224?3:e>=192?2:1;_utf8len[254]=_utf8len[254]=1;var string2buf=e=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(e);let t,r,n,Ee,Ce,De=e.length,Me=0;for(Ee=0;Ee<De;Ee++)r=e.charCodeAt(Ee),(r&64512)===55296&&Ee+1<De&&(n=e.charCodeAt(Ee+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),Ee++)),Me+=r<128?1:r<2048?2:r<65536?3:4;for(t=new Uint8Array(Me),Ce=0,Ee=0;Ce<Me;Ee++)r=e.charCodeAt(Ee),(r&64512)===55296&&Ee+1<De&&(n=e.charCodeAt(Ee+1),(n&64512)===56320&&(r=65536+(r-55296<<10)+(n-56320),Ee++)),r<128?t[Ce++]=r:r<2048?(t[Ce++]=192|r>>>6,t[Ce++]=128|r&63):r<65536?(t[Ce++]=224|r>>>12,t[Ce++]=128|r>>>6&63,t[Ce++]=128|r&63):(t[Ce++]=240|r>>>18,t[Ce++]=128|r>>>12&63,t[Ce++]=128|r>>>6&63,t[Ce++]=128|r&63);return t};const buf2binstring=(e,t)=>{if(t<65534&&e.subarray&&STR_APPLY_UIA_OK)return String.fromCharCode.apply(null,e.length===t?e:e.subarray(0,t));let r="";for(let n=0;n<t;n++)r+=String.fromCharCode(e[n]);return r};var buf2string=(e,t)=>{const r=t||e.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(e.subarray(0,t));let n,Ee;const Ce=new Array(r*2);for(Ee=0,n=0;n<r;){let De=e[n++];if(De<128){Ce[Ee++]=De;continue}let Me=_utf8len[De];if(Me>4){Ce[Ee++]=65533,n+=Me-1;continue}for(De&=Me===2?31:Me===3?15:7;Me>1&&n<r;)De=De<<6|e[n++]&63,Me--;if(Me>1){Ce[Ee++]=65533;continue}De<65536?Ce[Ee++]=De:(De-=65536,Ce[Ee++]=55296|De>>10&1023,Ce[Ee++]=56320|De&1023)}return buf2binstring(Ce,Ee)},utf8border=(e,t)=>{t=t||e.length,t>e.length&&(t=e.length);let r=t-1;for(;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+_utf8len[e[r]]>t?r:t},strings={string2buf,buf2string,utf8border};function ZStream(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var zstream=ZStream;const BAD$1=16209,TYPE$1=16191;var inffast=function e(t,r){let n,Ee,Ce,De,Me,ze,Oe,Be,He,Ve,Xe,We,Ge,$e,Ke,rr,tr,sr,ar,hr,pr,yr,fr,Rr;const mr=t.state;n=t.next_in,fr=t.input,Ee=n+(t.avail_in-5),Ce=t.next_out,Rr=t.output,De=Ce-(r-t.avail_out),Me=Ce+(t.avail_out-257),ze=mr.dmax,Oe=mr.wsize,Be=mr.whave,He=mr.wnext,Ve=mr.window,Xe=mr.hold,We=mr.bits,Ge=mr.lencode,$e=mr.distcode,Ke=(1<<mr.lenbits)-1,rr=(1<<mr.distbits)-1;e:do{We<15&&(Xe+=fr[n++]<<We,We+=8,Xe+=fr[n++]<<We,We+=8),tr=Ge[Xe&Ke];t:for(;;){if(sr=tr>>>24,Xe>>>=sr,We-=sr,sr=tr>>>16&255,sr===0)Rr[Ce++]=tr&65535;else if(sr&16){ar=tr&65535,sr&=15,sr&&(We<sr&&(Xe+=fr[n++]<<We,We+=8),ar+=Xe&(1<<sr)-1,Xe>>>=sr,We-=sr),We<15&&(Xe+=fr[n++]<<We,We+=8,Xe+=fr[n++]<<We,We+=8),tr=$e[Xe&rr];r:for(;;){if(sr=tr>>>24,Xe>>>=sr,We-=sr,sr=tr>>>16&255,sr&16){if(hr=tr&65535,sr&=15,We<sr&&(Xe+=fr[n++]<<We,We+=8,We<sr&&(Xe+=fr[n++]<<We,We+=8)),hr+=Xe&(1<<sr)-1,hr>ze){t.msg="invalid distance too far back",mr.mode=BAD$1;break e}if(Xe>>>=sr,We-=sr,sr=Ce-De,hr>sr){if(sr=hr-sr,sr>Be&&mr.sane){t.msg="invalid distance too far back",mr.mode=BAD$1;break e}if(pr=0,yr=Ve,He===0){if(pr+=Oe-sr,sr<ar){ar-=sr;do Rr[Ce++]=Ve[pr++];while(--sr);pr=Ce-hr,yr=Rr}}else if(He<sr){if(pr+=Oe+He-sr,sr-=He,sr<ar){ar-=sr;do Rr[Ce++]=Ve[pr++];while(--sr);if(pr=0,He<ar){sr=He,ar-=sr;do Rr[Ce++]=Ve[pr++];while(--sr);pr=Ce-hr,yr=Rr}}}else if(pr+=He-sr,sr<ar){ar-=sr;do Rr[Ce++]=Ve[pr++];while(--sr);pr=Ce-hr,yr=Rr}for(;ar>2;)Rr[Ce++]=yr[pr++],Rr[Ce++]=yr[pr++],Rr[Ce++]=yr[pr++],ar-=3;ar&&(Rr[Ce++]=yr[pr++],ar>1&&(Rr[Ce++]=yr[pr++]))}else{pr=Ce-hr;do Rr[Ce++]=Rr[pr++],Rr[Ce++]=Rr[pr++],Rr[Ce++]=Rr[pr++],ar-=3;while(ar>2);ar&&(Rr[Ce++]=Rr[pr++],ar>1&&(Rr[Ce++]=Rr[pr++]))}}else if((sr&64)===0){tr=$e[(tr&65535)+(Xe&(1<<sr)-1)];continue r}else{t.msg="invalid distance code",mr.mode=BAD$1;break e}break}}else if((sr&64)===0){tr=Ge[(tr&65535)+(Xe&(1<<sr)-1)];continue t}else if(sr&32){mr.mode=TYPE$1;break e}else{t.msg="invalid literal/length code",mr.mode=BAD$1;break e}break}}while(n<Ee&&Ce<Me);ar=We>>3,n-=ar,We-=ar<<3,Xe&=(1<<We)-1,t.next_in=n,t.next_out=Ce,t.avail_in=n<Ee?5+(Ee-n):5-(n-Ee),t.avail_out=Ce<Me?257+(Me-Ce):257-(Ce-Me),mr.hold=Xe,mr.bits=We};const MAXBITS=15,ENOUGH_LENS$1=852,ENOUGH_DISTS$1=592,CODES$1=0,LENS$1=1,DISTS$1=2,lbase=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),lext=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),dbase=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),dext=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),inflate_table=(e,t,r,n,Ee,Ce,De,Me)=>{const ze=Me.bits;let Oe=0,Be=0,He=0,Ve=0,Xe=0,We=0,Ge=0,$e=0,Ke=0,rr=0,tr,sr,ar,hr,pr,yr=null,fr;const Rr=new Uint16Array(MAXBITS+1),mr=new Uint16Array(MAXBITS+1);let wr=null,Fr,Mr,Hr;for(Oe=0;Oe<=MAXBITS;Oe++)Rr[Oe]=0;for(Be=0;Be<n;Be++)Rr[t[r+Be]]++;for(Xe=ze,Ve=MAXBITS;Ve>=1&&Rr[Ve]===0;Ve--);if(Xe>Ve&&(Xe=Ve),Ve===0)return Ee[Ce++]=1<<24|64<<16|0,Ee[Ce++]=1<<24|64<<16|0,Me.bits=1,0;for(He=1;He<Ve&&Rr[He]===0;He++);for(Xe<He&&(Xe=He),$e=1,Oe=1;Oe<=MAXBITS;Oe++)if($e<<=1,$e-=Rr[Oe],$e<0)return-1;if($e>0&&(e===CODES$1||Ve!==1))return-1;for(mr[1]=0,Oe=1;Oe<MAXBITS;Oe++)mr[Oe+1]=mr[Oe]+Rr[Oe];for(Be=0;Be<n;Be++)t[r+Be]!==0&&(De[mr[t[r+Be]]++]=Be);if(e===CODES$1?(yr=wr=De,fr=20):e===LENS$1?(yr=lbase,wr=lext,fr=257):(yr=dbase,wr=dext,fr=0),rr=0,Be=0,Oe=He,pr=Ce,We=Xe,Ge=0,ar=-1,Ke=1<<Xe,hr=Ke-1,e===LENS$1&&Ke>ENOUGH_LENS$1||e===DISTS$1&&Ke>ENOUGH_DISTS$1)return 1;for(;;){Fr=Oe-Ge,De[Be]+1<fr?(Mr=0,Hr=De[Be]):De[Be]>=fr?(Mr=wr[De[Be]-fr],Hr=yr[De[Be]-fr]):(Mr=96,Hr=0),tr=1<<Oe-Ge,sr=1<<We,He=sr;do sr-=tr,Ee[pr+(rr>>Ge)+sr]=Fr<<24|Mr<<16|Hr|0;while(sr!==0);for(tr=1<<Oe-1;rr&tr;)tr>>=1;if(tr!==0?(rr&=tr-1,rr+=tr):rr=0,Be++,--Rr[Oe]===0){if(Oe===Ve)break;Oe=t[r+De[Be]]}if(Oe>Xe&&(rr&hr)!==ar){for(Ge===0&&(Ge=Xe),pr+=He,We=Oe-Ge,$e=1<<We;We+Ge<Ve&&($e-=Rr[We+Ge],!($e<=0));)We++,$e<<=1;if(Ke+=1<<We,e===LENS$1&&Ke>ENOUGH_LENS$1||e===DISTS$1&&Ke>ENOUGH_DISTS$1)return 1;ar=rr&hr,Ee[ar]=Xe<<24|We<<16|pr-Ce|0}}return rr!==0&&(Ee[pr+rr]=Oe-Ge<<24|64<<16|0),Me.bits=Xe,0};var inftrees=inflate_table;const CODES=0,LENS=1,DISTS=2,{Z_FINISH:Z_FINISH$1,Z_BLOCK,Z_TREES,Z_OK:Z_OK$1,Z_STREAM_END:Z_STREAM_END$1,Z_NEED_DICT:Z_NEED_DICT$1,Z_STREAM_ERROR:Z_STREAM_ERROR$1,Z_DATA_ERROR:Z_DATA_ERROR$1,Z_MEM_ERROR:Z_MEM_ERROR$1,Z_BUF_ERROR,Z_DEFLATED}=constants$2,HEAD=16180,FLAGS=16181,TIME=16182,OS=16183,EXLEN=16184,EXTRA=16185,NAME=16186,COMMENT=16187,HCRC=16188,DICTID=16189,DICT=16190,TYPE=16191,TYPEDO=16192,STORED=16193,COPY_=16194,COPY=16195,TABLE=16196,LENLENS=16197,CODELENS=16198,LEN_=16199,LEN=16200,LENEXT=16201,DIST=16202,DISTEXT=16203,MATCH=16204,LIT=16205,CHECK=16206,LENGTH=16207,DONE=16208,BAD=16209,MEM=16210,SYNC=16211,ENOUGH_LENS=852,ENOUGH_DISTS=592,MAX_WBITS=15,DEF_WBITS=MAX_WBITS,zswap32=e=>(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24);function InflateState(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const inflateStateCheck=e=>{if(!e)return 1;const t=e.state;return!t||t.strm!==e||t.mode<HEAD||t.mode>SYNC?1:0},inflateResetKeep=e=>{if(inflateStateCheck(e))return Z_STREAM_ERROR$1;const t=e.state;return e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=HEAD,t.last=0,t.havedict=0,t.flags=-1,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(ENOUGH_LENS),t.distcode=t.distdyn=new Int32Array(ENOUGH_DISTS),t.sane=1,t.back=-1,Z_OK$1},inflateReset=e=>{if(inflateStateCheck(e))return Z_STREAM_ERROR$1;const t=e.state;return t.wsize=0,t.whave=0,t.wnext=0,inflateResetKeep(e)},inflateReset2=(e,t)=>{let r;if(inflateStateCheck(e))return Z_STREAM_ERROR$1;const n=e.state;return t<0?(r=0,t=-t):(r=(t>>4)+5,t<48&&(t&=15)),t&&(t<8||t>15)?Z_STREAM_ERROR$1:(n.window!==null&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,inflateReset(e))},inflateInit2=(e,t)=>{if(!e)return Z_STREAM_ERROR$1;const r=new InflateState;e.state=r,r.strm=e,r.window=null,r.mode=HEAD;const n=inflateReset2(e,t);return n!==Z_OK$1&&(e.state=null),n},inflateInit=e=>inflateInit2(e,DEF_WBITS);let virgin=!0,lenfix,distfix;const fixedtables=e=>{if(virgin){lenfix=new Int32Array(512),distfix=new Int32Array(32);let t=0;for(;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(inftrees(LENS,e.lens,0,288,lenfix,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;inftrees(DISTS,e.lens,0,32,distfix,0,e.work,{bits:5}),virgin=!1}e.lencode=lenfix,e.lenbits=9,e.distcode=distfix,e.distbits=5},updatewindow=(e,t,r,n)=>{let Ee;const Ce=e.state;return Ce.window===null&&(Ce.wsize=1<<Ce.wbits,Ce.wnext=0,Ce.whave=0,Ce.window=new Uint8Array(Ce.wsize)),n>=Ce.wsize?(Ce.window.set(t.subarray(r-Ce.wsize,r),0),Ce.wnext=0,Ce.whave=Ce.wsize):(Ee=Ce.wsize-Ce.wnext,Ee>n&&(Ee=n),Ce.window.set(t.subarray(r-n,r-n+Ee),Ce.wnext),n-=Ee,n?(Ce.window.set(t.subarray(r-n,r),0),Ce.wnext=n,Ce.whave=Ce.wsize):(Ce.wnext+=Ee,Ce.wnext===Ce.wsize&&(Ce.wnext=0),Ce.whave<Ce.wsize&&(Ce.whave+=Ee))),0},inflate$2=(e,t)=>{let r,n,Ee,Ce,De,Me,ze,Oe,Be,He,Ve,Xe,We,Ge,$e=0,Ke,rr,tr,sr,ar,hr,pr,yr;const fr=new Uint8Array(4);let Rr,mr;const wr=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(inflateStateCheck(e)||!e.output||!e.input&&e.avail_in!==0)return Z_STREAM_ERROR$1;r=e.state,r.mode===TYPE&&(r.mode=TYPEDO),De=e.next_out,Ee=e.output,ze=e.avail_out,Ce=e.next_in,n=e.input,Me=e.avail_in,Oe=r.hold,Be=r.bits,He=Me,Ve=ze,yr=Z_OK$1;e:for(;;)switch(r.mode){case HEAD:if(r.wrap===0){r.mode=TYPEDO;break}for(;Be<16;){if(Me===0)break e;Me--,Oe+=n[Ce++]<<Be,Be+=8}if(r.wrap&2&&Oe===35615){r.wbits===0&&(r.wbits=15),r.check=0,fr[0]=Oe&255,fr[1]=Oe>>>8&255,r.check=crc32_1(r.check,fr,2,0),Oe=0,Be=0,r.mode=FLAGS;break}if(r.head&&(r.head.done=!1),!(r.wrap&1)||(((Oe&255)<<8)+(Oe>>8))%31){e.msg="incorrect header check",r.mode=BAD;break}if((Oe&15)!==Z_DEFLATED){e.msg="unknown compression method",r.mode=BAD;break}if(Oe>>>=4,Be-=4,pr=(Oe&15)+8,r.wbits===0&&(r.wbits=pr),pr>15||pr>r.wbits){e.msg="invalid window size",r.mode=BAD;break}r.dmax=1<<r.wbits,r.flags=0,e.adler=r.check=1,r.mode=Oe&512?DICTID:TYPE,Oe=0,Be=0;break;case FLAGS:for(;Be<16;){if(Me===0)break e;Me--,Oe+=n[Ce++]<<Be,Be+=8}if(r.flags=Oe,(r.flags&255)!==Z_DEFLATED){e.msg="unknown compression method",r.mode=BAD;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=BAD;break}r.head&&(r.head.text=Oe>>8&1),r.flags&512&&r.wrap&4&&(fr[0]=Oe&255,fr[1]=Oe>>>8&255,r.check=crc32_1(r.check,fr,2,0)),Oe=0,Be=0,r.mode=TIME;case TIME:for(;Be<32;){if(Me===0)break e;Me--,Oe+=n[Ce++]<<Be,Be+=8}r.head&&(r.head.time=Oe),r.flags&512&&r.wrap&4&&(fr[0]=Oe&255,fr[1]=Oe>>>8&255,fr[2]=Oe>>>16&255,fr[3]=Oe>>>24&255,r.check=crc32_1(r.check,fr,4,0)),Oe=0,Be=0,r.mode=OS;case OS:for(;Be<16;){if(Me===0)break e;Me--,Oe+=n[Ce++]<<Be,Be+=8}r.head&&(r.head.xflags=Oe&255,r.head.os=Oe>>8),r.flags&512&&r.wrap&4&&(fr[0]=Oe&255,fr[1]=Oe>>>8&255,r.check=crc32_1(r.check,fr,2,0)),Oe=0,Be=0,r.mode=EXLEN;case EXLEN:if(r.flags&1024){for(;Be<16;){if(Me===0)break e;Me--,Oe+=n[Ce++]<<Be,Be+=8}r.length=Oe,r.head&&(r.head.extra_len=Oe),r.flags&512&&r.wrap&4&&(fr[0]=Oe&255,fr[1]=Oe>>>8&255,r.check=crc32_1(r.check,fr,2,0)),Oe=0,Be=0}else r.head&&(r.head.extra=null);r.mode=EXTRA;case EXTRA:if(r.flags&1024&&(Xe=r.length,Xe>Me&&(Xe=Me),Xe&&(r.head&&(pr=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(n.subarray(Ce,Ce+Xe),pr)),r.flags&512&&r.wrap&4&&(r.check=crc32_1(r.check,n,Xe,Ce)),Me-=Xe,Ce+=Xe,r.length-=Xe),r.length))break e;r.length=0,r.mode=NAME;case NAME:if(r.flags&2048){if(Me===0)break e;Xe=0;do pr=n[Ce+Xe++],r.head&&pr&&r.length<65536&&(r.head.name+=String.fromCharCode(pr));while(pr&&Xe<Me);if(r.flags&512&&r.wrap&4&&(r.check=crc32_1(r.check,n,Xe,Ce)),Me-=Xe,Ce+=Xe,pr)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=COMMENT;case COMMENT:if(r.flags&4096){if(Me===0)break e;Xe=0;do pr=n[Ce+Xe++],r.head&&pr&&r.length<65536&&(r.head.comment+=String.fromCharCode(pr));while(pr&&Xe<Me);if(r.flags&512&&r.wrap&4&&(r.check=crc32_1(r.check,n,Xe,Ce)),Me-=Xe,Ce+=Xe,pr)break e}else r.head&&(r.head.comment=null);r.mode=HCRC;case HCRC:if(r.flags&512){for(;Be<16;){if(Me===0)break e;Me--,Oe+=n[Ce++]<<Be,Be+=8}if(r.wrap&4&&Oe!==(r.check&65535)){e.msg="header crc mismatch",r.mode=BAD;break}Oe=0,Be=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=TYPE;break;case DICTID:for(;Be<32;){if(Me===0)break e;Me--,Oe+=n[Ce++]<<Be,Be+=8}e.adler=r.check=zswap32(Oe),Oe=0,Be=0,r.mode=DICT;case DICT:if(r.havedict===0)return e.next_out=De,e.avail_out=ze,e.next_in=Ce,e.avail_in=Me,r.hold=Oe,r.bits=Be,Z_NEED_DICT$1;e.adler=r.check=1,r.mode=TYPE;case TYPE:if(t===Z_BLOCK||t===Z_TREES)break e;case TYPEDO:if(r.last){Oe>>>=Be&7,Be-=Be&7,r.mode=CHECK;break}for(;Be<3;){if(Me===0)break e;Me--,Oe+=n[Ce++]<<Be,Be+=8}switch(r.last=Oe&1,Oe>>>=1,Be-=1,Oe&3){case 0:r.mode=STORED;break;case 1:if(fixedtables(r),r.mode=LEN_,t===Z_TREES){Oe>>>=2,Be-=2;break e}break;case 2:r.mode=TABLE;break;case 3:e.msg="invalid block type",r.mode=BAD}Oe>>>=2,Be-=2;break;case STORED:for(Oe>>>=Be&7,Be-=Be&7;Be<32;){if(Me===0)break e;Me--,Oe+=n[Ce++]<<Be,Be+=8}if((Oe&65535)!==(Oe>>>16^65535)){e.msg="invalid stored block lengths",r.mode=BAD;break}if(r.length=Oe&65535,Oe=0,Be=0,r.mode=COPY_,t===Z_TREES)break e;case COPY_:r.mode=COPY;case COPY:if(Xe=r.length,Xe){if(Xe>Me&&(Xe=Me),Xe>ze&&(Xe=ze),Xe===0)break e;Ee.set(n.subarray(Ce,Ce+Xe),De),Me-=Xe,Ce+=Xe,ze-=Xe,De+=Xe,r.length-=Xe;break}r.mode=TYPE;break;case TABLE:for(;Be<14;){if(Me===0)break e;Me--,Oe+=n[Ce++]<<Be,Be+=8}if(r.nlen=(Oe&31)+257,Oe>>>=5,Be-=5,r.ndist=(Oe&31)+1,Oe>>>=5,Be-=5,r.ncode=(Oe&15)+4,Oe>>>=4,Be-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=BAD;break}r.have=0,r.mode=LENLENS;case LENLENS:for(;r.have<r.ncode;){for(;Be<3;){if(Me===0)break e;Me--,Oe+=n[Ce++]<<Be,Be+=8}r.lens[wr[r.have++]]=Oe&7,Oe>>>=3,Be-=3}for(;r.have<19;)r.lens[wr[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,Rr={bits:r.lenbits},yr=inftrees(CODES,r.lens,0,19,r.lencode,0,r.work,Rr),r.lenbits=Rr.bits,yr){e.msg="invalid code lengths set",r.mode=BAD;break}r.have=0,r.mode=CODELENS;case CODELENS:for(;r.have<r.nlen+r.ndist;){for(;$e=r.lencode[Oe&(1<<r.lenbits)-1],Ke=$e>>>24,rr=$e>>>16&255,tr=$e&65535,!(Ke<=Be);){if(Me===0)break e;Me--,Oe+=n[Ce++]<<Be,Be+=8}if(tr<16)Oe>>>=Ke,Be-=Ke,r.lens[r.have++]=tr;else{if(tr===16){for(mr=Ke+2;Be<mr;){if(Me===0)break e;Me--,Oe+=n[Ce++]<<Be,Be+=8}if(Oe>>>=Ke,Be-=Ke,r.have===0){e.msg="invalid bit length repeat",r.mode=BAD;break}pr=r.lens[r.have-1],Xe=3+(Oe&3),Oe>>>=2,Be-=2}else if(tr===17){for(mr=Ke+3;Be<mr;){if(Me===0)break e;Me--,Oe+=n[Ce++]<<Be,Be+=8}Oe>>>=Ke,Be-=Ke,pr=0,Xe=3+(Oe&7),Oe>>>=3,Be-=3}else{for(mr=Ke+7;Be<mr;){if(Me===0)break e;Me--,Oe+=n[Ce++]<<Be,Be+=8}Oe>>>=Ke,Be-=Ke,pr=0,Xe=11+(Oe&127),Oe>>>=7,Be-=7}if(r.have+Xe>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=BAD;break}for(;Xe--;)r.lens[r.have++]=pr}}if(r.mode===BAD)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=BAD;break}if(r.lenbits=9,Rr={bits:r.lenbits},yr=inftrees(LENS,r.lens,0,r.nlen,r.lencode,0,r.work,Rr),r.lenbits=Rr.bits,yr){e.msg="invalid literal/lengths set",r.mode=BAD;break}if(r.distbits=6,r.distcode=r.distdyn,Rr={bits:r.distbits},yr=inftrees(DISTS,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,Rr),r.distbits=Rr.bits,yr){e.msg="invalid distances set",r.mode=BAD;break}if(r.mode=LEN_,t===Z_TREES)break e;case LEN_:r.mode=LEN;case LEN:if(Me>=6&&ze>=258){e.next_out=De,e.avail_out=ze,e.next_in=Ce,e.avail_in=Me,r.hold=Oe,r.bits=Be,inffast(e,Ve),De=e.next_out,Ee=e.output,ze=e.avail_out,Ce=e.next_in,n=e.input,Me=e.avail_in,Oe=r.hold,Be=r.bits,r.mode===TYPE&&(r.back=-1);break}for(r.back=0;$e=r.lencode[Oe&(1<<r.lenbits)-1],Ke=$e>>>24,rr=$e>>>16&255,tr=$e&65535,!(Ke<=Be);){if(Me===0)break e;Me--,Oe+=n[Ce++]<<Be,Be+=8}if(rr&&(rr&240)===0){for(sr=Ke,ar=rr,hr=tr;$e=r.lencode[hr+((Oe&(1<<sr+ar)-1)>>sr)],Ke=$e>>>24,rr=$e>>>16&255,tr=$e&65535,!(sr+Ke<=Be);){if(Me===0)break e;Me--,Oe+=n[Ce++]<<Be,Be+=8}Oe>>>=sr,Be-=sr,r.back+=sr}if(Oe>>>=Ke,Be-=Ke,r.back+=Ke,r.length=tr,rr===0){r.mode=LIT;break}if(rr&32){r.back=-1,r.mode=TYPE;break}if(rr&64){e.msg="invalid literal/length code",r.mode=BAD;break}r.extra=rr&15,r.mode=LENEXT;case LENEXT:if(r.extra){for(mr=r.extra;Be<mr;){if(Me===0)break e;Me--,Oe+=n[Ce++]<<Be,Be+=8}r.length+=Oe&(1<<r.extra)-1,Oe>>>=r.extra,Be-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=DIST;case DIST:for(;$e=r.distcode[Oe&(1<<r.distbits)-1],Ke=$e>>>24,rr=$e>>>16&255,tr=$e&65535,!(Ke<=Be);){if(Me===0)break e;Me--,Oe+=n[Ce++]<<Be,Be+=8}if((rr&240)===0){for(sr=Ke,ar=rr,hr=tr;$e=r.distcode[hr+((Oe&(1<<sr+ar)-1)>>sr)],Ke=$e>>>24,rr=$e>>>16&255,tr=$e&65535,!(sr+Ke<=Be);){if(Me===0)break e;Me--,Oe+=n[Ce++]<<Be,Be+=8}Oe>>>=sr,Be-=sr,r.back+=sr}if(Oe>>>=Ke,Be-=Ke,r.back+=Ke,rr&64){e.msg="invalid distance code",r.mode=BAD;break}r.offset=tr,r.extra=rr&15,r.mode=DISTEXT;case DISTEXT:if(r.extra){for(mr=r.extra;Be<mr;){if(Me===0)break e;Me--,Oe+=n[Ce++]<<Be,Be+=8}r.offset+=Oe&(1<<r.extra)-1,Oe>>>=r.extra,Be-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=BAD;break}r.mode=MATCH;case MATCH:if(ze===0)break e;if(Xe=Ve-ze,r.offset>Xe){if(Xe=r.offset-Xe,Xe>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=BAD;break}Xe>r.wnext?(Xe-=r.wnext,We=r.wsize-Xe):We=r.wnext-Xe,Xe>r.length&&(Xe=r.length),Ge=r.window}else Ge=Ee,We=De-r.offset,Xe=r.length;Xe>ze&&(Xe=ze),ze-=Xe,r.length-=Xe;do Ee[De++]=Ge[We++];while(--Xe);r.length===0&&(r.mode=LEN);break;case LIT:if(ze===0)break e;Ee[De++]=r.length,ze--,r.mode=LEN;break;case CHECK:if(r.wrap){for(;Be<32;){if(Me===0)break e;Me--,Oe|=n[Ce++]<<Be,Be+=8}if(Ve-=ze,e.total_out+=Ve,r.total+=Ve,r.wrap&4&&Ve&&(e.adler=r.check=r.flags?crc32_1(r.check,Ee,Ve,De-Ve):adler32_1(r.check,Ee,Ve,De-Ve)),Ve=ze,r.wrap&4&&(r.flags?Oe:zswap32(Oe))!==r.check){e.msg="incorrect data check",r.mode=BAD;break}Oe=0,Be=0}r.mode=LENGTH;case LENGTH:if(r.wrap&&r.flags){for(;Be<32;){if(Me===0)break e;Me--,Oe+=n[Ce++]<<Be,Be+=8}if(r.wrap&4&&Oe!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=BAD;break}Oe=0,Be=0}r.mode=DONE;case DONE:yr=Z_STREAM_END$1;break e;case BAD:yr=Z_DATA_ERROR$1;break e;case MEM:return Z_MEM_ERROR$1;case SYNC:default:return Z_STREAM_ERROR$1}return e.next_out=De,e.avail_out=ze,e.next_in=Ce,e.avail_in=Me,r.hold=Oe,r.bits=Be,(r.wsize||Ve!==e.avail_out&&r.mode<BAD&&(r.mode<CHECK||t!==Z_FINISH$1))&&updatewindow(e,e.output,e.next_out,Ve-e.avail_out),He-=e.avail_in,Ve-=e.avail_out,e.total_in+=He,e.total_out+=Ve,r.total+=Ve,r.wrap&4&&Ve&&(e.adler=r.check=r.flags?crc32_1(r.check,Ee,Ve,e.next_out-Ve):adler32_1(r.check,Ee,Ve,e.next_out-Ve)),e.data_type=r.bits+(r.last?64:0)+(r.mode===TYPE?128:0)+(r.mode===LEN_||r.mode===COPY_?256:0),(He===0&&Ve===0||t===Z_FINISH$1)&&yr===Z_OK$1&&(yr=Z_BUF_ERROR),yr},inflateEnd=e=>{if(inflateStateCheck(e))return Z_STREAM_ERROR$1;let t=e.state;return t.window&&(t.window=null),e.state=null,Z_OK$1},inflateGetHeader=(e,t)=>{if(inflateStateCheck(e))return Z_STREAM_ERROR$1;const r=e.state;return(r.wrap&2)===0?Z_STREAM_ERROR$1:(r.head=t,t.done=!1,Z_OK$1)},inflateSetDictionary=(e,t)=>{const r=t.length;let n,Ee,Ce;return inflateStateCheck(e)||(n=e.state,n.wrap!==0&&n.mode!==DICT)?Z_STREAM_ERROR$1:n.mode===DICT&&(Ee=1,Ee=adler32_1(Ee,t,r,0),Ee!==n.check)?Z_DATA_ERROR$1:(Ce=updatewindow(e,t,r,r),Ce?(n.mode=MEM,Z_MEM_ERROR$1):(n.havedict=1,Z_OK$1))};var inflateReset_1=inflateReset,inflateReset2_1=inflateReset2,inflateResetKeep_1=inflateResetKeep,inflateInit_1=inflateInit,inflateInit2_1=inflateInit2,inflate_2$1=inflate$2,inflateEnd_1=inflateEnd,inflateGetHeader_1=inflateGetHeader,inflateSetDictionary_1=inflateSetDictionary,inflateInfo="pako inflate (from Nodeca project)",inflate_1$2={inflateReset:inflateReset_1,inflateReset2:inflateReset2_1,inflateResetKeep:inflateResetKeep_1,inflateInit:inflateInit_1,inflateInit2:inflateInit2_1,inflate:inflate_2$1,inflateEnd:inflateEnd_1,inflateGetHeader:inflateGetHeader_1,inflateSetDictionary:inflateSetDictionary_1,inflateInfo};function GZheader(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var gzheader=GZheader;const toString=Object.prototype.toString,{Z_NO_FLUSH,Z_FINISH,Z_OK,Z_STREAM_END,Z_NEED_DICT,Z_STREAM_ERROR,Z_DATA_ERROR,Z_MEM_ERROR}=constants$2;function Inflate$1(e){this.options=common.assign({chunkSize:1024*64,windowBits:15,to:""},e||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new zstream,this.strm.avail_out=0;let r=inflate_1$2.inflateInit2(this.strm,t.windowBits);if(r!==Z_OK)throw new Error(messages[r]);if(this.header=new gzheader,inflate_1$2.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=strings.string2buf(t.dictionary):toString.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=inflate_1$2.inflateSetDictionary(this.strm,t.dictionary),r!==Z_OK)))throw new Error(messages[r])}Inflate$1.prototype.push=function(e,t){const r=this.strm,n=this.options.chunkSize,Ee=this.options.dictionary;let Ce,De,Me;if(this.ended)return!1;for(t===~~t?De=t:De=t===!0?Z_FINISH:Z_NO_FLUSH,toString.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;;){for(r.avail_out===0&&(r.output=new Uint8Array(n),r.next_out=0,r.avail_out=n),Ce=inflate_1$2.inflate(r,De),Ce===Z_NEED_DICT&&Ee&&(Ce=inflate_1$2.inflateSetDictionary(r,Ee),Ce===Z_OK?Ce=inflate_1$2.inflate(r,De):Ce===Z_DATA_ERROR&&(Ce=Z_NEED_DICT));r.avail_in>0&&Ce===Z_STREAM_END&&r.state.wrap>0&&e[r.next_in]!==0;)inflate_1$2.inflateReset(r),Ce=inflate_1$2.inflate(r,De);switch(Ce){case Z_STREAM_ERROR:case Z_DATA_ERROR:case Z_NEED_DICT:case Z_MEM_ERROR:return this.onEnd(Ce),this.ended=!0,!1}if(Me=r.avail_out,r.next_out&&(r.avail_out===0||Ce===Z_STREAM_END))if(this.options.to==="string"){let ze=strings.utf8border(r.output,r.next_out),Oe=r.next_out-ze,Be=strings.buf2string(r.output,ze);r.next_out=Oe,r.avail_out=n-Oe,Oe&&r.output.set(r.output.subarray(ze,ze+Oe),0),this.onData(Be)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(!(Ce===Z_OK&&Me===0)){if(Ce===Z_STREAM_END)return Ce=inflate_1$2.inflateEnd(this.strm),this.onEnd(Ce),this.ended=!0,!0;if(r.avail_in===0)break}}return!0};Inflate$1.prototype.onData=function(e){this.chunks.push(e)};Inflate$1.prototype.onEnd=function(e){e===Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=common.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function inflate$1(e,t){const r=new Inflate$1(t);if(r.push(e),r.err)throw r.msg||messages[r.err];return r.result}var Inflate_1$1=Inflate$1,inflate_2=inflate$1,inflate_1$1={Inflate:Inflate_1$1,inflate:inflate_2};const{Inflate,inflate}=inflate_1$1;var Inflate_1=Inflate,inflate_1=inflate;const crcTable=[];for(let e=0;e<256;e++){let t=e;for(let r=0;r<8;r++)t&1?t=3988292384^t>>>1:t=t>>>1;crcTable[e]=t}const initialCrc=4294967295;function updateCrc(e,t,r){let n=e;for(let Ee=0;Ee<r;Ee++)n=crcTable[(n^t[Ee])&255]^n>>>8;return n}function crc(e,t){return(updateCrc(initialCrc,e,t)^initialCrc)>>>0}function checkCrc(e,t,r){const n=e.readUint32(),Ee=crc(new Uint8Array(e.buffer,e.byteOffset+e.offset-t-4,t),t);if(Ee!==n)throw new Error(`CRC mismatch for chunk ${r}. Expected ${n}, found ${Ee}`)}function unfilterNone(e,t,r){for(let n=0;n<r;n++)t[n]=e[n]}function unfilterSub(e,t,r,n){let Ee=0;for(;Ee<n;Ee++)t[Ee]=e[Ee];for(;Ee<r;Ee++)t[Ee]=e[Ee]+t[Ee-n]&255}function unfilterUp(e,t,r,n){let Ee=0;if(r.length===0)for(;Ee<n;Ee++)t[Ee]=e[Ee];else for(;Ee<n;Ee++)t[Ee]=e[Ee]+r[Ee]&255}function unfilterAverage(e,t,r,n,Ee){let Ce=0;if(r.length===0){for(;Ce<Ee;Ce++)t[Ce]=e[Ce];for(;Ce<n;Ce++)t[Ce]=e[Ce]+(t[Ce-Ee]>>1)&255}else{for(;Ce<Ee;Ce++)t[Ce]=e[Ce]+(r[Ce]>>1)&255;for(;Ce<n;Ce++)t[Ce]=e[Ce]+(t[Ce-Ee]+r[Ce]>>1)&255}}function unfilterPaeth(e,t,r,n,Ee){let Ce=0;if(r.length===0){for(;Ce<Ee;Ce++)t[Ce]=e[Ce];for(;Ce<n;Ce++)t[Ce]=e[Ce]+t[Ce-Ee]&255}else{for(;Ce<Ee;Ce++)t[Ce]=e[Ce]+r[Ce]&255;for(;Ce<n;Ce++)t[Ce]=e[Ce]+paethPredictor(t[Ce-Ee],r[Ce],r[Ce-Ee])&255}}function paethPredictor(e,t,r){const n=e+t-r,Ee=Math.abs(n-e),Ce=Math.abs(n-t),De=Math.abs(n-r);return Ee<=Ce&&Ee<=De?e:Ce<=De?t:r}function applyUnfilter(e,t,r,n,Ee,Ce){switch(e){case 0:unfilterNone(t,r,Ee);break;case 1:unfilterSub(t,r,Ee,Ce);break;case 2:unfilterUp(t,r,n,Ee);break;case 3:unfilterAverage(t,r,n,Ee,Ce);break;case 4:unfilterPaeth(t,r,n,Ee,Ce);break;default:throw new Error(`Unsupported filter: ${e}`)}}const uint16$1=new Uint16Array([255]),uint8$1=new Uint8Array(uint16$1.buffer),osIsLittleEndian$1=uint8$1[0]===255;function decodeInterlaceAdam7(e){const{data:t,width:r,height:n,channels:Ee,depth:Ce}=e,De=[{x:0,y:0,xStep:8,yStep:8},{x:4,y:0,xStep:8,yStep:8},{x:0,y:4,xStep:4,yStep:8},{x:2,y:0,xStep:4,yStep:4},{x:0,y:2,xStep:2,yStep:4},{x:1,y:0,xStep:2,yStep:2},{x:0,y:1,xStep:1,yStep:2}],Me=Math.ceil(Ce/8)*Ee,ze=new Uint8Array(n*r*Me);let Oe=0;for(let Be=0;Be<7;Be++){const He=De[Be],Ve=Math.ceil((r-He.x)/He.xStep),Xe=Math.ceil((n-He.y)/He.yStep);if(Ve<=0||Xe<=0)continue;const We=Ve*Me,Ge=new Uint8Array(We);for(let $e=0;$e<Xe;$e++){const Ke=t[Oe++],rr=t.subarray(Oe,Oe+We);Oe+=We;const tr=new Uint8Array(We);applyUnfilter(Ke,rr,tr,Ge,We,Me),Ge.set(tr);for(let sr=0;sr<Ve;sr++){const ar=He.x+sr*He.xStep,hr=He.y+$e*He.yStep;if(!(ar>=r||hr>=n))for(let pr=0;pr<Me;pr++)ze[(hr*r+ar)*Me+pr]=tr[sr*Me+pr]}}}if(Ce===16){const Be=new Uint16Array(ze.buffer);if(osIsLittleEndian$1)for(let He=0;He<Be.length;He++)Be[He]=swap16$1(Be[He]);return Be}else return ze}function swap16$1(e){return(e&255)<<8|e>>8&255}const uint16=new Uint16Array([255]),uint8=new Uint8Array(uint16.buffer),osIsLittleEndian=uint8[0]===255,empty=new Uint8Array(0);function decodeInterlaceNull(e){const{data:t,width:r,height:n,channels:Ee,depth:Ce}=e,De=Math.ceil(Ce/8)*Ee,Me=Math.ceil(Ce/8*Ee*r),ze=new Uint8Array(n*Me);let Oe=empty,Be=0,He,Ve;for(let Xe=0;Xe<n;Xe++){switch(He=t.subarray(Be+1,Be+1+Me),Ve=ze.subarray(Xe*Me,(Xe+1)*Me),t[Be]){case 0:unfilterNone(He,Ve,Me);break;case 1:unfilterSub(He,Ve,Me,De);break;case 2:unfilterUp(He,Ve,Oe,Me);break;case 3:unfilterAverage(He,Ve,Oe,Me,De);break;case 4:unfilterPaeth(He,Ve,Oe,Me,De);break;default:throw new Error(`Unsupported filter: ${t[Be]}`)}Oe=Ve,Be+=Me+1}if(Ce===16){const Xe=new Uint16Array(ze.buffer);if(osIsLittleEndian)for(let We=0;We<Xe.length;We++)Xe[We]=swap16(Xe[We]);return Xe}else return ze}function swap16(e){return(e&255)<<8|e>>8&255}const pngSignature=Uint8Array.of(137,80,78,71,13,10,26,10);function checkSignature(e){if(!hasPngSignature(e.readBytes(pngSignature.length)))throw new Error("wrong PNG signature")}function hasPngSignature(e){if(e.length<pngSignature.length)return!1;for(let t=0;t<pngSignature.length;t++)if(e[t]!==pngSignature[t])return!1;return!0}const textChunkName="tEXt",NULL=0,latin1Decoder=new TextDecoder("latin1");function validateKeyword(e){if(validateLatin1(e),e.length===0||e.length>79)throw new Error("keyword length must be between 1 and 79")}const latin1Regex=/^[\u0000-\u00FF]*$/;function validateLatin1(e){if(!latin1Regex.test(e))throw new Error("invalid latin1 text")}function decodetEXt(e,t,r){const n=readKeyword(t);e[n]=readLatin1(t,r-n.length-1)}function readKeyword(e){for(e.mark();e.readByte()!==NULL;);const t=e.offset;e.reset();const r=latin1Decoder.decode(e.readBytes(t-e.offset-1));return e.skip(1),validateKeyword(r),r}function readLatin1(e,t){return latin1Decoder.decode(e.readBytes(t))}const ColorType={UNKNOWN:-1,GREYSCALE:0,TRUECOLOUR:2,INDEXED_COLOUR:3,GREYSCALE_ALPHA:4,TRUECOLOUR_ALPHA:6},CompressionMethod={UNKNOWN:-1,DEFLATE:0},FilterMethod={UNKNOWN:-1,ADAPTIVE:0},InterlaceMethod={UNKNOWN:-1,NO_INTERLACE:0,ADAM7:1},DisposeOpType={NONE:0,BACKGROUND:1,PREVIOUS:2},BlendOpType={SOURCE:0,OVER:1};class PngDecoder extends IOBuffer{_checkCrc;_inflator;_png;_apng;_end;_hasPalette;_palette;_hasTransparency;_transparency;_compressionMethod;_filterMethod;_interlaceMethod;_colorType;_isAnimated;_numberOfFrames;_numberOfPlays;_frames;_writingDataChunks;constructor(t,r={}){super(t);const{checkCrc:n=!1}=r;this._checkCrc=n,this._inflator=new Inflate_1,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._apng={width:-1,height:-1,channels:-1,depth:1,numberOfFrames:1,numberOfPlays:0,text:{},frames:[]},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=CompressionMethod.UNKNOWN,this._filterMethod=FilterMethod.UNKNOWN,this._interlaceMethod=InterlaceMethod.UNKNOWN,this._colorType=ColorType.UNKNOWN,this._isAnimated=!1,this._numberOfFrames=1,this._numberOfPlays=0,this._frames=[],this._writingDataChunks=!1,this.setBigEndian()}decode(){for(checkSignature(this);!this._end;){const t=this.readUint32(),r=this.readChars(4);this.decodeChunk(t,r)}return this.decodeImage(),this._png}decodeApng(){for(checkSignature(this);!this._end;){const t=this.readUint32(),r=this.readChars(4);this.decodeApngChunk(t,r)}return this.decodeApngImage(),this._apng}decodeChunk(t,r){const n=this.offset;switch(r){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case textChunkName:decodetEXt(this._png.text,this,t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t);break}if(this.offset-n!==t)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?checkCrc(this,t+4,r):this.skip(4)}decodeApngChunk(t,r){const n=this.offset;switch(r!=="fdAT"&&r!=="IDAT"&&this._writingDataChunks&&this.pushDataToFrame(),r){case"acTL":this.decodeACTL();break;case"fcTL":this.decodeFCTL();break;case"fdAT":this.decodeFDAT(t);break;default:this.decodeChunk(t,r),this.offset=n+t;break}if(this.offset-n!==t)throw new Error(`Length mismatch while decoding chunk ${r}`);this._checkCrc?checkCrc(this,t+4,r):this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=checkBitDepth(this.readUint8());const r=this.readUint8();this._colorType=r;let n;switch(r){case ColorType.GREYSCALE:n=1;break;case ColorType.TRUECOLOUR:n=3;break;case ColorType.INDEXED_COLOUR:n=1;break;case ColorType.GREYSCALE_ALPHA:n=2;break;case ColorType.TRUECOLOUR_ALPHA:n=4;break;case ColorType.UNKNOWN:default:throw new Error(`Unknown color type: ${r}`)}if(this._png.channels=n,this._compressionMethod=this.readUint8(),this._compressionMethod!==CompressionMethod.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodeACTL(){this._numberOfFrames=this.readUint32(),this._numberOfPlays=this.readUint32(),this._isAnimated=!0}decodeFCTL(){const t={sequenceNumber:this.readUint32(),width:this.readUint32(),height:this.readUint32(),xOffset:this.readUint32(),yOffset:this.readUint32(),delayNumber:this.readUint16(),delayDenominator:this.readUint16(),disposeOp:this.readUint8(),blendOp:this.readUint8(),data:new Uint8Array(0)};this._frames.push(t)}decodePLTE(t){if(t%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);const r=t/3;this._hasPalette=!0;const n=[];this._palette=n;for(let Ee=0;Ee<r;Ee++)n.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._writingDataChunks=!0;const r=t,n=this.offset+this.byteOffset;if(this._inflator.push(new Uint8Array(this.buffer,n,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodeFDAT(t){this._writingDataChunks=!0;let r=t,n=this.offset+this.byteOffset;if(n+=4,r-=4,this._inflator.push(new Uint8Array(this.buffer,n,r)),this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);this.skip(t)}decodetRNS(t){switch(this._colorType){case ColorType.GREYSCALE:case ColorType.TRUECOLOUR:{if(t%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let r=0;r<t/2;r++)this._transparency[r]=this.readUint16();break}case ColorType.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let r=0;for(;r<t;r++){const n=this.readByte();this._palette[r].push(n)}for(;r<this._palette.length;r++)this._palette[r].push(255);break}case ColorType.UNKNOWN:case ColorType.GREYSCALE_ALPHA:case ColorType.TRUECOLOUR_ALPHA:default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){const r=readKeyword(this),n=this.readUint8();if(n!==CompressionMethod.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${n}`);const Ee=this.readBytes(t-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:inflate_1(Ee)}}decodepHYs(){const t=this.readUint32(),r=this.readUint32(),n=this.readByte();this._png.resolution={x:t,y:r,unit:n}}decodeApngImage(){this._apng.width=this._png.width,this._apng.height=this._png.height,this._apng.channels=this._png.channels,this._apng.depth=this._png.depth,this._apng.numberOfFrames=this._numberOfFrames,this._apng.numberOfPlays=this._numberOfPlays,this._apng.text=this._png.text,this._apng.resolution=this._png.resolution;for(let t=0;t<this._numberOfFrames;t++){const r={sequenceNumber:this._frames[t].sequenceNumber,delayNumber:this._frames[t].delayNumber,delayDenominator:this._frames[t].delayDenominator,data:this._apng.depth===8?new Uint8Array(this._apng.width*this._apng.height*this._apng.channels):new Uint16Array(this._apng.width*this._apng.height*this._apng.channels)},n=this._frames.at(t);if(n){if(n.data=decodeInterlaceNull({data:n.data,width:n.width,height:n.height,channels:this._apng.channels,depth:this._apng.depth}),this._hasPalette&&(this._apng.palette=this._palette),this._hasTransparency&&(this._apng.transparency=this._transparency),t===0||n.xOffset===0&&n.yOffset===0&&n.width===this._png.width&&n.height===this._png.height)r.data=n.data;else{const Ee=this._apng.frames.at(t-1);this.disposeFrame(n,Ee,r),this.addFrameDataToCanvas(r,n)}this._apng.frames.push(r)}}return this._apng}disposeFrame(t,r,n){switch(t.disposeOp){case DisposeOpType.NONE:break;case DisposeOpType.BACKGROUND:for(let Ee=0;Ee<this._png.height;Ee++)for(let Ce=0;Ce<this._png.width;Ce++){const De=(Ee*t.width+Ce)*this._png.channels;for(let Me=0;Me<this._png.channels;Me++)n.data[De+Me]=0}break;case DisposeOpType.PREVIOUS:n.data.set(r.data);break;default:throw new Error("Unknown disposeOp")}}addFrameDataToCanvas(t,r){const n=1<<this._png.depth,Ee=(Ce,De)=>{const Me=((Ce+r.yOffset)*this._png.width+r.xOffset+De)*this._png.channels,ze=(Ce*r.width+De)*this._png.channels;return{index:Me,frameIndex:ze}};switch(r.blendOp){case BlendOpType.SOURCE:for(let Ce=0;Ce<r.height;Ce++)for(let De=0;De<r.width;De++){const{index:Me,frameIndex:ze}=Ee(Ce,De);for(let Oe=0;Oe<this._png.channels;Oe++)t.data[Me+Oe]=r.data[ze+Oe]}break;case BlendOpType.OVER:for(let Ce=0;Ce<r.height;Ce++)for(let De=0;De<r.width;De++){const{index:Me,frameIndex:ze}=Ee(Ce,De);for(let Oe=0;Oe<this._png.channels;Oe++){const Be=r.data[ze+this._png.channels-1]/n,He=Oe%(this._png.channels-1)===0?1:r.data[ze+Oe],Ve=Math.floor(Be*He+(1-Be)*t.data[Me+Oe]);t.data[Me+Oe]+=Ve}}break;default:throw new Error("Unknown blendOp")}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const t=this._isAnimated?(this._frames?.at(0)).data:this._inflator.result;if(this._filterMethod!==FilterMethod.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod===InterlaceMethod.NO_INTERLACE)this._png.data=decodeInterlaceNull({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else if(this._interlaceMethod===InterlaceMethod.ADAM7)this._png.data=decodeInterlaceAdam7({data:t,width:this._png.width,height:this._png.height,channels:this._png.channels,depth:this._png.depth});else throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency)}pushDataToFrame(){const t=this._inflator.result,r=this._frames.at(-1);r?r.data=t:this._frames.push({sequenceNumber:0,width:this._png.width,height:this._png.height,xOffset:0,yOffset:0,delayNumber:0,delayDenominator:0,disposeOp:DisposeOpType.NONE,blendOp:BlendOpType.SOURCE,data:t}),this._inflator=new Inflate_1,this._writingDataChunks=!1}}function checkBitDepth(e){if(e!==1&&e!==2&&e!==4&&e!==8&&e!==16)throw new Error(`invalid bit depth: ${e}`);return e}var ResolutionUnitSpecifier;(function(e){e[e.UNKNOWN=0]="UNKNOWN",e[e.METRE=1]="METRE"})(ResolutionUnitSpecifier||(ResolutionUnitSpecifier={}));function decodePng(e,t){return new PngDecoder(e,t).decode()}var i=(function(){return typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:this})();function a(){i.console&&typeof i.console.log=="function"&&i.console.log.apply(i.console,arguments)}var o={log:a,warn:function(e){i.console&&(typeof i.console.warn=="function"?i.console.warn.apply(i.console,arguments):a.call(null,arguments))},error:function(e){i.console&&(typeof i.console.error=="function"?i.console.error.apply(i.console,arguments):a(e))}};function s(e,t,r){var n=new XMLHttpRequest;n.open("GET",e),n.responseType="blob",n.onload=function(){l(n.response,t,r)},n.onerror=function(){o.error("could not download file")},n.send()}function u(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch{}return t.status>=200&&t.status<=299}function c(e){try{e.dispatchEvent(new MouseEvent("click"))}catch{var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var l=i.saveAs||((typeof window>"u"?"undefined":_typeof(window))!=="object"||window!==i?function(){}:typeof HTMLAnchorElement<"u"&&"download"in HTMLAnchorElement.prototype?function(e,t,r){var n=i.URL||i.webkitURL,Ee=document.createElement("a");t=t||e.name||"download",Ee.download=t,Ee.rel="noopener",typeof e=="string"?(Ee.href=e,Ee.origin!==location.origin?u(Ee.href)?s(e,t,r):c(Ee,Ee.target="_blank"):c(Ee)):(Ee.href=n.createObjectURL(e),setTimeout(function(){n.revokeObjectURL(Ee.href)},4e4),setTimeout(function(){c(Ee)},0))}:"msSaveOrOpenBlob"in navigator?function(e,t,r){if(t=t||e.name||"download",typeof e=="string")if(u(e))s(e,t,r);else{var n=document.createElement("a");n.href=e,n.target="_blank",setTimeout(function(){c(n)})}else navigator.msSaveOrOpenBlob((function(Ee,Ce){return Ce===void 0?Ce={autoBom:!1}:_typeof(Ce)!=="object"&&(o.warn("Deprecated: Expected third argument to be a object"),Ce={autoBom:!Ce}),Ce.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(Ee.type)?new Blob(["\uFEFF",Ee],{type:Ee.type}):Ee})(e,r),t)}:function(e,t,r,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),typeof e=="string")return s(e,t,r);var Ee=e.type==="application/octet-stream",Ce=/constructor/i.test(i.HTMLElement)||i.safari,De=/CriOS\/[\d]+/.test(navigator.userAgent);if((De||Ee&&Ce)&&(typeof FileReader>"u"?"undefined":_typeof(FileReader))==="object"){var Me=new FileReader;Me.onloadend=function(){var Be=Me.result;Be=De?Be:Be.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=Be:location=Be,n=null},Me.readAsDataURL(e)}else{var ze=i.URL||i.webkitURL,Oe=ze.createObjectURL(e);n?n.location=Oe:location.href=Oe,n=null,setTimeout(function(){ze.revokeObjectURL(Oe)},4e4)}});/**
 * A class to parse color values
 * @author Stoyan Stefanov <sstoo@gmail.com>
 * {@link   http://www.phpied.com/rgb-color-parser-in-javascript/}
 * @license Use it if you like it
 */function h(e){var t;e=e||"",this.ok=!1,e.charAt(0)=="#"&&(e=e.substr(1,6)),e={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"00ffff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000000",blanchedalmond:"ffebcd",blue:"0000ff",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"00ffff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dodgerblue:"1e90ff",feldspar:"d19275",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"ff00ff",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgrey:"d3d3d3",lightgreen:"90ee90",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslateblue:"8470ff",lightslategray:"778899",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"00ff00",limegreen:"32cd32",linen:"faf0e6",magenta:"ff00ff",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370d8",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"d87093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",red:"ff0000",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",violetred:"d02090",wheat:"f5deb3",white:"ffffff",whitesmoke:"f5f5f5",yellow:"ffff00",yellowgreen:"9acd32"}[e=(e=e.replace(/ /g,"")).toLowerCase()]||e;for(var r=[{re:/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,example:["rgb(123, 234, 45)","rgb(255,234,245)"],process:function(Me){return[parseInt(Me[1]),parseInt(Me[2]),parseInt(Me[3])]}},{re:/^(\w{2})(\w{2})(\w{2})$/,example:["#00ff00","336699"],process:function(Me){return[parseInt(Me[1],16),parseInt(Me[2],16),parseInt(Me[3],16)]}},{re:/^(\w{1})(\w{1})(\w{1})$/,example:["#fb0","f0f"],process:function(Me){return[parseInt(Me[1]+Me[1],16),parseInt(Me[2]+Me[2],16),parseInt(Me[3]+Me[3],16)]}}],n=0;n<r.length;n++){var Ee=r[n].re,Ce=r[n].process,De=Ee.exec(e);De&&(t=Ce(De),this.r=t[0],this.g=t[1],this.b=t[2],this.ok=!0)}this.r=this.r<0||isNaN(this.r)?0:this.r>255?255:this.r,this.g=this.g<0||isNaN(this.g)?0:this.g>255?255:this.g,this.b=this.b<0||isNaN(this.b)?0:this.b>255?255:this.b,this.toRGB=function(){return"rgb("+this.r+", "+this.g+", "+this.b+")"},this.toHex=function(){var Me=this.r.toString(16),ze=this.g.toString(16),Oe=this.b.toString(16);return Me.length==1&&(Me="0"+Me),ze.length==1&&(ze="0"+ze),Oe.length==1&&(Oe="0"+Oe),"#"+Me+ze+Oe}}var f=i.atob.bind(i),d=i.btoa.bind(i);/**
 * @license
 * Joseph Myers does not specify a particular license for his work.
 *
 * Author: Joseph Myers
 * Accessed from: http://www.myersdaily.org/joseph/javascript/md5.js
 *
 * Modified by: Owen Leong
 */function p(e,t){var r=e[0],n=e[1],Ee=e[2],Ce=e[3];r=m(r,n,Ee,Ce,t[0],7,-680876936),Ce=m(Ce,r,n,Ee,t[1],12,-389564586),Ee=m(Ee,Ce,r,n,t[2],17,606105819),n=m(n,Ee,Ce,r,t[3],22,-1044525330),r=m(r,n,Ee,Ce,t[4],7,-176418897),Ce=m(Ce,r,n,Ee,t[5],12,1200080426),Ee=m(Ee,Ce,r,n,t[6],17,-1473231341),n=m(n,Ee,Ce,r,t[7],22,-45705983),r=m(r,n,Ee,Ce,t[8],7,1770035416),Ce=m(Ce,r,n,Ee,t[9],12,-1958414417),Ee=m(Ee,Ce,r,n,t[10],17,-42063),n=m(n,Ee,Ce,r,t[11],22,-1990404162),r=m(r,n,Ee,Ce,t[12],7,1804603682),Ce=m(Ce,r,n,Ee,t[13],12,-40341101),Ee=m(Ee,Ce,r,n,t[14],17,-1502002290),r=v(r,n=m(n,Ee,Ce,r,t[15],22,1236535329),Ee,Ce,t[1],5,-165796510),Ce=v(Ce,r,n,Ee,t[6],9,-1069501632),Ee=v(Ee,Ce,r,n,t[11],14,643717713),n=v(n,Ee,Ce,r,t[0],20,-373897302),r=v(r,n,Ee,Ce,t[5],5,-701558691),Ce=v(Ce,r,n,Ee,t[10],9,38016083),Ee=v(Ee,Ce,r,n,t[15],14,-660478335),n=v(n,Ee,Ce,r,t[4],20,-405537848),r=v(r,n,Ee,Ce,t[9],5,568446438),Ce=v(Ce,r,n,Ee,t[14],9,-1019803690),Ee=v(Ee,Ce,r,n,t[3],14,-187363961),n=v(n,Ee,Ce,r,t[8],20,1163531501),r=v(r,n,Ee,Ce,t[13],5,-1444681467),Ce=v(Ce,r,n,Ee,t[2],9,-51403784),Ee=v(Ee,Ce,r,n,t[7],14,1735328473),r=b(r,n=v(n,Ee,Ce,r,t[12],20,-1926607734),Ee,Ce,t[5],4,-378558),Ce=b(Ce,r,n,Ee,t[8],11,-2022574463),Ee=b(Ee,Ce,r,n,t[11],16,1839030562),n=b(n,Ee,Ce,r,t[14],23,-35309556),r=b(r,n,Ee,Ce,t[1],4,-1530992060),Ce=b(Ce,r,n,Ee,t[4],11,1272893353),Ee=b(Ee,Ce,r,n,t[7],16,-155497632),n=b(n,Ee,Ce,r,t[10],23,-1094730640),r=b(r,n,Ee,Ce,t[13],4,681279174),Ce=b(Ce,r,n,Ee,t[0],11,-358537222),Ee=b(Ee,Ce,r,n,t[3],16,-722521979),n=b(n,Ee,Ce,r,t[6],23,76029189),r=b(r,n,Ee,Ce,t[9],4,-640364487),Ce=b(Ce,r,n,Ee,t[12],11,-421815835),Ee=b(Ee,Ce,r,n,t[15],16,530742520),r=y(r,n=b(n,Ee,Ce,r,t[2],23,-995338651),Ee,Ce,t[0],6,-198630844),Ce=y(Ce,r,n,Ee,t[7],10,1126891415),Ee=y(Ee,Ce,r,n,t[14],15,-1416354905),n=y(n,Ee,Ce,r,t[5],21,-57434055),r=y(r,n,Ee,Ce,t[12],6,1700485571),Ce=y(Ce,r,n,Ee,t[3],10,-1894986606),Ee=y(Ee,Ce,r,n,t[10],15,-1051523),n=y(n,Ee,Ce,r,t[1],21,-2054922799),r=y(r,n,Ee,Ce,t[8],6,1873313359),Ce=y(Ce,r,n,Ee,t[15],10,-30611744),Ee=y(Ee,Ce,r,n,t[6],15,-1560198380),n=y(n,Ee,Ce,r,t[13],21,1309151649),r=y(r,n,Ee,Ce,t[4],6,-145523070),Ce=y(Ce,r,n,Ee,t[11],10,-1120210379),Ee=y(Ee,Ce,r,n,t[2],15,718787259),n=y(n,Ee,Ce,r,t[9],21,-343485551),e[0]=P(r,e[0]),e[1]=P(n,e[1]),e[2]=P(Ee,e[2]),e[3]=P(Ce,e[3])}function g(e,t,r,n,Ee,Ce){return t=P(P(t,e),P(n,Ce)),P(t<<Ee|t>>>32-Ee,r)}function m(e,t,r,n,Ee,Ce,De){return g(t&r|~t&n,e,t,Ee,Ce,De)}function v(e,t,r,n,Ee,Ce,De){return g(t&n|r&~n,e,t,Ee,Ce,De)}function b(e,t,r,n,Ee,Ce,De){return g(t^r^n,e,t,Ee,Ce,De)}function y(e,t,r,n,Ee,Ce,De){return g(r^(t|~n),e,t,Ee,Ce,De)}function w(e){var t,r=e.length,n=[1732584193,-271733879,-1732584194,271733878];for(t=64;t<=e.length;t+=64)p(n,N(e.substring(t-64,t)));e=e.substring(t-64);var Ee=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(t=0;t<e.length;t++)Ee[t>>2]|=e.charCodeAt(t)<<(t%4<<3);if(Ee[t>>2]|=128<<(t%4<<3),t>55)for(p(n,Ee),t=0;t<16;t++)Ee[t]=0;return Ee[14]=8*r,p(n,Ee),n}function N(e){var t,r=[];for(t=0;t<64;t+=4)r[t>>2]=e.charCodeAt(t)+(e.charCodeAt(t+1)<<8)+(e.charCodeAt(t+2)<<16)+(e.charCodeAt(t+3)<<24);return r}var L="0123456789abcdef".split("");function x(e){for(var t="",r=0;r<4;r++)t+=L[e>>8*r+4&15]+L[e>>8*r&15];return t}function A(e){return String.fromCharCode(255&e,(65280&e)>>8,(16711680&e)>>16,(4278190080&e)>>24)}function S(e){return w(e).map(A).join("")}var _=(function(e){for(var t=0;t<e.length;t++)e[t]=x(e[t]);return e.join("")})(w("hello"))!="5d41402abc4b2a76b9719d911017c592";function P(e,t){if(_){var r=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(r>>16)<<16|65535&r}return e+t&4294967295}/**
 * @license
 * FPDF is released under a permissive license: there is no usage restriction.
 * You may embed it freely in your application (commercial or not), with or
 * without modifications.
 *
 * Reference: http://www.fpdf.org/en/script/script37.php
 */function k(e,t){var r,n,Ee,Ce;if(e!==r){for(var De=(Ee=e,Ce=1+(256/e.length|0),new Array(Ce+1).join(Ee)),Me=[],ze=0;ze<256;ze++)Me[ze]=ze;var Oe=0;for(ze=0;ze<256;ze++){var Be=Me[ze];Oe=(Oe+Be+De.charCodeAt(ze))%256,Me[ze]=Me[Oe],Me[Oe]=Be}r=e,n=Me}else Me=n;var He=t.length,Ve=0,Xe=0,We="";for(ze=0;ze<He;ze++)Xe=(Xe+(Be=Me[Ve=(Ve+1)%256]))%256,Me[Ve]=Me[Xe],Me[Xe]=Be,De=Me[(Me[Ve]+Me[Xe])%256],We+=String.fromCharCode(t.charCodeAt(ze)^De);return We}/**
 * @license
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 * Author: Owen Leong (@owenl131)
 * Date: 15 Oct 2020
 * References:
 * https://www.cs.cmu.edu/~dst/Adobe/Gallery/anon21jul01-pdf-encryption.txt
 * https://github.com/foliojs/pdfkit/blob/master/lib/security.js
 * http://www.fpdf.org/en/script/script37.php
 */var F={print:4,modify:8,copy:16,"annot-forms":32};function I(e,t,r,n){this.v=1,this.r=2;var Ee=192;e.forEach(function(Me){if(F.perm!==void 0)throw new Error("Invalid permission: "+Me);Ee+=F[Me]}),this.padding="(N^NuAd\0NV\b..\0h>/\fdSiz";var Ce=(t+this.padding).substr(0,32),De=(r+this.padding).substr(0,32);this.O=this.processOwnerPassword(Ce,De),this.P=-(1+(255^Ee)),this.encryptionKey=S(Ce+this.O+this.lsbFirstWord(this.P)+this.hexToBytes(n)).substr(0,5),this.U=k(this.encryptionKey,this.padding)}function j(e){if(/[^\u0000-\u00ff]/.test(e))throw new Error("Invalid PDF Name Object: "+e+", Only accept ASCII characters.");for(var t="",r=e.length,n=0;n<r;n++){var Ee=e.charCodeAt(n);t+=Ee<33||Ee===35||Ee===37||Ee===40||Ee===41||Ee===47||Ee===60||Ee===62||Ee===91||Ee===93||Ee===123||Ee===125||Ee>126?"#"+("0"+Ee.toString(16)).slice(-2):e[n]}return t}function C(e){if(_typeof(e)!=="object")throw new Error("Invalid Context passed to initialize PubSub (jsPDF-module)");var t={};this.subscribe=function(r,n,Ee){if(Ee=Ee||!1,typeof r!="string"||typeof n!="function"||typeof Ee!="boolean")throw new Error("Invalid arguments passed to PubSub.subscribe (jsPDF-module)");t.hasOwnProperty(r)||(t[r]={});var Ce=Math.random().toString(35);return t[r][Ce]=[n,!!Ee],Ce},this.unsubscribe=function(r){for(var n in t)if(t[n][r])return delete t[n][r],Object.keys(t[n]).length===0&&delete t[n],!0;return!1},this.publish=function(r){if(t.hasOwnProperty(r)){var n=Array.prototype.slice.call(arguments,1),Ee=[];for(var Ce in t[r]){var De=t[r][Ce];try{De[0].apply(e,n)}catch(Me){i.console&&o.error("jsPDF PubSub Error",Me.message,Me)}De[1]&&Ee.push(Ce)}Ee.length&&Ee.forEach(this.unsubscribe)}},this.getTopics=function(){return t}}function O(e){if(!(this instanceof O))return new O(e);var t="opacity,stroke-opacity".split(",");for(var r in e)e.hasOwnProperty(r)&&t.indexOf(r)>=0&&(this[r]=e[r]);this.id="",this.objectNumber=-1}function B(e,t){this.gState=e,this.matrix=t,this.id="",this.objectNumber=-1}function M(e,t,r,n,Ee){if(!(this instanceof M))return new M(e,t,r,n,Ee);this.type=e==="axial"?2:3,this.coords=t,this.colors=r,B.call(this,n,Ee)}function q(e,t,r,n,Ee){if(!(this instanceof q))return new q(e,t,r,n,Ee);this.boundingBox=e,this.xStep=t,this.yStep=r,this.stream="",this.cloneIndex=0,B.call(this,n,Ee)}function E(e){var t,r=typeof arguments[0]=="string"?arguments[0]:"p",n=arguments[1],Ee=arguments[2],Ce=arguments[3],De=[],Me=1,ze=16,Oe="S",Be=null;_typeof(e=e||{})==="object"&&(r=e.orientation,n=e.unit||n,Ee=e.format||Ee,Ce=e.compress||e.compressPdf||Ce,(Be=e.encryption||null)!==null&&(Be.userPassword=Be.userPassword||"",Be.ownerPassword=Be.ownerPassword||"",Be.userPermissions=Be.userPermissions||[]),Me=typeof e.userUnit=="number"?Math.abs(e.userUnit):1,e.precision!==void 0&&(t=e.precision),e.floatPrecision!==void 0&&(ze=e.floatPrecision),Oe=e.defaultPathOperation||"S"),De=e.filters||(Ce===!0?["FlateEncode"]:De),n=n||"mm",r=(""+(r||"P")).toLowerCase();var He=e.putOnlyUsedFonts||!1,Ve={},Xe={internal:{},__private__:{}};Xe.__private__.PubSub=C;var We="1.3",Ge=Xe.__private__.getPdfVersion=function(){return We};Xe.__private__.setPdfVersion=function(cr){We=cr};var $e={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};Xe.__private__.getPageFormats=function(){return $e};var Ke=Xe.__private__.getPageFormat=function(cr){return $e[cr]};Ee=Ee||"a4";var rr="compat",tr="advanced",sr=rr;function ar(){this.saveGraphicsState(),Cr(new sn(Ka,0,0,-Ka,0,jo()*Ka).toString()+" cm"),this.setFontSize(this.getFontSize()/Ka),Oe="n",sr=tr}function hr(){this.restoreGraphicsState(),Oe="S",sr=rr}var pr=Xe.__private__.combineFontStyleAndFontWeight=function(cr,Lr){if(cr=="bold"&&Lr=="normal"||cr=="bold"&&Lr==400||cr=="normal"&&Lr=="italic"||cr=="bold"&&Lr=="italic")throw new Error("Invalid Combination of fontweight and fontstyle");return Lr&&(cr=Lr==400||Lr==="normal"?cr==="italic"?"italic":"normal":Lr!=700&&Lr!=="bold"||cr!=="normal"?(Lr==700?"bold":Lr)+""+cr:"bold"),cr};Xe.advancedAPI=function(cr){var Lr=sr===rr;return Lr&&ar.call(this),typeof cr!="function"||(cr(this),Lr&&hr.call(this)),this},Xe.compatAPI=function(cr){var Lr=sr===tr;return Lr&&hr.call(this),typeof cr!="function"||(cr(this),Lr&&ar.call(this)),this},Xe.isAdvancedAPI=function(){return sr===tr};var yr,fr=function(cr){if(sr!==tr)throw new Error(cr+" is only available in 'advanced' API mode. You need to call advancedAPI() first.")},Rr=Xe.roundToPrecision=Xe.__private__.roundToPrecision=function(cr,Lr){var Kr=t||Lr;if(isNaN(cr)||isNaN(Kr))throw new Error("Invalid argument passed to jsPDF.roundToPrecision");return cr.toFixed(Kr).replace(/0+$/,"")};yr=Xe.hpf=Xe.__private__.hpf=typeof ze=="number"?function(cr){if(isNaN(cr))throw new Error("Invalid argument passed to jsPDF.hpf");return Rr(cr,ze)}:ze==="smart"?function(cr){if(isNaN(cr))throw new Error("Invalid argument passed to jsPDF.hpf");return Rr(cr,cr>-1&&cr<1?16:5)}:function(cr){if(isNaN(cr))throw new Error("Invalid argument passed to jsPDF.hpf");return Rr(cr,16)};var mr=Xe.f2=Xe.__private__.f2=function(cr){if(isNaN(cr))throw new Error("Invalid argument passed to jsPDF.f2");return Rr(cr,2)},wr=Xe.__private__.f3=function(cr){if(isNaN(cr))throw new Error("Invalid argument passed to jsPDF.f3");return Rr(cr,3)},Fr=Xe.scale=Xe.__private__.scale=function(cr){if(isNaN(cr))throw new Error("Invalid argument passed to jsPDF.scale");return sr===rr?cr*Ka:sr===tr?cr:void 0},Mr=function(cr){return Fr((function(Lr){return sr===rr?jo()-Lr:sr===tr?Lr:void 0})(cr))};Xe.__private__.setPrecision=Xe.setPrecision=function(cr){typeof parseInt(cr,10)=="number"&&(t=parseInt(cr,10))};var Hr,Nr="00000000000000000000000000000000",Ar=Xe.__private__.getFileId=function(){return Nr},xr=Xe.__private__.setFileId=function(cr){return Nr=cr!==void 0&&/^[a-fA-F0-9]{32}$/.test(cr)?cr.toUpperCase():Nr.split("").map(function(){return"ABCDEF0123456789".charAt(Math.floor(16*Math.random()))}).join(""),Be!==null&&(Ki=new I(Be.userPermissions,Be.userPassword,Be.ownerPassword,Nr)),Nr};Xe.setFileId=function(cr){return xr(cr),this},Xe.getFileId=function(){return Ar()};var ir=Xe.__private__.convertDateToPDFDate=function(cr){var Lr=cr.getTimezoneOffset(),Kr=Lr<0?"+":"-",ra=Math.floor(Math.abs(Lr/60)),fa=Math.abs(Lr%60),Ia=[Kr,or(ra),"'",or(fa),"'"].join("");return["D:",cr.getFullYear(),or(cr.getMonth()+1),or(cr.getDate()),or(cr.getHours()),or(cr.getMinutes()),or(cr.getSeconds()),Ia].join("")},_r=Xe.__private__.convertPDFDateToDate=function(cr){var Lr=parseInt(cr.substr(2,4),10),Kr=parseInt(cr.substr(6,2),10)-1,ra=parseInt(cr.substr(8,2),10),fa=parseInt(cr.substr(10,2),10),Ia=parseInt(cr.substr(12,2),10),qa=parseInt(cr.substr(14,2),10);return new Date(Lr,Kr,ra,fa,Ia,qa,0)},ur=Xe.__private__.setCreationDate=function(cr){var Lr;if(cr===void 0&&(cr=new Date),cr instanceof Date)Lr=ir(cr);else{if(!/^D:(20[0-2][0-9]|203[0-7]|19[7-9][0-9])(0[0-9]|1[0-2])([0-2][0-9]|3[0-1])(0[0-9]|1[0-9]|2[0-3])(0[0-9]|[1-5][0-9])(0[0-9]|[1-5][0-9])(\+0[0-9]|\+1[0-4]|-0[0-9]|-1[0-1])'(0[0-9]|[1-5][0-9])'?$/.test(cr))throw new Error("Invalid argument passed to jsPDF.setCreationDate");Lr=cr}return Hr=Lr},Je=Xe.__private__.getCreationDate=function(cr){var Lr=Hr;return cr==="jsDate"&&(Lr=_r(Hr)),Lr};Xe.setCreationDate=function(cr){return ur(cr),this},Xe.getCreationDate=function(cr){return Je(cr)};var nr,or=Xe.__private__.padd2=function(cr){return("0"+parseInt(cr)).slice(-2)},lr=Xe.__private__.padd2Hex=function(cr){return("00"+(cr=cr.toString())).substr(cr.length)},St=0,dr=[],vr=[],br=0,kr=[],Pr=[],Er=!1,Zr=vr;Xe.__private__.setCustomOutputDestination=function(cr){Er=!0,Zr=cr};var ua=function(cr){Er||(Zr=cr)};Xe.__private__.resetCustomOutputDestination=function(){Er=!1,Zr=vr};var Cr=Xe.__private__.out=function(cr){return cr=cr.toString(),br+=cr.length+1,Zr.push(cr),Zr},Jr=Xe.__private__.write=function(cr){return Cr(arguments.length===1?cr.toString():Array.prototype.join.call(arguments," "))},Qr=Xe.__private__.getArrayBuffer=function(cr){for(var Lr=cr.length,Kr=new ArrayBuffer(Lr),ra=new Uint8Array(Kr);Lr--;)ra[Lr]=cr.charCodeAt(Lr);return Kr},oa=[["Helvetica","helvetica","normal","WinAnsiEncoding"],["Helvetica-Bold","helvetica","bold","WinAnsiEncoding"],["Helvetica-Oblique","helvetica","italic","WinAnsiEncoding"],["Helvetica-BoldOblique","helvetica","bolditalic","WinAnsiEncoding"],["Courier","courier","normal","WinAnsiEncoding"],["Courier-Bold","courier","bold","WinAnsiEncoding"],["Courier-Oblique","courier","italic","WinAnsiEncoding"],["Courier-BoldOblique","courier","bolditalic","WinAnsiEncoding"],["Times-Roman","times","normal","WinAnsiEncoding"],["Times-Bold","times","bold","WinAnsiEncoding"],["Times-Italic","times","italic","WinAnsiEncoding"],["Times-BoldItalic","times","bolditalic","WinAnsiEncoding"],["ZapfDingbats","zapfdingbats","normal",null],["Symbol","symbol","normal",null]];Xe.__private__.getStandardFonts=function(){return oa};var ta=e.fontSize||16;Xe.__private__.setFontSize=Xe.setFontSize=function(cr){return ta=sr===tr?cr/Ka:cr,this};var Na,Ca=Xe.__private__.getFontSize=Xe.getFontSize=function(){return sr===rr?ta:ta*Ka},za=e.R2L||!1;Xe.__private__.setR2L=Xe.setR2L=function(cr){return za=cr,this},Xe.__private__.getR2L=Xe.getR2L=function(){return za};var Xa,Ya=Xe.__private__.setZoomMode=function(cr){if(/^(?:\d+\.\d*|\d*\.\d+|\d+)%$/.test(cr))Na=cr;else if(isNaN(cr)){if([void 0,null,"fullwidth","fullheight","fullpage","original"].indexOf(cr)===-1)throw new Error('zoom must be Integer (e.g. 2), a percentage Value (e.g. 300%) or fullwidth, fullheight, fullpage, original. "'+cr+'" is not recognized.');Na=cr}else Na=parseInt(cr,10)};Xe.__private__.getZoomMode=function(){return Na};var nn,on=Xe.__private__.setPageMode=function(cr){if([void 0,null,"UseNone","UseOutlines","UseThumbs","FullScreen"].indexOf(cr)==-1)throw new Error('Page mode must be one of UseNone, UseOutlines, UseThumbs, or FullScreen. "'+cr+'" is not recognized.');Xa=cr};Xe.__private__.getPageMode=function(){return Xa};var yn=Xe.__private__.setLayoutMode=function(cr){if([void 0,null,"continuous","single","twoleft","tworight","two"].indexOf(cr)==-1)throw new Error('Layout mode must be one of continuous, single, twoleft, tworight. "'+cr+'" is not recognized.');nn=cr};Xe.__private__.getLayoutMode=function(){return nn},Xe.__private__.setDisplayMode=Xe.setDisplayMode=function(cr,Lr,Kr){return Ya(cr),yn(Lr),on(Kr),this};var fn={title:"",subject:"",author:"",keywords:"",creator:""};Xe.__private__.getDocumentProperty=function(cr){if(Object.keys(fn).indexOf(cr)===-1)throw new Error("Invalid argument passed to jsPDF.getDocumentProperty");return fn[cr]},Xe.__private__.getDocumentProperties=function(){return fn},Xe.__private__.setDocumentProperties=Xe.setProperties=Xe.setDocumentProperties=function(cr){for(var Lr in fn)fn.hasOwnProperty(Lr)&&cr[Lr]&&(fn[Lr]=cr[Lr]);return this},Xe.__private__.setDocumentProperty=function(cr,Lr){if(Object.keys(fn).indexOf(cr)===-1)throw new Error("Invalid arguments passed to jsPDF.setDocumentProperty");return fn[cr]=Lr};var Qa,Ka,en,Bn,vn,va={},aa={},ia=[],Oa={},ca={},pa={},xa={},$a=null,ka=0,La=[],Wa=new C(Xe),_n=e.hotfixes||[],hn={},Fn={},Tn=[],sn=function cr(Lr,Kr,ra,fa,Ia,qa){if(!(this instanceof cr))return new cr(Lr,Kr,ra,fa,Ia,qa);isNaN(Lr)&&(Lr=1),isNaN(Kr)&&(Kr=0),isNaN(ra)&&(ra=0),isNaN(fa)&&(fa=1),isNaN(Ia)&&(Ia=0),isNaN(qa)&&(qa=0),this._matrix=[Lr,Kr,ra,fa,Ia,qa]};Object.defineProperty(sn.prototype,"sx",{get:function(){return this._matrix[0]},set:function(cr){this._matrix[0]=cr}}),Object.defineProperty(sn.prototype,"shy",{get:function(){return this._matrix[1]},set:function(cr){this._matrix[1]=cr}}),Object.defineProperty(sn.prototype,"shx",{get:function(){return this._matrix[2]},set:function(cr){this._matrix[2]=cr}}),Object.defineProperty(sn.prototype,"sy",{get:function(){return this._matrix[3]},set:function(cr){this._matrix[3]=cr}}),Object.defineProperty(sn.prototype,"tx",{get:function(){return this._matrix[4]},set:function(cr){this._matrix[4]=cr}}),Object.defineProperty(sn.prototype,"ty",{get:function(){return this._matrix[5]},set:function(cr){this._matrix[5]=cr}}),Object.defineProperty(sn.prototype,"a",{get:function(){return this._matrix[0]},set:function(cr){this._matrix[0]=cr}}),Object.defineProperty(sn.prototype,"b",{get:function(){return this._matrix[1]},set:function(cr){this._matrix[1]=cr}}),Object.defineProperty(sn.prototype,"c",{get:function(){return this._matrix[2]},set:function(cr){this._matrix[2]=cr}}),Object.defineProperty(sn.prototype,"d",{get:function(){return this._matrix[3]},set:function(cr){this._matrix[3]=cr}}),Object.defineProperty(sn.prototype,"e",{get:function(){return this._matrix[4]},set:function(cr){this._matrix[4]=cr}}),Object.defineProperty(sn.prototype,"f",{get:function(){return this._matrix[5]},set:function(cr){this._matrix[5]=cr}}),Object.defineProperty(sn.prototype,"rotation",{get:function(){return Math.atan2(this.shx,this.sx)}}),Object.defineProperty(sn.prototype,"scaleX",{get:function(){return this.decompose().scale.sx}}),Object.defineProperty(sn.prototype,"scaleY",{get:function(){return this.decompose().scale.sy}}),Object.defineProperty(sn.prototype,"isIdentity",{get:function(){return this.sx===1&&this.shy===0&&this.shx===0&&this.sy===1&&this.tx===0&&this.ty===0}}),sn.prototype.join=function(cr){return[this.sx,this.shy,this.shx,this.sy,this.tx,this.ty].map(yr).join(cr)},sn.prototype.multiply=function(cr){var Lr=cr.sx*this.sx+cr.shy*this.shx,Kr=cr.sx*this.shy+cr.shy*this.sy,ra=cr.shx*this.sx+cr.sy*this.shx,fa=cr.shx*this.shy+cr.sy*this.sy,Ia=cr.tx*this.sx+cr.ty*this.shx+this.tx,qa=cr.tx*this.shy+cr.ty*this.sy+this.ty;return new sn(Lr,Kr,ra,fa,Ia,qa)},sn.prototype.decompose=function(){var cr=this.sx,Lr=this.shy,Kr=this.shx,ra=this.sy,fa=this.tx,Ia=this.ty,qa=Math.sqrt(cr*cr+Lr*Lr),gn=(cr/=qa)*Kr+(Lr/=qa)*ra;Kr-=cr*gn,ra-=Lr*gn;var wn=Math.sqrt(Kr*Kr+ra*ra);return gn/=wn,cr*(ra/=wn)<Lr*(Kr/=wn)&&(cr=-cr,Lr=-Lr,gn=-gn,qa=-qa),{scale:new sn(qa,0,0,wn,0,0),translate:new sn(1,0,0,1,fa,Ia),rotate:new sn(cr,Lr,-Lr,cr,0,0),skew:new sn(1,0,gn,1,0,0)}},sn.prototype.toString=function(cr){return this.join(" ")},sn.prototype.inversed=function(){var cr=this.sx,Lr=this.shy,Kr=this.shx,ra=this.sy,fa=this.tx,Ia=this.ty,qa=1/(cr*ra-Lr*Kr),gn=ra*qa,wn=-Lr*qa,Nn=-Kr*qa,Mn=cr*qa;return new sn(gn,wn,Nn,Mn,-gn*fa-Nn*Ia,-wn*fa-Mn*Ia)},sn.prototype.applyToPoint=function(cr){var Lr=cr.x*this.sx+cr.y*this.shx+this.tx,Kr=cr.x*this.shy+cr.y*this.sy+this.ty;return new js(Lr,Kr)},sn.prototype.applyToRectangle=function(cr){var Lr=this.applyToPoint(cr),Kr=this.applyToPoint(new js(cr.x+cr.w,cr.y+cr.h));return new Mo(Lr.x,Lr.y,Kr.x-Lr.x,Kr.y-Lr.y)},sn.prototype.clone=function(){var cr=this.sx,Lr=this.shy,Kr=this.shx,ra=this.sy,fa=this.tx,Ia=this.ty;return new sn(cr,Lr,Kr,ra,fa,Ia)},Xe.Matrix=sn;var Gi=Xe.matrixMult=function(cr,Lr){return Lr.multiply(cr)},Yi=new sn(1,0,0,1,0,0);Xe.unitMatrix=Xe.identityMatrix=Yi;var Si=function(cr,Lr){if(!ca[cr]){var Kr=(Lr instanceof M?"Sh":"P")+(Object.keys(Oa).length+1).toString(10);Lr.id=Kr,ca[cr]=Kr,Oa[Kr]=Lr,Wa.publish("addPattern",Lr)}};Xe.ShadingPattern=M,Xe.TilingPattern=q,Xe.addShadingPattern=function(cr,Lr){return fr("addShadingPattern()"),Si(cr,Lr),this},Xe.beginTilingPattern=function(cr){fr("beginTilingPattern()"),Cl(cr.boundingBox[0],cr.boundingBox[1],cr.boundingBox[2]-cr.boundingBox[0],cr.boundingBox[3]-cr.boundingBox[1],cr.matrix)},Xe.endTilingPattern=function(cr,Lr){fr("endTilingPattern()"),Lr.stream=Pr[nr].join(`
`),Si(cr,Lr),Wa.publish("endTilingPattern",Lr),Tn.pop().restore()};var bi,Ln=Xe.__private__.newObject=function(){var cr=$n();return Or(cr,!0),cr},$n=Xe.__private__.newObjectDeferred=function(){return St++,dr[St]=function(){return br},St},Or=function(cr,Lr){return Lr=typeof Lr=="boolean"&&Lr,dr[cr]=br,Lr&&Cr(cr+" 0 obj"),cr},Yr=Xe.__private__.newAdditionalObject=function(){var cr={objId:$n(),content:""};return kr.push(cr),cr},zr=$n(),Xr=$n(),Wr=Xe.__private__.decodeColorString=function(cr){var Lr=cr.split(" ");if(Lr.length!==2||Lr[1]!=="g"&&Lr[1]!=="G")Lr.length!==5||Lr[4]!=="k"&&Lr[4]!=="K"||(Lr=[(1-Lr[0])*(1-Lr[3]),(1-Lr[1])*(1-Lr[3]),(1-Lr[2])*(1-Lr[3]),"r"]);else{var Kr=parseFloat(Lr[0]);Lr=[Kr,Kr,Kr,"r"]}for(var ra="#",fa=0;fa<3;fa++)ra+=("0"+Math.floor(255*parseFloat(Lr[fa])).toString(16)).slice(-2);return ra},$r=Xe.__private__.encodeColorString=function(cr){var Lr;typeof cr=="string"&&(cr={ch1:cr});var Kr=cr.ch1,ra=cr.ch2,fa=cr.ch3,Ia=cr.ch4,qa=cr.pdfColorType==="draw"?["G","RG","K"]:["g","rg","k"];if(typeof Kr=="string"&&Kr.charAt(0)!=="#"){var gn=new h(Kr);if(gn.ok)Kr=gn.toHex();else if(!/^\d*\.?\d*$/.test(Kr))throw new Error('Invalid color "'+Kr+'" passed to jsPDF.encodeColorString.')}if(typeof Kr=="string"&&/^#[0-9A-Fa-f]{3}$/.test(Kr)&&(Kr="#"+Kr[1]+Kr[1]+Kr[2]+Kr[2]+Kr[3]+Kr[3]),typeof Kr=="string"&&/^#[0-9A-Fa-f]{6}$/.test(Kr)){var wn=parseInt(Kr.substr(1),16);Kr=wn>>16&255,ra=wn>>8&255,fa=255&wn}if(ra===void 0||Ia===void 0&&Kr===ra&&ra===fa)Lr=typeof Kr=="string"?Kr+" "+qa[0]:cr.precision===2?mr(Kr/255)+" "+qa[0]:wr(Kr/255)+" "+qa[0];else if(Ia===void 0||_typeof(Ia)==="object"){if(Ia&&!isNaN(Ia.a)&&Ia.a===0)return["1.","1.","1.",qa[1]].join(" ");Lr=typeof Kr=="string"?[Kr,ra,fa,qa[1]].join(" "):cr.precision===2?[mr(Kr/255),mr(ra/255),mr(fa/255),qa[1]].join(" "):[wr(Kr/255),wr(ra/255),wr(fa/255),qa[1]].join(" ")}else Lr=typeof Kr=="string"?[Kr,ra,fa,Ia,qa[2]].join(" "):cr.precision===2?[mr(Kr),mr(ra),mr(fa),mr(Ia),qa[2]].join(" "):[wr(Kr),wr(ra),wr(fa),wr(Ia),qa[2]].join(" ");return Lr},ga=Xe.__private__.getFilters=function(){return De},Fa=Xe.__private__.putStream=function(cr){var Lr=(cr=cr||{}).data||"",Kr=cr.filters||ga(),ra=cr.alreadyAppliedFilters||[],fa=cr.addLength1||!1,Ia=Lr.length,qa=cr.objectId,gn=function($i){return $i};if(Be!==null&&qa===void 0)throw new Error("ObjectId must be passed to putStream for file encryption");Be!==null&&(gn=Ki.encryptor(qa,0));var wn={};Kr===!0&&(Kr=["FlateEncode"]);var Nn=cr.additionalKeyValues||[],Mn=(wn=E.API.processDataByFilters!==void 0?E.API.processDataByFilters(Lr,Kr):{data:Lr,reverseChain:[]}).reverseChain+(Array.isArray(ra)?ra.join(" "):ra.toString());if(wn.data.length!==0&&(Nn.push({key:"Length",value:wn.data.length}),fa===!0&&Nn.push({key:"Length1",value:Ia})),Mn.length!=0)if(Mn.split("/").length-1==1)Nn.push({key:"Filter",value:Mn});else{Nn.push({key:"Filter",value:"["+Mn+"]"});for(var Gn=0;Gn<Nn.length;Gn+=1)if(Nn[Gn].key==="DecodeParms"){for(var Ei=[],Mi=0;Mi<wn.reverseChain.split("/").length-1;Mi+=1)Ei.push("null");Ei.push(Nn[Gn].value),Nn[Gn].value="["+Ei.join(" ")+"]"}}Cr("<<");for(var di=0;di<Nn.length;di++)Cr("/"+Nn[di].key+" "+Nn[di].value);Cr(">>"),wn.data.length!==0&&(Cr("stream"),Cr(gn(wn.data)),Cr("endstream"))},ya=Xe.__private__.putPage=function(cr){var Lr=cr.number,Kr=cr.data,ra=cr.objId,fa=cr.contentsObjId;Or(ra,!0),Cr("<</Type /Page"),Cr("/Parent "+cr.rootDictionaryObjId+" 0 R"),Cr("/Resources "+cr.resourceDictionaryObjId+" 0 R"),Cr("/MediaBox ["+parseFloat(yr(cr.mediaBox.bottomLeftX))+" "+parseFloat(yr(cr.mediaBox.bottomLeftY))+" "+yr(cr.mediaBox.topRightX)+" "+yr(cr.mediaBox.topRightY)+"]"),cr.cropBox!==null&&Cr("/CropBox ["+yr(cr.cropBox.bottomLeftX)+" "+yr(cr.cropBox.bottomLeftY)+" "+yr(cr.cropBox.topRightX)+" "+yr(cr.cropBox.topRightY)+"]"),cr.bleedBox!==null&&Cr("/BleedBox ["+yr(cr.bleedBox.bottomLeftX)+" "+yr(cr.bleedBox.bottomLeftY)+" "+yr(cr.bleedBox.topRightX)+" "+yr(cr.bleedBox.topRightY)+"]"),cr.trimBox!==null&&Cr("/TrimBox ["+yr(cr.trimBox.bottomLeftX)+" "+yr(cr.trimBox.bottomLeftY)+" "+yr(cr.trimBox.topRightX)+" "+yr(cr.trimBox.topRightY)+"]"),cr.artBox!==null&&Cr("/ArtBox ["+yr(cr.artBox.bottomLeftX)+" "+yr(cr.artBox.bottomLeftY)+" "+yr(cr.artBox.topRightX)+" "+yr(cr.artBox.topRightY)+"]"),typeof cr.userUnit=="number"&&cr.userUnit!==1&&Cr("/UserUnit "+cr.userUnit),Wa.publish("putPage",{objId:ra,pageContext:La[Lr],pageNumber:Lr,page:Kr}),Cr("/Contents "+fa+" 0 R"),Cr(">>"),Cr("endobj");var Ia=Kr.join(`
`);return sr===tr&&(Ia+=`
Q`),Or(fa,!0),Fa({data:Ia,filters:ga(),objectId:fa}),Cr("endobj"),ra},wa=Xe.__private__.putPages=function(){var cr,Lr,Kr=[];for(cr=1;cr<=ka;cr++)La[cr].objId=$n(),La[cr].contentsObjId=$n();for(cr=1;cr<=ka;cr++)Kr.push(ya({number:cr,data:Pr[cr],objId:La[cr].objId,contentsObjId:La[cr].contentsObjId,mediaBox:La[cr].mediaBox,cropBox:La[cr].cropBox,bleedBox:La[cr].bleedBox,trimBox:La[cr].trimBox,artBox:La[cr].artBox,userUnit:La[cr].userUnit,rootDictionaryObjId:zr,resourceDictionaryObjId:Xr}));Or(zr,!0),Cr("<</Type /Pages");var ra="/Kids [";for(Lr=0;Lr<ka;Lr++)ra+=Kr[Lr]+" 0 R ";Cr(ra+"]"),Cr("/Count "+ka),Cr(">>"),Cr("endobj"),Wa.publish("postPutPages")},Sa=function(cr){Wa.publish("putFont",{font:cr,out:Cr,newObject:Ln,putStream:Fa}),cr.isAlreadyPutted!==!0&&(cr.objectNumber=Ln(),Cr("<<"),Cr("/Type /Font"),Cr("/BaseFont /"+j(cr.postScriptName)),Cr("/Subtype /Type1"),typeof cr.encoding=="string"&&Cr("/Encoding /"+cr.encoding),Cr("/FirstChar 32"),Cr("/LastChar 255"),Cr(">>"),Cr("endobj"))},Va=function(cr){cr.objectNumber=Ln();var Lr=[];Lr.push({key:"Type",value:"/XObject"}),Lr.push({key:"Subtype",value:"/Form"}),Lr.push({key:"BBox",value:"["+[yr(cr.x),yr(cr.y),yr(cr.x+cr.width),yr(cr.y+cr.height)].join(" ")+"]"}),Lr.push({key:"Matrix",value:"["+cr.matrix.toString()+"]"});var Kr=cr.pages[1].join(`
`);Fa({data:Kr,additionalKeyValues:Lr,objectId:cr.objectNumber}),Cr("endobj")},Ja=function(cr,Lr){Lr||(Lr=21);var Kr=Ln(),ra=(function(qa,gn){var wn,Nn=[],Mn=1/(gn-1);for(wn=0;wn<1;wn+=Mn)Nn.push(wn);if(Nn.push(1),qa[0].offset!=0){var Gn={offset:0,color:qa[0].color};qa.unshift(Gn)}if(qa[qa.length-1].offset!=1){var Ei={offset:1,color:qa[qa.length-1].color};qa.push(Ei)}for(var Mi="",di=0,$i=0;$i<Nn.length;$i++){for(wn=Nn[$i];wn>qa[di+1].offset;)di++;var Ui=qa[di].offset,is=(wn-Ui)/(qa[di+1].offset-Ui),Uo=qa[di].color,so=qa[di+1].color;Mi+=lr(Math.round((1-is)*Uo[0]+is*so[0]).toString(16))+lr(Math.round((1-is)*Uo[1]+is*so[1]).toString(16))+lr(Math.round((1-is)*Uo[2]+is*so[2]).toString(16))}return Mi.trim()})(cr.colors,Lr),fa=[];fa.push({key:"FunctionType",value:"0"}),fa.push({key:"Domain",value:"[0.0 1.0]"}),fa.push({key:"Size",value:"["+Lr+"]"}),fa.push({key:"BitsPerSample",value:"8"}),fa.push({key:"Range",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),fa.push({key:"Decode",value:"[0.0 1.0 0.0 1.0 0.0 1.0]"}),Fa({data:ra,additionalKeyValues:fa,alreadyAppliedFilters:["/ASCIIHexDecode"],objectId:Kr}),Cr("endobj"),cr.objectNumber=Ln(),Cr("<< /ShadingType "+cr.type),Cr("/ColorSpace /DeviceRGB");var Ia="/Coords ["+yr(parseFloat(cr.coords[0]))+" "+yr(parseFloat(cr.coords[1]))+" ";cr.type===2?Ia+=yr(parseFloat(cr.coords[2]))+" "+yr(parseFloat(cr.coords[3])):Ia+=yr(parseFloat(cr.coords[2]))+" "+yr(parseFloat(cr.coords[3]))+" "+yr(parseFloat(cr.coords[4]))+" "+yr(parseFloat(cr.coords[5])),Cr(Ia+="]"),cr.matrix&&Cr("/Matrix ["+cr.matrix.toString()+"]"),Cr("/Function "+Kr+" 0 R"),Cr("/Extend [true true]"),Cr(">>"),Cr("endobj")},an=function(cr,Lr){var Kr=$n(),ra=Ln();Lr.push({resourcesOid:Kr,objectOid:ra}),cr.objectNumber=ra;var fa=[];fa.push({key:"Type",value:"/Pattern"}),fa.push({key:"PatternType",value:"1"}),fa.push({key:"PaintType",value:"1"}),fa.push({key:"TilingType",value:"1"}),fa.push({key:"BBox",value:"["+cr.boundingBox.map(yr).join(" ")+"]"}),fa.push({key:"XStep",value:yr(cr.xStep)}),fa.push({key:"YStep",value:yr(cr.yStep)}),fa.push({key:"Resources",value:Kr+" 0 R"}),cr.matrix&&fa.push({key:"Matrix",value:"["+cr.matrix.toString()+"]"}),Fa({data:cr.stream,additionalKeyValues:fa,objectId:cr.objectNumber}),Cr("endobj")},Za=function(cr){for(var Lr in cr.objectNumber=Ln(),Cr("<<"),cr)switch(Lr){case"opacity":Cr("/ca "+mr(cr[Lr]));break;case"stroke-opacity":Cr("/CA "+mr(cr[Lr]))}Cr(">>"),Cr("endobj")},tn=function(cr){Or(cr.resourcesOid,!0),Cr("<<"),Cr("/ProcSet [/PDF /Text /ImageB /ImageC /ImageI]"),(function(){for(var Lr in Cr("/Font <<"),va)va.hasOwnProperty(Lr)&&(He===!1||He===!0&&Ve.hasOwnProperty(Lr))&&Cr("/"+Lr+" "+va[Lr].objectNumber+" 0 R");Cr(">>")})(),(function(){if(Object.keys(Oa).length>0){for(var Lr in Cr("/Shading <<"),Oa)Oa.hasOwnProperty(Lr)&&Oa[Lr]instanceof M&&Oa[Lr].objectNumber>=0&&Cr("/"+Lr+" "+Oa[Lr].objectNumber+" 0 R");Wa.publish("putShadingPatternDict"),Cr(">>")}})(),(function(Lr){if(Object.keys(Oa).length>0){for(var Kr in Cr("/Pattern <<"),Oa)Oa.hasOwnProperty(Kr)&&Oa[Kr]instanceof Xe.TilingPattern&&Oa[Kr].objectNumber>=0&&Oa[Kr].objectNumber<Lr&&Cr("/"+Kr+" "+Oa[Kr].objectNumber+" 0 R");Wa.publish("putTilingPatternDict"),Cr(">>")}})(cr.objectOid),(function(){if(Object.keys(pa).length>0){var Lr;for(Lr in Cr("/ExtGState <<"),pa)pa.hasOwnProperty(Lr)&&pa[Lr].objectNumber>=0&&Cr("/"+Lr+" "+pa[Lr].objectNumber+" 0 R");Wa.publish("putGStateDict"),Cr(">>")}})(),(function(){for(var Lr in Cr("/XObject <<"),hn)hn.hasOwnProperty(Lr)&&hn[Lr].objectNumber>=0&&Cr("/"+Lr+" "+hn[Lr].objectNumber+" 0 R");Wa.publish("putXobjectDict"),Cr(">>")})(),Cr(">>"),Cr("endobj")},dn=function(cr){aa[cr.fontName]=aa[cr.fontName]||{},aa[cr.fontName][cr.fontStyle]=cr.id},ii=function(cr,Lr,Kr,ra,fa){var Ia={id:"F"+(Object.keys(va).length+1).toString(10),postScriptName:cr,fontName:Lr,fontStyle:Kr,encoding:ra,isStandardFont:fa||!1,metadata:{}};return Wa.publish("addFont",{font:Ia,instance:this}),va[Ia.id]=Ia,dn(Ia),Ia.id},Un=Xe.__private__.pdfEscape=Xe.pdfEscape=function(cr,Lr){return(function(Kr,ra){var fa,Ia,qa,gn,wn,Nn,Mn,Gn,Ei;if(qa=(ra=ra||{}).sourceEncoding||"Unicode",wn=ra.outputEncoding,(ra.autoencode||wn)&&va[Qa].metadata&&va[Qa].metadata[qa]&&va[Qa].metadata[qa].encoding&&(gn=va[Qa].metadata[qa].encoding,!wn&&va[Qa].encoding&&(wn=va[Qa].encoding),!wn&&gn.codePages&&(wn=gn.codePages[0]),typeof wn=="string"&&(wn=gn[wn]),wn)){for(Mn=!1,Nn=[],fa=0,Ia=Kr.length;fa<Ia;fa++)(Gn=wn[Kr.charCodeAt(fa)])?Nn.push(String.fromCharCode(Gn)):Nn.push(Kr[fa]),Nn[fa].charCodeAt(0)>>8&&(Mn=!0);Kr=Nn.join("")}for(fa=Kr.length;Mn===void 0&&fa!==0;)Kr.charCodeAt(fa-1)>>8&&(Mn=!0),fa--;if(!Mn)return Kr;for(Nn=ra.noBOM?[]:[254,255],fa=0,Ia=Kr.length;fa<Ia;fa++){if((Ei=(Gn=Kr.charCodeAt(fa))>>8)>>8)throw new Error("Character at position "+fa+" of string '"+Kr+"' exceeds 16bits. Cannot be encoded into UCS-2 BE");Nn.push(Ei),Nn.push(Gn-(Ei<<8))}return String.fromCharCode.apply(void 0,Nn)})(cr,Lr).replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},ci=Xe.__private__.beginPage=function(cr){Pr[++ka]=[],La[ka]={objId:0,contentsObjId:0,userUnit:Number(Me),artBox:null,bleedBox:null,cropBox:null,trimBox:null,mediaBox:{bottomLeftX:0,bottomLeftY:0,topRightX:Number(cr[0]),topRightY:Number(cr[1])}},ro(ka),ua(Pr[nr])},vs=function(cr,Lr){var Kr,ra,fa;switch(r=Lr||r,typeof cr=="string"&&(Kr=Ke(cr.toLowerCase()),Array.isArray(Kr)&&(ra=Kr[0],fa=Kr[1])),Array.isArray(cr)&&(ra=cr[0]*Ka,fa=cr[1]*Ka),isNaN(ra)&&(ra=Ee[0],fa=Ee[1]),(ra>14400||fa>14400)&&(o.warn("A page in a PDF can not be wider or taller than 14400 userUnit. jsPDF limits the width/height to 14400"),ra=Math.min(14400,ra),fa=Math.min(14400,fa)),Ee=[ra,fa],r.substr(0,1)){case"l":fa>ra&&(Ee=[fa,ra]);break;case"p":ra>fa&&(Ee=[fa,ra])}ci(Ee),kn(El),Cr(Ds),Jl!==0&&Cr(Jl+" J"),Qi!==0&&Cr(Qi+" j"),Wa.publish("addPage",{pageNumber:ka})},to=function(cr){cr>0&&cr<=ka&&(Pr.splice(cr,1),La.splice(cr,1),ka--,nr>ka&&(nr=ka),this.setPage(nr))},ro=function(cr){cr>0&&cr<=ka&&(nr=cr)},Fs=Xe.__private__.getNumberOfPages=Xe.getNumberOfPages=function(){return Pr.length-1},nl=function(cr,Lr,Kr){var ra,fa=void 0;return Kr=Kr||{},cr=cr!==void 0?cr:va[Qa].fontName,Lr=Lr!==void 0?Lr:va[Qa].fontStyle,ra=cr.toLowerCase(),aa[ra]!==void 0&&aa[ra][Lr]!==void 0?fa=aa[ra][Lr]:aa[cr]!==void 0&&aa[cr][Lr]!==void 0?fa=aa[cr][Lr]:Kr.disableWarning===!1&&o.warn("Unable to look up font label for font '"+cr+"', '"+Lr+"'. Refer to getFontList() for available fonts."),fa||Kr.noFallback||(fa=aa.times[Lr])==null&&(fa=aa.times.normal),fa},Ai=Xe.__private__.putInfo=function(){var cr=Ln(),Lr=function(ra){return ra};for(var Kr in Be!==null&&(Lr=Ki.encryptor(cr,0)),Cr("<<"),Cr("/Producer ("+Un(Lr("jsPDF "+E.version))+")"),fn)fn.hasOwnProperty(Kr)&&fn[Kr]&&Cr("/"+Kr.substr(0,1).toUpperCase()+Kr.substr(1)+" ("+Un(Lr(fn[Kr]))+")");Cr("/CreationDate ("+Un(Lr(Hr))+")"),Cr(">>"),Cr("endobj")},Lo=Xe.__private__.putCatalog=function(cr){var Lr=(cr=cr||{}).rootDictionaryObjId||zr;switch(Ln(),Cr("<<"),Cr("/Type /Catalog"),Cr("/Pages "+Lr+" 0 R"),Na||(Na="fullwidth"),Na){case"fullwidth":Cr("/OpenAction [3 0 R /FitH null]");break;case"fullheight":Cr("/OpenAction [3 0 R /FitV null]");break;case"fullpage":Cr("/OpenAction [3 0 R /Fit]");break;case"original":Cr("/OpenAction [3 0 R /XYZ null null 1]");break;default:var Kr=""+Na;Kr.substr(Kr.length-1)==="%"&&(Na=parseInt(Na)/100),typeof Na=="number"&&Cr("/OpenAction [3 0 R /XYZ null null "+mr(Na)+"]")}switch(nn||(nn="continuous"),nn){case"continuous":Cr("/PageLayout /OneColumn");break;case"single":Cr("/PageLayout /SinglePage");break;case"two":case"twoleft":Cr("/PageLayout /TwoColumnLeft");break;case"tworight":Cr("/PageLayout /TwoColumnRight")}Xa&&Cr("/PageMode /"+Xa),Wa.publish("putCatalog"),Cr(">>"),Cr("endobj")},ao=Xe.__private__.putTrailer=function(){Cr("trailer"),Cr("<<"),Cr("/Size "+(St+1)),Cr("/Root "+St+" 0 R"),Cr("/Info "+(St-1)+" 0 R"),Be!==null&&Cr("/Encrypt "+Ki.oid+" 0 R"),Cr("/ID [ <"+Nr+"> <"+Nr+"> ]"),Cr(">>")},ei=Xe.__private__.putHeader=function(){Cr("%PDF-"+We),Cr("%")},Fc=Xe.__private__.putXRef=function(){var cr="0000000000";Cr("xref"),Cr("0 "+(St+1)),Cr("0000000000 65535 f ");for(var Lr=1;Lr<=St;Lr++)typeof dr[Lr]=="function"?Cr((cr+dr[Lr]()).slice(-10)+" 00000 n "):dr[Lr]!==void 0?Cr((cr+dr[Lr]).slice(-10)+" 00000 n "):Cr("0000000000 00000 n ")},mo=Xe.__private__.buildDocument=function(){var cr;St=0,br=0,vr=[],dr=[],kr=[],zr=$n(),Xr=$n(),ua(vr),Wa.publish("buildDocument"),ei(),wa(),(function(){Wa.publish("putAdditionalObjects");for(var Kr=0;Kr<kr.length;Kr++){var ra=kr[Kr];Or(ra.objId,!0),Cr(ra.content),Cr("endobj")}Wa.publish("postPutAdditionalObjects")})(),cr=[],(function(){for(var Kr in va)va.hasOwnProperty(Kr)&&(He===!1||He===!0&&Ve.hasOwnProperty(Kr))&&Sa(va[Kr])})(),(function(){var Kr;for(Kr in pa)pa.hasOwnProperty(Kr)&&Za(pa[Kr])})(),(function(){for(var Kr in hn)hn.hasOwnProperty(Kr)&&Va(hn[Kr])})(),(function(Kr){var ra;for(ra in Oa)Oa.hasOwnProperty(ra)&&(Oa[ra]instanceof M?Ja(Oa[ra]):Oa[ra]instanceof q&&an(Oa[ra],Kr))})(cr),Wa.publish("putResources"),cr.forEach(tn),tn({resourcesOid:Xr,objectOid:Number.MAX_SAFE_INTEGER}),Wa.publish("postPutResources"),Be!==null&&(Ki.oid=Ln(),Cr("<<"),Cr("/Filter /Standard"),Cr("/V "+Ki.v),Cr("/R "+Ki.r),Cr("/U <"+Ki.toHexString(Ki.U)+">"),Cr("/O <"+Ki.toHexString(Ki.O)+">"),Cr("/P "+Ki.P),Cr(">>"),Cr("endobj")),Ai(),Lo();var Lr=br;return Fc(),ao(),Cr("startxref"),Cr(""+Lr),Cr("%%EOF"),ua(Pr[nr]),vr.join(`
`)},il=Xe.__private__.getBlob=function(cr){return new Blob([Qr(cr)],{type:"application/pdf"})},Lc=Xe.output=Xe.__private__.output=(bi=function(cr,Lr){switch(typeof(Lr=Lr||{})=="string"?Lr={filename:Lr}:Lr.filename=Lr.filename||"generated.pdf",cr){case void 0:return mo();case"save":Xe.save(Lr.filename);break;case"arraybuffer":return Qr(mo());case"blob":return il(mo());case"bloburi":case"bloburl":if(i.URL!==void 0&&typeof i.URL.createObjectURL=="function")return i.URL&&i.URL.createObjectURL(il(mo()))||void 0;o.warn("bloburl is not supported by your system, because URL.createObjectURL is not supported by your browser.");break;case"datauristring":case"dataurlstring":var Kr="",ra=mo();try{Kr=d(ra)}catch{Kr=d(unescape(encodeURIComponent(ra)))}return"data:application/pdf;filename="+Lr.filename+";base64,"+Kr;case"pdfobjectnewwindow":if(Object.prototype.toString.call(i)==="[object Window]"){var fa="https://cdnjs.cloudflare.com/ajax/libs/pdfobject/2.1.1/pdfobject.min.js",Ia=' integrity="sha512-4ze/a9/4jqu+tX9dfOqJYSvyYd5M6qum/3HpCLr+/Jqf0whc37VUbkpNGHR7/8pSnCFw47T1fmIpwBV7UySh3g==" crossorigin="anonymous"';Lr.pdfObjectUrl&&(fa=Lr.pdfObjectUrl,Ia="");var qa='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><script src="'+fa+'"'+Ia+'><\/script><script >PDFObject.embed("'+this.output("dataurlstring")+'", '+JSON.stringify(Lr)+");<\/script></body></html>",gn=i.open();return gn!==null&&gn.document.write(qa),gn}throw new Error("The option pdfobjectnewwindow just works in a browser-environment.");case"pdfjsnewwindow":if(Object.prototype.toString.call(i)==="[object Window]"){var wn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe id="pdfViewer" src="'+(Lr.pdfJsUrl||"examples/PDF.js/web/viewer.html")+"?file=&downloadName="+Lr.filename+'" width="500px" height="400px" /></body></html>',Nn=i.open();if(Nn!==null){Nn.document.write(wn);var Mn=this;Nn.document.documentElement.querySelector("#pdfViewer").onload=function(){Nn.document.title=Lr.filename,Nn.document.documentElement.querySelector("#pdfViewer").contentWindow.PDFViewerApplication.open(Mn.output("bloburl"))}}return Nn}throw new Error("The option pdfjsnewwindow just works in a browser-environment.");case"dataurlnewwindow":if(Object.prototype.toString.call(i)!=="[object Window]")throw new Error("The option dataurlnewwindow just works in a browser-environment.");var Gn='<html><style>html, body { padding: 0; margin: 0; } iframe { width: 100%; height: 100%; border: 0;}  </style><body><iframe src="'+this.output("datauristring",Lr)+'"></iframe></body></html>',Ei=i.open();if(Ei!==null&&(Ei.document.write(Gn),Ei.document.title=Lr.filename),Ei||typeof safari>"u")return Ei;break;case"datauri":case"dataurl":return i.document.location.href=this.output("datauristring",Lr);default:return null}},bi.foo=function(){try{return bi.apply(this,arguments)}catch(Kr){var cr=Kr.stack||"";~cr.indexOf(" at ")&&(cr=cr.split(" at ")[1]);var Lr="Error in function "+cr.split(`
`)[0].split("<")[0]+": "+Kr.message;if(!i.console)throw new Error(Lr);i.console.error(Lr,Kr),i.alert&&alert(Lr)}},bi.foo.bar=bi,bi.foo),ys=function(cr){return Array.isArray(_n)===!0&&_n.indexOf(cr)>-1};switch(n){case"pt":Ka=1;break;case"mm":Ka=72/25.4;break;case"cm":Ka=72/2.54;break;case"in":Ka=72;break;case"px":Ka=ys("px_scaling")==1?.75:96/72;break;case"pc":case"em":Ka=12;break;case"ex":Ka=6;break;default:if(typeof n!="number")throw new Error("Invalid unit: "+n);Ka=n}var Ki=null;ur(),xr();var ji=Xe.__private__.getPageInfo=Xe.getPageInfo=function(cr){if(isNaN(cr)||cr%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfo");return{objId:La[cr].objId,pageNumber:cr,pageContext:La[cr]}},$l=Xe.__private__.getPageInfoByObjId=function(cr){if(isNaN(cr)||cr%1!=0)throw new Error("Invalid argument passed to jsPDF.getPageInfoByObjId");for(var Lr in La)if(La[Lr].objId===cr)break;return ji(Lr)},iu=Xe.__private__.getCurrentPageInfo=Xe.getCurrentPageInfo=function(){return{objId:La[nr].objId,pageNumber:nr,pageContext:La[nr]}};Xe.addPage=function(){return vs.apply(this,arguments),this},Xe.setPage=function(){return ro.apply(this,arguments),ua.call(this,Pr[nr]),this},Xe.insertPage=function(cr){return this.addPage(),this.movePage(nr,cr),this},Xe.movePage=function(cr,Lr){var Kr,ra;if(cr>Lr){Kr=Pr[cr],ra=La[cr];for(var fa=cr;fa>Lr;fa--)Pr[fa]=Pr[fa-1],La[fa]=La[fa-1];Pr[Lr]=Kr,La[Lr]=ra,this.setPage(Lr)}else if(cr<Lr){Kr=Pr[cr],ra=La[cr];for(var Ia=cr;Ia<Lr;Ia++)Pr[Ia]=Pr[Ia+1],La[Ia]=La[Ia+1];Pr[Lr]=Kr,La[Lr]=ra,this.setPage(Lr)}return this},Xe.deletePage=function(){return to.apply(this,arguments),this},Xe.__private__.text=Xe.text=function(cr,Lr,Kr,ra,fa){var Ia,qa,gn,wn,Nn,Mn,Gn,Ei,Mi,di=(ra=ra||{}).scope||this;if(typeof cr=="number"&&typeof Lr=="number"&&(typeof Kr=="string"||Array.isArray(Kr))){var $i=Kr;Kr=Lr,Lr=cr,cr=$i}if(arguments[3]instanceof sn==0?(gn=arguments[4],wn=arguments[5],_typeof(Gn=arguments[3])==="object"&&Gn!==null||(typeof gn=="string"&&(wn=gn,gn=null),typeof Gn=="string"&&(wn=Gn,Gn=null),typeof Gn=="number"&&(gn=Gn,Gn=null),ra={flags:Gn,angle:gn,align:wn})):(fr("The transform parameter of text() with a Matrix value"),Mi=fa),isNaN(Lr)||isNaN(Kr)||cr==null)throw new Error("Invalid arguments passed to jsPDF.text");if(cr.length===0)return di;var Ui,is="",Uo=typeof ra.lineHeightFactor=="number"?ra.lineHeightFactor:Do,so=di.internal.scaleFactor;function zo(ti){return ti=ti.split("	").join(Array(ra.TabLen||9).join(" ")),Un(ti,Gn)}function zc(ti){for(var Yn,pi=ti.concat(),Pi=[],To=pi.length;To--;)typeof(Yn=pi.shift())=="string"?Pi.push(Yn):Array.isArray(ti)&&(Yn.length===1||Yn[1]===void 0&&Yn[2]===void 0)?Pi.push(Yn[0]):Pi.push([Yn[0],Yn[1],Yn[2]]);return Pi}function ec(ti,Yn){var pi;if(typeof ti=="string")pi=Yn(ti)[0];else if(Array.isArray(ti)){for(var Pi,To,uo=ti.concat(),Ll=[],qc=uo.length;qc--;)typeof(Pi=uo.shift())=="string"?Ll.push(Yn(Pi)[0]):Array.isArray(Pi)&&typeof Pi[0]=="string"&&(To=Yn(Pi[0],Pi[1],Pi[2]),Ll.push([To[0],To[1],To[2]]));pi=Ll}return pi}var vo=!1,oo=!0;if(typeof cr=="string")vo=!0;else if(Array.isArray(cr)){var Nl=cr.concat();qa=[];for(var Ho,es=Nl.length;es--;)(typeof(Ho=Nl.shift())!="string"||Array.isArray(Ho)&&typeof Ho[0]!="string")&&(oo=!1);vo=oo}if(vo===!1)throw new Error('Type of text must be string or Array. "'+cr+'" is not recognized.');typeof cr=="string"&&(cr=cr.match(/[\r?\n]/)?cr.split(/\r\n|\r|\n/g):[cr]);var ol=ta/di.internal.scaleFactor,ll=ol*(Uo-1);switch(ra.baseline){case"bottom":Kr-=ll;break;case"top":Kr+=ol-ll;break;case"hanging":Kr+=ol-2*ll;break;case"middle":Kr+=ol/2-ll}if((Mn=ra.maxWidth||0)>0&&(typeof cr=="string"?cr=di.splitTextToSize(cr,Mn):Object.prototype.toString.call(cr)==="[object Array]"&&(cr=cr.reduce(function(ti,Yn){return ti.concat(di.splitTextToSize(Yn,Mn))},[]))),Ia={text:cr,x:Lr,y:Kr,options:ra,mutex:{pdfEscape:Un,activeFontKey:Qa,fonts:va,activeFontSize:ta}},Wa.publish("preProcessText",Ia),cr=Ia.text,gn=(ra=Ia.options).angle,Mi instanceof sn==0&&gn&&typeof gn=="number"){gn*=Math.PI/180,ra.rotationDirection===0&&(gn=-gn),sr===tr&&(gn=-gn);var tc=Math.cos(gn),yo=Math.sin(gn);Mi=new sn(tc,yo,-yo,tc,0,0)}else gn&&gn instanceof sn&&(Mi=gn);sr!==tr||Mi||(Mi=Yi),(Nn=ra.charSpace||Bs)!==void 0&&(is+=yr(Fr(Nn))+` Tc
`,this.setCharSpace(this.getCharSpace()||0)),(Ei=ra.horizontalScale)!==void 0&&(is+=yr(100*Ei)+` Tz
`),ra.lang;var bs=-1,Xo=ra.renderingMode!==void 0?ra.renderingMode:ra.stroke,rc=di.internal.getCurrentPageInfo().pageContext;switch(Xo){case 0:case!1:case"fill":bs=0;break;case 1:case!0:case"stroke":bs=1;break;case 2:case"fillThenStroke":bs=2;break;case 3:case"invisible":bs=3;break;case 4:case"fillAndAddForClipping":bs=4;break;case 5:case"strokeAndAddPathForClipping":bs=5;break;case 6:case"fillThenStrokeAndAddToPathForClipping":bs=6;break;case 7:case"addToPathForClipping":bs=7}var Hc=rc.usedRenderingMode!==void 0?rc.usedRenderingMode:-1;bs!==-1?is+=bs+` Tr
`:Hc!==-1&&(is+=`0 Tr
`),bs!==-1&&(rc.usedRenderingMode=bs),wn=ra.align||"left";var Ms,lo=ta*Uo,qo=di.internal.pageSize.getWidth(),Xc=va[Qa];Nn=ra.charSpace||Bs,Mn=ra.maxWidth||0,Gn=Object.assign({autoencode:!0,noBOM:!0},ra.flags);var co=[],cl=function(ti){return di.getStringUnitWidth(ti,{font:Xc,charSpace:Nn,fontSize:ta,doKerning:!1})*ta/so};if(Object.prototype.toString.call(cr)==="[object Array]"){var Rs;qa=zc(cr),wn!=="left"&&(Ms=qa.map(cl));var Ss,wo=0;if(wn==="right"){Lr-=Ms[0],cr=[],es=qa.length;for(var bo=0;bo<es;bo++)bo===0?(Ss=Ls(Lr),Rs=ns(Kr)):(Ss=Fr(wo-Ms[bo]),Rs=-lo),cr.push([qa[bo],Ss,Rs]),wo=Ms[bo]}else if(wn==="center"){Lr-=Ms[0]/2,cr=[],es=qa.length;for(var Wo=0;Wo<es;Wo++)Wo===0?(Ss=Ls(Lr),Rs=ns(Kr)):(Ss=Fr((wo-Ms[Wo])/2),Rs=-lo),cr.push([qa[Wo],Ss,Rs]),wo=Ms[Wo]}else if(wn==="left"){cr=[],es=qa.length;for(var ac=0;ac<es;ac++)cr.push(qa[ac])}else if(wn==="justify"&&Xc.encoding==="Identity-H"){cr=[],es=qa.length,Mn=Mn!==0?Mn:qo;for(var nc=0,Oi=0;Oi<es;Oi++)if(Rs=Oi===0?ns(Kr):-lo,Ss=Oi===0?Ls(Lr):nc,Oi<es-1){var pu=Fr((Mn-Ms[Oi])/(qa[Oi].split(" ").length-1)),So=qa[Oi].split(" ");cr.push([So[0]+" ",Ss,Rs]),nc=0;for(var Ao=1;Ao<So.length;Ao++){var ss=(cl(So[Ao-1]+" "+So[Ao])-cl(So[Ao]))*so+pu;Ao==So.length-1?cr.push([So[Ao],ss,0]):cr.push([So[Ao]+" ",ss,0]),nc-=ss}}else cr.push([qa[Oi],Ss,Rs]);cr.push(["",nc,0])}else{if(wn!=="justify")throw new Error('Unrecognized alignment option, use "left", "center", "right" or "justify".');for(cr=[],es=qa.length,Mn=Mn!==0?Mn:qo,Oi=0;Oi<es;Oi++){Rs=Oi===0?ns(Kr):-lo,Ss=Oi===0?Ls(Lr):0;var Vo=qa[Oi].split(" ").length-1,ic=Vo>0?(Mn-Ms[Oi])/Vo:0;Oi<es-1?co.push(yr(Fr(ic))):co.push(0),cr.push([qa[Oi],Ss,Rs])}}}(typeof ra.R2L=="boolean"?ra.R2L:za)===!0&&(cr=ec(cr,function(ti,Yn,pi){return[ti.split("").reverse().join(""),Yn,pi]})),Ia={text:cr,x:Lr,y:Kr,options:ra,mutex:{pdfEscape:Un,activeFontKey:Qa,fonts:va,activeFontSize:ta}},Wa.publish("postProcessText",Ia),cr=Ia.text,Ui=Ia.mutex.isHex||!1;var sc=va[Qa].encoding;sc!=="WinAnsiEncoding"&&sc!=="StandardEncoding"||(cr=ec(cr,function(ti,Yn,pi){return[zo(ti),Yn,pi]})),qa=zc(cr),cr=[];for(var Go,Yo,Eo,Fl=Array.isArray(qa[0])?1:0,Os="",Ko=function(ti,Yn,pi){var Pi="";return pi instanceof sn?(pi=typeof ra.angle=="number"?Gi(pi,new sn(1,0,0,1,ti,Yn)):Gi(new sn(1,0,0,1,ti,Yn),pi),sr===tr&&(pi=Gi(new sn(1,0,0,-1,0,0),pi)),Pi=pi.join(" ")+` Tm
`):Pi=yr(ti)+" "+yr(Yn)+` Td
`,Pi},ds=0;ds<qa.length;ds++){switch(Os="",Fl){case 1:Eo=(Ui?"<":"(")+qa[ds][0]+(Ui?">":")"),Go=parseFloat(qa[ds][1]),Yo=parseFloat(qa[ds][2]);break;case 0:Eo=(Ui?"<":"(")+qa[ds]+(Ui?">":")"),Go=Ls(Lr),Yo=ns(Kr)}co!==void 0&&co[ds]!==void 0&&(Os=co[ds]+` Tw
`),ds===0?cr.push(Os+Ko(Go,Yo,Mi)+Eo):Fl===0?cr.push(Os+Eo):Fl===1&&cr.push(Os+Ko(Go,Yo,Mi)+Eo)}cr=Fl===0?cr.join(` Tj
T* `):cr.join(` Tj
`),cr+=` Tj
`;var Us=`BT
/`;return Us+=Qa+" "+ta+` Tf
`,Us+=yr(ta*Uo)+` TL
`,Us+=_o+`
`,Us+=is,Us+=cr,Cr(Us+="ET"),Ve[Qa]=!0,di};var Dc=Xe.__private__.clip=Xe.clip=function(cr){return Cr(cr==="evenodd"?"W*":"W"),this};Xe.clipEvenOdd=function(){return Dc("evenodd")},Xe.__private__.discardPath=Xe.discardPath=function(){return Cr("n"),this};var ws=Xe.__private__.isValidStyle=function(cr){var Lr=!1;return[void 0,null,"S","D","F","DF","FD","f","f*","B","B*","n"].indexOf(cr)!==-1&&(Lr=!0),Lr};Xe.__private__.setDefaultPathOperation=Xe.setDefaultPathOperation=function(cr){return ws(cr)&&(Oe=cr),this};var Mc=Xe.__private__.getStyle=Xe.getStyle=function(cr){var Lr=Oe;switch(cr){case"D":case"S":Lr="S";break;case"F":Lr="f";break;case"FD":case"DF":Lr="B";break;case"f":case"f*":case"B":case"B*":Lr=cr}return Lr},Oc=Xe.close=function(){return Cr("h"),this};Xe.stroke=function(){return Cr("S"),this},Xe.fill=function(cr){return no("f",cr),this},Xe.fillEvenOdd=function(cr){return no("f*",cr),this},Xe.fillStroke=function(cr){return no("B",cr),this},Xe.fillStrokeEvenOdd=function(cr){return no("B*",cr),this};var no=function(cr,Lr){_typeof(Lr)==="object"?ou(Lr,cr):Cr(cr)},Al=function(cr){cr===null||sr===tr&&cr===void 0||(cr=Mc(cr),Cr(cr))};function su(cr,Lr,Kr,ra,fa){var Ia=new q(Lr||this.boundingBox,Kr||this.xStep,ra||this.yStep,this.gState,fa||this.matrix);Ia.stream=this.stream;var qa=cr+"$$"+this.cloneIndex+++"$$";return Si(qa,Ia),Ia}var ou=function(cr,Lr){var Kr=ca[cr.key],ra=Oa[Kr];if(ra instanceof M)Cr("q"),Cr(Pc(Lr)),ra.gState&&Xe.setGState(ra.gState),Cr(cr.matrix.toString()+" cm"),Cr("/"+Kr+" sh"),Cr("Q");else if(ra instanceof q){var fa=new sn(1,0,0,-1,0,jo());cr.matrix&&(fa=fa.multiply(cr.matrix||Yi),Kr=su.call(ra,cr.key,cr.boundingBox,cr.xStep,cr.yStep,fa).id),Cr("q"),Cr("/Pattern cs"),Cr("/"+Kr+" scn"),ra.gState&&Xe.setGState(ra.gState),Cr(Lr),Cr("Q")}},Pc=function(cr){switch(cr){case"f":case"F":case"n":return"W n";case"f*":return"W* n";case"B":case"S":return"W S";case"B*":return"W* S"}},Ic=Xe.moveTo=function(cr,Lr){return Cr(yr(Fr(cr))+" "+yr(Mr(Lr))+" m"),this},lu=Xe.lineTo=function(cr,Lr){return Cr(yr(Fr(cr))+" "+yr(Mr(Lr))+" l"),this},Cs=Xe.curveTo=function(cr,Lr,Kr,ra,fa,Ia){return Cr([yr(Fr(cr)),yr(Mr(Lr)),yr(Fr(Kr)),yr(Mr(ra)),yr(Fr(fa)),yr(Mr(Ia)),"c"].join(" ")),this};Xe.__private__.line=Xe.line=function(cr,Lr,Kr,ra,fa){if(isNaN(cr)||isNaN(Lr)||isNaN(Kr)||isNaN(ra)||!ws(fa))throw new Error("Invalid arguments passed to jsPDF.line");return sr===rr?this.lines([[Kr-cr,ra-Lr]],cr,Lr,[1,1],fa||"S"):this.lines([[Kr-cr,ra-Lr]],cr,Lr,[1,1]).stroke()},Xe.__private__.lines=Xe.lines=function(cr,Lr,Kr,ra,fa,Ia){var qa,gn,wn,Nn,Mn,Gn,Ei,Mi,di,$i,Ui,is;if(typeof cr=="number"&&(is=Kr,Kr=Lr,Lr=cr,cr=is),ra=ra||[1,1],Ia=Ia||!1,isNaN(Lr)||isNaN(Kr)||!Array.isArray(cr)||!Array.isArray(ra)||!ws(fa)||typeof Ia!="boolean")throw new Error("Invalid arguments passed to jsPDF.lines");for(Ic(Lr,Kr),qa=ra[0],gn=ra[1],Nn=cr.length,$i=Lr,Ui=Kr,wn=0;wn<Nn;wn++)(Mn=cr[wn]).length===2?($i=Mn[0]*qa+$i,Ui=Mn[1]*gn+Ui,lu($i,Ui)):(Gn=Mn[0]*qa+$i,Ei=Mn[1]*gn+Ui,Mi=Mn[2]*qa+$i,di=Mn[3]*gn+Ui,$i=Mn[4]*qa+$i,Ui=Mn[5]*gn+Ui,Cs(Gn,Ei,Mi,di,$i,Ui));return Ia&&Oc(),Al(fa),this},Xe.path=function(cr){for(var Lr=0;Lr<cr.length;Lr++){var Kr=cr[Lr],ra=Kr.c;switch(Kr.op){case"m":Ic(ra[0],ra[1]);break;case"l":lu(ra[0],ra[1]);break;case"c":Cs.apply(this,ra);break;case"h":Oc()}}return this},Xe.__private__.rect=Xe.rect=function(cr,Lr,Kr,ra,fa){if(isNaN(cr)||isNaN(Lr)||isNaN(Kr)||isNaN(ra)||!ws(fa))throw new Error("Invalid arguments passed to jsPDF.rect");return sr===rr&&(ra=-ra),Cr([yr(Fr(cr)),yr(Mr(Lr)),yr(Fr(Kr)),yr(Fr(ra)),"re"].join(" ")),Al(fa),this},Xe.__private__.triangle=Xe.triangle=function(cr,Lr,Kr,ra,fa,Ia,qa){if(isNaN(cr)||isNaN(Lr)||isNaN(Kr)||isNaN(ra)||isNaN(fa)||isNaN(Ia)||!ws(qa))throw new Error("Invalid arguments passed to jsPDF.triangle");return this.lines([[Kr-cr,ra-Lr],[fa-Kr,Ia-ra],[cr-fa,Lr-Ia]],cr,Lr,[1,1],qa,!0),this},Xe.__private__.roundedRect=Xe.roundedRect=function(cr,Lr,Kr,ra,fa,Ia,qa){if(isNaN(cr)||isNaN(Lr)||isNaN(Kr)||isNaN(ra)||isNaN(fa)||isNaN(Ia)||!ws(qa))throw new Error("Invalid arguments passed to jsPDF.roundedRect");var gn=4/3*(Math.SQRT2-1);return fa=Math.min(fa,.5*Kr),Ia=Math.min(Ia,.5*ra),this.lines([[Kr-2*fa,0],[fa*gn,0,fa,Ia-Ia*gn,fa,Ia],[0,ra-2*Ia],[0,Ia*gn,-fa*gn,Ia,-fa,Ia],[2*fa-Kr,0],[-fa*gn,0,-fa,-Ia*gn,-fa,-Ia],[0,2*Ia-ra],[0,-Ia*gn,fa*gn,-Ia,fa,-Ia]],cr+fa,Lr,[1,1],qa,!0),this},Xe.__private__.ellipse=Xe.ellipse=function(cr,Lr,Kr,ra,fa){if(isNaN(cr)||isNaN(Lr)||isNaN(Kr)||isNaN(ra)||!ws(fa))throw new Error("Invalid arguments passed to jsPDF.ellipse");var Ia=4/3*(Math.SQRT2-1)*Kr,qa=4/3*(Math.SQRT2-1)*ra;return Ic(cr+Kr,Lr),Cs(cr+Kr,Lr-qa,cr+Ia,Lr-ra,cr,Lr-ra),Cs(cr-Ia,Lr-ra,cr-Kr,Lr-qa,cr-Kr,Lr),Cs(cr-Kr,Lr+qa,cr-Ia,Lr+ra,cr,Lr+ra),Cs(cr+Ia,Lr+ra,cr+Kr,Lr+qa,cr+Kr,Lr),Al(fa),this},Xe.__private__.circle=Xe.circle=function(cr,Lr,Kr,ra){if(isNaN(cr)||isNaN(Lr)||isNaN(Kr)||!ws(ra))throw new Error("Invalid arguments passed to jsPDF.circle");return this.ellipse(cr,Lr,Kr,Kr,ra)},Xe.setFont=function(cr,Lr,Kr){return Kr&&(Lr=pr(Lr,Kr)),Qa=nl(cr,Lr,{disableWarning:!1}),this};var io=Xe.__private__.getFont=Xe.getFont=function(){return va[nl.apply(Xe,arguments)]};Xe.__private__.getFontList=Xe.getFontList=function(){var cr,Lr,Kr={};for(cr in aa)if(aa.hasOwnProperty(cr))for(Lr in Kr[cr]=[],aa[cr])aa[cr].hasOwnProperty(Lr)&&Kr[cr].push(Lr);return Kr},Xe.addFont=function(cr,Lr,Kr,ra,fa){var Ia=["StandardEncoding","MacRomanEncoding","Identity-H","WinAnsiEncoding"];return arguments[3]&&Ia.indexOf(arguments[3])!==-1?fa=arguments[3]:arguments[3]&&Ia.indexOf(arguments[3])==-1&&(Kr=pr(Kr,ra)),ii.call(this,cr,Lr,Kr,fa=fa||"Identity-H")};var Do,El=e.lineWidth||.200025,sl=Xe.__private__.getLineWidth=Xe.getLineWidth=function(){return El},kn=Xe.__private__.setLineWidth=Xe.setLineWidth=function(cr){return El=cr,Cr(yr(Fr(cr))+" w"),this};Xe.__private__.setLineDash=E.API.setLineDash=E.API.setLineDashPattern=function(cr,Lr){if(cr=cr||[],Lr=Lr||0,isNaN(Lr)||!Array.isArray(cr))throw new Error("Invalid arguments passed to jsPDF.setLineDash");return cr=cr.map(function(Kr){return yr(Fr(Kr))}).join(" "),Lr=yr(Fr(Lr)),Cr("["+cr+"] "+Lr+" d"),this};var cu=Xe.__private__.getLineHeight=Xe.getLineHeight=function(){return ta*Do};Xe.__private__.getLineHeight=Xe.getLineHeight=function(){return ta*Do};var Bc=Xe.__private__.setLineHeightFactor=Xe.setLineHeightFactor=function(cr){return typeof(cr=cr||1.15)=="number"&&(Do=cr),this},uu=Xe.__private__.getLineHeightFactor=Xe.getLineHeightFactor=function(){return Do};Bc(e.lineHeight);var Ls=Xe.__private__.getHorizontalCoordinate=function(cr){return Fr(cr)},ns=Xe.__private__.getVerticalCoordinate=function(cr){return sr===tr?cr:La[nr].mediaBox.topRightY-La[nr].mediaBox.bottomLeftY-Fr(cr)},jc=Xe.__private__.getHorizontalCoordinateString=Xe.getHorizontalCoordinateString=function(cr){return yr(Ls(cr))},Tl=Xe.__private__.getVerticalCoordinateString=Xe.getVerticalCoordinateString=function(cr){return yr(ns(cr))},Ds=e.strokeColor||"0 G";Xe.__private__.getStrokeColor=Xe.getDrawColor=function(){return Wr(Ds)},Xe.__private__.setStrokeColor=Xe.setDrawColor=function(cr,Lr,Kr,ra){return Ds=$r({ch1:cr,ch2:Lr,ch3:Kr,ch4:ra,pdfColorType:"draw",precision:2}),Cr(Ds),this};var kl=e.fillColor||"0 g";Xe.__private__.getFillColor=Xe.getFillColor=function(){return Wr(kl)},Xe.__private__.setFillColor=Xe.setFillColor=function(cr,Lr,Kr,ra){return kl=$r({ch1:cr,ch2:Lr,ch3:Kr,ch4:ra,pdfColorType:"fill",precision:2}),Cr(kl),this};var _o=e.textColor||"0 g",fu=Xe.__private__.getTextColor=Xe.getTextColor=function(){return Wr(_o)};Xe.__private__.setTextColor=Xe.setTextColor=function(cr,Lr,Kr,ra){return _o=$r({ch1:cr,ch2:Lr,ch3:Kr,ch4:ra,pdfColorType:"text",precision:3}),this};var Bs=e.charSpace,Zl=Xe.__private__.getCharSpace=Xe.getCharSpace=function(){return parseFloat(Bs||0)};Xe.__private__.setCharSpace=Xe.setCharSpace=function(cr){if(isNaN(cr))throw new Error("Invalid argument passed to jsPDF.setCharSpace");return Bs=cr,this};var Jl=0;Xe.CapJoinStyles={0:0,butt:0,but:0,miter:0,1:1,round:1,rounded:1,circle:1,2:2,projecting:2,project:2,square:2,bevel:2},Xe.__private__.setLineCap=Xe.setLineCap=function(cr){var Lr=Xe.CapJoinStyles[cr];if(Lr===void 0)throw new Error("Line cap style of '"+cr+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Jl=Lr,Cr(Lr+" J"),this};var Qi=0;Xe.__private__.setLineJoin=Xe.setLineJoin=function(cr){var Lr=Xe.CapJoinStyles[cr];if(Lr===void 0)throw new Error("Line join style of '"+cr+"' is not recognized. See or extend .CapJoinStyles property for valid styles");return Qi=Lr,Cr(Lr+" j"),this},Xe.__private__.setLineMiterLimit=Xe.__private__.setMiterLimit=Xe.setLineMiterLimit=Xe.setMiterLimit=function(cr){if(cr=cr||0,isNaN(cr))throw new Error("Invalid argument passed to jsPDF.setLineMiterLimit");return Cr(yr(Fr(cr))+" M"),this},Xe.GState=O,Xe.setGState=function(cr){(cr=typeof cr=="string"?pa[xa[cr]]:xo(null,cr)).equals($a)||(Cr("/"+cr.id+" gs"),$a=cr)};var xo=function(cr,Lr){if(!cr||!xa[cr]){var Kr=!1;for(var ra in pa)if(pa.hasOwnProperty(ra)&&pa[ra].equals(Lr)){Kr=!0;break}if(Kr)Lr=pa[ra];else{var fa="GS"+(Object.keys(pa).length+1).toString(10);pa[fa]=Lr,Lr.id=fa}return cr&&(xa[cr]=Lr.id),Wa.publish("addGState",Lr),Lr}};Xe.addGState=function(cr,Lr){return xo(cr,Lr),this},Xe.saveGraphicsState=function(){return Cr("q"),ia.push({key:Qa,size:ta,color:_o}),this},Xe.restoreGraphicsState=function(){Cr("Q");var cr=ia.pop();return Qa=cr.key,ta=cr.size,_o=cr.color,$a=null,this},Xe.setCurrentTransformationMatrix=function(cr){return Cr(cr.toString()+" cm"),this},Xe.comment=function(cr){return Cr("#"+cr),this};var js=function(cr,Lr){var Kr=cr||0;Object.defineProperty(this,"x",{enumerable:!0,get:function(){return Kr},set:function(Ia){isNaN(Ia)||(Kr=parseFloat(Ia))}});var ra=Lr||0;Object.defineProperty(this,"y",{enumerable:!0,get:function(){return ra},set:function(Ia){isNaN(Ia)||(ra=parseFloat(Ia))}});var fa="pt";return Object.defineProperty(this,"type",{enumerable:!0,get:function(){return fa},set:function(Ia){fa=Ia.toString()}}),this},Mo=function(cr,Lr,Kr,ra){js.call(this,cr,Lr),this.type="rect";var fa=Kr||0;Object.defineProperty(this,"w",{enumerable:!0,get:function(){return fa},set:function(qa){isNaN(qa)||(fa=parseFloat(qa))}});var Ia=ra||0;return Object.defineProperty(this,"h",{enumerable:!0,get:function(){return Ia},set:function(qa){isNaN(qa)||(Ia=parseFloat(qa))}}),this},Ql=function(){this.page=ka,this.currentPage=nr,this.pages=Pr.slice(0),this.pagesContext=La.slice(0),this.x=en,this.y=Bn,this.matrix=vn,this.width=Po(nr),this.height=Uc(nr),this.outputDestination=Zr,this.id="",this.objectNumber=-1};Ql.prototype.restore=function(){ka=this.page,nr=this.currentPage,La=this.pagesContext,Pr=this.pages,en=this.x,Bn=this.y,vn=this.matrix,Rl(nr,this.width),Io(nr,this.height),Zr=this.outputDestination};var Cl=function(cr,Lr,Kr,ra,fa){Tn.push(new Ql),ka=nr=0,Pr=[],en=cr,Bn=Lr,vn=fa,ci([Kr,ra])};for(var Oo in Xe.beginFormObject=function(cr,Lr,Kr,ra,fa){return Cl(cr,Lr,Kr,ra,fa),this},Xe.endFormObject=function(cr){return(function(Lr){if(Fn[Lr])Tn.pop().restore();else{var Kr=new Ql,ra="Xo"+(Object.keys(hn).length+1).toString(10);Kr.id=ra,Fn[Lr]=ra,hn[ra]=Kr,Wa.publish("addFormObject",Kr),Tn.pop().restore()}})(cr),this},Xe.doFormObject=function(cr,Lr){var Kr=hn[Fn[cr]];return Cr("q"),Cr(Lr.toString()+" cm"),Cr("/"+Kr.id+" Do"),Cr("Q"),this},Xe.getFormObject=function(cr){var Lr=hn[Fn[cr]];return{x:Lr.x,y:Lr.y,width:Lr.width,height:Lr.height,matrix:Lr.matrix}},Xe.save=function(cr,Lr){return cr=cr||"generated.pdf",(Lr=Lr||{}).returnPromise=Lr.returnPromise||!1,Lr.returnPromise===!1?(l(il(mo()),cr),typeof l.unload=="function"&&i.setTimeout&&setTimeout(l.unload,911),this):new Promise(function(Kr,ra){try{var fa=l(il(mo()),cr);typeof l.unload=="function"&&i.setTimeout&&setTimeout(l.unload,911),Kr(fa)}catch(Ia){ra(Ia.message)}})},E.API)E.API.hasOwnProperty(Oo)&&(Oo==="events"&&E.API.events.length?(function(cr,Lr){var Kr,ra,fa;for(fa=Lr.length-1;fa!==-1;fa--)Kr=Lr[fa][0],ra=Lr[fa][1],cr.subscribe.apply(cr,[Kr].concat(typeof ra=="function"?[ra]:ra))})(Wa,E.API.events):Xe[Oo]=E.API[Oo]);function Po(cr){return La[cr].mediaBox.topRightX-La[cr].mediaBox.bottomLeftX}function Rl(cr,Lr){La[cr].mediaBox.topRightX=Lr+La[cr].mediaBox.bottomLeftX}function Uc(cr){return La[cr].mediaBox.topRightY-La[cr].mediaBox.bottomLeftY}function Io(cr,Lr){La[cr].mediaBox.topRightY=Lr+La[cr].mediaBox.bottomLeftY}var Bo=Xe.getPageWidth=function(cr){return Po(cr=cr||nr)/Ka},hu=Xe.setPageWidth=function(cr,Lr){Rl(cr,Lr*Ka)},jo=Xe.getPageHeight=function(cr){return Uc(cr=cr||nr)/Ka},du=Xe.setPageHeight=function(cr,Lr){Io(cr,Lr*Ka)};return Xe.internal={pdfEscape:Un,getStyle:Mc,getFont:io,getFontSize:Ca,getCharSpace:Zl,getTextColor:fu,getLineHeight:cu,getLineHeightFactor:uu,getLineWidth:sl,write:Jr,getHorizontalCoordinate:Ls,getVerticalCoordinate:ns,getCoordinateString:jc,getVerticalCoordinateString:Tl,collections:{},newObject:Ln,newAdditionalObject:Yr,newObjectDeferred:$n,newObjectDeferredBegin:Or,getFilters:ga,putStream:Fa,events:Wa,scaleFactor:Ka,pageSize:{getWidth:function(){return Bo(nr)},setWidth:function(cr){hu(nr,cr)},getHeight:function(){return jo(nr)},setHeight:function(cr){du(nr,cr)}},encryptionOptions:Be,encryption:Ki,getEncryptor:function(cr){return Be!==null?Ki.encryptor(cr,0):function(Lr){return Lr}},output:Lc,getNumberOfPages:Fs,get pages(){return Pr},out:Cr,f2:mr,f3:wr,getPageInfo:ji,getPageInfoByObjId:$l,getCurrentPageInfo:iu,getPDFVersion:Ge,Point:js,Rectangle:Mo,Matrix:sn,hasHotfix:ys},Object.defineProperty(Xe.internal.pageSize,"width",{get:function(){return Bo(nr)},set:function(cr){hu(nr,cr)},enumerable:!0,configurable:!0}),Object.defineProperty(Xe.internal.pageSize,"height",{get:function(){return jo(nr)},set:function(cr){du(nr,cr)},enumerable:!0,configurable:!0}),function(cr){for(var Lr=0,Kr=oa.length;Lr<Kr;Lr++){var ra=ii.call(this,cr[Lr][0],cr[Lr][1],cr[Lr][2],oa[Lr][3],!0);He===!1&&(Ve[ra]=!0);var fa=cr[Lr][0].split("-");dn({id:ra,fontName:fa[0],fontStyle:fa[1]||""})}Wa.publish("addFonts",{fonts:va,dictionary:aa})}.call(Xe,oa),Qa="F1",vs(Ee,r),Wa.publish("initialized"),Xe}I.prototype.lsbFirstWord=function(e){return String.fromCharCode(255&e,e>>8&255,e>>16&255,e>>24&255)},I.prototype.toHexString=function(e){return e.split("").map(function(t){return("0"+(255&t.charCodeAt(0)).toString(16)).slice(-2)}).join("")},I.prototype.hexToBytes=function(e){for(var t=[],r=0;r<e.length;r+=2)t.push(String.fromCharCode(parseInt(e.substr(r,2),16)));return t.join("")},I.prototype.processOwnerPassword=function(e,t){return k(S(t).substr(0,5),e)},I.prototype.encryptor=function(e,t){var r=S(this.encryptionKey+String.fromCharCode(255&e,e>>8&255,e>>16&255,255&t,t>>8&255)).substr(0,10);return function(n){return k(r,n)}},O.prototype.equals=function(e){var t,r="id,objectNumber,equals";if(!e||_typeof(e)!==_typeof(this))return!1;var n=0;for(t in this)if(!(r.indexOf(t)>=0)){if(this.hasOwnProperty(t)&&!e.hasOwnProperty(t)||this[t]!==e[t])return!1;n++}for(t in e)e.hasOwnProperty(t)&&r.indexOf(t)<0&&n--;return n===0},E.API={events:[]},E.version="4.0.0";var R=E.API,D=1,T=function(e){return e.replace(/\\/g,"\\\\").replace(/\(/g,"\\(").replace(/\)/g,"\\)")},z=function(e){return e.replace(/\\\\/g,"\\").replace(/\\\(/g,"(").replace(/\\\)/g,")")},U=function(e){return e.toFixed(2)},H=function(e){return e.toFixed(5)};R.__acroform__={};var W=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e},V=function(e){return e*D},G=function(e){var t=new ct,r=xt.internal.getHeight(e)||0,n=xt.internal.getWidth(e)||0;return t.BBox=[0,0,Number(U(n)),Number(U(r))],t},Y=R.__acroform__.setBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBit");return e|1<<t},J=R.__acroform__.clearBit=function(e,t){if(e=e||0,t=t||0,isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBit");return e&~(1<<t)},X=R.__acroform__.getBit=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBit");return e&1<<t?1:0},K=R.__acroform__.getBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.getBitForPdf");return X(e,t-1)},Z=R.__acroform__.setBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.setBitForPdf");return Y(e,t-1)},$$1=R.__acroform__.clearBitForPdf=function(e,t){if(isNaN(e)||isNaN(t))throw new Error("Invalid arguments passed to jsPDF.API.__acroform__.clearBitForPdf");return J(e,t-1)},Q=R.__acroform__.calculateCoordinates=function(e,t){var r=t.internal.getHorizontalCoordinate,n=t.internal.getVerticalCoordinate,Ee=e[0],Ce=e[1],De=e[2],Me=e[3],ze={};return ze.lowerLeft_X=r(Ee)||0,ze.lowerLeft_Y=n(Ce+Me)||0,ze.upperRight_X=r(Ee+De)||0,ze.upperRight_Y=n(Ce)||0,[Number(U(ze.lowerLeft_X)),Number(U(ze.lowerLeft_Y)),Number(U(ze.upperRight_X)),Number(U(ze.upperRight_Y))]},tt=function(e){if(e.appearanceStreamContent)return e.appearanceStreamContent;if(e.V||e.DV){var t=[],r=e._V||e.DV,n=et(e,r),Ee=e.scope.internal.getFont(e.fontName,e.fontStyle).id;t.push("/Tx BMC"),t.push("q"),t.push("BT"),t.push(e.scope.__private__.encodeColorString(e.color)),t.push("/"+Ee+" "+U(n.fontSize)+" Tf"),t.push("1 0 0 1 0 0 Tm"),t.push(n.text),t.push("ET"),t.push("Q"),t.push("EMC");var Ce=G(e);return Ce.scope=e.scope,Ce.stream=t.join(`
`),Ce}},et=function(e,t){var r=e.fontSize===0?e.maxFontSize:e.fontSize,n={text:"",fontSize:""},Ee=(t=(t=t.substr(0,1)=="("?t.substr(1):t).substr(t.length-1)==")"?t.substr(0,t.length-1):t).split(" ");Ee=e.multiline?Ee.map(function(mr){return mr.split(`
`)}):Ee.map(function(mr){return[mr]});var Ce=r,De=xt.internal.getHeight(e)||0;De=De<0?-De:De;var Me=xt.internal.getWidth(e)||0;Me=Me<0?-Me:Me;var ze=function(mr,wr,Fr){if(mr+1<Ee.length){var Mr=wr+" "+Ee[mr+1][0];return nt(Mr,e,Fr).width<=Me-4}return!1};Ce++;e:for(;Ce>0;){t="",Ce--;var Oe,Be,He=nt("3",e,Ce).height,Ve=e.multiline?De-Ce:(De-He)/2,Xe=Ve+=2,We=0,Ge=0,$e=0;if(Ce<=0){t=`(...) Tj
`,t+="% Width of Text: "+nt(t,e,Ce=12).width+", FieldWidth:"+Me+`
`;break}for(var Ke="",rr=0,tr=0;tr<Ee.length;tr++)if(Ee.hasOwnProperty(tr)){var sr=!1;if(Ee[tr].length!==1&&$e!==Ee[tr].length-1){if((He+2)*(rr+2)+2>De)continue e;Ke+=Ee[tr][$e],sr=!0,Ge=tr,tr--}else{Ke=(Ke+=Ee[tr][$e]+" ").substr(Ke.length-1)==" "?Ke.substr(0,Ke.length-1):Ke;var ar=parseInt(tr),hr=ze(ar,Ke,Ce),pr=tr>=Ee.length-1;if(hr&&!pr){Ke+=" ",$e=0;continue}if(hr||pr){if(pr)Ge=ar;else if(e.multiline&&(He+2)*(rr+2)+2>De)continue e}else{if(!e.multiline||(He+2)*(rr+2)+2>De)continue e;Ge=ar}}for(var yr="",fr=We;fr<=Ge;fr++){var Rr=Ee[fr];if(e.multiline){if(fr===Ge){yr+=Rr[$e]+" ",$e=($e+1)%Rr.length;continue}if(fr===We){yr+=Rr[Rr.length-1]+" ";continue}}yr+=Rr[0]+" "}switch(yr=yr.substr(yr.length-1)==" "?yr.substr(0,yr.length-1):yr,Be=nt(yr,e,Ce).width,e.textAlign){case"right":Oe=Me-Be-2;break;case"center":Oe=(Me-Be)/2;break;default:Oe=2}t+=U(Oe)+" "+U(Xe)+` Td
`,t+="("+T(yr)+`) Tj
`,t+=-U(Oe)+` 0 Td
`,Xe=-(Ce+2),Be=0,We=sr?Ge:Ge+1,rr++,Ke=""}break}return n.text=t,n.fontSize=Ce,n},nt=function(e,t,r){var n=t.scope.internal.getFont(t.fontName,t.fontStyle),Ee=t.scope.getStringUnitWidth(e,{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r);return{height:t.scope.getStringUnitWidth("3",{font:n,fontSize:parseFloat(r),charSpace:0})*parseFloat(r)*1.5,width:Ee}},rt={fields:[],xForms:[],acroFormDictionaryRoot:null,printedOut:!1,internal:null,isInitialized:!1},it=function(e,t){var r={type:"reference",object:e};t.internal.getPageInfo(e.page).pageContext.annotations.find(function(n){return n.type===r.type&&n.object===r.object})===void 0&&t.internal.getPageInfo(e.page).pageContext.annotations.push(r)},at=function(e,t){if(t.scope=e,e.internal!==void 0&&(e.internal.acroformPlugin===void 0||e.internal.acroformPlugin.isInitialized===!1)){if(ht.FieldNum=0,e.internal.acroformPlugin=JSON.parse(JSON.stringify(rt)),e.internal.acroformPlugin.acroFormDictionaryRoot)throw new Error("Exception while creating AcroformDictionary");D=e.internal.scaleFactor,e.internal.acroformPlugin.acroFormDictionaryRoot=new lt,e.internal.acroformPlugin.acroFormDictionaryRoot.scope=e,e.internal.acroformPlugin.acroFormDictionaryRoot._eventID=e.internal.events.subscribe("postPutResources",function(){(function(r){r.internal.events.unsubscribe(r.internal.acroformPlugin.acroFormDictionaryRoot._eventID),delete r.internal.acroformPlugin.acroFormDictionaryRoot._eventID,r.internal.acroformPlugin.printedOut=!0})(e)}),e.internal.events.subscribe("buildDocument",function(){(function(r){r.internal.acroformPlugin.acroFormDictionaryRoot.objId=void 0;var n=r.internal.acroformPlugin.acroFormDictionaryRoot.Fields;for(var Ee in n)if(n.hasOwnProperty(Ee)){var Ce=n[Ee];Ce.objId=void 0,Ce.hasAnnotation&&it(Ce,r)}})(e)}),e.internal.events.subscribe("putCatalog",function(){(function(r){if(r.internal.acroformPlugin.acroFormDictionaryRoot===void 0)throw new Error("putCatalogCallback: Root missing.");r.internal.write("/AcroForm "+r.internal.acroformPlugin.acroFormDictionaryRoot.objId+" 0 R")})(e)}),e.internal.events.subscribe("postPutPages",function(r){(function(n,Ee){var Ce=!n;for(var De in n||(Ee.internal.newObjectDeferredBegin(Ee.internal.acroformPlugin.acroFormDictionaryRoot.objId,!0),Ee.internal.acroformPlugin.acroFormDictionaryRoot.putStream()),n=n||Ee.internal.acroformPlugin.acroFormDictionaryRoot.Kids)if(n.hasOwnProperty(De)){var Me=n[De],ze=[],Oe=Me.Rect;if(Me.Rect&&(Me.Rect=Q(Me.Rect,Ee)),Ee.internal.newObjectDeferredBegin(Me.objId,!0),Me.DA=xt.createDefaultAppearanceStream(Me),_typeof(Me)==="object"&&typeof Me.getKeyValueListForStream=="function"&&(ze=Me.getKeyValueListForStream()),Me.Rect=Oe,Me.hasAppearanceStream&&!Me.appearanceStreamContent){var Be=tt(Me);ze.push({key:"AP",value:"<</N "+Be+">>"}),Ee.internal.acroformPlugin.xForms.push(Be)}if(Me.appearanceStreamContent){var He="";for(var Ve in Me.appearanceStreamContent)if(Me.appearanceStreamContent.hasOwnProperty(Ve)){var Xe=Me.appearanceStreamContent[Ve];if(He+="/"+Ve+" ",He+="<<",Object.keys(Xe).length>=1||Array.isArray(Xe)){for(var De in Xe)if(Xe.hasOwnProperty(De)){var We=Xe[De];typeof We=="function"&&(We=We.call(Ee,Me)),He+="/"+De+" "+We+" ",Ee.internal.acroformPlugin.xForms.indexOf(We)>=0||Ee.internal.acroformPlugin.xForms.push(We)}}else typeof(We=Xe)=="function"&&(We=We.call(Ee,Me)),He+="/"+De+" "+We,Ee.internal.acroformPlugin.xForms.indexOf(We)>=0||Ee.internal.acroformPlugin.xForms.push(We);He+=">>"}ze.push({key:"AP",value:`<<
`+He+">>"})}Ee.internal.putStream({additionalKeyValues:ze,objectId:Me.objId}),Ee.internal.out("endobj")}Ce&&(function(Ge,$e){for(var Ke in Ge)if(Ge.hasOwnProperty(Ke)){var rr=Ke,tr=Ge[Ke];$e.internal.newObjectDeferredBegin(tr.objId,!0),_typeof(tr)==="object"&&typeof tr.putStream=="function"&&tr.putStream(),delete Ge[rr]}})(Ee.internal.acroformPlugin.xForms,Ee)})(r,e)}),e.internal.acroformPlugin.isInitialized=!0}},ot=R.__acroform__.arrayToPdfArray=function(e,t,r){var n=function(De){return De};if(Array.isArray(e)){for(var Ee="[",Ce=0;Ce<e.length;Ce++)switch(Ce!==0&&(Ee+=" "),_typeof(e[Ce])){case"boolean":case"number":case"object":Ee+=e[Ce].toString();break;case"string":e[Ce].substr(0,1)!=="/"?(t!==void 0&&r&&(n=r.internal.getEncryptor(t)),Ee+="("+T(n(e[Ce].toString()))+")"):Ee+=e[Ce].toString()}return Ee+"]"}throw new Error("Invalid argument passed to jsPDF.__acroform__.arrayToPdfArray")},st=function(e,t,r){var n=function(Ee){return Ee};return t!==void 0&&r&&(n=r.internal.getEncryptor(t)),(e=e||"").toString(),"("+T(n(e))+")"},ut=function(){this._objId=void 0,this._scope=void 0,Object.defineProperty(this,"objId",{get:function(){if(this._objId===void 0){if(this.scope===void 0)return;this._objId=this.scope.internal.newObjectDeferred()}return this._objId},set:function(e){this._objId=e}}),Object.defineProperty(this,"scope",{value:this._scope,writable:!0})};ut.prototype.toString=function(){return this.objId+" 0 R"},ut.prototype.putStream=function(){var e=this.getKeyValueListForStream();this.scope.internal.putStream({data:this.stream,additionalKeyValues:e,objectId:this.objId}),this.scope.internal.out("endobj")},ut.prototype.getKeyValueListForStream=function(){var e=[],t=Object.getOwnPropertyNames(this).filter(function(Ce){return Ce!="content"&&Ce!="appearanceStreamContent"&&Ce!="scope"&&Ce!="objId"&&Ce.substring(0,1)!="_"});for(var r in t)if(Object.getOwnPropertyDescriptor(this,t[r]).configurable===!1){var n=t[r],Ee=this[n];Ee&&(Array.isArray(Ee)?e.push({key:n,value:ot(Ee,this.objId,this.scope)}):Ee instanceof ut?(Ee.scope=this.scope,e.push({key:n,value:Ee.objId+" 0 R"})):typeof Ee!="function"&&e.push({key:n,value:Ee}))}return e};var ct=function(){ut.call(this),Object.defineProperty(this,"Type",{value:"/XObject",configurable:!1,writable:!0}),Object.defineProperty(this,"Subtype",{value:"/Form",configurable:!1,writable:!0}),Object.defineProperty(this,"FormType",{value:1,configurable:!1,writable:!0});var e,t=[];Object.defineProperty(this,"BBox",{configurable:!1,get:function(){return t},set:function(r){t=r}}),Object.defineProperty(this,"Resources",{value:"2 0 R",configurable:!1,writable:!0}),Object.defineProperty(this,"stream",{enumerable:!1,configurable:!0,set:function(r){e=r.trim()},get:function(){return e||null}})};W(ct,ut);var lt=function(){ut.call(this);var e,t=[];Object.defineProperty(this,"Kids",{enumerable:!1,configurable:!0,get:function(){return t.length>0?t:void 0}}),Object.defineProperty(this,"Fields",{enumerable:!1,configurable:!1,get:function(){return t}}),Object.defineProperty(this,"DA",{enumerable:!1,configurable:!1,get:function(){if(e){var r=function(n){return n};return this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),"("+T(r(e))+")"}},set:function(r){e=r}})};W(lt,ut);var ht=function e(){ut.call(this);var t=4;Object.defineProperty(this,"F",{enumerable:!1,configurable:!1,get:function(){return t},set:function(Ke){if(isNaN(Ke))throw new Error('Invalid value "'+Ke+'" for attribute F supplied.');t=Ke}}),Object.defineProperty(this,"showWhenPrinted",{enumerable:!0,configurable:!0,get:function(){return!!K(t,3)},set:function(Ke){Ke?this.F=Z(t,3):this.F=$$1(t,3)}});var r=0;Object.defineProperty(this,"Ff",{enumerable:!1,configurable:!1,get:function(){return r},set:function(Ke){if(isNaN(Ke))throw new Error('Invalid value "'+Ke+'" for attribute Ff supplied.');r=Ke}});var n=[];Object.defineProperty(this,"Rect",{enumerable:!1,configurable:!1,get:function(){if(n.length!==0)return n},set:function(Ke){n=Ke!==void 0?Ke:[]}}),Object.defineProperty(this,"x",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[0])?0:n[0]},set:function(Ke){n[0]=Ke}}),Object.defineProperty(this,"y",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[1])?0:n[1]},set:function(Ke){n[1]=Ke}}),Object.defineProperty(this,"width",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[2])?0:n[2]},set:function(Ke){n[2]=Ke}}),Object.defineProperty(this,"height",{enumerable:!0,configurable:!0,get:function(){return!n||isNaN(n[3])?0:n[3]},set:function(Ke){n[3]=Ke}});var Ee="";Object.defineProperty(this,"FT",{enumerable:!0,configurable:!1,get:function(){return Ee},set:function(Ke){switch(Ke){case"/Btn":case"/Tx":case"/Ch":case"/Sig":Ee=Ke;break;default:throw new Error('Invalid value "'+Ke+'" for attribute FT supplied.')}}});var Ce=null;Object.defineProperty(this,"T",{enumerable:!0,configurable:!1,get:function(){if(!Ce||Ce.length<1){if(this instanceof yt)return;Ce="FieldObject"+e.FieldNum++}var Ke=function(rr){return rr};return this.scope&&(Ke=this.scope.internal.getEncryptor(this.objId)),"("+T(Ke(Ce))+")"},set:function(Ke){Ce=Ke.toString()}}),Object.defineProperty(this,"fieldName",{configurable:!0,enumerable:!0,get:function(){return Ce},set:function(Ke){Ce=Ke}});var De="helvetica";Object.defineProperty(this,"fontName",{enumerable:!0,configurable:!0,get:function(){return De},set:function(Ke){De=Ke}});var Me="normal";Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,get:function(){return Me},set:function(Ke){Me=Ke}});var ze=0;Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,get:function(){return ze},set:function(Ke){ze=Ke}});var Oe=void 0;Object.defineProperty(this,"maxFontSize",{enumerable:!0,configurable:!0,get:function(){return Oe===void 0?50/D:Oe},set:function(Ke){Oe=Ke}});var Be="black";Object.defineProperty(this,"color",{enumerable:!0,configurable:!0,get:function(){return Be},set:function(Ke){Be=Ke}});var He="/F1 0 Tf 0 g";Object.defineProperty(this,"DA",{enumerable:!0,configurable:!1,get:function(){if(!(!He||this instanceof yt||this instanceof Nt))return st(He,this.objId,this.scope)},set:function(Ke){Ke=Ke.toString(),He=Ke}});var Ve=null;Object.defineProperty(this,"DV",{enumerable:!1,configurable:!1,get:function(){if(Ve)return this instanceof mt==0?st(Ve,this.objId,this.scope):Ve},set:function(Ke){Ke=Ke.toString(),Ve=this instanceof mt==0?Ke.substr(0,1)==="("?z(Ke.substr(1,Ke.length-2)):z(Ke):Ke}}),Object.defineProperty(this,"defaultValue",{enumerable:!0,configurable:!0,get:function(){return this instanceof mt==1?z(Ve.substr(1,Ve.length-1)):Ve},set:function(Ke){Ke=Ke.toString(),Ve=this instanceof mt==1?"/"+Ke:Ke}});var Xe=null;Object.defineProperty(this,"_V",{enumerable:!1,configurable:!1,get:function(){if(Xe)return Xe},set:function(Ke){this.V=Ke}}),Object.defineProperty(this,"V",{enumerable:!1,configurable:!1,get:function(){if(Xe)return this instanceof mt==0?st(Xe,this.objId,this.scope):Xe},set:function(Ke){Ke=Ke.toString(),Xe=this instanceof mt==0?Ke.substr(0,1)==="("?z(Ke.substr(1,Ke.length-2)):z(Ke):Ke}}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,get:function(){return this instanceof mt==1?z(Xe.substr(1,Xe.length-1)):Xe},set:function(Ke){Ke=Ke.toString(),Xe=this instanceof mt==1?"/"+Ke:Ke}}),Object.defineProperty(this,"hasAnnotation",{enumerable:!0,configurable:!0,get:function(){return this.Rect}}),Object.defineProperty(this,"Type",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Annot":null}}),Object.defineProperty(this,"Subtype",{enumerable:!0,configurable:!1,get:function(){return this.hasAnnotation?"/Widget":null}});var We,Ge=!1;Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return Ge},set:function(Ke){Ke=!!Ke,Ge=Ke}}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,get:function(){if(We)return We},set:function(Ke){We=Ke}}),Object.defineProperty(this,"readOnly",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,1)},set:function(Ke){Ke?this.Ff=Z(this.Ff,1):this.Ff=$$1(this.Ff,1)}}),Object.defineProperty(this,"required",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,2)},set:function(Ke){Ke?this.Ff=Z(this.Ff,2):this.Ff=$$1(this.Ff,2)}}),Object.defineProperty(this,"noExport",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,3)},set:function(Ke){Ke?this.Ff=Z(this.Ff,3):this.Ff=$$1(this.Ff,3)}});var $e=null;Object.defineProperty(this,"Q",{enumerable:!0,configurable:!1,get:function(){if($e!==null)return $e},set:function(Ke){if([0,1,2].indexOf(Ke)===-1)throw new Error('Invalid value "'+Ke+'" for attribute Q supplied.');$e=Ke}}),Object.defineProperty(this,"textAlign",{get:function(){var Ke;switch($e){case 0:default:Ke="left";break;case 1:Ke="center";break;case 2:Ke="right"}return Ke},configurable:!0,enumerable:!0,set:function(Ke){switch(Ke){case"right":case 2:$e=2;break;case"center":case 1:$e=1;break;default:$e=0}}})};W(ht,ut);var ft=function(){ht.call(this),this.FT="/Ch",this.V="()",this.fontName="zapfdingbats";var e=0;Object.defineProperty(this,"TI",{enumerable:!0,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"topIndex",{enumerable:!0,configurable:!0,get:function(){return e},set:function(r){e=r}});var t=[];Object.defineProperty(this,"Opt",{enumerable:!0,configurable:!1,get:function(){return ot(t,this.objId,this.scope)},set:function(r){var n,Ee;Ee=[],typeof(n=r)=="string"&&(Ee=(function(Ce,De,Me){Me||(Me=1);for(var ze,Oe=[];ze=De.exec(Ce);)Oe.push(ze[Me]);return Oe})(n,/\((.*?)\)/g)),t=Ee}}),this.getOptions=function(){return t},this.setOptions=function(r){t=r,this.sort&&t.sort()},this.addOption=function(r){r=(r=r||"").toString(),t.push(r),this.sort&&t.sort()},this.removeOption=function(r,n){for(n=n||!1,r=(r=r||"").toString();t.indexOf(r)!==-1&&(t.splice(t.indexOf(r),1),n!==!1););},Object.defineProperty(this,"combo",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,18)},set:function(r){r?this.Ff=Z(this.Ff,18):this.Ff=$$1(this.Ff,18)}}),Object.defineProperty(this,"edit",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,19)},set:function(r){this.combo===!0&&(r?this.Ff=Z(this.Ff,19):this.Ff=$$1(this.Ff,19))}}),Object.defineProperty(this,"sort",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,20)},set:function(r){r?(this.Ff=Z(this.Ff,20),t.sort()):this.Ff=$$1(this.Ff,20)}}),Object.defineProperty(this,"multiSelect",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,22)},set:function(r){r?this.Ff=Z(this.Ff,22):this.Ff=$$1(this.Ff,22)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,23)},set:function(r){r?this.Ff=Z(this.Ff,23):this.Ff=$$1(this.Ff,23)}}),Object.defineProperty(this,"commitOnSelChange",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,27)},set:function(r){r?this.Ff=Z(this.Ff,27):this.Ff=$$1(this.Ff,27)}}),this.hasAppearanceStream=!1};W(ft,ht);var dt=function(){ft.call(this),this.fontName="helvetica",this.combo=!1};W(dt,ft);var pt=function(){dt.call(this),this.combo=!0};W(pt,dt);var gt=function(){pt.call(this),this.edit=!0};W(gt,pt);var mt=function(){ht.call(this),this.FT="/Btn",Object.defineProperty(this,"noToggleToOff",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,15)},set:function(r){r?this.Ff=Z(this.Ff,15):this.Ff=$$1(this.Ff,15)}}),Object.defineProperty(this,"radio",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,16)},set:function(r){r?this.Ff=Z(this.Ff,16):this.Ff=$$1(this.Ff,16)}}),Object.defineProperty(this,"pushButton",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,17)},set:function(r){r?this.Ff=Z(this.Ff,17):this.Ff=$$1(this.Ff,17)}}),Object.defineProperty(this,"radioIsUnison",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,26)},set:function(r){r?this.Ff=Z(this.Ff,26):this.Ff=$$1(this.Ff,26)}});var e,t={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var r=function(Ce){return Ce};if(this.scope&&(r=this.scope.internal.getEncryptor(this.objId)),Object.keys(t).length!==0){var n,Ee=[];for(n in Ee.push("<<"),t)Ee.push("/"+n+" ("+T(r(t[n]))+")");return Ee.push(">>"),Ee.join(`
`)}},set:function(r){_typeof(r)==="object"&&(t=r)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return t.CA||""},set:function(r){typeof r=="string"&&(t.CA=r)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return e},set:function(r){e=r}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return e.substr(1,e.length-1)},set:function(r){e="/"+r}})};W(mt,ht);var vt=function(){mt.call(this),this.pushButton=!0};W(vt,mt);var bt=function(){mt.call(this),this.radio=!0,this.pushButton=!1;var e=[];Object.defineProperty(this,"Kids",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t!==void 0?t:[]}})};W(bt,mt);var yt=function(){var e,t;ht.call(this),Object.defineProperty(this,"Parent",{enumerable:!1,configurable:!1,get:function(){return e},set:function(Ee){e=Ee}}),Object.defineProperty(this,"optionName",{enumerable:!1,configurable:!0,get:function(){return t},set:function(Ee){t=Ee}});var r,n={};Object.defineProperty(this,"MK",{enumerable:!1,configurable:!1,get:function(){var Ee=function(Me){return Me};this.scope&&(Ee=this.scope.internal.getEncryptor(this.objId));var Ce,De=[];for(Ce in De.push("<<"),n)De.push("/"+Ce+" ("+T(Ee(n[Ce]))+")");return De.push(">>"),De.join(`
`)},set:function(Ee){_typeof(Ee)==="object"&&(n=Ee)}}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,get:function(){return n.CA||""},set:function(Ee){typeof Ee=="string"&&(n.CA=Ee)}}),Object.defineProperty(this,"AS",{enumerable:!1,configurable:!1,get:function(){return r},set:function(Ee){r=Ee}}),Object.defineProperty(this,"appearanceState",{enumerable:!0,configurable:!0,get:function(){return r.substr(1,r.length-1)},set:function(Ee){r="/"+Ee}}),this.caption="l",this.appearanceState="Off",this._AppearanceType=xt.RadioButton.Circle,this.appearanceStreamContent=this._AppearanceType.createAppearanceStream(this.optionName)};W(yt,ht),bt.prototype.setAppearance=function(e){if(!("createAppearanceStream"in e)||!("getCA"in e))throw new Error("Couldn't assign Appearance to RadioButton. Appearance was Invalid!");for(var t in this.Kids)if(this.Kids.hasOwnProperty(t)){var r=this.Kids[t];r.appearanceStreamContent=e.createAppearanceStream(r.optionName),r.caption=e.getCA()}},bt.prototype.createOption=function(e){var t=new yt;return t.Parent=this,t.optionName=e,this.Kids.push(t),At.call(this.scope,t),t};var wt=function(){mt.call(this),this.fontName="zapfdingbats",this.caption="3",this.appearanceState="On",this.value="On",this.textAlign="center",this.appearanceStreamContent=xt.CheckBox.createAppearanceStream()};W(wt,mt);var Nt=function(){ht.call(this),this.FT="/Tx",Object.defineProperty(this,"multiline",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,13)},set:function(t){t?this.Ff=Z(this.Ff,13):this.Ff=$$1(this.Ff,13)}}),Object.defineProperty(this,"fileSelect",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,21)},set:function(t){t?this.Ff=Z(this.Ff,21):this.Ff=$$1(this.Ff,21)}}),Object.defineProperty(this,"doNotSpellCheck",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,23)},set:function(t){t?this.Ff=Z(this.Ff,23):this.Ff=$$1(this.Ff,23)}}),Object.defineProperty(this,"doNotScroll",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,24)},set:function(t){t?this.Ff=Z(this.Ff,24):this.Ff=$$1(this.Ff,24)}}),Object.defineProperty(this,"comb",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,25)},set:function(t){t?this.Ff=Z(this.Ff,25):this.Ff=$$1(this.Ff,25)}}),Object.defineProperty(this,"richText",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,26)},set:function(t){t?this.Ff=Z(this.Ff,26):this.Ff=$$1(this.Ff,26)}});var e=null;Object.defineProperty(this,"MaxLen",{enumerable:!0,configurable:!1,get:function(){return e},set:function(t){e=t}}),Object.defineProperty(this,"maxLength",{enumerable:!0,configurable:!0,get:function(){return e},set:function(t){Number.isInteger(t)&&(e=t)}}),Object.defineProperty(this,"hasAppearanceStream",{enumerable:!0,configurable:!0,get:function(){return this.V||this.DV}})};W(Nt,ht);var Lt=function(){Nt.call(this),Object.defineProperty(this,"password",{enumerable:!0,configurable:!0,get:function(){return!!K(this.Ff,14)},set:function(e){e?this.Ff=Z(this.Ff,14):this.Ff=$$1(this.Ff,14)}}),this.password=!0};W(Lt,Nt);var xt={CheckBox:{createAppearanceStream:function(){return{N:{On:xt.CheckBox.YesNormal},D:{On:xt.CheckBox.YesPushDown,Off:xt.CheckBox.OffPushDown}}},YesPushDown:function(e){var t=G(e);t.scope=e.scope;var r=[],n=e.scope.internal.getFont(e.fontName,e.fontStyle).id,Ee=e.scope.__private__.encodeColorString(e.color),Ce=et(e,e.caption);return r.push("0.749023 g"),r.push("0 0 "+U(xt.internal.getWidth(e))+" "+U(xt.internal.getHeight(e))+" re"),r.push("f"),r.push("BMC"),r.push("q"),r.push("0 0 1 rg"),r.push("/"+n+" "+U(Ce.fontSize)+" Tf "+Ee),r.push("BT"),r.push(Ce.text),r.push("ET"),r.push("Q"),r.push("EMC"),t.stream=r.join(`
`),t},YesNormal:function(e){var t=G(e);t.scope=e.scope;var r=e.scope.internal.getFont(e.fontName,e.fontStyle).id,n=e.scope.__private__.encodeColorString(e.color),Ee=[],Ce=xt.internal.getHeight(e),De=xt.internal.getWidth(e),Me=et(e,e.caption);return Ee.push("1 g"),Ee.push("0 0 "+U(De)+" "+U(Ce)+" re"),Ee.push("f"),Ee.push("q"),Ee.push("0 0 1 rg"),Ee.push("0 0 "+U(De-1)+" "+U(Ce-1)+" re"),Ee.push("W"),Ee.push("n"),Ee.push("0 g"),Ee.push("BT"),Ee.push("/"+r+" "+U(Me.fontSize)+" Tf "+n),Ee.push(Me.text),Ee.push("ET"),Ee.push("Q"),t.stream=Ee.join(`
`),t},OffPushDown:function(e){var t=G(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+U(xt.internal.getWidth(e))+" "+U(xt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}},RadioButton:{Circle:{createAppearanceStream:function(e){var t={D:{Off:xt.RadioButton.Circle.OffPushDown},N:{}};return t.N[e]=xt.RadioButton.Circle.YesNormal,t.D[e]=xt.RadioButton.Circle.YesPushDown,t},getCA:function(){return"l"},YesNormal:function(e){var t=G(e);t.scope=e.scope;var r=[],n=xt.internal.getWidth(e)<=xt.internal.getHeight(e)?xt.internal.getWidth(e)/4:xt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var Ee=xt.internal.Bezier_C,Ce=Number((n*Ee).toFixed(5));return r.push("q"),r.push("1 0 0 1 "+H(xt.internal.getWidth(e)/2)+" "+H(xt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+Ce+" "+Ce+" "+n+" 0 "+n+" c"),r.push("-"+Ce+" "+n+" -"+n+" "+Ce+" -"+n+" 0 c"),r.push("-"+n+" -"+Ce+" -"+Ce+" -"+n+" 0 -"+n+" c"),r.push(Ce+" -"+n+" "+n+" -"+Ce+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=G(e);t.scope=e.scope;var r=[],n=xt.internal.getWidth(e)<=xt.internal.getHeight(e)?xt.internal.getWidth(e)/4:xt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var Ee=Number((2*n).toFixed(5)),Ce=Number((Ee*xt.internal.Bezier_C).toFixed(5)),De=Number((n*xt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+H(xt.internal.getWidth(e)/2)+" "+H(xt.internal.getHeight(e)/2)+" cm"),r.push(Ee+" 0 m"),r.push(Ee+" "+Ce+" "+Ce+" "+Ee+" 0 "+Ee+" c"),r.push("-"+Ce+" "+Ee+" -"+Ee+" "+Ce+" -"+Ee+" 0 c"),r.push("-"+Ee+" -"+Ce+" -"+Ce+" -"+Ee+" 0 -"+Ee+" c"),r.push(Ce+" -"+Ee+" "+Ee+" -"+Ce+" "+Ee+" 0 c"),r.push("f"),r.push("Q"),r.push("0 g"),r.push("q"),r.push("1 0 0 1 "+H(xt.internal.getWidth(e)/2)+" "+H(xt.internal.getHeight(e)/2)+" cm"),r.push(n+" 0 m"),r.push(n+" "+De+" "+De+" "+n+" 0 "+n+" c"),r.push("-"+De+" "+n+" -"+n+" "+De+" -"+n+" 0 c"),r.push("-"+n+" -"+De+" -"+De+" -"+n+" 0 -"+n+" c"),r.push(De+" -"+n+" "+n+" -"+De+" "+n+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t},OffPushDown:function(e){var t=G(e);t.scope=e.scope;var r=[],n=xt.internal.getWidth(e)<=xt.internal.getHeight(e)?xt.internal.getWidth(e)/4:xt.internal.getHeight(e)/4;n=Number((.9*n).toFixed(5));var Ee=Number((2*n).toFixed(5)),Ce=Number((Ee*xt.internal.Bezier_C).toFixed(5));return r.push("0.749023 g"),r.push("q"),r.push("1 0 0 1 "+H(xt.internal.getWidth(e)/2)+" "+H(xt.internal.getHeight(e)/2)+" cm"),r.push(Ee+" 0 m"),r.push(Ee+" "+Ce+" "+Ce+" "+Ee+" 0 "+Ee+" c"),r.push("-"+Ce+" "+Ee+" -"+Ee+" "+Ce+" -"+Ee+" 0 c"),r.push("-"+Ee+" -"+Ce+" -"+Ce+" -"+Ee+" 0 -"+Ee+" c"),r.push(Ce+" -"+Ee+" "+Ee+" -"+Ce+" "+Ee+" 0 c"),r.push("f"),r.push("Q"),t.stream=r.join(`
`),t}},Cross:{createAppearanceStream:function(e){var t={D:{Off:xt.RadioButton.Cross.OffPushDown},N:{}};return t.N[e]=xt.RadioButton.Cross.YesNormal,t.D[e]=xt.RadioButton.Cross.YesPushDown,t},getCA:function(){return"8"},YesNormal:function(e){var t=G(e);t.scope=e.scope;var r=[],n=xt.internal.calculateCross(e);return r.push("q"),r.push("1 1 "+U(xt.internal.getWidth(e)-2)+" "+U(xt.internal.getHeight(e)-2)+" re"),r.push("W"),r.push("n"),r.push(U(n.x1.x)+" "+U(n.x1.y)+" m"),r.push(U(n.x2.x)+" "+U(n.x2.y)+" l"),r.push(U(n.x4.x)+" "+U(n.x4.y)+" m"),r.push(U(n.x3.x)+" "+U(n.x3.y)+" l"),r.push("s"),r.push("Q"),t.stream=r.join(`
`),t},YesPushDown:function(e){var t=G(e);t.scope=e.scope;var r=xt.internal.calculateCross(e),n=[];return n.push("0.749023 g"),n.push("0 0 "+U(xt.internal.getWidth(e))+" "+U(xt.internal.getHeight(e))+" re"),n.push("f"),n.push("q"),n.push("1 1 "+U(xt.internal.getWidth(e)-2)+" "+U(xt.internal.getHeight(e)-2)+" re"),n.push("W"),n.push("n"),n.push(U(r.x1.x)+" "+U(r.x1.y)+" m"),n.push(U(r.x2.x)+" "+U(r.x2.y)+" l"),n.push(U(r.x4.x)+" "+U(r.x4.y)+" m"),n.push(U(r.x3.x)+" "+U(r.x3.y)+" l"),n.push("s"),n.push("Q"),t.stream=n.join(`
`),t},OffPushDown:function(e){var t=G(e);t.scope=e.scope;var r=[];return r.push("0.749023 g"),r.push("0 0 "+U(xt.internal.getWidth(e))+" "+U(xt.internal.getHeight(e))+" re"),r.push("f"),t.stream=r.join(`
`),t}}},createDefaultAppearanceStream:function(e){var t=e.scope.internal.getFont(e.fontName,e.fontStyle).id,r=e.scope.__private__.encodeColorString(e.color);return"/"+t+" "+e.fontSize+" Tf "+r}};xt.internal={Bezier_C:.551915024494,calculateCross:function(e){var t=xt.internal.getWidth(e),r=xt.internal.getHeight(e),n=Math.min(t,r);return{x1:{x:(t-n)/2,y:(r-n)/2+n},x2:{x:(t-n)/2+n,y:(r-n)/2},x3:{x:(t-n)/2,y:(r-n)/2},x4:{x:(t-n)/2+n,y:(r-n)/2+n}}}},xt.internal.getWidth=function(e){var t=0;return _typeof(e)==="object"&&(t=V(e.Rect[2])),t},xt.internal.getHeight=function(e){var t=0;return _typeof(e)==="object"&&(t=V(e.Rect[3])),t};var At=R.addField=function(e){if(at(this,e),!(e instanceof ht))throw new Error("Invalid argument passed to jsPDF.addField.");var t;return(t=e).scope.internal.acroformPlugin.printedOut&&(t.scope.internal.acroformPlugin.printedOut=!1,t.scope.internal.acroformPlugin.acroFormDictionaryRoot=null),t.scope.internal.acroformPlugin.acroFormDictionaryRoot.Fields.push(t),e.page=e.scope.internal.getCurrentPageInfo().pageNumber,this};R.AcroFormChoiceField=ft,R.AcroFormListBox=dt,R.AcroFormComboBox=pt,R.AcroFormEditBox=gt,R.AcroFormButton=mt,R.AcroFormPushButton=vt,R.AcroFormRadioButton=bt,R.AcroFormCheckBox=wt,R.AcroFormTextField=Nt,R.AcroFormPasswordField=Lt,R.AcroFormAppearance=xt,R.AcroForm={ChoiceField:ft,ListBox:dt,ComboBox:pt,EditBox:gt,Button:mt,PushButton:vt,RadioButton:bt,CheckBox:wt,TextField:Nt,PasswordField:Lt,Appearance:xt},E.AcroForm={ChoiceField:ft,ListBox:dt,ComboBox:pt,EditBox:gt,Button:mt,PushButton:vt,RadioButton:bt,CheckBox:wt,TextField:Nt,PasswordField:Lt,Appearance:xt};E.AcroForm;function _t(e){return e.reduce(function(t,r,n){return t[r]=n,t},{})}(function(e){var t="addImage_";e.__addimage__={};var r="UNKNOWN",n={PNG:[[137,80,78,71]],TIFF:[[77,77,0,42],[73,73,42,0]],JPEG:[[255,216,255,224,void 0,void 0,74,70,73,70,0],[255,216,255,225,void 0,void 0,69,120,105,102,0,0],[255,216,255,219],[255,216,255,238]],JPEG2000:[[0,0,0,12,106,80,32,32]],GIF87a:[[71,73,70,56,55,97]],GIF89a:[[71,73,70,56,57,97]],WEBP:[[82,73,70,70,void 0,void 0,void 0,void 0,87,69,66,80]],BMP:[[66,77],[66,65],[67,73],[67,80],[73,67],[80,84]]},Ee=e.__addimage__.getImageFileTypeByImageData=function(mr,wr){var Fr,Mr,Hr,Nr,Ar,xr=r;if((wr=wr||r)==="RGBA"||mr.data!==void 0&&mr.data instanceof Uint8ClampedArray&&"height"in mr&&"width"in mr)return"RGBA";if(hr(mr))for(Ar in n)for(Hr=n[Ar],Fr=0;Fr<Hr.length;Fr+=1){for(Nr=!0,Mr=0;Mr<Hr[Fr].length;Mr+=1)if(Hr[Fr][Mr]!==void 0&&Hr[Fr][Mr]!==mr[Mr]){Nr=!1;break}if(Nr===!0){xr=Ar;break}}else for(Ar in n)for(Hr=n[Ar],Fr=0;Fr<Hr.length;Fr+=1){for(Nr=!0,Mr=0;Mr<Hr[Fr].length;Mr+=1)if(Hr[Fr][Mr]!==void 0&&Hr[Fr][Mr]!==mr.charCodeAt(Mr)){Nr=!1;break}if(Nr===!0){xr=Ar;break}}return xr===r&&wr!==r&&(xr=wr),xr},Ce=function mr(wr){for(var Fr=this.internal.write,Mr=this.internal.putStream,Hr=(0,this.internal.getFilters)();Hr.indexOf("FlateEncode")!==-1;)Hr.splice(Hr.indexOf("FlateEncode"),1);wr.objectId=this.internal.newObject();var Nr=[];if(Nr.push({key:"Type",value:"/XObject"}),Nr.push({key:"Subtype",value:"/Image"}),Nr.push({key:"Width",value:wr.width}),Nr.push({key:"Height",value:wr.height}),wr.colorSpace===Ke.INDEXED?Nr.push({key:"ColorSpace",value:"[/Indexed /DeviceRGB "+(wr.palette.length/3-1)+" "+("sMask"in wr&&wr.sMask!==void 0?wr.objectId+2:wr.objectId+1)+" 0 R]"}):(Nr.push({key:"ColorSpace",value:"/"+wr.colorSpace}),wr.colorSpace===Ke.DEVICE_CMYK&&Nr.push({key:"Decode",value:"[1 0 1 0 1 0 1 0]"})),Nr.push({key:"BitsPerComponent",value:wr.bitsPerComponent}),"decodeParameters"in wr&&wr.decodeParameters!==void 0&&Nr.push({key:"DecodeParms",value:"<<"+wr.decodeParameters+">>"}),"transparency"in wr&&Array.isArray(wr.transparency)&&wr.transparency.length>0){for(var Ar="",xr=0,ir=wr.transparency.length;xr<ir;xr++)Ar+=wr.transparency[xr]+" "+wr.transparency[xr]+" ";Nr.push({key:"Mask",value:"["+Ar+"]"})}wr.sMask!==void 0&&Nr.push({key:"SMask",value:wr.objectId+1+" 0 R"});var _r=wr.filter!==void 0?["/"+wr.filter]:void 0;if(Mr({data:wr.data,additionalKeyValues:Nr,alreadyAppliedFilters:_r,objectId:wr.objectId}),Fr("endobj"),"sMask"in wr&&wr.sMask!==void 0){var ur,Je=(ur=wr.sMaskBitsPerComponent)!==null&&ur!==void 0?ur:wr.bitsPerComponent,nr={width:wr.width,height:wr.height,colorSpace:"DeviceGray",bitsPerComponent:Je,data:wr.sMask};"filter"in wr&&(nr.decodeParameters="/Predictor ".concat(wr.predictor," /Colors 1 /BitsPerComponent ").concat(Je," /Columns ").concat(wr.width),nr.filter=wr.filter),mr.call(this,nr)}if(wr.colorSpace===Ke.INDEXED){var or=this.internal.newObject();Mr({data:yr(new Uint8Array(wr.palette)),objectId:or}),Fr("endobj")}},De=function(){var mr=this.internal.collections[t+"images"];for(var wr in mr)Ce.call(this,mr[wr])},Me=function(){var mr,wr=this.internal.collections[t+"images"],Fr=this.internal.write;for(var Mr in wr)Fr("/I"+(mr=wr[Mr]).index,mr.objectId,"0","R")},ze=function(){this.internal.collections[t+"images"]||(this.internal.collections[t+"images"]={},this.internal.events.subscribe("putResources",De),this.internal.events.subscribe("putXobjectDict",Me))},Oe=function(){var mr=this.internal.collections[t+"images"];return ze.call(this),mr},Be=function(){return Object.keys(this.internal.collections[t+"images"]).length},He=function(mr){return typeof e["process"+mr.toUpperCase()]=="function"},Ve=function(mr){return _typeof(mr)==="object"&&mr.nodeType===1},Xe=function(mr,wr){if(mr.nodeName==="IMG"&&mr.hasAttribute("src")){var Fr=""+mr.getAttribute("src");if(Fr.indexOf("data:image/")===0)return f(unescape(Fr).split("base64,").pop());var Mr=e.loadFile(Fr,!0);if(Mr!==void 0)return Mr}if(mr.nodeName==="CANVAS"){if(mr.width===0||mr.height===0)throw new Error("Given canvas must have data. Canvas width: "+mr.width+", height: "+mr.height);var Hr;switch(wr){case"PNG":Hr="image/png";break;case"WEBP":Hr="image/webp";break;default:Hr="image/jpeg"}return f(mr.toDataURL(Hr,1).split("base64,").pop())}},We=function(mr){var wr=this.internal.collections[t+"images"];if(wr){for(var Fr in wr)if(mr===wr[Fr].alias)return wr[Fr]}},Ge=function(mr,wr,Fr){return mr||wr||(mr=-96,wr=-96),mr<0&&(mr=-1*Fr.width*72/mr/this.internal.scaleFactor),wr<0&&(wr=-1*Fr.height*72/wr/this.internal.scaleFactor),mr===0&&(mr=wr*Fr.width/Fr.height),wr===0&&(wr=mr*Fr.height/Fr.width),[mr,wr]},$e=function(mr,wr,Fr,Mr,Hr,Nr){var Ar=Ge.call(this,Fr,Mr,Hr),xr=this.internal.getCoordinateString,ir=this.internal.getVerticalCoordinateString,_r=Oe.call(this);if(Fr=Ar[0],Mr=Ar[1],_r[Hr.index]=Hr,Nr){Nr*=Math.PI/180;var ur=Math.cos(Nr),Je=Math.sin(Nr),nr=function(lr){return lr.toFixed(4)},or=[nr(ur),nr(Je),nr(-1*Je),nr(ur),0,0,"cm"]}this.internal.write("q"),Nr?(this.internal.write([1,"0","0",1,xr(mr),ir(wr+Mr),"cm"].join(" ")),this.internal.write(or.join(" ")),this.internal.write([xr(Fr),"0","0",xr(Mr),"0","0","cm"].join(" "))):this.internal.write([xr(Fr),"0","0",xr(Mr),xr(mr),ir(wr+Mr),"cm"].join(" ")),this.isAdvancedAPI()&&this.internal.write([1,0,0,-1,0,0,"cm"].join(" ")),this.internal.write("/I"+Hr.index+" Do"),this.internal.write("Q")},Ke=e.color_spaces={DEVICE_RGB:"DeviceRGB",DEVICE_GRAY:"DeviceGray",DEVICE_CMYK:"DeviceCMYK",CAL_GREY:"CalGray",CAL_RGB:"CalRGB",LAB:"Lab",ICC_BASED:"ICCBased",INDEXED:"Indexed",PATTERN:"Pattern",SEPARATION:"Separation",DEVICE_N:"DeviceN"};e.decode={DCT_DECODE:"DCTDecode",FLATE_DECODE:"FlateDecode",LZW_DECODE:"LZWDecode",JPX_DECODE:"JPXDecode",JBIG2_DECODE:"JBIG2Decode",ASCII85_DECODE:"ASCII85Decode",ASCII_HEX_DECODE:"ASCIIHexDecode",RUN_LENGTH_DECODE:"RunLengthDecode",CCITT_FAX_DECODE:"CCITTFaxDecode"};var rr=e.image_compression={NONE:"NONE",FAST:"FAST",MEDIUM:"MEDIUM",SLOW:"SLOW"},tr=e.__addimage__.sHashCode=function(mr){var wr,Fr,Mr=0;if(typeof mr=="string")for(Fr=mr.length,wr=0;wr<Fr;wr++)Mr=(Mr<<5)-Mr+mr.charCodeAt(wr),Mr|=0;else if(hr(mr))for(Fr=mr.byteLength/2,wr=0;wr<Fr;wr++)Mr=(Mr<<5)-Mr+mr[wr],Mr|=0;return Mr},sr=e.__addimage__.validateStringAsBase64=function(mr){(mr=mr||"").toString().trim();var wr=!0;return mr.length===0&&(wr=!1),mr.length%4!=0&&(wr=!1),/^[A-Za-z0-9+/]+$/.test(mr.substr(0,mr.length-2))===!1&&(wr=!1),/^[A-Za-z0-9/][A-Za-z0-9+/]|[A-Za-z0-9+/]=|==$/.test(mr.substr(-2))===!1&&(wr=!1),wr},ar=e.__addimage__.extractImageFromDataUrl=function(mr){if(mr==null||!(mr=mr.trim()).startsWith("data:"))return null;var wr=mr.indexOf(",");return wr<0?null:mr.substring(0,wr).trim().endsWith("base64")?mr.substring(wr+1):null};e.__addimage__.isArrayBuffer=function(mr){return mr instanceof ArrayBuffer};var hr=e.__addimage__.isArrayBufferView=function(mr){return mr instanceof Int8Array||mr instanceof Uint8Array||mr instanceof Uint8ClampedArray||mr instanceof Int16Array||mr instanceof Uint16Array||mr instanceof Int32Array||mr instanceof Uint32Array||mr instanceof Float32Array||mr instanceof Float64Array},pr=e.__addimage__.binaryStringToUint8Array=function(mr){for(var wr=mr.length,Fr=new Uint8Array(wr),Mr=0;Mr<wr;Mr++)Fr[Mr]=mr.charCodeAt(Mr);return Fr},yr=e.__addimage__.arrayBufferToBinaryString=function(mr){for(var wr="",Fr=hr(mr)?mr:new Uint8Array(mr),Mr=0;Mr<Fr.length;Mr+=8192)wr+=String.fromCharCode.apply(null,Fr.subarray(Mr,Mr+8192));return wr};e.addImage=function(){var mr,wr,Fr,Mr,Hr,Nr,Ar,xr,ir;if(typeof arguments[1]=="number"?(wr=r,Fr=arguments[1],Mr=arguments[2],Hr=arguments[3],Nr=arguments[4],Ar=arguments[5],xr=arguments[6],ir=arguments[7]):(wr=arguments[1],Fr=arguments[2],Mr=arguments[3],Hr=arguments[4],Nr=arguments[5],Ar=arguments[6],xr=arguments[7],ir=arguments[8]),_typeof(mr=arguments[0])==="object"&&!Ve(mr)&&"imageData"in mr){var _r=mr;mr=_r.imageData,wr=_r.format||wr||r,Fr=_r.x||Fr||0,Mr=_r.y||Mr||0,Hr=_r.w||_r.width||Hr,Nr=_r.h||_r.height||Nr,Ar=_r.alias||Ar,xr=_r.compression||xr,ir=_r.rotation||_r.angle||ir}var ur=this.internal.getFilters();if(xr===void 0&&ur.indexOf("FlateEncode")!==-1&&(xr="SLOW"),isNaN(Fr)||isNaN(Mr))throw new Error("Invalid coordinates passed to jsPDF.addImage");ze.call(this);var Je=fr.call(this,mr,wr,Ar,xr);return $e.call(this,Fr,Mr,Hr,Nr,Je,ir),this};var fr=function(mr,wr,Fr,Mr){var Hr,Nr,Ar;if(typeof mr=="string"&&Ee(mr)===r){mr=unescape(mr);var xr=Rr(mr,!1);(xr!==""||(xr=e.loadFile(mr,!0))!==void 0)&&(mr=xr)}if(Ve(mr)&&(mr=Xe(mr,wr)),wr=Ee(mr,wr),!He(wr))throw new Error("addImage does not support files of type '"+wr+"', please ensure that a plugin for '"+wr+"' support is added.");if(((Ar=Fr)==null||Ar.length===0)&&(Fr=(function(ir){return typeof ir=="string"||hr(ir)?tr(ir):hr(ir.data)?tr(ir.data):null})(mr)),(Hr=We.call(this,Fr))||(mr instanceof Uint8Array||wr==="RGBA"||(Nr=mr,mr=pr(mr)),Hr=this["process"+wr.toUpperCase()](mr,Be.call(this),Fr,(function(ir){return ir&&typeof ir=="string"&&(ir=ir.toUpperCase()),ir in e.image_compression?ir:rr.NONE})(Mr),Nr)),!Hr)throw new Error("An unknown error occurred whilst processing the image.");return Hr},Rr=e.__addimage__.convertBase64ToBinaryString=function(mr,wr){wr=typeof wr!="boolean"||wr;var Fr,Mr="";if(typeof mr=="string"){var Hr;Fr=(Hr=ar(mr))!==null&&Hr!==void 0?Hr:mr;try{Mr=f(Fr)}catch(Nr){if(wr)throw sr(Fr)?new Error("atob-Error in jsPDF.convertBase64ToBinaryString "+Nr.message):new Error("Supplied Data is not a valid base64-String jsPDF.convertBase64ToBinaryString ")}}return Mr};e.getImageProperties=function(mr){var wr,Fr,Mr="";if(Ve(mr)&&(mr=Xe(mr)),typeof mr=="string"&&Ee(mr)===r&&((Mr=Rr(mr,!1))===""&&(Mr=e.loadFile(mr)||""),mr=Mr),Fr=Ee(mr),!He(Fr))throw new Error("addImage does not support files of type '"+Fr+"', please ensure that a plugin for '"+Fr+"' support is added.");if(mr instanceof Uint8Array||(mr=pr(mr)),!(wr=this["process"+Fr.toUpperCase()](mr)))throw new Error("An unknown error occurred whilst processing the image");return wr.fileType=Fr,wr}})(E.API),(function(e){var t=function(r){if(r!==void 0&&r!="")return!0};E.API.events.push(["addPage",function(r){this.internal.getPageInfo(r.pageNumber).pageContext.annotations=[]}]),e.events.push(["putPage",function(r){for(var n,Ee,Ce,De=this.internal.getCoordinateString,Me=this.internal.getVerticalCoordinateString,ze=this.internal.getPageInfoByObjId(r.objId),Oe=r.pageContext.annotations,Be=!1,He=0;He<Oe.length&&!Be;He++)switch((n=Oe[He]).type){case"link":(t(n.options.url)||t(n.options.pageNumber))&&(Be=!0);break;case"reference":case"text":case"freetext":Be=!0}if(Be!=0){this.internal.write("/Annots [");for(var Ve=0;Ve<Oe.length;Ve++){n=Oe[Ve];var Xe=this.internal.pdfEscape,We=this.internal.getEncryptor(r.objId);switch(n.type){case"reference":this.internal.write(" "+n.object.objId+" 0 R ");break;case"text":var Ge=this.internal.newAdditionalObject(),$e=this.internal.newAdditionalObject(),Ke=this.internal.getEncryptor(Ge.objId),rr=n.title||"Note";Ce="<</Type /Annot /Subtype /Text "+(Ee="/Rect ["+De(n.bounds.x)+" "+Me(n.bounds.y+n.bounds.h)+" "+De(n.bounds.x+n.bounds.w)+" "+Me(n.bounds.y)+"] ")+"/Contents ("+Xe(Ke(n.contents))+")",Ce+=" /Popup "+$e.objId+" 0 R",Ce+=" /P "+ze.objId+" 0 R",Ce+=" /T ("+Xe(Ke(rr))+") >>",Ge.content=Ce;var tr=Ge.objId+" 0 R";Ce="<</Type /Annot /Subtype /Popup "+(Ee="/Rect ["+De(n.bounds.x+30)+" "+Me(n.bounds.y+n.bounds.h)+" "+De(n.bounds.x+n.bounds.w+30)+" "+Me(n.bounds.y)+"] ")+" /Parent "+tr,n.open&&(Ce+=" /Open true"),Ce+=" >>",$e.content=Ce,this.internal.write(Ge.objId,"0 R",$e.objId,"0 R");break;case"freetext":Ee="/Rect ["+De(n.bounds.x)+" "+Me(n.bounds.y)+" "+De(n.bounds.x+n.bounds.w)+" "+Me(n.bounds.y+n.bounds.h)+"] ";var sr=n.color||"#000000";Ce="<</Type /Annot /Subtype /FreeText "+Ee+"/Contents ("+Xe(We(n.contents))+")",Ce+=" /DS(font: Helvetica,sans-serif 12.0pt; text-align:left; color:#"+sr+")",Ce+=" /Border [0 0 0]",Ce+=" >>",this.internal.write(Ce);break;case"link":if(n.options.name){var ar=this.annotations._nameMap[n.options.name];n.options.pageNumber=ar.page,n.options.top=ar.y}else n.options.top||(n.options.top=0);if(Ee="/Rect ["+n.finalBounds.x+" "+n.finalBounds.y+" "+n.finalBounds.w+" "+n.finalBounds.h+"] ",Ce="",n.options.url)Ce="<</Type /Annot /Subtype /Link "+Ee+"/Border [0 0 0] /A <</S /URI /URI ("+Xe(We(n.options.url))+") >>";else if(n.options.pageNumber)switch(Ce="<</Type /Annot /Subtype /Link "+Ee+"/Border [0 0 0] /Dest ["+this.internal.getPageInfo(n.options.pageNumber).objId+" 0 R",n.options.magFactor=n.options.magFactor||"XYZ",n.options.magFactor){case"Fit":Ce+=" /Fit]";break;case"FitH":Ce+=" /FitH "+n.options.top+"]";break;case"FitV":n.options.left=n.options.left||0,Ce+=" /FitV "+n.options.left+"]";break;default:var hr=Me(n.options.top);n.options.left=n.options.left||0,n.options.zoom===void 0&&(n.options.zoom=0),Ce+=" /XYZ "+n.options.left+" "+hr+" "+n.options.zoom+"]"}Ce!=""&&(Ce+=" >>",this.internal.write(Ce))}}this.internal.write("]")}}]),e.createAnnotation=function(r){var n=this.internal.getCurrentPageInfo();switch(r.type){case"link":this.link(r.bounds.x,r.bounds.y,r.bounds.w,r.bounds.h,r);break;case"text":case"freetext":n.pageContext.annotations.push(r)}},e.link=function(r,n,Ee,Ce,De){var Me=this.internal.getCurrentPageInfo(),ze=this.internal.getCoordinateString,Oe=this.internal.getVerticalCoordinateString;Me.pageContext.annotations.push({finalBounds:{x:ze(r),y:Oe(n),w:ze(r+Ee),h:Oe(n+Ce)},options:De,type:"link"})},e.textWithLink=function(r,n,Ee,Ce){var De,Me,ze=this.getTextWidth(r),Oe=this.internal.getLineHeight()/this.internal.scaleFactor;if(Ce.maxWidth!==void 0){Me=Ce.maxWidth;var Be=this.splitTextToSize(r,Me).length;De=Math.ceil(Oe*Be)}else Me=ze,De=Oe;return this.text(r,n,Ee,Ce),Ee+=.2*Oe,Ce.align==="center"&&(n-=ze/2),Ce.align==="right"&&(n-=ze),this.link(n,Ee-Oe,Me,De,Ce),ze},e.getTextWidth=function(r){var n=this.internal.getFontSize();return this.getStringUnitWidth(r)*n/this.internal.scaleFactor}})(E.API),(function(e){var t={1569:[65152],1570:[65153,65154],1571:[65155,65156],1572:[65157,65158],1573:[65159,65160],1574:[65161,65162,65163,65164],1575:[65165,65166],1576:[65167,65168,65169,65170],1577:[65171,65172],1578:[65173,65174,65175,65176],1579:[65177,65178,65179,65180],1580:[65181,65182,65183,65184],1581:[65185,65186,65187,65188],1582:[65189,65190,65191,65192],1583:[65193,65194],1584:[65195,65196],1585:[65197,65198],1586:[65199,65200],1587:[65201,65202,65203,65204],1588:[65205,65206,65207,65208],1589:[65209,65210,65211,65212],1590:[65213,65214,65215,65216],1591:[65217,65218,65219,65220],1592:[65221,65222,65223,65224],1593:[65225,65226,65227,65228],1594:[65229,65230,65231,65232],1601:[65233,65234,65235,65236],1602:[65237,65238,65239,65240],1603:[65241,65242,65243,65244],1604:[65245,65246,65247,65248],1605:[65249,65250,65251,65252],1606:[65253,65254,65255,65256],1607:[65257,65258,65259,65260],1608:[65261,65262],1609:[65263,65264,64488,64489],1610:[65265,65266,65267,65268],1649:[64336,64337],1655:[64477],1657:[64358,64359,64360,64361],1658:[64350,64351,64352,64353],1659:[64338,64339,64340,64341],1662:[64342,64343,64344,64345],1663:[64354,64355,64356,64357],1664:[64346,64347,64348,64349],1667:[64374,64375,64376,64377],1668:[64370,64371,64372,64373],1670:[64378,64379,64380,64381],1671:[64382,64383,64384,64385],1672:[64392,64393],1676:[64388,64389],1677:[64386,64387],1678:[64390,64391],1681:[64396,64397],1688:[64394,64395],1700:[64362,64363,64364,64365],1702:[64366,64367,64368,64369],1705:[64398,64399,64400,64401],1709:[64467,64468,64469,64470],1711:[64402,64403,64404,64405],1713:[64410,64411,64412,64413],1715:[64406,64407,64408,64409],1722:[64414,64415],1723:[64416,64417,64418,64419],1726:[64426,64427,64428,64429],1728:[64420,64421],1729:[64422,64423,64424,64425],1733:[64480,64481],1734:[64473,64474],1735:[64471,64472],1736:[64475,64476],1737:[64482,64483],1739:[64478,64479],1740:[64508,64509,64510,64511],1744:[64484,64485,64486,64487],1746:[64430,64431],1747:[64432,64433]},r={65247:{65154:65269,65156:65271,65160:65273,65166:65275},65248:{65154:65270,65156:65272,65160:65274,65166:65276},65165:{65247:{65248:{65258:65010}}},1617:{1612:64606,1613:64607,1614:64608,1615:64609,1616:64610}},n={1612:64606,1613:64607,1614:64608,1615:64609,1616:64610},Ee=[1570,1571,1573,1575];e.__arabicParser__={};var Ce=e.__arabicParser__.isInArabicSubstitutionA=function(Ge){return t[Ge.charCodeAt(0)]!==void 0},De=e.__arabicParser__.isArabicLetter=function(Ge){return typeof Ge=="string"&&/^[\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]+$/.test(Ge)},Me=e.__arabicParser__.isArabicEndLetter=function(Ge){return De(Ge)&&Ce(Ge)&&t[Ge.charCodeAt(0)].length<=2},ze=e.__arabicParser__.isArabicAlfLetter=function(Ge){return De(Ge)&&Ee.indexOf(Ge.charCodeAt(0))>=0};e.__arabicParser__.arabicLetterHasIsolatedForm=function(Ge){return De(Ge)&&Ce(Ge)&&t[Ge.charCodeAt(0)].length>=1};var Oe=e.__arabicParser__.arabicLetterHasFinalForm=function(Ge){return De(Ge)&&Ce(Ge)&&t[Ge.charCodeAt(0)].length>=2};e.__arabicParser__.arabicLetterHasInitialForm=function(Ge){return De(Ge)&&Ce(Ge)&&t[Ge.charCodeAt(0)].length>=3};var Be=e.__arabicParser__.arabicLetterHasMedialForm=function(Ge){return De(Ge)&&Ce(Ge)&&t[Ge.charCodeAt(0)].length==4},He=e.__arabicParser__.resolveLigatures=function(Ge){var $e=0,Ke=r,rr="",tr=0;for($e=0;$e<Ge.length;$e+=1)Ke[Ge.charCodeAt($e)]!==void 0?(tr++,typeof(Ke=Ke[Ge.charCodeAt($e)])=="number"&&(rr+=String.fromCharCode(Ke),Ke=r,tr=0),$e===Ge.length-1&&(Ke=r,rr+=Ge.charAt($e-(tr-1)),$e-=tr-1,tr=0)):(Ke=r,rr+=Ge.charAt($e-tr),$e-=tr,tr=0);return rr};e.__arabicParser__.isArabicDiacritic=function(Ge){return Ge!==void 0&&n[Ge.charCodeAt(0)]!==void 0};var Ve=e.__arabicParser__.getCorrectForm=function(Ge,$e,Ke){return De(Ge)?Ce(Ge)===!1?-1:!Oe(Ge)||!De($e)&&!De(Ke)||!De(Ke)&&Me($e)||Me(Ge)&&!De($e)||Me(Ge)&&ze($e)||Me(Ge)&&Me($e)?0:Be(Ge)&&De($e)&&!Me($e)&&De(Ke)&&Oe(Ke)?3:Me(Ge)||!De(Ke)?1:2:-1},Xe=function(Ge){var $e=0,Ke=0,rr=0,tr="",sr="",ar="",hr=(Ge=Ge||"").split("\\s+"),pr=[];for($e=0;$e<hr.length;$e+=1){for(pr.push(""),Ke=0;Ke<hr[$e].length;Ke+=1)tr=hr[$e][Ke],sr=hr[$e][Ke-1],ar=hr[$e][Ke+1],De(tr)?(rr=Ve(tr,sr,ar),pr[$e]+=rr!==-1?String.fromCharCode(t[tr.charCodeAt(0)][rr]):tr):pr[$e]+=tr;pr[$e]=He(pr[$e])}return pr.join(" ")},We=e.__arabicParser__.processArabic=e.processArabic=function(){var Ge,$e=typeof arguments[0]=="string"?arguments[0]:arguments[0].text,Ke=[];if(Array.isArray($e)){var rr=0;for(Ke=[],rr=0;rr<$e.length;rr+=1)Array.isArray($e[rr])?Ke.push([Xe($e[rr][0]),$e[rr][1],$e[rr][2]]):Ke.push([Xe($e[rr])]);Ge=Ke}else Ge=Xe($e);return typeof arguments[0]=="string"?Ge:(arguments[0].text=Ge,arguments[0])};e.events.push(["preProcessText",We])})(E.API),E.API.autoPrint=function(e){var t;return(e=e||{}).variant=e.variant||"non-conform",e.variant==="javascript"?this.addJS("print({});"):(this.internal.events.subscribe("postPutResources",function(){t=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /Named"),this.internal.out("/Type /Action"),this.internal.out("/N /Print"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){this.internal.out("/OpenAction "+t+" 0 R")})),this},(function(e){var t=function(){var r=void 0;Object.defineProperty(this,"pdf",{get:function(){return r},set:function(Me){r=Me}});var n=150;Object.defineProperty(this,"width",{get:function(){return n},set:function(Me){n=isNaN(Me)||Number.isInteger(Me)===!1||Me<0?150:Me,this.getContext("2d").pageWrapXEnabled&&(this.getContext("2d").pageWrapX=n+1)}});var Ee=300;Object.defineProperty(this,"height",{get:function(){return Ee},set:function(Me){Ee=isNaN(Me)||Number.isInteger(Me)===!1||Me<0?300:Me,this.getContext("2d").pageWrapYEnabled&&(this.getContext("2d").pageWrapY=Ee+1)}});var Ce=[];Object.defineProperty(this,"childNodes",{get:function(){return Ce},set:function(Me){Ce=Me}});var De={};Object.defineProperty(this,"style",{get:function(){return De},set:function(Me){De=Me}}),Object.defineProperty(this,"parentNode",{})};t.prototype.getContext=function(r,n){var Ee;if((r=r||"2d")!=="2d")return null;for(Ee in n)this.pdf.context2d.hasOwnProperty(Ee)&&(this.pdf.context2d[Ee]=n[Ee]);return this.pdf.context2d._canvas=this,this.pdf.context2d},t.prototype.toDataURL=function(){throw new Error("toDataURL is not implemented.")},e.events.push(["initialized",function(){this.canvas=new t,this.canvas.pdf=this}])})(E.API),(function(e){var t={left:0,top:0,bottom:0,right:0},r=!1,n=function(){this.internal.__cell__===void 0&&(this.internal.__cell__={},this.internal.__cell__.padding=3,this.internal.__cell__.headerFunction=void 0,this.internal.__cell__.margins=Object.assign({},t),this.internal.__cell__.margins.width=this.getPageWidth(),Ee.call(this))},Ee=function(){this.internal.__cell__.lastCell=new Ce,this.internal.__cell__.pages=1},Ce=function(){var ze=arguments[0];Object.defineProperty(this,"x",{enumerable:!0,get:function(){return ze},set:function(Ge){ze=Ge}});var Oe=arguments[1];Object.defineProperty(this,"y",{enumerable:!0,get:function(){return Oe},set:function(Ge){Oe=Ge}});var Be=arguments[2];Object.defineProperty(this,"width",{enumerable:!0,get:function(){return Be},set:function(Ge){Be=Ge}});var He=arguments[3];Object.defineProperty(this,"height",{enumerable:!0,get:function(){return He},set:function(Ge){He=Ge}});var Ve=arguments[4];Object.defineProperty(this,"text",{enumerable:!0,get:function(){return Ve},set:function(Ge){Ve=Ge}});var Xe=arguments[5];Object.defineProperty(this,"lineNumber",{enumerable:!0,get:function(){return Xe},set:function(Ge){Xe=Ge}});var We=arguments[6];return Object.defineProperty(this,"align",{enumerable:!0,get:function(){return We},set:function(Ge){We=Ge}}),this};Ce.prototype.clone=function(){return new Ce(this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align)},Ce.prototype.toArray=function(){return[this.x,this.y,this.width,this.height,this.text,this.lineNumber,this.align]},e.setHeaderFunction=function(ze){return n.call(this),this.internal.__cell__.headerFunction=typeof ze=="function"?ze:void 0,this},e.getTextDimensions=function(ze,Oe){n.call(this);var Be=(Oe=Oe||{}).fontSize||this.getFontSize(),He=Oe.font||this.getFont(),Ve=Oe.scaleFactor||this.internal.scaleFactor,Xe=0,We=0,Ge=0,$e=this;if(!Array.isArray(ze)&&typeof ze!="string"){if(typeof ze!="number")throw new Error("getTextDimensions expects text-parameter to be of type String or type Number or an Array of Strings.");ze=String(ze)}var Ke=Oe.maxWidth;Ke>0?typeof ze=="string"?ze=this.splitTextToSize(ze,Ke):Object.prototype.toString.call(ze)==="[object Array]"&&(ze=ze.reduce(function(tr,sr){return tr.concat($e.splitTextToSize(sr,Ke))},[])):ze=Array.isArray(ze)?ze:[ze];for(var rr=0;rr<ze.length;rr++)Xe<(Ge=this.getStringUnitWidth(ze[rr],{font:He})*Be)&&(Xe=Ge);return Xe!==0&&(We=ze.length),{w:Xe/=Ve,h:Math.max((We*Be*this.getLineHeightFactor()-Be*(this.getLineHeightFactor()-1))/Ve,0)}},e.cellAddPage=function(){n.call(this),this.addPage();var ze=this.internal.__cell__.margins||t;return this.internal.__cell__.lastCell=new Ce(ze.left,ze.top,void 0,void 0),this.internal.__cell__.pages+=1,this};var De=e.cell=function(){var ze;ze=arguments[0]instanceof Ce?arguments[0]:new Ce(arguments[0],arguments[1],arguments[2],arguments[3],arguments[4],arguments[5],arguments[6]),n.call(this);var Oe=this.internal.__cell__.lastCell,Be=this.internal.__cell__.padding,He=this.internal.__cell__.margins||t,Ve=this.internal.__cell__.tableHeaderRow,Xe=this.internal.__cell__.printHeaders;return Oe.lineNumber!==void 0&&(Oe.lineNumber===ze.lineNumber?(ze.x=(Oe.x||0)+(Oe.width||0),ze.y=Oe.y||0):Oe.y+Oe.height+ze.height+He.bottom>this.getPageHeight()?(this.cellAddPage(),ze.y=He.top,Xe&&Ve&&(this.printHeaderRow(ze.lineNumber,!0),ze.y+=Ve[0].height)):ze.y=Oe.y+Oe.height||ze.y),ze.text[0]!==void 0&&(this.rect(ze.x,ze.y,ze.width,ze.height,r===!0?"FD":void 0),ze.align==="right"?this.text(ze.text,ze.x+ze.width-Be,ze.y+Be,{align:"right",baseline:"top"}):ze.align==="center"?this.text(ze.text,ze.x+ze.width/2,ze.y+Be,{align:"center",baseline:"top",maxWidth:ze.width-Be-Be}):this.text(ze.text,ze.x+Be,ze.y+Be,{align:"left",baseline:"top",maxWidth:ze.width-Be-Be})),this.internal.__cell__.lastCell=ze,this};e.table=function(ze,Oe,Be,He,Ve){if(n.call(this),!Be)throw new Error("No data for PDF table.");var Xe,We,Ge,$e,Ke=[],rr=[],tr=[],sr={},ar={},hr=[],pr=[],yr=(Ve=Ve||{}).autoSize||!1,fr=Ve.printHeaders!==!1,Rr=Ve.css&&Ve.css["font-size"]!==void 0?16*Ve.css["font-size"]:Ve.fontSize||12,mr=Ve.margins||Object.assign({width:this.getPageWidth()},t),wr=typeof Ve.padding=="number"?Ve.padding:3,Fr=Ve.headerBackgroundColor||"#c8c8c8",Mr=Ve.headerTextColor||"#000";if(Ee.call(this),this.internal.__cell__.printHeaders=fr,this.internal.__cell__.margins=mr,this.internal.__cell__.table_font_size=Rr,this.internal.__cell__.padding=wr,this.internal.__cell__.headerBackgroundColor=Fr,this.internal.__cell__.headerTextColor=Mr,this.setFontSize(Rr),He==null)rr=Ke=Object.keys(Be[0]),tr=Ke.map(function(){return"left"});else if(Array.isArray(He)&&_typeof(He[0])==="object")for(Ke=He.map(function(_r){return _r.name}),rr=He.map(function(_r){return _r.prompt||_r.name||""}),tr=He.map(function(_r){return _r.align||"left"}),Xe=0;Xe<He.length;Xe+=1)ar[He[Xe].name]=.7499990551181103*He[Xe].width;else Array.isArray(He)&&typeof He[0]=="string"&&(rr=Ke=He,tr=Ke.map(function(){return"left"}));if(yr||Array.isArray(He)&&typeof He[0]=="string")for(Xe=0;Xe<Ke.length;Xe+=1){for(sr[$e=Ke[Xe]]=Be.map(function(_r){return _r[$e]}),this.setFont(void 0,"bold"),hr.push(this.getTextDimensions(rr[Xe],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w),We=sr[$e],this.setFont(void 0,"normal"),Ge=0;Ge<We.length;Ge+=1)hr.push(this.getTextDimensions(We[Ge],{fontSize:this.internal.__cell__.table_font_size,scaleFactor:this.internal.scaleFactor}).w);ar[$e]=Math.max.apply(null,hr)+wr+wr,hr=[]}if(fr){var Hr={};for(Xe=0;Xe<Ke.length;Xe+=1)Hr[Ke[Xe]]={},Hr[Ke[Xe]].text=rr[Xe],Hr[Ke[Xe]].align=tr[Xe];var Nr=Me.call(this,Hr,ar);pr=Ke.map(function(_r){return new Ce(ze,Oe,ar[_r],Nr,Hr[_r].text,void 0,Hr[_r].align)}),this.setTableHeaderRow(pr),this.printHeaderRow(1,!1)}var Ar=He.reduce(function(_r,ur){return _r[ur.name]=ur.align,_r},{});for(Xe=0;Xe<Be.length;Xe+=1){"rowStart"in Ve&&Ve.rowStart instanceof Function&&Ve.rowStart({row:Xe,data:Be[Xe]},this);var xr=Me.call(this,Be[Xe],ar);for(Ge=0;Ge<Ke.length;Ge+=1){var ir=Be[Xe][Ke[Ge]];"cellStart"in Ve&&Ve.cellStart instanceof Function&&Ve.cellStart({row:Xe,col:Ge,data:ir},this),De.call(this,new Ce(ze,Oe,ar[Ke[Ge]],xr,ir,Xe+2,Ar[Ke[Ge]]))}}return this.internal.__cell__.table_x=ze,this.internal.__cell__.table_y=Oe,this};var Me=function(ze,Oe){var Be=this.internal.__cell__.padding,He=this.internal.__cell__.table_font_size,Ve=this.internal.scaleFactor;return Object.keys(ze).map(function(Xe){var We=ze[Xe];return this.splitTextToSize(We.hasOwnProperty("text")?We.text:We,Oe[Xe]-Be-Be)},this).map(function(Xe){return this.getLineHeightFactor()*Xe.length*He/Ve+Be+Be},this).reduce(function(Xe,We){return Math.max(Xe,We)},0)};e.setTableHeaderRow=function(ze){n.call(this),this.internal.__cell__.tableHeaderRow=ze},e.printHeaderRow=function(ze,Oe){if(n.call(this),!this.internal.__cell__.tableHeaderRow)throw new Error("Property tableHeaderRow does not exist.");var Be;if(r=!0,typeof this.internal.__cell__.headerFunction=="function"){var He=this.internal.__cell__.headerFunction(this,this.internal.__cell__.pages);this.internal.__cell__.lastCell=new Ce(He[0],He[1],He[2],He[3],void 0,-1)}this.setFont(void 0,"bold");for(var Ve=[],Xe=0;Xe<this.internal.__cell__.tableHeaderRow.length;Xe+=1){Be=this.internal.__cell__.tableHeaderRow[Xe].clone(),Oe&&(Be.y=this.internal.__cell__.margins.top||0,Ve.push(Be)),Be.lineNumber=ze;var We=this.getTextColor();this.setTextColor(this.internal.__cell__.headerTextColor),this.setFillColor(this.internal.__cell__.headerBackgroundColor),De.call(this,Be),this.setTextColor(We)}Ve.length>0&&this.setTableHeaderRow(Ve),this.setFont(void 0,"normal"),r=!1}})(E.API);var Pt={italic:["italic","oblique","normal"],oblique:["oblique","italic","normal"],normal:["normal","oblique","italic"]},kt=["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded"],Ft=_t(kt),It=[100,200,300,400,500,600,700,800,900],jt=_t(It);function Ct(e){var t=e.family.replace(/"|'/g,"").toLowerCase(),r=(function(Ce){return Pt[Ce=Ce||"normal"]?Ce:"normal"})(e.style),n=(function(Ce){return Ce?typeof Ce=="number"?Ce>=100&&Ce<=900&&Ce%100==0?Ce:400:/^\d00$/.test(Ce)?parseInt(Ce):Ce==="bold"?700:400:400})(e.weight),Ee=(function(Ce){return typeof Ft[Ce=Ce||"normal"]=="number"?Ce:"normal"})(e.stretch);return{family:t,style:r,weight:n,stretch:Ee,src:e.src||[],ref:e.ref||{name:t,style:[Ee,r,n].join(" ")}}}function Ot(e,t,r,n){var Ee;for(Ee=r;Ee>=0&&Ee<t.length;Ee+=n)if(e[t[Ee]])return e[t[Ee]];for(Ee=r;Ee>=0&&Ee<t.length;Ee-=n)if(e[t[Ee]])return e[t[Ee]]}var Bt={"sans-serif":"helvetica",fixed:"courier",monospace:"courier",terminal:"courier",cursive:"times",fantasy:"times",serif:"times"},Mt={caption:"times",icon:"times",menu:"times","message-box":"times","small-caption":"times","status-bar":"times"};function qt(e){return[e.stretch,e.style,e.weight,e.family].join(" ")}function Et(e){return e.trimLeft()}function Rt(e,t){for(var r=0;r<e.length;){if(e.charAt(r)===t)return[e.substring(0,r),e.substring(r+1)];r+=1}return null}function Dt(e){var t=e.match(/^(-[a-z_]|[a-z_])[a-z0-9_-]*/i);return t===null?null:[t[0],e.substring(t[0].length)]}var Tt,zt,Ut,Ht,Wt,Vt,Gt,Yt,Jt=["times"];function Xt(e,t,r,n,Ee){var Ce=4,De=$t;switch(Ee){case E.API.image_compression.FAST:Ce=1,De=Zt;break;case E.API.image_compression.MEDIUM:Ce=6,De=Qt;break;case E.API.image_compression.SLOW:Ce=9,De=te}e=(function(ze,Oe,Be,He){for(var Ve,Xe=ze.length/Oe,We=new Uint8Array(ze.length+Xe),Ge=[Kt,Zt,$t,Qt,te],$e=0;$e<Xe;$e+=1){var Ke=$e*Oe,rr=ze.subarray(Ke,Ke+Oe);if(He)We.set(He(rr,Be,Ve),Ke+$e);else{for(var tr=Ge.length,sr=[],ar=0;ar<tr;ar+=1)sr[ar]=Ge[ar](rr,Be,Ve);var hr=ne(sr.concat());We.set(sr[hr],Ke+$e)}Ve=rr}return We})(e,t,Math.ceil(r*n/8),De);var Me=zlibSync(e,{level:Ce});return E.API.__addimage__.arrayBufferToBinaryString(Me)}function Kt(e){var t=Array.apply([],e);return t.unshift(0),t}function Zt(e,t){var r=e.length,n=[];n[0]=1;for(var Ee=0;Ee<r;Ee+=1){var Ce=e[Ee-t]||0;n[Ee+1]=e[Ee]-Ce+256&255}return n}function $t(e,t,r){var n=e.length,Ee=[];Ee[0]=2;for(var Ce=0;Ce<n;Ce+=1){var De=r&&r[Ce]||0;Ee[Ce+1]=e[Ce]-De+256&255}return Ee}function Qt(e,t,r){var n=e.length,Ee=[];Ee[0]=3;for(var Ce=0;Ce<n;Ce+=1){var De=e[Ce-t]||0,Me=r&&r[Ce]||0;Ee[Ce+1]=e[Ce]+256-(De+Me>>>1)&255}return Ee}function te(e,t,r){var n=e.length,Ee=[];Ee[0]=4;for(var Ce=0;Ce<n;Ce+=1){var De=ee(e[Ce-t]||0,r&&r[Ce]||0,r&&r[Ce-t]||0);Ee[Ce+1]=e[Ce]-De+256&255}return Ee}function ee(e,t,r){if(e===t&&t===r)return e;var n=Math.abs(t-r),Ee=Math.abs(e-r),Ce=Math.abs(e+t-r-r);return n<=Ee&&n<=Ce?e:Ee<=Ce?t:r}function ne(e){var t=e.map(function(r){return r.reduce(function(n,Ee){return n+Math.abs(Ee)},0)});return t.indexOf(Math.min.apply(null,t))}function re(e,t,r){var n=t*r,Ee=Math.floor(n/8),Ce=16-(n-8*Ee+r),De=(1<<r)-1;return ae(e,Ee)>>Ce&De}function ie(e,t,r,n){var Ee=r*n,Ce=Math.floor(Ee/8),De=16-(Ee-8*Ce+n),Me=(1<<n)-1,ze=(t&Me)<<De;(function(Oe,Be,He){if(Be+1<Oe.byteLength)Oe.setUint16(Be,He,!1);else{var Ve=He>>8&255;Oe.setUint8(Be,Ve)}})(e,Ce,ae(e,Ce)&~(Me<<De)&65535|ze)}function ae(e,t){return t+1<e.byteLength?e.getUint16(t,!1):e.getUint8(t)<<8}function oe(e){var t=0;if(e[t++]!==71||e[t++]!==73||e[t++]!==70||e[t++]!==56||(e[t++]+1&253)!=56||e[t++]!==97)throw new Error("Invalid GIF 87a/89a header.");var r=e[t++]|e[t++]<<8,n=e[t++]|e[t++]<<8,Ee=e[t++],Ce=Ee>>7,De=1<<1+(7&Ee);e[t++],e[t++];var Me=null,ze=null;Ce&&(Me=t,ze=De,t+=3*De);var Oe=!0,Be=[],He=0,Ve=null,Xe=0,We=null;for(this.width=r,this.height=n;Oe&&t<e.length;)switch(e[t++]){case 33:switch(e[t++]){case 255:if(e[t]!==11||e[t+1]==78&&e[t+2]==69&&e[t+3]==84&&e[t+4]==83&&e[t+5]==67&&e[t+6]==65&&e[t+7]==80&&e[t+8]==69&&e[t+9]==50&&e[t+10]==46&&e[t+11]==48&&e[t+12]==3&&e[t+13]==1&&e[t+16]==0)t+=14,We=e[t++]|e[t++]<<8,t++;else for(t+=12;;){if(!((mr=e[t++])>=0))throw Error("Invalid block size");if(mr===0)break;t+=mr}break;case 249:if(e[t++]!==4||e[t+4]!==0)throw new Error("Invalid graphics extension block.");var Ge=e[t++];He=e[t++]|e[t++]<<8,Ve=e[t++],1&Ge||(Ve=null),Xe=Ge>>2&7,t++;break;case 254:for(;;){if(!((mr=e[t++])>=0))throw Error("Invalid block size");if(mr===0)break;t+=mr}break;default:throw new Error("Unknown graphic control label: 0x"+e[t-1].toString(16))}break;case 44:var $e=e[t++]|e[t++]<<8,Ke=e[t++]|e[t++]<<8,rr=e[t++]|e[t++]<<8,tr=e[t++]|e[t++]<<8,sr=e[t++],ar=sr>>6&1,hr=1<<1+(7&sr),pr=Me,yr=ze,fr=!1;sr>>7&&(fr=!0,pr=t,yr=hr,t+=3*hr);var Rr=t;for(t++;;){var mr;if(!((mr=e[t++])>=0))throw Error("Invalid block size");if(mr===0)break;t+=mr}Be.push({x:$e,y:Ke,width:rr,height:tr,has_local_palette:fr,palette_offset:pr,palette_size:yr,data_offset:Rr,data_length:t-Rr,transparent_index:Ve,interlaced:!!ar,delay:He,disposal:Xe});break;case 59:Oe=!1;break;default:throw new Error("Unknown gif block: 0x"+e[t-1].toString(16))}this.numFrames=function(){return Be.length},this.loopCount=function(){return We},this.frameInfo=function(wr){if(wr<0||wr>=Be.length)throw new Error("Frame index out of range.");return Be[wr]},this.decodeAndBlitFrameBGRA=function(wr,Fr){var Mr=this.frameInfo(wr),Hr=Mr.width*Mr.height,Nr=new Uint8Array(Hr);se(e,Mr.data_offset,Nr,Hr);var Ar=Mr.palette_offset,xr=Mr.transparent_index;xr===null&&(xr=256);var ir=Mr.width,_r=r-ir,ur=ir,Je=4*(Mr.y*r+Mr.x),nr=4*((Mr.y+Mr.height)*r+Mr.x),or=Je,lr=4*_r;Mr.interlaced===!0&&(lr+=4*r*7);for(var St=8,dr=0,vr=Nr.length;dr<vr;++dr){var br=Nr[dr];if(ur===0&&(ur=ir,(or+=lr)>=nr&&(lr=4*_r+4*r*(St-1),or=Je+(ir+_r)*(St<<1),St>>=1)),br===xr)or+=4;else{var kr=e[Ar+3*br],Pr=e[Ar+3*br+1],Er=e[Ar+3*br+2];Fr[or++]=Er,Fr[or++]=Pr,Fr[or++]=kr,Fr[or++]=255}--ur}},this.decodeAndBlitFrameRGBA=function(wr,Fr){var Mr=this.frameInfo(wr),Hr=Mr.width*Mr.height,Nr=new Uint8Array(Hr);se(e,Mr.data_offset,Nr,Hr);var Ar=Mr.palette_offset,xr=Mr.transparent_index;xr===null&&(xr=256);var ir=Mr.width,_r=r-ir,ur=ir,Je=4*(Mr.y*r+Mr.x),nr=4*((Mr.y+Mr.height)*r+Mr.x),or=Je,lr=4*_r;Mr.interlaced===!0&&(lr+=4*r*7);for(var St=8,dr=0,vr=Nr.length;dr<vr;++dr){var br=Nr[dr];if(ur===0&&(ur=ir,(or+=lr)>=nr&&(lr=4*_r+4*r*(St-1),or=Je+(ir+_r)*(St<<1),St>>=1)),br===xr)or+=4;else{var kr=e[Ar+3*br],Pr=e[Ar+3*br+1],Er=e[Ar+3*br+2];Fr[or++]=kr,Fr[or++]=Pr,Fr[or++]=Er,Fr[or++]=255}--ur}}}function se(e,t,r,n){for(var Ee=e[t++],Ce=1<<Ee,De=Ce+1,Me=De+1,ze=Ee+1,Oe=(1<<ze)-1,Be=0,He=0,Ve=0,Xe=e[t++],We=new Int32Array(4096),Ge=null;;){for(;Be<16&&Xe!==0;)He|=e[t++]<<Be,Be+=8,Xe===1?Xe=e[t++]:--Xe;if(Be<ze)break;var $e=He&Oe;if(He>>=ze,Be-=ze,$e!==Ce){if($e===De)break;for(var Ke=$e<Me?$e:Ge,rr=0,tr=Ke;tr>Ce;)tr=We[tr]>>8,++rr;var sr=tr;if(Ve+rr+(Ke!==$e?1:0)>n)return void o.log("Warning, gif stream longer than expected.");r[Ve++]=sr;var ar=Ve+=rr;for(Ke!==$e&&(r[Ve++]=sr),tr=Ke;rr--;)tr=We[tr],r[--ar]=255&tr,tr>>=8;Ge!==null&&Me<4096&&(We[Me++]=Ge<<8|sr,Me>=Oe+1&&ze<12&&(++ze,Oe=Oe<<1|1)),Ge=$e}else Me=De+1,Oe=(1<<(ze=Ee+1))-1,Ge=null}return Ve!==n&&o.log("Warning, gif stream shorter than expected."),r}/**
 * @license
  Copyright (c) 2008, Adobe Systems Incorporated
  All rights reserved.

  Redistribution and use in source and binary forms, with or without 
  modification, are permitted provided that the following conditions are
  met:

  * Redistributions of source code must retain the above copyright notice, 
    this list of conditions and the following disclaimer.
  
  * Redistributions in binary form must reproduce the above copyright
    notice, this list of conditions and the following disclaimer in the 
    documentation and/or other materials provided with the distribution.
  
  * Neither the name of Adobe Systems Incorporated nor the names of its 
    contributors may be used to endorse or promote products derived from 
    this software without specific prior written permission.

  THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS
  IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO,
  THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR
  PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR 
  CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL,
  EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO,
  PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR
  PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF
  LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
  NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
  SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
*/function ue(e){var t,r,n,Ee,Ce,De=Math.floor,Me=new Array(64),ze=new Array(64),Oe=new Array(64),Be=new Array(64),He=new Array(65535),Ve=new Array(65535),Xe=new Array(64),We=new Array(64),Ge=[],$e=0,Ke=7,rr=new Array(64),tr=new Array(64),sr=new Array(64),ar=new Array(256),hr=new Array(2048),pr=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],yr=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],fr=[0,1,2,3,4,5,6,7,8,9,10,11],Rr=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],mr=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],wr=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Fr=[0,1,2,3,4,5,6,7,8,9,10,11],Mr=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],Hr=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function Nr(Je,nr){for(var or=0,lr=0,St=new Array,dr=1;dr<=16;dr++){for(var vr=1;vr<=Je[dr];vr++)St[nr[lr]]=[],St[nr[lr]][0]=or,St[nr[lr]][1]=dr,lr++,or++;or*=2}return St}function Ar(Je){for(var nr=Je[0],or=Je[1]-1;or>=0;)nr&1<<or&&($e|=1<<Ke),or--,--Ke<0&&($e==255?(xr(255),xr(0)):xr($e),Ke=7,$e=0)}function xr(Je){Ge.push(Je)}function ir(Je){xr(Je>>8&255),xr(255&Je)}function _r(Je,nr,or,lr,St){for(var dr,vr=St[0],br=St[240],kr=(function(ta,Na){var Ca,za,Xa,Ya,nn,on,yn,fn,Qa,Ka,en=0;for(Qa=0;Qa<8;++Qa){Ca=ta[en],za=ta[en+1],Xa=ta[en+2],Ya=ta[en+3],nn=ta[en+4],on=ta[en+5],yn=ta[en+6];var Bn=Ca+(fn=ta[en+7]),vn=Ca-fn,va=za+yn,aa=za-yn,ia=Xa+on,Oa=Xa-on,ca=Ya+nn,pa=Ya-nn,xa=Bn+ca,$a=Bn-ca,ka=va+ia,La=va-ia;ta[en]=xa+ka,ta[en+4]=xa-ka;var Wa=.707106781*(La+$a);ta[en+2]=$a+Wa,ta[en+6]=$a-Wa;var _n=.382683433*((xa=pa+Oa)-(La=aa+vn)),hn=.5411961*xa+_n,Fn=1.306562965*La+_n,Tn=.707106781*(ka=Oa+aa),sn=vn+Tn,Gi=vn-Tn;ta[en+5]=Gi+hn,ta[en+3]=Gi-hn,ta[en+1]=sn+Fn,ta[en+7]=sn-Fn,en+=8}for(en=0,Qa=0;Qa<8;++Qa){Ca=ta[en],za=ta[en+8],Xa=ta[en+16],Ya=ta[en+24],nn=ta[en+32],on=ta[en+40],yn=ta[en+48];var Yi=Ca+(fn=ta[en+56]),Si=Ca-fn,bi=za+yn,Ln=za-yn,$n=Xa+on,Or=Xa-on,Yr=Ya+nn,zr=Ya-nn,Xr=Yi+Yr,Wr=Yi-Yr,$r=bi+$n,ga=bi-$n;ta[en]=Xr+$r,ta[en+32]=Xr-$r;var Fa=.707106781*(ga+Wr);ta[en+16]=Wr+Fa,ta[en+48]=Wr-Fa;var ya=.382683433*((Xr=zr+Or)-(ga=Ln+Si)),wa=.5411961*Xr+ya,Sa=1.306562965*ga+ya,Va=.707106781*($r=Or+Ln),Ja=Si+Va,an=Si-Va;ta[en+40]=an+wa,ta[en+24]=an-wa,ta[en+8]=Ja+Sa,ta[en+56]=Ja-Sa,en++}for(Qa=0;Qa<64;++Qa)Ka=ta[Qa]*Na[Qa],Xe[Qa]=Ka>0?Ka+.5|0:Ka-.5|0;return Xe})(Je,nr),Pr=0;Pr<64;++Pr)We[pr[Pr]]=kr[Pr];var Er=We[0]-or;or=We[0],Er==0?Ar(lr[0]):(Ar(lr[Ve[dr=32767+Er]]),Ar(He[dr]));for(var Zr=63;Zr>0&&We[Zr]==0;)Zr--;if(Zr==0)return Ar(vr),or;for(var ua,Cr=1;Cr<=Zr;){for(var Jr=Cr;We[Cr]==0&&Cr<=Zr;)++Cr;var Qr=Cr-Jr;if(Qr>=16){ua=Qr>>4;for(var oa=1;oa<=ua;++oa)Ar(br);Qr&=15}dr=32767+We[Cr],Ar(St[(Qr<<4)+Ve[dr]]),Ar(He[dr]),Cr++}return Zr!=63&&Ar(vr),or}function ur(Je){Je=Math.min(Math.max(Je,1),100),Ce!=Je&&((function(nr){for(var or=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],lr=0;lr<64;lr++){var St=De((or[lr]*nr+50)/100);St=Math.min(Math.max(St,1),255),Me[pr[lr]]=St}for(var dr=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],vr=0;vr<64;vr++){var br=De((dr[vr]*nr+50)/100);br=Math.min(Math.max(br,1),255),ze[pr[vr]]=br}for(var kr=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],Pr=0,Er=0;Er<8;Er++)for(var Zr=0;Zr<8;Zr++)Oe[Pr]=1/(Me[pr[Pr]]*kr[Er]*kr[Zr]*8),Be[Pr]=1/(ze[pr[Pr]]*kr[Er]*kr[Zr]*8),Pr++})(Je<50?Math.floor(5e3/Je):Math.floor(200-2*Je)),Ce=Je)}this.encode=function(Je,nr){nr&&ur(nr),Ge=new Array,$e=0,Ke=7,ir(65496),ir(65504),ir(16),xr(74),xr(70),xr(73),xr(70),xr(0),xr(1),xr(1),xr(0),ir(1),ir(1),xr(0),xr(0),(function(){ir(65499),ir(132),xr(0);for(var za=0;za<64;za++)xr(Me[za]);xr(1);for(var Xa=0;Xa<64;Xa++)xr(ze[Xa])})(),(function(za,Xa){ir(65472),ir(17),xr(8),ir(Xa),ir(za),xr(3),xr(1),xr(17),xr(0),xr(2),xr(17),xr(1),xr(3),xr(17),xr(1)})(Je.width,Je.height),(function(){ir(65476),ir(418),xr(0);for(var za=0;za<16;za++)xr(yr[za+1]);for(var Xa=0;Xa<=11;Xa++)xr(fr[Xa]);xr(16);for(var Ya=0;Ya<16;Ya++)xr(Rr[Ya+1]);for(var nn=0;nn<=161;nn++)xr(mr[nn]);xr(1);for(var on=0;on<16;on++)xr(wr[on+1]);for(var yn=0;yn<=11;yn++)xr(Fr[yn]);xr(17);for(var fn=0;fn<16;fn++)xr(Mr[fn+1]);for(var Qa=0;Qa<=161;Qa++)xr(Hr[Qa])})(),ir(65498),ir(12),xr(3),xr(1),xr(0),xr(2),xr(17),xr(3),xr(17),xr(0),xr(63),xr(0);var or=0,lr=0,St=0;$e=0,Ke=7,this.encode.displayName="_encode_";for(var dr,vr,br,kr,Pr,Er,Zr,ua,Cr,Jr=Je.data,Qr=Je.width,oa=Je.height,ta=4*Qr,Na=0;Na<oa;){for(dr=0;dr<ta;){for(Pr=ta*Na+dr,Zr=-1,ua=0,Cr=0;Cr<64;Cr++)Er=Pr+(ua=Cr>>3)*ta+(Zr=4*(7&Cr)),Na+ua>=oa&&(Er-=ta*(Na+1+ua-oa)),dr+Zr>=ta&&(Er-=dr+Zr-ta+4),vr=Jr[Er++],br=Jr[Er++],kr=Jr[Er++],rr[Cr]=(hr[vr]+hr[br+256|0]+hr[kr+512|0]>>16)-128,tr[Cr]=(hr[vr+768|0]+hr[br+1024|0]+hr[kr+1280|0]>>16)-128,sr[Cr]=(hr[vr+1280|0]+hr[br+1536|0]+hr[kr+1792|0]>>16)-128;or=_r(rr,Oe,or,t,n),lr=_r(tr,Be,lr,r,Ee),St=_r(sr,Be,St,r,Ee),dr+=32}Na+=8}if(Ke>=0){var Ca=[];Ca[1]=Ke+1,Ca[0]=(1<<Ke+1)-1,Ar(Ca)}return ir(65497),new Uint8Array(Ge)},e=e||50,(function(){for(var Je=String.fromCharCode,nr=0;nr<256;nr++)ar[nr]=Je(nr)})(),t=Nr(yr,fr),r=Nr(wr,Fr),n=Nr(Rr,mr),Ee=Nr(Mr,Hr),(function(){for(var Je=1,nr=2,or=1;or<=15;or++){for(var lr=Je;lr<nr;lr++)Ve[32767+lr]=or,He[32767+lr]=[],He[32767+lr][1]=or,He[32767+lr][0]=lr;for(var St=-(nr-1);St<=-Je;St++)Ve[32767+St]=or,He[32767+St]=[],He[32767+St][1]=or,He[32767+St][0]=nr-1+St;Je<<=1,nr<<=1}})(),(function(){for(var Je=0;Je<256;Je++)hr[Je]=19595*Je,hr[Je+256|0]=38470*Je,hr[Je+512|0]=7471*Je+32768,hr[Je+768|0]=-11059*Je,hr[Je+1024|0]=-21709*Je,hr[Je+1280|0]=32768*Je+8421375,hr[Je+1536|0]=-27439*Je,hr[Je+1792|0]=-5329*Je})(),ur(e)}/**
 * @license
 * Copyright (c) 2017 Aras Abbasi
 *
 * Licensed under the MIT License.
 * http://opensource.org/licenses/mit-license
 */function ce(e,t){if(this.pos=0,this.buffer=e,this.datav=new DataView(e.buffer),this.is_with_alpha=!!t,this.bottom_up=!0,this.flag=String.fromCharCode(this.buffer[0])+String.fromCharCode(this.buffer[1]),this.pos+=2,["BM","BA","CI","CP","IC","PT"].indexOf(this.flag)===-1)throw new Error("Invalid BMP File");this.parseHeader(),this.parseBGR()}function le(e){function t(fr){if(!fr)throw Error("assert :P")}function r(fr,Rr,mr){for(var wr=0;4>wr;wr++)if(fr[Rr+wr]!=mr.charCodeAt(wr))return!0;return!1}function n(fr,Rr,mr,wr,Fr){for(var Mr=0;Mr<Fr;Mr++)fr[Rr+Mr]=mr[wr+Mr]}function Ee(fr,Rr,mr,wr){for(var Fr=0;Fr<wr;Fr++)fr[Rr+Fr]=mr}function Ce(fr){return new Int32Array(fr)}function De(fr,Rr){for(var mr=[],wr=0;wr<fr;wr++)mr.push(new Rr);return mr}function Me(fr,Rr){var mr=[];return(function wr(Fr,Mr,Hr){for(var Nr=Hr[Mr],Ar=0;Ar<Nr&&(Fr.push(Hr.length>Mr+1?[]:new Rr),!(Hr.length<Mr+1));Ar++)wr(Fr[Ar],Mr+1,Hr)})(mr,0,fr),mr}var ze=function(){var fr=this;function Rr(Ye,Qe){for(var gr=1<<Qe-1>>>0;Ye&gr;)gr>>>=1;return gr?(Ye&gr-1)+gr:Ye}function mr(Ye,Qe,gr,Sr,Dr){t(!(Sr%gr));do Ye[Qe+(Sr-=gr)]=Dr;while(0<Sr)}function wr(Ye,Qe,gr,Sr,Dr){if(t(2328>=Dr),512>=Dr)var Ir=Ce(512);else if((Ir=Ce(Dr))==null)return 0;return(function(Br,Ur,qr,Gr,na,ba){var Vr,la,da=Ur,Ma=1<<qr,ma=Ce(16),Da=Ce(16);for(t(na!=0),t(Gr!=null),t(Br!=null),t(0<qr),la=0;la<na;++la){if(15<Gr[la])return 0;++ma[Gr[la]]}if(ma[0]==na)return 0;for(Da[1]=0,Vr=1;15>Vr;++Vr){if(ma[Vr]>1<<Vr)return 0;Da[Vr+1]=Da[Vr]+ma[Vr]}for(la=0;la<na;++la)Vr=Gr[la],0<Gr[la]&&(ba[Da[Vr]++]=la);if(Da[15]==1)return(Gr=new Fr).g=0,Gr.value=ba[0],mr(Br,da,1,Ma,Gr),Ma;var Ba,Ga=-1,Ha=Ma-1,xn=0,cn=1,Dn=1,pn=1<<qr;for(la=0,Vr=1,na=2;Vr<=qr;++Vr,na<<=1){if(cn+=Dn<<=1,0>(Dn-=ma[Vr]))return 0;for(;0<ma[Vr];--ma[Vr])(Gr=new Fr).g=Vr,Gr.value=ba[la++],mr(Br,da+xn,na,pn,Gr),xn=Rr(xn,Vr)}for(Vr=qr+1,na=2;15>=Vr;++Vr,na<<=1){if(cn+=Dn<<=1,0>(Dn-=ma[Vr]))return 0;for(;0<ma[Vr];--ma[Vr]){if(Gr=new Fr,(xn&Ha)!=Ga){for(da+=pn,Ba=1<<(Ga=Vr)-qr;15>Ga&&!(0>=(Ba-=ma[Ga]));)++Ga,Ba<<=1;Ma+=pn=1<<(Ba=Ga-qr),Br[Ur+(Ga=xn&Ha)].g=Ba+qr,Br[Ur+Ga].value=da-Ur-Ga}Gr.g=Vr-qr,Gr.value=ba[la++],mr(Br,da+(xn>>qr),na,pn,Gr),xn=Rr(xn,Vr)}}return cn!=2*Da[15]-1?0:Ma})(Ye,Qe,gr,Sr,Dr,Ir)}function Fr(){this.value=this.g=0}function Mr(){this.value=this.g=0}function Hr(){this.G=De(5,Fr),this.H=Ce(5),this.jc=this.Qb=this.qb=this.nd=0,this.pd=De(cl,Mr)}function Nr(Ye,Qe,gr,Sr){t(Ye!=null),t(Qe!=null),t(2147483648>Sr),Ye.Ca=254,Ye.I=0,Ye.b=-8,Ye.Ka=0,Ye.oa=Qe,Ye.pa=gr,Ye.Jd=Qe,Ye.Yc=gr+Sr,Ye.Zc=4<=Sr?gr+Sr-4+1:gr,vr(Ye)}function Ar(Ye,Qe){for(var gr=0;0<Qe--;)gr|=kr(Ye,128)<<Qe;return gr}function xr(Ye,Qe){var gr=Ar(Ye,Qe);return br(Ye)?-gr:gr}function ir(Ye,Qe,gr,Sr){var Dr,Ir=0;for(t(Ye!=null),t(Qe!=null),t(4294967288>Sr),Ye.Sb=Sr,Ye.Ra=0,Ye.u=0,Ye.h=0,4<Sr&&(Sr=4),Dr=0;Dr<Sr;++Dr)Ir+=Qe[gr+Dr]<<8*Dr;Ye.Ra=Ir,Ye.bb=Sr,Ye.oa=Qe,Ye.pa=gr}function _r(Ye){for(;8<=Ye.u&&Ye.bb<Ye.Sb;)Ye.Ra>>>=8,Ye.Ra+=Ye.oa[Ye.pa+Ye.bb]<<wo-8>>>0,++Ye.bb,Ye.u-=8;lr(Ye)&&(Ye.h=1,Ye.u=0)}function ur(Ye,Qe){if(t(0<=Qe),!Ye.h&&Qe<=Ss){var gr=or(Ye)&Rs[Qe];return Ye.u+=Qe,_r(Ye),gr}return Ye.h=1,Ye.u=0}function Je(){this.b=this.Ca=this.I=0,this.oa=[],this.pa=0,this.Jd=[],this.Yc=0,this.Zc=[],this.Ka=0}function nr(){this.Ra=0,this.oa=[],this.h=this.u=this.bb=this.Sb=this.pa=0}function or(Ye){return Ye.Ra>>>(Ye.u&wo-1)>>>0}function lr(Ye){return t(Ye.bb<=Ye.Sb),Ye.h||Ye.bb==Ye.Sb&&Ye.u>wo}function St(Ye,Qe){Ye.u=Qe,Ye.h=lr(Ye)}function dr(Ye){Ye.u>=bo&&(t(Ye.u>=bo),_r(Ye))}function vr(Ye){t(Ye!=null&&Ye.oa!=null),Ye.pa<Ye.Zc?(Ye.I=(Ye.oa[Ye.pa++]|Ye.I<<8)>>>0,Ye.b+=8):(t(Ye!=null&&Ye.oa!=null),Ye.pa<Ye.Yc?(Ye.b+=8,Ye.I=Ye.oa[Ye.pa++]|Ye.I<<8):Ye.Ka?Ye.b=0:(Ye.I<<=8,Ye.b+=8,Ye.Ka=1))}function br(Ye){return Ar(Ye,1)}function kr(Ye,Qe){var gr=Ye.Ca;0>Ye.b&&vr(Ye);var Sr=Ye.b,Dr=gr*Qe>>>8,Ir=(Ye.I>>>Sr>Dr)+0;for(Ir?(gr-=Dr,Ye.I-=Dr+1<<Sr>>>0):gr=Dr+1,Sr=gr,Dr=0;256<=Sr;)Dr+=8,Sr>>=8;return Sr=7^Dr+Wo[Sr],Ye.b-=Sr,Ye.Ca=(gr<<Sr)-1,Ir}function Pr(Ye,Qe,gr){Ye[Qe+0]=gr>>24&255,Ye[Qe+1]=gr>>16&255,Ye[Qe+2]=gr>>8&255,Ye[Qe+3]=255&gr}function Er(Ye,Qe){return Ye[Qe+0]|Ye[Qe+1]<<8}function Zr(Ye,Qe){return Er(Ye,Qe)|Ye[Qe+2]<<16}function ua(Ye,Qe){return Er(Ye,Qe)|Er(Ye,Qe+2)<<16}function Cr(Ye,Qe){var gr=1<<Qe;return t(Ye!=null),t(0<Qe),Ye.X=Ce(gr),Ye.X==null?0:(Ye.Mb=32-Qe,Ye.Xa=Qe,1)}function Jr(Ye,Qe){t(Ye!=null),t(Qe!=null),t(Ye.Xa==Qe.Xa),n(Qe.X,0,Ye.X,0,1<<Qe.Xa)}function Qr(){this.X=[],this.Xa=this.Mb=0}function oa(Ye,Qe,gr,Sr){t(gr!=null),t(Sr!=null);var Dr=gr[0],Ir=Sr[0];return Dr==0&&(Dr=(Ye*Ir+Qe/2)/Qe),Ir==0&&(Ir=(Qe*Dr+Ye/2)/Ye),0>=Dr||0>=Ir?0:(gr[0]=Dr,Sr[0]=Ir,1)}function ta(Ye,Qe){return Ye+(1<<Qe)-1>>>Qe}function Na(Ye,Qe){return((4278255360&Ye)+(4278255360&Qe)>>>0&4278255360)+((16711935&Ye)+(16711935&Qe)>>>0&16711935)>>>0}function Ca(Ye,Qe){fr[Qe]=function(gr,Sr,Dr,Ir,Br,Ur,qr){var Gr;for(Gr=0;Gr<Br;++Gr){var na=fr[Ye](Ur[qr+Gr-1],Dr,Ir+Gr);Ur[qr+Gr]=Na(gr[Sr+Gr],na)}}}function za(){this.ud=this.hd=this.jd=0}function Xa(Ye,Qe){return((4278124286&(Ye^Qe))>>>1)+(Ye&Qe)>>>0}function Ya(Ye){return 0<=Ye&&256>Ye?Ye:0>Ye?0:255<Ye?255:void 0}function nn(Ye,Qe){return Ya(Ye+(Ye-Qe+.5>>1))}function on(Ye,Qe,gr){return Math.abs(Qe-gr)-Math.abs(Ye-gr)}function yn(Ye,Qe,gr,Sr,Dr,Ir,Br){for(Sr=Ir[Br-1],gr=0;gr<Dr;++gr)Ir[Br+gr]=Sr=Na(Ye[Qe+gr],Sr)}function fn(Ye,Qe,gr,Sr,Dr){var Ir;for(Ir=0;Ir<gr;++Ir){var Br=Ye[Qe+Ir],Ur=Br>>8&255,qr=16711935&(qr=(qr=16711935&Br)+((Ur<<16)+Ur));Sr[Dr+Ir]=(4278255360&Br)+qr>>>0}}function Qa(Ye,Qe){Qe.jd=255&Ye,Qe.hd=Ye>>8&255,Qe.ud=Ye>>16&255}function Ka(Ye,Qe,gr,Sr,Dr,Ir){var Br;for(Br=0;Br<Sr;++Br){var Ur=Qe[gr+Br],qr=Ur>>>8,Gr=Ur,na=255&(na=(na=Ur>>>16)+((Ye.jd<<24>>24)*(qr<<24>>24)>>>5));Gr=255&(Gr=(Gr+=(Ye.hd<<24>>24)*(qr<<24>>24)>>>5)+((Ye.ud<<24>>24)*(na<<24>>24)>>>5)),Dr[Ir+Br]=(4278255360&Ur)+(na<<16)+Gr}}function en(Ye,Qe,gr,Sr,Dr){fr[Qe]=function(Ir,Br,Ur,qr,Gr,na,ba,Vr,la){for(qr=ba;qr<Vr;++qr)for(ba=0;ba<la;++ba)Gr[na++]=Dr(Ur[Sr(Ir[Br++])])},fr[Ye]=function(Ir,Br,Ur,qr,Gr,na,ba){var Vr=8>>Ir.b,la=Ir.Ea,da=Ir.K[0],Ma=Ir.w;if(8>Vr)for(Ir=(1<<Ir.b)-1,Ma=(1<<Vr)-1;Br<Ur;++Br){var ma,Da=0;for(ma=0;ma<la;++ma)ma&Ir||(Da=Sr(qr[Gr++])),na[ba++]=Dr(da[Da&Ma]),Da>>=Vr}else fr["VP8LMapColor"+gr](qr,Gr,da,Ma,na,ba,Br,Ur,la)}}function Bn(Ye,Qe,gr,Sr,Dr){for(gr=Qe+gr;Qe<gr;){var Ir=Ye[Qe++];Sr[Dr++]=Ir>>16&255,Sr[Dr++]=Ir>>8&255,Sr[Dr++]=255&Ir}}function vn(Ye,Qe,gr,Sr,Dr){for(gr=Qe+gr;Qe<gr;){var Ir=Ye[Qe++];Sr[Dr++]=Ir>>16&255,Sr[Dr++]=Ir>>8&255,Sr[Dr++]=255&Ir,Sr[Dr++]=Ir>>24&255}}function va(Ye,Qe,gr,Sr,Dr){for(gr=Qe+gr;Qe<gr;){var Ir=(Br=Ye[Qe++])>>16&240|Br>>12&15,Br=240&Br|Br>>28&15;Sr[Dr++]=Ir,Sr[Dr++]=Br}}function aa(Ye,Qe,gr,Sr,Dr){for(gr=Qe+gr;Qe<gr;){var Ir=(Br=Ye[Qe++])>>16&248|Br>>13&7,Br=Br>>5&224|Br>>3&31;Sr[Dr++]=Ir,Sr[Dr++]=Br}}function ia(Ye,Qe,gr,Sr,Dr){for(gr=Qe+gr;Qe<gr;){var Ir=Ye[Qe++];Sr[Dr++]=255&Ir,Sr[Dr++]=Ir>>8&255,Sr[Dr++]=Ir>>16&255}}function Oa(Ye,Qe,gr,Sr,Dr,Ir){if(Ir==0)for(gr=Qe+gr;Qe<gr;)Pr(Sr,((Ir=Ye[Qe++])[0]>>24|Ir[1]>>8&65280|Ir[2]<<8&16711680|Ir[3]<<24)>>>0),Dr+=32;else n(Sr,Dr,Ye,Qe,gr)}function ca(Ye,Qe){fr[Qe][0]=fr[Ye+"0"],fr[Qe][1]=fr[Ye+"1"],fr[Qe][2]=fr[Ye+"2"],fr[Qe][3]=fr[Ye+"3"],fr[Qe][4]=fr[Ye+"4"],fr[Qe][5]=fr[Ye+"5"],fr[Qe][6]=fr[Ye+"6"],fr[Qe][7]=fr[Ye+"7"],fr[Qe][8]=fr[Ye+"8"],fr[Qe][9]=fr[Ye+"9"],fr[Qe][10]=fr[Ye+"10"],fr[Qe][11]=fr[Ye+"11"],fr[Qe][12]=fr[Ye+"12"],fr[Qe][13]=fr[Ye+"13"],fr[Qe][14]=fr[Ye+"0"],fr[Qe][15]=fr[Ye+"0"]}function pa(Ye){return Ye==$c||Ye==vu||Ye==cc||Ye==yu}function xa(){this.eb=[],this.size=this.A=this.fb=0}function $a(){this.y=[],this.f=[],this.ea=[],this.F=[],this.Tc=this.Ed=this.Cd=this.Fd=this.lb=this.Db=this.Ab=this.fa=this.J=this.W=this.N=this.O=0}function ka(){this.Rd=this.height=this.width=this.S=0,this.f={},this.f.RGBA=new xa,this.f.kb=new $a,this.sd=null}function La(){this.width=[0],this.height=[0],this.Pd=[0],this.Qd=[0],this.format=[0]}function Wa(){this.Id=this.fd=this.Md=this.hb=this.ib=this.da=this.bd=this.cd=this.j=this.v=this.Da=this.Sd=this.ob=0}function _n(Ye){return alert("todo:WebPSamplerProcessPlane"),Ye.T}function hn(Ye,Qe){var gr=Ye.T,Sr=Qe.ba.f.RGBA,Dr=Sr.eb,Ir=Sr.fb+Ye.ka*Sr.A,Br=cs[Qe.ba.S],Ur=Ye.y,qr=Ye.O,Gr=Ye.f,na=Ye.N,ba=Ye.ea,Vr=Ye.W,la=Qe.cc,da=Qe.dc,Ma=Qe.Mc,ma=Qe.Nc,Da=Ye.ka,Ba=Ye.ka+Ye.T,Ga=Ye.U,Ha=Ga+1>>1;for(Da==0?Br(Ur,qr,null,null,Gr,na,ba,Vr,Gr,na,ba,Vr,Dr,Ir,null,null,Ga):(Br(Qe.ec,Qe.fc,Ur,qr,la,da,Ma,ma,Gr,na,ba,Vr,Dr,Ir-Sr.A,Dr,Ir,Ga),++gr);Da+2<Ba;Da+=2)la=Gr,da=na,Ma=ba,ma=Vr,na+=Ye.Rc,Vr+=Ye.Rc,Ir+=2*Sr.A,Br(Ur,(qr+=2*Ye.fa)-Ye.fa,Ur,qr,la,da,Ma,ma,Gr,na,ba,Vr,Dr,Ir-Sr.A,Dr,Ir,Ga);return qr+=Ye.fa,Ye.j+Ba<Ye.o?(n(Qe.ec,Qe.fc,Ur,qr,Ga),n(Qe.cc,Qe.dc,Gr,na,Ha),n(Qe.Mc,Qe.Nc,ba,Vr,Ha),gr--):1&Ba||Br(Ur,qr,null,null,Gr,na,ba,Vr,Gr,na,ba,Vr,Dr,Ir+Sr.A,null,null,Ga),gr}function Fn(Ye,Qe,gr){var Sr=Ye.F,Dr=[Ye.J];if(Sr!=null){var Ir=Ye.U,Br=Qe.ba.S,Ur=Br==Kc||Br==cc;Qe=Qe.ba.f.RGBA;var qr=[0],Gr=Ye.ka;qr[0]=Ye.T,Ye.Kb&&(Gr==0?--qr[0]:(--Gr,Dr[0]-=Ye.width),Ye.j+Ye.ka+Ye.T==Ye.o&&(qr[0]=Ye.o-Ye.j-Gr));var na=Qe.eb;Gr=Qe.fb+Gr*Qe.A,Ye=Wc(Sr,Dr[0],Ye.width,Ir,qr,na,Gr+(Ur?0:3),Qe.A),t(gr==qr),Ye&&pa(Br)&&Dl(na,Gr,Ur,Ir,qr,Qe.A)}return 0}function Tn(Ye){var Qe=Ye.ma,gr=Qe.ba.S,Sr=11>gr,Dr=gr==gs||gr==Hs||gr==Kc||gr==oc||gr==12||pa(gr);if(Qe.memory=null,Qe.Ib=null,Qe.Jb=null,Qe.Nd=null,!qo(Qe.Oa,Ye,Dr?11:12))return 0;if(Dr&&pa(gr)&&zc(),Ye.da)alert("todo:use_scaling");else{if(Sr){if(Qe.Ib=_n,Ye.Kb){if(gr=Ye.U+1>>1,Qe.memory=Ce(Ye.U+2*gr),Qe.memory==null)return 0;Qe.ec=Qe.memory,Qe.fc=0,Qe.cc=Qe.ec,Qe.dc=Qe.fc+Ye.U,Qe.Mc=Qe.cc,Qe.Nc=Qe.dc+gr,Qe.Ib=hn,zc()}}else alert("todo:EmitYUV");Dr&&(Qe.Jb=Fn,Sr&&so())}if(Sr&&!_l){for(Ye=0;256>Ye;++Ye)us[Ye]=89858*(Ye-128)+hc>>Ys,bh[Ye]=-22014*(Ye-128)+hc,Of[Ye]=-45773*(Ye-128),Eu[Ye]=113618*(Ye-128)+hc>>Ys;for(Ye=Il;Ye<ml;++Ye)Qe=76283*(Ye-16)+hc>>Ys,Sh[Ye-Il]=Ai(Qe,255),Ah[Ye-Il]=Ai(Qe+8>>4,15);_l=1}return 1}function sn(Ye){var Qe=Ye.ma,gr=Ye.U,Sr=Ye.T;return t(!(1&Ye.ka)),0>=gr||0>=Sr?0:(gr=Qe.Ib(Ye,Qe),Qe.Jb!=null&&Qe.Jb(Ye,Qe,gr),Qe.Dc+=gr,1)}function Gi(Ye){Ye.ma.memory=null}function Yi(Ye,Qe,gr,Sr){return ur(Ye,8)!=47?0:(Qe[0]=ur(Ye,14)+1,gr[0]=ur(Ye,14)+1,Sr[0]=ur(Ye,1),ur(Ye,3)!=0?0:!Ye.h)}function Si(Ye,Qe){if(4>Ye)return Ye+1;var gr=Ye-2>>1;return(2+(1&Ye)<<gr)+ur(Qe,gr)+1}function bi(Ye,Qe){return 120<Qe?Qe-120:1<=(gr=((gr=qs[Qe-1])>>4)*Ye+(8-(15&gr)))?gr:1;var gr}function Ln(Ye,Qe,gr){var Sr=or(gr),Dr=Ye[Qe+=255&Sr].g-8;return 0<Dr&&(St(gr,gr.u+8),Sr=or(gr),Qe+=Ye[Qe].value,Qe+=Sr&(1<<Dr)-1),St(gr,gr.u+Ye[Qe].g),Ye[Qe].value}function $n(Ye,Qe,gr){return gr.g+=Ye.g,gr.value+=Ye.value<<Qe>>>0,t(8>=gr.g),Ye.g}function Or(Ye,Qe,gr){var Sr=Ye.xc;return t((Qe=Sr==0?0:Ye.vc[Ye.md*(gr>>Sr)+(Qe>>Sr)])<Ye.Wb),Ye.Ya[Qe]}function Yr(Ye,Qe,gr,Sr){var Dr=Ye.ab,Ir=Ye.c*Qe,Br=Ye.C;Qe=Br+Qe;var Ur=gr,qr=Sr;for(Sr=Ye.Ta,gr=Ye.Ua;0<Dr--;){var Gr=Ye.gc[Dr],na=Br,ba=Qe,Vr=Ur,la=qr,da=(qr=Sr,Ur=gr,Gr.Ea);switch(t(na<ba),t(ba<=Gr.nc),Gr.hc){case 2:Oi(Vr,la,(ba-na)*da,qr,Ur);break;case 0:var Ma=na,ma=ba,Da=qr,Ba=Ur,Ga=(pn=Gr).Ea;Ma==0&&(ac(Vr,la,null,null,1,Da,Ba),yn(Vr,la+1,0,0,Ga-1,Da,Ba+1),la+=Ga,Ba+=Ga,++Ma);for(var Ha=1<<pn.b,xn=Ha-1,cn=ta(Ga,pn.b),Dn=pn.K,pn=pn.w+(Ma>>pn.b)*cn;Ma<ma;){var zn=Dn,yi=pn,On=1;for(nc(Vr,la,Da,Ba-Ga,1,Da,Ba);On<Ga;){var un=(On&~xn)+Ha;un>Ga&&(un=Ga),(0,Vo[zn[yi++]>>8&15])(Vr,la+ +On,Da,Ba+On-Ga,un-On,Da,Ba+On),On=un}la+=Ga,Ba+=Ga,++Ma&xn||(pn+=cn)}ba!=Gr.nc&&n(qr,Ur-da,qr,Ur+(ba-na-1)*da,da);break;case 1:for(da=Vr,ma=la,Ga=(Vr=Gr.Ea)-(Ba=Vr&~(Da=(la=1<<Gr.b)-1)),Ma=ta(Vr,Gr.b),Ha=Gr.K,Gr=Gr.w+(na>>Gr.b)*Ma;na<ba;){for(xn=Ha,cn=Gr,Dn=new za,pn=ma+Ba,zn=ma+Vr;ma<pn;)Qa(xn[cn++],Dn),ic(Dn,da,ma,la,qr,Ur),ma+=la,Ur+=la;ma<zn&&(Qa(xn[cn++],Dn),ic(Dn,da,ma,Ga,qr,Ur),ma+=Ga,Ur+=Ga),++na&Da||(Gr+=Ma)}break;case 3:if(Vr==qr&&la==Ur&&0<Gr.b){for(ma=qr,Vr=da=Ur+(ba-na)*da-(Ba=(ba-na)*ta(Gr.Ea,Gr.b)),la=qr,Da=Ur,Ma=[],Ba=(Ga=Ba)-1;0<=Ba;--Ba)Ma[Ba]=la[Da+Ba];for(Ba=Ga-1;0<=Ba;--Ba)ma[Vr+Ba]=Ma[Ba];pu(Gr,na,ba,qr,da,qr,Ur)}else pu(Gr,na,ba,Vr,la,qr,Ur)}Ur=Sr,qr=gr}qr!=gr&&n(Sr,gr,Ur,qr,Ir)}function zr(Ye,Qe){var gr=Ye.V,Sr=Ye.Ba+Ye.c*Ye.C,Dr=Qe-Ye.C;if(t(Qe<=Ye.l.o),t(16>=Dr),0<Dr){var Ir=Ye.l,Br=Ye.Ta,Ur=Ye.Ua,qr=Ir.width;if(Yr(Ye,Dr,gr,Sr),Dr=Ur=[Ur],t((gr=Ye.C)<(Sr=Qe)),t(Ir.v<Ir.va),Sr>Ir.o&&(Sr=Ir.o),gr<Ir.j){var Gr=Ir.j-gr;gr=Ir.j,Dr[0]+=Gr*qr}if(gr>=Sr?gr=0:(Dr[0]+=4*Ir.v,Ir.ka=gr-Ir.j,Ir.U=Ir.va-Ir.v,Ir.T=Sr-gr,gr=1),gr){if(Ur=Ur[0],11>(gr=Ye.ca).S){var na=gr.f.RGBA,ba=(Sr=gr.S,Dr=Ir.U,Ir=Ir.T,Gr=na.eb,na.A),Vr=Ir;for(na=na.fb+Ye.Ma*na.A;0<Vr--;){var la=Br,da=Ur,Ma=Dr,ma=Gr,Da=na;switch(Sr){case _u:sc(la,da,Ma,ma,Da);break;case gs:Go(la,da,Ma,ma,Da);break;case $c:Go(la,da,Ma,ma,Da),Dl(ma,Da,0,Ma,1,0);break;case xu:Fl(la,da,Ma,ma,Da);break;case Hs:Oa(la,da,Ma,ma,Da,1);break;case vu:Oa(la,da,Ma,ma,Da,1),Dl(ma,Da,0,Ma,1,0);break;case Kc:Oa(la,da,Ma,ma,Da,0);break;case cc:Oa(la,da,Ma,ma,Da,0),Dl(ma,Da,1,Ma,1,0);break;case oc:Yo(la,da,Ma,ma,Da);break;case yu:Yo(la,da,Ma,ma,Da),zs(ma,Da,Ma,1,0);break;case ul:Eo(la,da,Ma,ma,Da);break;default:t(0)}Ur+=qr,na+=ba}Ye.Ma+=Ir}else alert("todo:EmitRescaledRowsYUVA");t(Ye.Ma<=gr.height)}}Ye.C=Qe,t(Ye.C<=Ye.i)}function Xr(Ye){var Qe;if(0<Ye.ua)return 0;for(Qe=0;Qe<Ye.Wb;++Qe){var gr=Ye.Ya[Qe].G,Sr=Ye.Ya[Qe].H;if(0<gr[1][Sr[1]+0].g||0<gr[2][Sr[2]+0].g||0<gr[3][Sr[3]+0].g)return 0}return 1}function Wr(Ye,Qe,gr,Sr,Dr,Ir){if(Ye.Z!=0){var Br=Ye.qd,Ur=Ye.rd;for(t(Zo[Ye.Z]!=null);Qe<gr;++Qe)Zo[Ye.Z](Br,Ur,Sr,Dr,Sr,Dr,Ir),Br=Sr,Ur=Dr,Dr+=Ir;Ye.qd=Br,Ye.rd=Ur}}function $r(Ye,Qe){var gr=Ye.l.ma,Sr=gr.Z==0||gr.Z==1?Ye.l.j:Ye.C;if(Sr=Ye.C<Sr?Sr:Ye.C,t(Qe<=Ye.l.o),Qe>Sr){var Dr=Ye.l.width,Ir=gr.ca,Br=gr.tb+Dr*Sr,Ur=Ye.V,qr=Ye.Ba+Ye.c*Sr,Gr=Ye.gc;t(Ye.ab==1),t(Gr[0].hc==3),Ao(Gr[0],Sr,Qe,Ur,qr,Ir,Br),Wr(gr,Sr,Qe,Ir,Br,Dr)}Ye.C=Ye.Ma=Qe}function ga(Ye,Qe,gr,Sr,Dr,Ir,Br){var Ur=Ye.$/Sr,qr=Ye.$%Sr,Gr=Ye.m,na=Ye.s,ba=gr+Ye.$,Vr=ba;Dr=gr+Sr*Dr;var la=gr+Sr*Ir,da=280+na.ua,Ma=Ye.Pb?Ur:16777216,ma=0<na.ua?na.Wa:null,Da=na.wc,Ba=ba<la?Or(na,qr,Ur):null;t(Ye.C<Ir),t(la<=Dr);var Ga=!1;e:for(;;){for(;Ga||ba<la;){var Ha=0;if(Ur>=Ma){var xn=ba-gr;t((Ma=Ye).Pb),Ma.wd=Ma.m,Ma.xd=xn,0<Ma.s.ua&&Jr(Ma.s.Wa,Ma.s.vb),Ma=Ur+hl}if(qr&Da||(Ba=Or(na,qr,Ur)),t(Ba!=null),Ba.Qb&&(Qe[ba]=Ba.qb,Ga=!0),!Ga)if(dr(Gr),Ba.jc){Ha=Gr,xn=Qe;var cn=ba,Dn=Ba.pd[or(Ha)&cl-1];t(Ba.jc),256>Dn.g?(St(Ha,Ha.u+Dn.g),xn[cn]=Dn.value,Ha=0):(St(Ha,Ha.u+Dn.g-256),t(256<=Dn.value),Ha=Dn.value),Ha==0&&(Ga=!0)}else Ha=Ln(Ba.G[0],Ba.H[0],Gr);if(Gr.h)break;if(Ga||256>Ha){if(!Ga)if(Ba.nd)Qe[ba]=(Ba.qb|Ha<<8)>>>0;else{if(dr(Gr),Ga=Ln(Ba.G[1],Ba.H[1],Gr),dr(Gr),xn=Ln(Ba.G[2],Ba.H[2],Gr),cn=Ln(Ba.G[3],Ba.H[3],Gr),Gr.h)break;Qe[ba]=(cn<<24|Ga<<16|Ha<<8|xn)>>>0}if(Ga=!1,++ba,++qr>=Sr&&(qr=0,++Ur,Br!=null&&Ur<=Ir&&!(Ur%16)&&Br(Ye,Ur),ma!=null))for(;Vr<ba;)Ha=Qe[Vr++],ma.X[(506832829*Ha&4294967295)>>>ma.Mb]=Ha}else if(280>Ha){if(Ha=Si(Ha-256,Gr),xn=Ln(Ba.G[4],Ba.H[4],Gr),dr(Gr),xn=bi(Sr,xn=Si(xn,Gr)),Gr.h)break;if(ba-gr<xn||Dr-ba<Ha)break e;for(cn=0;cn<Ha;++cn)Qe[ba+cn]=Qe[ba+cn-xn];for(ba+=Ha,qr+=Ha;qr>=Sr;)qr-=Sr,++Ur,Br!=null&&Ur<=Ir&&!(Ur%16)&&Br(Ye,Ur);if(t(ba<=Dr),qr&Da&&(Ba=Or(na,qr,Ur)),ma!=null)for(;Vr<ba;)Ha=Qe[Vr++],ma.X[(506832829*Ha&4294967295)>>>ma.Mb]=Ha}else{if(!(Ha<da))break e;for(Ga=Ha-280,t(ma!=null);Vr<ba;)Ha=Qe[Vr++],ma.X[(506832829*Ha&4294967295)>>>ma.Mb]=Ha;Ha=ba,t(!(Ga>>>(xn=ma).Xa)),Qe[Ha]=xn.X[Ga],Ga=!0}Ga||t(Gr.h==lr(Gr))}if(Ye.Pb&&Gr.h&&ba<Dr)t(Ye.m.h),Ye.a=5,Ye.m=Ye.wd,Ye.$=Ye.xd,0<Ye.s.ua&&Jr(Ye.s.vb,Ye.s.Wa);else{if(Gr.h)break e;Br?.(Ye,Ur>Ir?Ir:Ur),Ye.a=0,Ye.$=ba-gr}return 1}return Ye.a=3,0}function Fa(Ye){t(Ye!=null),Ye.vc=null,Ye.yc=null,Ye.Ya=null;var Qe=Ye.Wa;Qe!=null&&(Qe.X=null),Ye.vb=null,t(Ye!=null)}function ya(){var Ye=new Nn;return Ye==null?null:(Ye.a=0,Ye.xb=Ju,ca("Predictor","VP8LPredictors"),ca("Predictor","VP8LPredictors_C"),ca("PredictorAdd","VP8LPredictorsAdd"),ca("PredictorAdd","VP8LPredictorsAdd_C"),Oi=fn,ic=Ka,sc=Bn,Go=vn,Yo=va,Eo=aa,Fl=ia,fr.VP8LMapColor32b=So,fr.VP8LMapColor8b=ss,Ye)}function wa(Ye,Qe,gr,Sr,Dr){var Ir=1,Br=[Ye],Ur=[Qe],qr=Sr.m,Gr=Sr.s,na=null,ba=0;e:for(;;){if(gr)for(;Ir&&ur(qr,1);){var Vr=Br,la=Ur,da=Sr,Ma=1,ma=da.m,Da=da.gc[da.ab],Ba=ur(ma,2);if(da.Oc&1<<Ba)Ir=0;else{switch(da.Oc|=1<<Ba,Da.hc=Ba,Da.Ea=Vr[0],Da.nc=la[0],Da.K=[null],++da.ab,t(4>=da.ab),Ba){case 0:case 1:Da.b=ur(ma,3)+2,Ma=wa(ta(Da.Ea,Da.b),ta(Da.nc,Da.b),0,da,Da.K),Da.K=Da.K[0];break;case 3:var Ga,Ha=ur(ma,8)+1,xn=16<Ha?0:4<Ha?1:2<Ha?2:3;if(Vr[0]=ta(Da.Ea,xn),Da.b=xn,Ga=Ma=wa(Ha,1,0,da,Da.K)){var cn,Dn=Ha,pn=Da,zn=1<<(8>>pn.b),yi=Ce(zn);if(yi==null)Ga=0;else{var On=pn.K[0],un=pn.w;for(yi[0]=pn.K[0][0],cn=1;cn<1*Dn;++cn)yi[cn]=Na(On[un+cn],yi[cn-1]);for(;cn<4*zn;++cn)yi[cn]=0;pn.K[0]=null,pn.K[0]=yi,Ga=1}}Ma=Ga;break;case 2:break;default:t(0)}Ir=Ma}}if(Br=Br[0],Ur=Ur[0],Ir&&ur(qr,1)&&!(Ir=1<=(ba=ur(qr,4))&&11>=ba)){Sr.a=3;break e}var rn;if(rn=Ir)t:{var Ti,Cn,Pn,si=Sr,Zi=Br,fs=Ur,gi=ba,zi=gr,ms=si.m,Hi=si.s,jn=[null],Zn=1,ki=0,ri=Ws[gi];r:for(;;){if(zi&&ur(ms,1)){var Ji=ur(ms,3)+2,Ci=ta(Zi,Ji),Jn=ta(fs,Ji),Bi=Ci*Jn;if(!wa(Ci,Jn,0,si,jn))break r;for(jn=jn[0],Hi.xc=Ji,Ti=0;Ti<Bi;++Ti){var oi=jn[Ti]>>8&65535;jn[Ti]=oi,oi>=Zn&&(Zn=oi+1)}}if(ms.h)break r;for(Cn=0;5>Cn;++Cn){var Xi=Ol[Cn];!Cn&&0<gi&&(Xi+=1<<gi),ki<Xi&&(ki=Xi)}var qi=De(Zn*ri,Fr),ui=Zn,Kn=De(ui,Hr);if(Kn==null)var _s=null;else t(65536>=ui),_s=Kn;var Fi=Ce(ki);if(_s==null||Fi==null||qi==null){si.a=1;break r}var Sn=qi;for(Ti=Pn=0;Ti<Zn;++Ti){var An=_s[Ti],Qn=An.G,Ns=An.H,Ks=0,Es=1,Wi=0;for(Cn=0;5>Cn;++Cn){Xi=Ol[Cn],Qn[Cn]=Sn,Ns[Cn]=Pn,!Cn&&0<gi&&(Xi+=1<<gi);n:{var xl,vl=Xi,ku=si,mi=Fi,ef=Sn,tf=Pn,Cu=0,Jo=ku.m,Eh=ur(Jo,1);if(Ee(mi,0,0,vl),Eh){var rf=ur(Jo,1)+1,af=ur(Jo,1),Ru=ur(Jo,af==0?1:8);mi[Ru]=1,rf==2&&(mi[Ru=ur(Jo,8)]=1);var ts=1}else{var Li=Ce(19),eu=ur(Jo,4)+4;if(19<eu){ku.a=3;var yl=0;break n}for(xl=0;xl<eu;++xl)Li[Zc[xl]]=ur(Jo,3);var pc=void 0,Bl=void 0,Co=ku,Nu=Li,gc=vl,Fu=mi,Lu=0,Qo=Co.m,nf=8,sf=De(128,Fr);a:for(;wr(sf,0,7,Nu,19);){if(ur(Qo,1)){var Pf=2+2*ur(Qo,3);if((pc=2+ur(Qo,Pf))>gc)break a}else pc=gc;for(Bl=0;Bl<gc&&pc--;){dr(Qo);var of=sf[0+(127&or(Qo))];St(Qo,Qo.u+of.g);var wl=of.value;if(16>wl)Fu[Bl++]=wl,wl!=0&&(nf=wl);else{var If=wl==16,Bf=wl-16,jf=uc[Bf],lf=ur(Qo,Xs[Bf])+jf;if(Bl+lf>gc)break a;for(var Uf=If?nf:0;0<lf--;)Fu[Bl++]=Uf}}Lu=1;break a}Lu||(Co.a=3),ts=Lu}(ts=ts&&!Jo.h)&&(Cu=wr(ef,tf,8,mi,vl)),ts&&Cu!=0?yl=Cu:(ku.a=3,yl=0)}if(yl==0)break r;if(Es&&wu[Cn]==1&&(Es=Sn[Pn].g==0),Ks+=Sn[Pn].g,Pn+=yl,3>=Cn){var jl,Du=Fi[0];for(jl=1;jl<Xi;++jl)Fi[jl]>Du&&(Du=Fi[jl]);Wi+=Du}}if(An.nd=Es,An.Qb=0,Es&&(An.qb=(Qn[3][Ns[3]+0].value<<24|Qn[1][Ns[1]+0].value<<16|Qn[2][Ns[2]+0].value)>>>0,Ks==0&&256>Qn[0][Ns[0]+0].value&&(An.Qb=1,An.qb+=Qn[0][Ns[0]+0].value<<8)),An.jc=!An.Qb&&6>Wi,An.jc){var tu,Ro=An;for(tu=0;tu<cl;++tu){var el=tu,tl=Ro.pd[el],Mu=Ro.G[0][Ro.H[0]+el];256<=Mu.value?(tl.g=Mu.g+256,tl.value=Mu.value):(tl.g=0,tl.value=0,el>>=$n(Mu,8,tl),el>>=$n(Ro.G[1][Ro.H[1]+el],16,tl),el>>=$n(Ro.G[2][Ro.H[2]+el],0,tl),$n(Ro.G[3][Ro.H[3]+el],24,tl))}}}Hi.vc=jn,Hi.Wb=Zn,Hi.Ya=_s,Hi.yc=qi,rn=1;break t}rn=0}if(!(Ir=rn)){Sr.a=3;break e}if(0<ba){if(Gr.ua=1<<ba,!Cr(Gr.Wa,ba)){Sr.a=1,Ir=0;break e}}else Gr.ua=0;var Ou=Sr,Ul=Br,zf=Ur,mc=Ou.s,_c=mc.xc;if(Ou.c=Ul,Ou.i=zf,mc.md=ta(Ul,_c),mc.wc=_c==0?-1:(1<<_c)-1,gr){Sr.xb=dl;break e}if((na=Ce(Br*Ur))==null){Sr.a=1,Ir=0;break e}Ir=(Ir=ga(Sr,na,0,Br,Ur,Ur,null))&&!qr.h;break e}return Ir?(Dr!=null?Dr[0]=na:(t(na==null),t(gr)),Sr.$=0,gr||Fa(Gr)):Fa(Gr),Ir}function Sa(Ye,Qe){var gr=Ye.c*Ye.i,Sr=gr+Qe+16*Qe;return t(Ye.c<=Qe),Ye.V=Ce(Sr),Ye.V==null?(Ye.Ta=null,Ye.Ua=0,Ye.a=1,0):(Ye.Ta=Ye.V,Ye.Ua=Ye.Ba+gr+Qe,1)}function Va(Ye,Qe){var gr=Ye.C,Sr=Qe-gr,Dr=Ye.V,Ir=Ye.Ba+Ye.c*gr;for(t(Qe<=Ye.l.o);0<Sr;){var Br=16<Sr?16:Sr,Ur=Ye.l.ma,qr=Ye.l.width,Gr=qr*Br,na=Ur.ca,ba=Ur.tb+qr*gr,Vr=Ye.Ta,la=Ye.Ua;Yr(Ye,Br,Dr,Ir),Ps(Vr,la,na,ba,Gr),Wr(Ur,gr,gr+Br,na,ba,qr),Sr-=Br,Dr+=Br*Ye.c,gr+=Br}t(gr==Qe),Ye.C=Ye.Ma=Qe}function Ja(){this.ub=this.yd=this.td=this.Rb=0}function an(){this.Kd=this.Ld=this.Ud=this.Td=this.i=this.c=0}function Za(){this.Fb=this.Bb=this.Cb=0,this.Zb=Ce(4),this.Lb=Ce(4)}function tn(){this.Yb=(function(){var Ye=[];return(function Qe(gr,Sr,Dr){for(var Ir=Dr[Sr],Br=0;Br<Ir&&(gr.push(Dr.length>Sr+1?[]:0),!(Dr.length<Sr+1));Br++)Qe(gr[Br],Sr+1,Dr)})(Ye,0,[3,11]),Ye})()}function dn(){this.jb=Ce(3),this.Wc=Me([4,8],tn),this.Xc=Me([4,17],tn)}function ii(){this.Pc=this.wb=this.Tb=this.zd=0,this.vd=new Ce(4),this.od=new Ce(4)}function Un(){this.ld=this.La=this.dd=this.tc=0}function ci(){this.Na=this.la=0}function vs(){this.Sc=[0,0],this.Eb=[0,0],this.Qc=[0,0],this.ia=this.lc=0}function to(){this.ad=Ce(384),this.Za=0,this.Ob=Ce(16),this.$b=this.Ad=this.ia=this.Gc=this.Hc=this.Dd=0}function ro(){this.uc=this.M=this.Nb=0,this.wa=Array(new Un),this.Y=0,this.ya=Array(new to),this.aa=0,this.l=new Lo}function Fs(){this.y=Ce(16),this.f=Ce(8),this.ea=Ce(8)}function nl(){this.cb=this.a=0,this.sc="",this.m=new Je,this.Od=new Ja,this.Kc=new an,this.ed=new ii,this.Qa=new Za,this.Ic=this.$c=this.Aa=0,this.D=new ro,this.Xb=this.Va=this.Hb=this.zb=this.yb=this.Ub=this.za=0,this.Jc=De(8,Je),this.ia=0,this.pb=De(4,vs),this.Pa=new dn,this.Bd=this.kc=0,this.Ac=[],this.Bc=0,this.zc=[0,0,0,0],this.Gd=Array(new Fs),this.Hd=0,this.rb=Array(new ci),this.sb=0,this.wa=Array(new Un),this.Y=0,this.oc=[],this.pc=0,this.sa=[],this.ta=0,this.qa=[],this.ra=0,this.Ha=[],this.B=this.R=this.Ia=0,this.Ec=[],this.M=this.ja=this.Vb=this.Fc=0,this.ya=Array(new to),this.L=this.aa=0,this.gd=Me([4,2],Un),this.ga=null,this.Fa=[],this.Cc=this.qc=this.P=0,this.Gb=[],this.Uc=0,this.mb=[],this.nb=0,this.rc=[],this.Ga=this.Vc=0}function Ai(Ye,Qe){return 0>Ye?0:Ye>Qe?Qe:Ye}function Lo(){this.T=this.U=this.ka=this.height=this.width=0,this.y=[],this.f=[],this.ea=[],this.Rc=this.fa=this.W=this.N=this.O=0,this.ma="void",this.put="VP8IoPutHook",this.ac="VP8IoSetupHook",this.bc="VP8IoTeardownHook",this.ha=this.Kb=0,this.data=[],this.hb=this.ib=this.da=this.o=this.j=this.va=this.v=this.Da=this.ob=this.w=0,this.F=[],this.J=0}function ao(){var Ye=new nl;return Ye!=null&&(Ye.a=0,Ye.sc="OK",Ye.cb=0,Ye.Xb=0,Is||(Is=il)),Ye}function ei(Ye,Qe,gr){return Ye.a==0&&(Ye.a=Qe,Ye.sc=gr,Ye.cb=0),0}function Fc(Ye,Qe,gr){return 3<=gr&&Ye[Qe+0]==157&&Ye[Qe+1]==1&&Ye[Qe+2]==42}function mo(Ye,Qe){if(Ye==null)return 0;if(Ye.a=0,Ye.sc="OK",Qe==null)return ei(Ye,2,"null VP8Io passed to VP8GetHeaders()");var gr=Qe.data,Sr=Qe.w,Dr=Qe.ha;if(4>Dr)return ei(Ye,7,"Truncated header.");var Ir=gr[Sr+0]|gr[Sr+1]<<8|gr[Sr+2]<<16,Br=Ye.Od;if(Br.Rb=!(1&Ir),Br.td=Ir>>1&7,Br.yd=Ir>>4&1,Br.ub=Ir>>5,3<Br.td)return ei(Ye,3,"Incorrect keyframe parameters.");if(!Br.yd)return ei(Ye,4,"Frame not displayable.");Sr+=3,Dr-=3;var Ur=Ye.Kc;if(Br.Rb){if(7>Dr)return ei(Ye,7,"cannot parse picture header");if(!Fc(gr,Sr,Dr))return ei(Ye,3,"Bad code word");Ur.c=16383&(gr[Sr+4]<<8|gr[Sr+3]),Ur.Td=gr[Sr+4]>>6,Ur.i=16383&(gr[Sr+6]<<8|gr[Sr+5]),Ur.Ud=gr[Sr+6]>>6,Sr+=7,Dr-=7,Ye.za=Ur.c+15>>4,Ye.Ub=Ur.i+15>>4,Qe.width=Ur.c,Qe.height=Ur.i,Qe.Da=0,Qe.j=0,Qe.v=0,Qe.va=Qe.width,Qe.o=Qe.height,Qe.da=0,Qe.ib=Qe.width,Qe.hb=Qe.height,Qe.U=Qe.width,Qe.T=Qe.height,Ee((Ir=Ye.Pa).jb,0,255,Ir.jb.length),t((Ir=Ye.Qa)!=null),Ir.Cb=0,Ir.Bb=0,Ir.Fb=1,Ee(Ir.Zb,0,0,Ir.Zb.length),Ee(Ir.Lb,0,0,Ir.Lb)}if(Br.ub>Dr)return ei(Ye,7,"bad partition length");Nr(Ir=Ye.m,gr,Sr,Br.ub),Sr+=Br.ub,Dr-=Br.ub,Br.Rb&&(Ur.Ld=br(Ir),Ur.Kd=br(Ir)),Ur=Ye.Qa;var qr,Gr=Ye.Pa;if(t(Ir!=null),t(Ur!=null),Ur.Cb=br(Ir),Ur.Cb){if(Ur.Bb=br(Ir),br(Ir)){for(Ur.Fb=br(Ir),qr=0;4>qr;++qr)Ur.Zb[qr]=br(Ir)?xr(Ir,7):0;for(qr=0;4>qr;++qr)Ur.Lb[qr]=br(Ir)?xr(Ir,6):0}if(Ur.Bb)for(qr=0;3>qr;++qr)Gr.jb[qr]=br(Ir)?Ar(Ir,8):255}else Ur.Bb=0;if(Ir.Ka)return ei(Ye,3,"cannot parse segment header");if((Ur=Ye.ed).zd=br(Ir),Ur.Tb=Ar(Ir,6),Ur.wb=Ar(Ir,3),Ur.Pc=br(Ir),Ur.Pc&&br(Ir)){for(Gr=0;4>Gr;++Gr)br(Ir)&&(Ur.vd[Gr]=xr(Ir,6));for(Gr=0;4>Gr;++Gr)br(Ir)&&(Ur.od[Gr]=xr(Ir,6))}if(Ye.L=Ur.Tb==0?0:Ur.zd?1:2,Ir.Ka)return ei(Ye,3,"cannot parse filter header");var na=Dr;if(Dr=qr=Sr,Sr=qr+na,Ur=na,Ye.Xb=(1<<Ar(Ye.m,2))-1,na<3*(Gr=Ye.Xb))gr=7;else{for(qr+=3*Gr,Ur-=3*Gr,na=0;na<Gr;++na){var ba=gr[Dr+0]|gr[Dr+1]<<8|gr[Dr+2]<<16;ba>Ur&&(ba=Ur),Nr(Ye.Jc[+na],gr,qr,ba),qr+=ba,Ur-=ba,Dr+=3}Nr(Ye.Jc[+Gr],gr,qr,Ur),gr=qr<Sr?0:5}if(gr!=0)return ei(Ye,gr,"cannot parse partitions");for(gr=Ar(qr=Ye.m,7),Dr=br(qr)?xr(qr,4):0,Sr=br(qr)?xr(qr,4):0,Ur=br(qr)?xr(qr,4):0,Gr=br(qr)?xr(qr,4):0,qr=br(qr)?xr(qr,4):0,na=Ye.Qa,ba=0;4>ba;++ba){if(na.Cb){var Vr=na.Zb[ba];na.Fb||(Vr+=gr)}else{if(0<ba){Ye.pb[ba]=Ye.pb[0];continue}Vr=gr}var la=Ye.pb[ba];la.Sc[0]=Vs[Ai(Vr+Dr,127)],la.Sc[1]=Gs[Ai(Vr+0,127)],la.Eb[0]=2*Vs[Ai(Vr+Sr,127)],la.Eb[1]=101581*Gs[Ai(Vr+Ur,127)]>>16,8>la.Eb[1]&&(la.Eb[1]=8),la.Qc[0]=Vs[Ai(Vr+Gr,117)],la.Qc[1]=Gs[Ai(Vr+qr,127)],la.lc=Vr+qr}if(!Br.Rb)return ei(Ye,4,"Not a key frame.");for(br(Ir),Br=Ye.Pa,gr=0;4>gr;++gr){for(Dr=0;8>Dr;++Dr)for(Sr=0;3>Sr;++Sr)for(Ur=0;11>Ur;++Ur)Gr=kr(Ir,vi[gr][Dr][Sr][Ur])?Ar(Ir,8):Mf[gr][Dr][Sr][Ur],Br.Wc[gr][Dr].Yb[Sr][Ur]=Gr;for(Dr=0;17>Dr;++Dr)Br.Xc[gr][Dr]=Br.Wc[gr][Hn[Dr]]}return Ye.kc=br(Ir),Ye.kc&&(Ye.Bd=Ar(Ir,8)),Ye.cb=1}function il(Ye,Qe,gr,Sr,Dr,Ir,Br){var Ur=Qe[Dr].Yb[gr];for(gr=0;16>Dr;++Dr){if(!kr(Ye,Ur[gr+0]))return Dr;for(;!kr(Ye,Ur[gr+1]);)if(Ur=Qe[++Dr].Yb[0],gr=0,Dr==16)return 16;var qr=Qe[Dr+1].Yb;if(kr(Ye,Ur[gr+2])){var Gr=Ye,na=0;if(kr(Gr,(Vr=Ur)[(ba=gr)+3]))if(kr(Gr,Vr[ba+6])){for(Ur=0,ba=2*(na=kr(Gr,Vr[ba+8]))+(Vr=kr(Gr,Vr[ba+9+na])),na=0,Vr=Df[ba];Vr[Ur];++Ur)na+=na+kr(Gr,Vr[Ur]);na+=3+(8<<ba)}else kr(Gr,Vr[ba+7])?(na=7+2*kr(Gr,165),na+=kr(Gr,145)):na=5+kr(Gr,159);else na=kr(Gr,Vr[ba+4])?3+kr(Gr,Vr[ba+5]):2;Ur=qr[2]}else na=1,Ur=qr[1];qr=Br+Zu[Dr],0>(Gr=Ye).b&&vr(Gr);var ba,Vr=Gr.b,la=(ba=Gr.Ca>>1)-(Gr.I>>Vr)>>31;--Gr.b,Gr.Ca+=la,Gr.Ca|=1,Gr.I-=(ba+1&la)<<Vr,Ir[qr]=((na^la)-la)*Sr[(0<Dr)+0]}return 16}function Lc(Ye){var Qe=Ye.rb[Ye.sb-1];Qe.la=0,Qe.Na=0,Ee(Ye.zc,0,0,Ye.zc.length),Ye.ja=0}function ys(Ye,Qe,gr,Sr,Dr){Dr=Ye[Qe+gr+32*Sr]+(Dr>>3),Ye[Qe+gr+32*Sr]=-256&Dr?0>Dr?0:255:Dr}function Ki(Ye,Qe,gr,Sr,Dr,Ir){ys(Ye,Qe,0,gr,Sr+Dr),ys(Ye,Qe,1,gr,Sr+Ir),ys(Ye,Qe,2,gr,Sr-Ir),ys(Ye,Qe,3,gr,Sr-Dr)}function ji(Ye){return(20091*Ye>>16)+Ye}function $l(Ye,Qe,gr,Sr){var Dr,Ir=0,Br=Ce(16);for(Dr=0;4>Dr;++Dr){var Ur=Ye[Qe+0]+Ye[Qe+8],qr=Ye[Qe+0]-Ye[Qe+8],Gr=(35468*Ye[Qe+4]>>16)-ji(Ye[Qe+12]),na=ji(Ye[Qe+4])+(35468*Ye[Qe+12]>>16);Br[Ir+0]=Ur+na,Br[Ir+1]=qr+Gr,Br[Ir+2]=qr-Gr,Br[Ir+3]=Ur-na,Ir+=4,Qe++}for(Dr=Ir=0;4>Dr;++Dr)Ur=(Ye=Br[Ir+0]+4)+Br[Ir+8],qr=Ye-Br[Ir+8],Gr=(35468*Br[Ir+4]>>16)-ji(Br[Ir+12]),ys(gr,Sr,0,0,Ur+(na=ji(Br[Ir+4])+(35468*Br[Ir+12]>>16))),ys(gr,Sr,1,0,qr+Gr),ys(gr,Sr,2,0,qr-Gr),ys(gr,Sr,3,0,Ur-na),Ir++,Sr+=32}function iu(Ye,Qe,gr,Sr){var Dr=Ye[Qe+0]+4,Ir=35468*Ye[Qe+4]>>16,Br=ji(Ye[Qe+4]),Ur=35468*Ye[Qe+1]>>16;Ki(gr,Sr,0,Dr+Br,Ye=ji(Ye[Qe+1]),Ur),Ki(gr,Sr,1,Dr+Ir,Ye,Ur),Ki(gr,Sr,2,Dr-Ir,Ye,Ur),Ki(gr,Sr,3,Dr-Br,Ye,Ur)}function Dc(Ye,Qe,gr,Sr,Dr){$l(Ye,Qe,gr,Sr),Dr&&$l(Ye,Qe+16,gr,Sr+4)}function ws(Ye,Qe,gr,Sr){Ko(Ye,Qe+0,gr,Sr,1),Ko(Ye,Qe+32,gr,Sr+128,1)}function Mc(Ye,Qe,gr,Sr){var Dr;for(Ye=Ye[Qe+0]+4,Dr=0;4>Dr;++Dr)for(Qe=0;4>Qe;++Qe)ys(gr,Sr,Qe,Dr,Ye)}function Oc(Ye,Qe,gr,Sr){Ye[Qe+0]&&ti(Ye,Qe+0,gr,Sr),Ye[Qe+16]&&ti(Ye,Qe+16,gr,Sr+4),Ye[Qe+32]&&ti(Ye,Qe+32,gr,Sr+128),Ye[Qe+48]&&ti(Ye,Qe+48,gr,Sr+128+4)}function no(Ye,Qe,gr,Sr){var Dr,Ir=Ce(16);for(Dr=0;4>Dr;++Dr){var Br=Ye[Qe+0+Dr]+Ye[Qe+12+Dr],Ur=Ye[Qe+4+Dr]+Ye[Qe+8+Dr],qr=Ye[Qe+4+Dr]-Ye[Qe+8+Dr],Gr=Ye[Qe+0+Dr]-Ye[Qe+12+Dr];Ir[0+Dr]=Br+Ur,Ir[8+Dr]=Br-Ur,Ir[4+Dr]=Gr+qr,Ir[12+Dr]=Gr-qr}for(Dr=0;4>Dr;++Dr)Br=(Ye=Ir[0+4*Dr]+3)+Ir[3+4*Dr],Ur=Ir[1+4*Dr]+Ir[2+4*Dr],qr=Ir[1+4*Dr]-Ir[2+4*Dr],Gr=Ye-Ir[3+4*Dr],gr[Sr+0]=Br+Ur>>3,gr[Sr+16]=Gr+qr>>3,gr[Sr+32]=Br-Ur>>3,gr[Sr+48]=Gr-qr>>3,Sr+=64}function Al(Ye,Qe,gr){var Sr,Dr=Qe-32,Ir=ps,Br=255-Ye[Dr-1];for(Sr=0;Sr<gr;++Sr){var Ur,qr=Ir,Gr=Br+Ye[Qe-1];for(Ur=0;Ur<gr;++Ur)Ye[Qe+Ur]=qr[Gr+Ye[Dr+Ur]];Qe+=32}}function su(Ye,Qe){Al(Ye,Qe,4)}function ou(Ye,Qe){Al(Ye,Qe,8)}function Pc(Ye,Qe){Al(Ye,Qe,16)}function Ic(Ye,Qe){var gr;for(gr=0;16>gr;++gr)n(Ye,Qe+32*gr,Ye,Qe-32,16)}function lu(Ye,Qe){var gr;for(gr=16;0<gr;--gr)Ee(Ye,Qe,Ye[Qe-1],16),Qe+=32}function Cs(Ye,Qe,gr){var Sr;for(Sr=0;16>Sr;++Sr)Ee(Qe,gr+32*Sr,Ye,16)}function io(Ye,Qe){var gr,Sr=16;for(gr=0;16>gr;++gr)Sr+=Ye[Qe-1+32*gr]+Ye[Qe+gr-32];Cs(Sr>>5,Ye,Qe)}function Do(Ye,Qe){var gr,Sr=8;for(gr=0;16>gr;++gr)Sr+=Ye[Qe-1+32*gr];Cs(Sr>>4,Ye,Qe)}function El(Ye,Qe){var gr,Sr=8;for(gr=0;16>gr;++gr)Sr+=Ye[Qe+gr-32];Cs(Sr>>4,Ye,Qe)}function sl(Ye,Qe){Cs(128,Ye,Qe)}function kn(Ye,Qe,gr){return Ye+2*Qe+gr+2>>2}function cu(Ye,Qe){var gr,Sr=Qe-32;for(Sr=new Uint8Array([kn(Ye[Sr-1],Ye[Sr+0],Ye[Sr+1]),kn(Ye[Sr+0],Ye[Sr+1],Ye[Sr+2]),kn(Ye[Sr+1],Ye[Sr+2],Ye[Sr+3]),kn(Ye[Sr+2],Ye[Sr+3],Ye[Sr+4])]),gr=0;4>gr;++gr)n(Ye,Qe+32*gr,Sr,0,Sr.length)}function Bc(Ye,Qe){var gr=Ye[Qe-1],Sr=Ye[Qe-1+32],Dr=Ye[Qe-1+64],Ir=Ye[Qe-1+96];Pr(Ye,Qe+0,16843009*kn(Ye[Qe-1-32],gr,Sr)),Pr(Ye,Qe+32,16843009*kn(gr,Sr,Dr)),Pr(Ye,Qe+64,16843009*kn(Sr,Dr,Ir)),Pr(Ye,Qe+96,16843009*kn(Dr,Ir,Ir))}function uu(Ye,Qe){var gr,Sr=4;for(gr=0;4>gr;++gr)Sr+=Ye[Qe+gr-32]+Ye[Qe-1+32*gr];for(Sr>>=3,gr=0;4>gr;++gr)Ee(Ye,Qe+32*gr,Sr,4)}function Ls(Ye,Qe){var gr=Ye[Qe-1+0],Sr=Ye[Qe-1+32],Dr=Ye[Qe-1+64],Ir=Ye[Qe-1-32],Br=Ye[Qe+0-32],Ur=Ye[Qe+1-32],qr=Ye[Qe+2-32],Gr=Ye[Qe+3-32];Ye[Qe+0+96]=kn(Sr,Dr,Ye[Qe-1+96]),Ye[Qe+1+96]=Ye[Qe+0+64]=kn(gr,Sr,Dr),Ye[Qe+2+96]=Ye[Qe+1+64]=Ye[Qe+0+32]=kn(Ir,gr,Sr),Ye[Qe+3+96]=Ye[Qe+2+64]=Ye[Qe+1+32]=Ye[Qe+0+0]=kn(Br,Ir,gr),Ye[Qe+3+64]=Ye[Qe+2+32]=Ye[Qe+1+0]=kn(Ur,Br,Ir),Ye[Qe+3+32]=Ye[Qe+2+0]=kn(qr,Ur,Br),Ye[Qe+3+0]=kn(Gr,qr,Ur)}function ns(Ye,Qe){var gr=Ye[Qe+1-32],Sr=Ye[Qe+2-32],Dr=Ye[Qe+3-32],Ir=Ye[Qe+4-32],Br=Ye[Qe+5-32],Ur=Ye[Qe+6-32],qr=Ye[Qe+7-32];Ye[Qe+0+0]=kn(Ye[Qe+0-32],gr,Sr),Ye[Qe+1+0]=Ye[Qe+0+32]=kn(gr,Sr,Dr),Ye[Qe+2+0]=Ye[Qe+1+32]=Ye[Qe+0+64]=kn(Sr,Dr,Ir),Ye[Qe+3+0]=Ye[Qe+2+32]=Ye[Qe+1+64]=Ye[Qe+0+96]=kn(Dr,Ir,Br),Ye[Qe+3+32]=Ye[Qe+2+64]=Ye[Qe+1+96]=kn(Ir,Br,Ur),Ye[Qe+3+64]=Ye[Qe+2+96]=kn(Br,Ur,qr),Ye[Qe+3+96]=kn(Ur,qr,qr)}function jc(Ye,Qe){var gr=Ye[Qe-1+0],Sr=Ye[Qe-1+32],Dr=Ye[Qe-1+64],Ir=Ye[Qe-1-32],Br=Ye[Qe+0-32],Ur=Ye[Qe+1-32],qr=Ye[Qe+2-32],Gr=Ye[Qe+3-32];Ye[Qe+0+0]=Ye[Qe+1+64]=Ir+Br+1>>1,Ye[Qe+1+0]=Ye[Qe+2+64]=Br+Ur+1>>1,Ye[Qe+2+0]=Ye[Qe+3+64]=Ur+qr+1>>1,Ye[Qe+3+0]=qr+Gr+1>>1,Ye[Qe+0+96]=kn(Dr,Sr,gr),Ye[Qe+0+64]=kn(Sr,gr,Ir),Ye[Qe+0+32]=Ye[Qe+1+96]=kn(gr,Ir,Br),Ye[Qe+1+32]=Ye[Qe+2+96]=kn(Ir,Br,Ur),Ye[Qe+2+32]=Ye[Qe+3+96]=kn(Br,Ur,qr),Ye[Qe+3+32]=kn(Ur,qr,Gr)}function Tl(Ye,Qe){var gr=Ye[Qe+0-32],Sr=Ye[Qe+1-32],Dr=Ye[Qe+2-32],Ir=Ye[Qe+3-32],Br=Ye[Qe+4-32],Ur=Ye[Qe+5-32],qr=Ye[Qe+6-32],Gr=Ye[Qe+7-32];Ye[Qe+0+0]=gr+Sr+1>>1,Ye[Qe+1+0]=Ye[Qe+0+64]=Sr+Dr+1>>1,Ye[Qe+2+0]=Ye[Qe+1+64]=Dr+Ir+1>>1,Ye[Qe+3+0]=Ye[Qe+2+64]=Ir+Br+1>>1,Ye[Qe+0+32]=kn(gr,Sr,Dr),Ye[Qe+1+32]=Ye[Qe+0+96]=kn(Sr,Dr,Ir),Ye[Qe+2+32]=Ye[Qe+1+96]=kn(Dr,Ir,Br),Ye[Qe+3+32]=Ye[Qe+2+96]=kn(Ir,Br,Ur),Ye[Qe+3+64]=kn(Br,Ur,qr),Ye[Qe+3+96]=kn(Ur,qr,Gr)}function Ds(Ye,Qe){var gr=Ye[Qe-1+0],Sr=Ye[Qe-1+32],Dr=Ye[Qe-1+64],Ir=Ye[Qe-1+96];Ye[Qe+0+0]=gr+Sr+1>>1,Ye[Qe+2+0]=Ye[Qe+0+32]=Sr+Dr+1>>1,Ye[Qe+2+32]=Ye[Qe+0+64]=Dr+Ir+1>>1,Ye[Qe+1+0]=kn(gr,Sr,Dr),Ye[Qe+3+0]=Ye[Qe+1+32]=kn(Sr,Dr,Ir),Ye[Qe+3+32]=Ye[Qe+1+64]=kn(Dr,Ir,Ir),Ye[Qe+3+64]=Ye[Qe+2+64]=Ye[Qe+0+96]=Ye[Qe+1+96]=Ye[Qe+2+96]=Ye[Qe+3+96]=Ir}function kl(Ye,Qe){var gr=Ye[Qe-1+0],Sr=Ye[Qe-1+32],Dr=Ye[Qe-1+64],Ir=Ye[Qe-1+96],Br=Ye[Qe-1-32],Ur=Ye[Qe+0-32],qr=Ye[Qe+1-32],Gr=Ye[Qe+2-32];Ye[Qe+0+0]=Ye[Qe+2+32]=gr+Br+1>>1,Ye[Qe+0+32]=Ye[Qe+2+64]=Sr+gr+1>>1,Ye[Qe+0+64]=Ye[Qe+2+96]=Dr+Sr+1>>1,Ye[Qe+0+96]=Ir+Dr+1>>1,Ye[Qe+3+0]=kn(Ur,qr,Gr),Ye[Qe+2+0]=kn(Br,Ur,qr),Ye[Qe+1+0]=Ye[Qe+3+32]=kn(gr,Br,Ur),Ye[Qe+1+32]=Ye[Qe+3+64]=kn(Sr,gr,Br),Ye[Qe+1+64]=Ye[Qe+3+96]=kn(Dr,Sr,gr),Ye[Qe+1+96]=kn(Ir,Dr,Sr)}function _o(Ye,Qe){var gr;for(gr=0;8>gr;++gr)n(Ye,Qe+32*gr,Ye,Qe-32,8)}function fu(Ye,Qe){var gr;for(gr=0;8>gr;++gr)Ee(Ye,Qe,Ye[Qe-1],8),Qe+=32}function Bs(Ye,Qe,gr){var Sr;for(Sr=0;8>Sr;++Sr)Ee(Qe,gr+32*Sr,Ye,8)}function Zl(Ye,Qe){var gr,Sr=8;for(gr=0;8>gr;++gr)Sr+=Ye[Qe+gr-32]+Ye[Qe-1+32*gr];Bs(Sr>>4,Ye,Qe)}function Jl(Ye,Qe){var gr,Sr=4;for(gr=0;8>gr;++gr)Sr+=Ye[Qe+gr-32];Bs(Sr>>3,Ye,Qe)}function Qi(Ye,Qe){var gr,Sr=4;for(gr=0;8>gr;++gr)Sr+=Ye[Qe-1+32*gr];Bs(Sr>>3,Ye,Qe)}function xo(Ye,Qe){Bs(128,Ye,Qe)}function js(Ye,Qe,gr){var Sr=Ye[Qe-gr],Dr=Ye[Qe+0],Ir=3*(Dr-Sr)+$o[1020+Ye[Qe-2*gr]-Ye[Qe+gr]],Br=Yc[112+(Ir+4>>3)];Ye[Qe-gr]=ps[255+Sr+Yc[112+(Ir+3>>3)]],Ye[Qe+0]=ps[255+Dr-Br]}function Mo(Ye,Qe,gr,Sr){var Dr=Ye[Qe+0],Ir=Ye[Qe+gr];return os[255+Ye[Qe-2*gr]-Ye[Qe-gr]]>Sr||os[255+Ir-Dr]>Sr}function Ql(Ye,Qe,gr,Sr){return 4*os[255+Ye[Qe-gr]-Ye[Qe+0]]+os[255+Ye[Qe-2*gr]-Ye[Qe+gr]]<=Sr}function Cl(Ye,Qe,gr,Sr,Dr){var Ir=Ye[Qe-3*gr],Br=Ye[Qe-2*gr],Ur=Ye[Qe-gr],qr=Ye[Qe+0],Gr=Ye[Qe+gr],na=Ye[Qe+2*gr],ba=Ye[Qe+3*gr];return 4*os[255+Ur-qr]+os[255+Br-Gr]>Sr?0:os[255+Ye[Qe-4*gr]-Ir]<=Dr&&os[255+Ir-Br]<=Dr&&os[255+Br-Ur]<=Dr&&os[255+ba-na]<=Dr&&os[255+na-Gr]<=Dr&&os[255+Gr-qr]<=Dr}function Oo(Ye,Qe,gr,Sr){var Dr=2*Sr+1;for(Sr=0;16>Sr;++Sr)Ql(Ye,Qe+Sr,gr,Dr)&&js(Ye,Qe+Sr,gr)}function Po(Ye,Qe,gr,Sr){var Dr=2*Sr+1;for(Sr=0;16>Sr;++Sr)Ql(Ye,Qe+Sr*gr,1,Dr)&&js(Ye,Qe+Sr*gr,1)}function Rl(Ye,Qe,gr,Sr){var Dr;for(Dr=3;0<Dr;--Dr)Oo(Ye,Qe+=4*gr,gr,Sr)}function Uc(Ye,Qe,gr,Sr){var Dr;for(Dr=3;0<Dr;--Dr)Po(Ye,Qe+=4,gr,Sr)}function Io(Ye,Qe,gr,Sr,Dr,Ir,Br,Ur){for(Ir=2*Ir+1;0<Dr--;){if(Cl(Ye,Qe,gr,Ir,Br))if(Mo(Ye,Qe,gr,Ur))js(Ye,Qe,gr);else{var qr=Ye,Gr=Qe,na=gr,ba=qr[Gr-2*na],Vr=qr[Gr-na],la=qr[Gr+0],da=qr[Gr+na],Ma=qr[Gr+2*na],ma=27*(Ba=$o[1020+3*(la-Vr)+$o[1020+ba-da]])+63>>7,Da=18*Ba+63>>7,Ba=9*Ba+63>>7;qr[Gr-3*na]=ps[255+qr[Gr-3*na]+Ba],qr[Gr-2*na]=ps[255+ba+Da],qr[Gr-na]=ps[255+Vr+ma],qr[Gr+0]=ps[255+la-ma],qr[Gr+na]=ps[255+da-Da],qr[Gr+2*na]=ps[255+Ma-Ba]}Qe+=Sr}}function Bo(Ye,Qe,gr,Sr,Dr,Ir,Br,Ur){for(Ir=2*Ir+1;0<Dr--;){if(Cl(Ye,Qe,gr,Ir,Br))if(Mo(Ye,Qe,gr,Ur))js(Ye,Qe,gr);else{var qr=Ye,Gr=Qe,na=gr,ba=qr[Gr-na],Vr=qr[Gr+0],la=qr[Gr+na],da=Yc[112+(4+(Ma=3*(Vr-ba))>>3)],Ma=Yc[112+(Ma+3>>3)],ma=da+1>>1;qr[Gr-2*na]=ps[255+qr[Gr-2*na]+ma],qr[Gr-na]=ps[255+ba+Ma],qr[Gr+0]=ps[255+Vr-da],qr[Gr+na]=ps[255+la-ma]}Qe+=Sr}}function hu(Ye,Qe,gr,Sr,Dr,Ir){Io(Ye,Qe,gr,1,16,Sr,Dr,Ir)}function jo(Ye,Qe,gr,Sr,Dr,Ir){Io(Ye,Qe,1,gr,16,Sr,Dr,Ir)}function du(Ye,Qe,gr,Sr,Dr,Ir){var Br;for(Br=3;0<Br;--Br)Bo(Ye,Qe+=4*gr,gr,1,16,Sr,Dr,Ir)}function cr(Ye,Qe,gr,Sr,Dr,Ir){var Br;for(Br=3;0<Br;--Br)Bo(Ye,Qe+=4,1,gr,16,Sr,Dr,Ir)}function Lr(Ye,Qe,gr,Sr,Dr,Ir,Br,Ur){Io(Ye,Qe,Dr,1,8,Ir,Br,Ur),Io(gr,Sr,Dr,1,8,Ir,Br,Ur)}function Kr(Ye,Qe,gr,Sr,Dr,Ir,Br,Ur){Io(Ye,Qe,1,Dr,8,Ir,Br,Ur),Io(gr,Sr,1,Dr,8,Ir,Br,Ur)}function ra(Ye,Qe,gr,Sr,Dr,Ir,Br,Ur){Bo(Ye,Qe+4*Dr,Dr,1,8,Ir,Br,Ur),Bo(gr,Sr+4*Dr,Dr,1,8,Ir,Br,Ur)}function fa(Ye,Qe,gr,Sr,Dr,Ir,Br,Ur){Bo(Ye,Qe+4,1,Dr,8,Ir,Br,Ur),Bo(gr,Sr+4,1,Dr,8,Ir,Br,Ur)}function Ia(){this.ba=new ka,this.ec=[],this.cc=[],this.Mc=[],this.Dc=this.Nc=this.dc=this.fc=0,this.Oa=new Wa,this.memory=0,this.Ib="OutputFunc",this.Jb="OutputAlphaFunc",this.Nd="OutputRowFunc"}function qa(){this.data=[],this.offset=this.kd=this.ha=this.w=0,this.na=[],this.xa=this.gb=this.Ja=this.Sa=this.P=0}function gn(){this.nc=this.Ea=this.b=this.hc=0,this.K=[],this.w=0}function wn(){this.ua=0,this.Wa=new Qr,this.vb=new Qr,this.md=this.xc=this.wc=0,this.vc=[],this.Wb=0,this.Ya=new Hr,this.yc=new Fr}function Nn(){this.xb=this.a=0,this.l=new Lo,this.ca=new ka,this.V=[],this.Ba=0,this.Ta=[],this.Ua=0,this.m=new nr,this.Pb=0,this.wd=new nr,this.Ma=this.$=this.C=this.i=this.c=this.xd=0,this.s=new wn,this.ab=0,this.gc=De(4,gn),this.Oc=0}function Mn(){this.Lc=this.Z=this.$a=this.i=this.c=0,this.l=new Lo,this.ic=0,this.ca=[],this.tb=0,this.qd=null,this.rd=0}function Gn(Ye,Qe,gr,Sr,Dr,Ir,Br){for(Ye=Ye==null?0:Ye[Qe+0],Qe=0;Qe<Br;++Qe)Dr[Ir+Qe]=Ye+gr[Sr+Qe]&255,Ye=Dr[Ir+Qe]}function Ei(Ye,Qe,gr,Sr,Dr,Ir,Br){var Ur;if(Ye==null)Gn(null,null,gr,Sr,Dr,Ir,Br);else for(Ur=0;Ur<Br;++Ur)Dr[Ir+Ur]=Ye[Qe+Ur]+gr[Sr+Ur]&255}function Mi(Ye,Qe,gr,Sr,Dr,Ir,Br){if(Ye==null)Gn(null,null,gr,Sr,Dr,Ir,Br);else{var Ur,qr=Ye[Qe+0],Gr=qr,na=qr;for(Ur=0;Ur<Br;++Ur)Gr=na+(qr=Ye[Qe+Ur])-Gr,na=gr[Sr+Ur]+(-256&Gr?0>Gr?0:255:Gr)&255,Gr=qr,Dr[Ir+Ur]=na}}function di(Ye,Qe,gr,Sr){var Dr=Qe.width,Ir=Qe.o;if(t(Ye!=null&&Qe!=null),0>gr||0>=Sr||gr+Sr>Ir)return null;if(!Ye.Cc){if(Ye.ga==null){var Br;if(Ye.ga=new Mn,(Br=Ye.ga==null)||(Br=Qe.width*Qe.o,t(Ye.Gb.length==0),Ye.Gb=Ce(Br),Ye.Uc=0,Ye.Gb==null?Br=0:(Ye.mb=Ye.Gb,Ye.nb=Ye.Uc,Ye.rc=null,Br=1),Br=!Br),!Br){Br=Ye.ga;var Ur=Ye.Fa,qr=Ye.P,Gr=Ye.qc,na=Ye.mb,ba=Ye.nb,Vr=qr+1,la=Gr-1,da=Br.l;if(t(Ur!=null&&na!=null&&Qe!=null),Zo[0]=null,Zo[1]=Gn,Zo[2]=Ei,Zo[3]=Mi,Br.ca=na,Br.tb=ba,Br.c=Qe.width,Br.i=Qe.height,t(0<Br.c&&0<Br.i),1>=Gr)Qe=0;else if(Br.$a=3&Ur[qr+0],Br.Z=Ur[qr+0]>>2&3,Br.Lc=Ur[qr+0]>>4&3,qr=Ur[qr+0]>>6&3,0>Br.$a||1<Br.$a||4<=Br.Z||1<Br.Lc||qr)Qe=0;else if(da.put=sn,da.ac=Tn,da.bc=Gi,da.ma=Br,da.width=Qe.width,da.height=Qe.height,da.Da=Qe.Da,da.v=Qe.v,da.va=Qe.va,da.j=Qe.j,da.o=Qe.o,Br.$a)e:{t(Br.$a==1),Qe=ya();t:for(;;){if(Qe==null){Qe=0;break e}if(t(Br!=null),Br.mc=Qe,Qe.c=Br.c,Qe.i=Br.i,Qe.l=Br.l,Qe.l.ma=Br,Qe.l.width=Br.c,Qe.l.height=Br.i,Qe.a=0,ir(Qe.m,Ur,Vr,la),!wa(Br.c,Br.i,1,Qe,null)||(Qe.ab==1&&Qe.gc[0].hc==3&&Xr(Qe.s)?(Br.ic=1,Ur=Qe.c*Qe.i,Qe.Ta=null,Qe.Ua=0,Qe.V=Ce(Ur),Qe.Ba=0,Qe.V==null?(Qe.a=1,Qe=0):Qe=1):(Br.ic=0,Qe=Sa(Qe,Br.c)),!Qe))break t;Qe=1;break e}Br.mc=null,Qe=0}else Qe=la>=Br.c*Br.i;Br=!Qe}if(Br)return null;Ye.ga.Lc!=1?Ye.Ga=0:Sr=Ir-gr}t(Ye.ga!=null),t(gr+Sr<=Ir);e:{if(Qe=(Ur=Ye.ga).c,Ir=Ur.l.o,Ur.$a==0){if(Vr=Ye.rc,la=Ye.Vc,da=Ye.Fa,qr=Ye.P+1+gr*Qe,Gr=Ye.mb,na=Ye.nb+gr*Qe,t(qr<=Ye.P+Ye.qc),Ur.Z!=0)for(t(Zo[Ur.Z]!=null),Br=0;Br<Sr;++Br)Zo[Ur.Z](Vr,la,da,qr,Gr,na,Qe),Vr=Gr,la=na,na+=Qe,qr+=Qe;else for(Br=0;Br<Sr;++Br)n(Gr,na,da,qr,Qe),Vr=Gr,la=na,na+=Qe,qr+=Qe;Ye.rc=Vr,Ye.Vc=la}else{if(t(Ur.mc!=null),Qe=gr+Sr,t((Br=Ur.mc)!=null),t(Qe<=Br.i),Br.C>=Qe)Qe=1;else if(Ur.ic||so(),Ur.ic){Ur=Br.V,Vr=Br.Ba,la=Br.c;var Ma=Br.i,ma=(da=1,qr=Br.$/la,Gr=Br.$%la,na=Br.m,ba=Br.s,Br.$),Da=la*Ma,Ba=la*Qe,Ga=ba.wc,Ha=ma<Ba?Or(ba,Gr,qr):null;t(ma<=Da),t(Qe<=Ma),t(Xr(ba));t:for(;;){for(;!na.h&&ma<Ba;){if(Gr&Ga||(Ha=Or(ba,Gr,qr)),t(Ha!=null),dr(na),256>(Ma=Ln(Ha.G[0],Ha.H[0],na)))Ur[Vr+ma]=Ma,++ma,++Gr>=la&&(Gr=0,++qr<=Qe&&!(qr%16)&&$r(Br,qr));else{if(!(280>Ma)){da=0;break t}Ma=Si(Ma-256,na);var xn,cn=Ln(Ha.G[4],Ha.H[4],na);if(dr(na),!(ma>=(cn=bi(la,cn=Si(cn,na)))&&Da-ma>=Ma)){da=0;break t}for(xn=0;xn<Ma;++xn)Ur[Vr+ma+xn]=Ur[Vr+ma+xn-cn];for(ma+=Ma,Gr+=Ma;Gr>=la;)Gr-=la,++qr<=Qe&&!(qr%16)&&$r(Br,qr);ma<Ba&&Gr&Ga&&(Ha=Or(ba,Gr,qr))}t(na.h==lr(na))}$r(Br,qr>Qe?Qe:qr);break t}!da||na.h&&ma<Da?(da=0,Br.a=na.h?5:3):Br.$=ma,Qe=da}else Qe=ga(Br,Br.V,Br.Ba,Br.c,Br.i,Qe,Va);if(!Qe){Sr=0;break e}}gr+Sr>=Ir&&(Ye.Cc=1),Sr=1}if(!Sr)return null;if(Ye.Cc&&((Sr=Ye.ga)!=null&&(Sr.mc=null),Ye.ga=null,0<Ye.Ga))return alert("todo:WebPDequantizeLevels"),null}return Ye.nb+gr*Dr}function $i(Ye,Qe,gr,Sr,Dr,Ir){for(;0<Dr--;){var Br,Ur=Ye,qr=Qe+(gr?1:0),Gr=Ye,na=Qe+(gr?0:3);for(Br=0;Br<Sr;++Br){var ba=Gr[na+4*Br];ba!=255&&(ba*=32897,Ur[qr+4*Br+0]=Ur[qr+4*Br+0]*ba>>23,Ur[qr+4*Br+1]=Ur[qr+4*Br+1]*ba>>23,Ur[qr+4*Br+2]=Ur[qr+4*Br+2]*ba>>23)}Qe+=Ir}}function Ui(Ye,Qe,gr,Sr,Dr){for(;0<Sr--;){var Ir;for(Ir=0;Ir<gr;++Ir){var Br=Ye[Qe+2*Ir+0],Ur=15&(Gr=Ye[Qe+2*Ir+1]),qr=4369*Ur,Gr=(240&Gr|Gr>>4)*qr>>16;Ye[Qe+2*Ir+0]=(240&Br|Br>>4)*qr>>16&240|(15&Br|Br<<4)*qr>>16>>4&15,Ye[Qe+2*Ir+1]=240&Gr|Ur}Qe+=Dr}}function is(Ye,Qe,gr,Sr,Dr,Ir,Br,Ur){var qr,Gr,na=255;for(Gr=0;Gr<Dr;++Gr){for(qr=0;qr<Sr;++qr){var ba=Ye[Qe+qr];Ir[Br+4*qr]=ba,na&=ba}Qe+=gr,Br+=Ur}return na!=255}function Uo(Ye,Qe,gr,Sr,Dr){var Ir;for(Ir=0;Ir<Dr;++Ir)gr[Sr+Ir]=Ye[Qe+Ir]>>8}function so(){Dl=$i,zs=Ui,Wc=is,Ps=Uo}function zo(Ye,Qe,gr){fr[Ye]=function(Sr,Dr,Ir,Br,Ur,qr,Gr,na,ba,Vr,la,da,Ma,ma,Da,Ba,Ga){var Ha,xn=Ga-1>>1,cn=Ur[qr+0]|Gr[na+0]<<16,Dn=ba[Vr+0]|la[da+0]<<16;t(Sr!=null);var pn=3*cn+Dn+131074>>2;for(Qe(Sr[Dr+0],255&pn,pn>>16,Ma,ma),Ir!=null&&(pn=3*Dn+cn+131074>>2,Qe(Ir[Br+0],255&pn,pn>>16,Da,Ba)),Ha=1;Ha<=xn;++Ha){var zn=Ur[qr+Ha]|Gr[na+Ha]<<16,yi=ba[Vr+Ha]|la[da+Ha]<<16,On=cn+zn+Dn+yi+524296,un=On+2*(zn+Dn)>>3;pn=un+cn>>1,cn=(On=On+2*(cn+yi)>>3)+zn>>1,Qe(Sr[Dr+2*Ha-1],255&pn,pn>>16,Ma,ma+(2*Ha-1)*gr),Qe(Sr[Dr+2*Ha-0],255&cn,cn>>16,Ma,ma+(2*Ha-0)*gr),Ir!=null&&(pn=On+Dn>>1,cn=un+yi>>1,Qe(Ir[Br+2*Ha-1],255&pn,pn>>16,Da,Ba+(2*Ha-1)*gr),Qe(Ir[Br+2*Ha+0],255&cn,cn>>16,Da,Ba+(2*Ha+0)*gr)),cn=zn,Dn=yi}1&Ga||(pn=3*cn+Dn+131074>>2,Qe(Sr[Dr+Ga-1],255&pn,pn>>16,Ma,ma+(Ga-1)*gr),Ir!=null&&(pn=3*Dn+cn+131074>>2,Qe(Ir[Br+Ga-1],255&pn,pn>>16,Da,Ba+(Ga-1)*gr)))}}function zc(){cs[_u]=Pl,cs[gs]=fc,cs[xu]=Qu,cs[Hs]=Su,cs[Kc]=pl,cs[oc]=ko,cs[ul]=gl,cs[$c]=fc,cs[vu]=Su,cs[cc]=pl,cs[yu]=ko}function ec(Ye){return Ye&-16384?0>Ye?0:255:Ye>>Au}function vo(Ye,Qe){return ec((19077*Ye>>8)+(26149*Qe>>8)-14234)}function oo(Ye,Qe,gr){return ec((19077*Ye>>8)-(6419*Qe>>8)-(13320*gr>>8)+8708)}function Nl(Ye,Qe){return ec((19077*Ye>>8)+(33050*Qe>>8)-17685)}function Ho(Ye,Qe,gr,Sr,Dr){Sr[Dr+0]=vo(Ye,gr),Sr[Dr+1]=oo(Ye,Qe,gr),Sr[Dr+2]=Nl(Ye,Qe)}function es(Ye,Qe,gr,Sr,Dr){Sr[Dr+0]=Nl(Ye,Qe),Sr[Dr+1]=oo(Ye,Qe,gr),Sr[Dr+2]=vo(Ye,gr)}function ol(Ye,Qe,gr,Sr,Dr){var Ir=oo(Ye,Qe,gr);Qe=Ir<<3&224|Nl(Ye,Qe)>>3,Sr[Dr+0]=248&vo(Ye,gr)|Ir>>5,Sr[Dr+1]=Qe}function ll(Ye,Qe,gr,Sr,Dr){var Ir=240&Nl(Ye,Qe)|15;Sr[Dr+0]=240&vo(Ye,gr)|oo(Ye,Qe,gr)>>4,Sr[Dr+1]=Ir}function tc(Ye,Qe,gr,Sr,Dr){Sr[Dr+0]=255,Ho(Ye,Qe,gr,Sr,Dr+1)}function yo(Ye,Qe,gr,Sr,Dr){es(Ye,Qe,gr,Sr,Dr),Sr[Dr+3]=255}function bs(Ye,Qe,gr,Sr,Dr){Ho(Ye,Qe,gr,Sr,Dr),Sr[Dr+3]=255}function Xo(Ye,Qe,gr){fr[Ye]=function(Sr,Dr,Ir,Br,Ur,qr,Gr,na,ba){for(var Vr=na+(-2&ba)*gr;na!=Vr;)Qe(Sr[Dr+0],Ir[Br+0],Ur[qr+0],Gr,na),Qe(Sr[Dr+1],Ir[Br+0],Ur[qr+0],Gr,na+gr),Dr+=2,++Br,++qr,na+=2*gr;1&ba&&Qe(Sr[Dr+0],Ir[Br+0],Ur[qr+0],Gr,na)}}function rc(Ye,Qe,gr){return gr==0?Ye==0?Qe==0?6:5:Qe==0?4:0:gr}function Hc(Ye,Qe,gr,Sr,Dr){switch(Ye>>>30){case 3:Ko(Qe,gr,Sr,Dr,0);break;case 2:ds(Qe,gr,Sr,Dr);break;case 1:ti(Qe,gr,Sr,Dr)}}function Ms(Ye,Qe){var gr,Sr,Dr=Qe.M,Ir=Qe.Nb,Br=Ye.oc,Ur=Ye.pc+40,qr=Ye.oc,Gr=Ye.pc+584,na=Ye.oc,ba=Ye.pc+600;for(gr=0;16>gr;++gr)Br[Ur+32*gr-1]=129;for(gr=0;8>gr;++gr)qr[Gr+32*gr-1]=129,na[ba+32*gr-1]=129;for(0<Dr?Br[Ur-1-32]=qr[Gr-1-32]=na[ba-1-32]=129:(Ee(Br,Ur-32-1,127,21),Ee(qr,Gr-32-1,127,9),Ee(na,ba-32-1,127,9)),Sr=0;Sr<Ye.za;++Sr){var Vr=Qe.ya[Qe.aa+Sr];if(0<Sr){for(gr=-1;16>gr;++gr)n(Br,Ur+32*gr-4,Br,Ur+32*gr+12,4);for(gr=-1;8>gr;++gr)n(qr,Gr+32*gr-4,qr,Gr+32*gr+4,4),n(na,ba+32*gr-4,na,ba+32*gr+4,4)}var la=Ye.Gd,da=Ye.Hd+Sr,Ma=Vr.ad,ma=Vr.Hc;if(0<Dr&&(n(Br,Ur-32,la[da].y,0,16),n(qr,Gr-32,la[da].f,0,8),n(na,ba-32,la[da].ea,0,8)),Vr.Za){var Da=Br,Ba=Ur-32+16;for(0<Dr&&(Sr>=Ye.za-1?Ee(Da,Ba,la[da].y[15],4):n(Da,Ba,la[da+1].y,0,4)),gr=0;4>gr;gr++)Da[Ba+128+gr]=Da[Ba+256+gr]=Da[Ba+384+gr]=Da[Ba+0+gr];for(gr=0;16>gr;++gr,ma<<=2)Da=Br,Ba=Ur+Ii[gr],Ni[Vr.Ob[gr]](Da,Ba),Hc(ma,Ma,16*+gr,Da,Ba)}else if(Da=rc(Sr,Dr,Vr.Ob[0]),As[Da](Br,Ur),ma!=0)for(gr=0;16>gr;++gr,ma<<=2)Hc(ma,Ma,16*+gr,Br,Ur+Ii[gr]);for(gr=Vr.Gc,Da=rc(Sr,Dr,Vr.Dd),fo[Da](qr,Gr),fo[Da](na,ba),ma=Ma,Da=qr,Ba=Gr,255&(Vr=0|gr)&&(170&Vr?Us(ma,256,Da,Ba):Yn(ma,256,Da,Ba)),Vr=na,ma=ba,255&(gr>>=8)&&(170&gr?Us(Ma,320,Vr,ma):Yn(Ma,320,Vr,ma)),Dr<Ye.Ub-1&&(n(la[da].y,0,Br,Ur+480,16),n(la[da].f,0,qr,Gr+224,8),n(la[da].ea,0,na,ba+224,8)),gr=8*Ir*Ye.B,la=Ye.sa,da=Ye.ta+16*Sr+16*Ir*Ye.R,Ma=Ye.qa,Vr=Ye.ra+8*Sr+gr,ma=Ye.Ha,Da=Ye.Ia+8*Sr+gr,gr=0;16>gr;++gr)n(la,da+gr*Ye.R,Br,Ur+32*gr,16);for(gr=0;8>gr;++gr)n(Ma,Vr+gr*Ye.B,qr,Gr+32*gr,8),n(ma,Da+gr*Ye.B,na,ba+32*gr,8)}}function lo(Ye,Qe,gr,Sr,Dr,Ir,Br,Ur,qr){var Gr=[0],na=[0],ba=0,Vr=qr!=null?qr.kd:0,la=qr??new qa;if(Ye==null||12>gr)return 7;la.data=Ye,la.w=Qe,la.ha=gr,Qe=[Qe],gr=[gr],la.gb=[la.gb];e:{var da=Qe,Ma=gr,ma=la.gb;if(t(Ye!=null),t(Ma!=null),t(ma!=null),ma[0]=0,12<=Ma[0]&&!r(Ye,da[0],"RIFF")){if(r(Ye,da[0]+8,"WEBP")){ma=3;break e}var Da=ua(Ye,da[0]+4);if(12>Da||4294967286<Da){ma=3;break e}if(Vr&&Da>Ma[0]-8){ma=7;break e}ma[0]=Da,da[0]+=12,Ma[0]-=12}ma=0}if(ma!=0)return ma;for(Da=0<la.gb[0],gr=gr[0];;){e:{var Ba=Ye;Ma=Qe,ma=gr;var Ga=Gr,Ha=na,xn=da=[0];if((pn=ba=[ba])[0]=0,8>ma[0])ma=7;else{if(!r(Ba,Ma[0],"VP8X")){if(ua(Ba,Ma[0]+4)!=10){ma=3;break e}if(18>ma[0]){ma=7;break e}var cn=ua(Ba,Ma[0]+8),Dn=1+Zr(Ba,Ma[0]+12);if(2147483648<=Dn*(Ba=1+Zr(Ba,Ma[0]+15))){ma=3;break e}xn!=null&&(xn[0]=cn),Ga!=null&&(Ga[0]=Dn),Ha!=null&&(Ha[0]=Ba),Ma[0]+=18,ma[0]-=18,pn[0]=1}ma=0}}if(ba=ba[0],da=da[0],ma!=0)return ma;if(Ma=!!(2&da),!Da&&ba)return 3;if(Ir!=null&&(Ir[0]=!!(16&da)),Br!=null&&(Br[0]=Ma),Ur!=null&&(Ur[0]=0),Br=Gr[0],da=na[0],ba&&Ma&&qr==null){ma=0;break}if(4>gr){ma=7;break}if(Da&&ba||!Da&&!ba&&!r(Ye,Qe[0],"ALPH")){gr=[gr],la.na=[la.na],la.P=[la.P],la.Sa=[la.Sa];e:{cn=Ye,ma=Qe,Da=gr;var pn=la.gb;Ga=la.na,Ha=la.P,xn=la.Sa,Dn=22,t(cn!=null),t(Da!=null),Ba=ma[0];var zn=Da[0];for(t(Ga!=null),t(xn!=null),Ga[0]=null,Ha[0]=null,xn[0]=0;;){if(ma[0]=Ba,Da[0]=zn,8>zn){ma=7;break e}var yi=ua(cn,Ba+4);if(4294967286<yi){ma=3;break e}var On=8+yi+1&-2;if(Dn+=On,0<pn&&Dn>pn){ma=3;break e}if(!r(cn,Ba,"VP8 ")||!r(cn,Ba,"VP8L")){ma=0;break e}if(zn[0]<On){ma=7;break e}r(cn,Ba,"ALPH")||(Ga[0]=cn,Ha[0]=Ba+8,xn[0]=yi),Ba+=On,zn-=On}}if(gr=gr[0],la.na=la.na[0],la.P=la.P[0],la.Sa=la.Sa[0],ma!=0)break}gr=[gr],la.Ja=[la.Ja],la.xa=[la.xa];e:if(pn=Ye,ma=Qe,Da=gr,Ga=la.gb[0],Ha=la.Ja,xn=la.xa,cn=ma[0],Ba=!r(pn,cn,"VP8 "),Dn=!r(pn,cn,"VP8L"),t(pn!=null),t(Da!=null),t(Ha!=null),t(xn!=null),8>Da[0])ma=7;else{if(Ba||Dn){if(pn=ua(pn,cn+4),12<=Ga&&pn>Ga-12){ma=3;break e}if(Vr&&pn>Da[0]-8){ma=7;break e}Ha[0]=pn,ma[0]+=8,Da[0]-=8,xn[0]=Dn}else xn[0]=5<=Da[0]&&pn[cn+0]==47&&!(pn[cn+4]>>5),Ha[0]=Da[0];ma=0}if(gr=gr[0],la.Ja=la.Ja[0],la.xa=la.xa[0],Qe=Qe[0],ma!=0)break;if(4294967286<la.Ja)return 3;if(Ur==null||Ma||(Ur[0]=la.xa?2:1),Br=[Br],da=[da],la.xa){if(5>gr){ma=7;break}Ur=Br,Vr=da,Ma=Ir,Ye==null||5>gr?Ye=0:5<=gr&&Ye[Qe+0]==47&&!(Ye[Qe+4]>>5)?(Da=[0],pn=[0],Ga=[0],ir(Ha=new nr,Ye,Qe,gr),Yi(Ha,Da,pn,Ga)?(Ur!=null&&(Ur[0]=Da[0]),Vr!=null&&(Vr[0]=pn[0]),Ma!=null&&(Ma[0]=Ga[0]),Ye=1):Ye=0):Ye=0}else{if(10>gr){ma=7;break}Ur=da,Ye==null||10>gr||!Fc(Ye,Qe+3,gr-3)?Ye=0:(Vr=Ye[Qe+0]|Ye[Qe+1]<<8|Ye[Qe+2]<<16,Ma=16383&(Ye[Qe+7]<<8|Ye[Qe+6]),Ye=16383&(Ye[Qe+9]<<8|Ye[Qe+8]),1&Vr||3<(Vr>>1&7)||!(Vr>>4&1)||Vr>>5>=la.Ja||!Ma||!Ye?Ye=0:(Br&&(Br[0]=Ma),Ur&&(Ur[0]=Ye),Ye=1))}if(!Ye||(Br=Br[0],da=da[0],ba&&(Gr[0]!=Br||na[0]!=da)))return 3;qr!=null&&(qr[0]=la,qr.offset=Qe-qr.w,t(4294967286>Qe-qr.w),t(qr.offset==qr.ha-gr));break}return ma==0||ma==7&&ba&&qr==null?(Ir!=null&&(Ir[0]|=la.na!=null&&0<la.na.length),Sr!=null&&(Sr[0]=Br),Dr!=null&&(Dr[0]=da),0):ma}function qo(Ye,Qe,gr){var Sr=Qe.width,Dr=Qe.height,Ir=0,Br=0,Ur=Sr,qr=Dr;if(Qe.Da=Ye!=null&&0<Ye.Da,Qe.Da&&(Ur=Ye.cd,qr=Ye.bd,Ir=Ye.v,Br=Ye.j,11>gr||(Ir&=-2,Br&=-2),0>Ir||0>Br||0>=Ur||0>=qr||Ir+Ur>Sr||Br+qr>Dr))return 0;if(Qe.v=Ir,Qe.j=Br,Qe.va=Ir+Ur,Qe.o=Br+qr,Qe.U=Ur,Qe.T=qr,Qe.da=Ye!=null&&0<Ye.da,Qe.da){if(!oa(Ur,qr,gr=[Ye.ib],Ir=[Ye.hb]))return 0;Qe.ib=gr[0],Qe.hb=Ir[0]}return Qe.ob=Ye!=null&&Ye.ob,Qe.Kb=Ye==null||!Ye.Sd,Qe.da&&(Qe.ob=Qe.ib<3*Sr/4&&Qe.hb<3*Dr/4,Qe.Kb=0),1}function Xc(Ye){if(Ye==null)return 2;if(11>Ye.S){var Qe=Ye.f.RGBA;Qe.fb+=(Ye.height-1)*Qe.A,Qe.A=-Qe.A}else Qe=Ye.f.kb,Ye=Ye.height,Qe.O+=(Ye-1)*Qe.fa,Qe.fa=-Qe.fa,Qe.N+=(Ye-1>>1)*Qe.Ab,Qe.Ab=-Qe.Ab,Qe.W+=(Ye-1>>1)*Qe.Db,Qe.Db=-Qe.Db,Qe.F!=null&&(Qe.J+=(Ye-1)*Qe.lb,Qe.lb=-Qe.lb);return 0}function co(Ye,Qe,gr,Sr){if(Sr==null||0>=Ye||0>=Qe)return 2;if(gr!=null){if(gr.Da){var Dr=gr.cd,Ir=gr.bd,Br=-2&gr.v,Ur=-2&gr.j;if(0>Br||0>Ur||0>=Dr||0>=Ir||Br+Dr>Ye||Ur+Ir>Qe)return 2;Ye=Dr,Qe=Ir}if(gr.da){if(!oa(Ye,Qe,Dr=[gr.ib],Ir=[gr.hb]))return 2;Ye=Dr[0],Qe=Ir[0]}}Sr.width=Ye,Sr.height=Qe;e:{var qr=Sr.width,Gr=Sr.height;if(Ye=Sr.S,0>=qr||0>=Gr||!(Ye>=_u&&13>Ye))Ye=2;else{if(0>=Sr.Rd&&Sr.sd==null){Br=Ir=Dr=Qe=0;var na=(Ur=qr*Tu[Ye])*Gr;if(11>Ye||(Ir=(Gr+1)/2*(Qe=(qr+1)/2),Ye==12&&(Br=(Dr=qr)*Gr)),(Gr=Ce(na+2*Ir+Br))==null){Ye=1;break e}Sr.sd=Gr,11>Ye?((qr=Sr.f.RGBA).eb=Gr,qr.fb=0,qr.A=Ur,qr.size=na):((qr=Sr.f.kb).y=Gr,qr.O=0,qr.fa=Ur,qr.Fd=na,qr.f=Gr,qr.N=0+na,qr.Ab=Qe,qr.Cd=Ir,qr.ea=Gr,qr.W=0+na+Ir,qr.Db=Qe,qr.Ed=Ir,Ye==12&&(qr.F=Gr,qr.J=0+na+2*Ir),qr.Tc=Br,qr.lb=Dr)}if(Qe=1,Dr=Sr.S,Ir=Sr.width,Br=Sr.height,Dr>=_u&&13>Dr)if(11>Dr)Ye=Sr.f.RGBA,Qe&=(Ur=Math.abs(Ye.A))*(Br-1)+Ir<=Ye.size,Qe&=Ur>=Ir*Tu[Dr],Qe&=Ye.eb!=null;else{Ye=Sr.f.kb,Ur=(Ir+1)/2,na=(Br+1)/2,qr=Math.abs(Ye.fa),Gr=Math.abs(Ye.Ab);var ba=Math.abs(Ye.Db),Vr=Math.abs(Ye.lb),la=Vr*(Br-1)+Ir;Qe&=qr*(Br-1)+Ir<=Ye.Fd,Qe&=Gr*(na-1)+Ur<=Ye.Cd,Qe=(Qe&=ba*(na-1)+Ur<=Ye.Ed)&qr>=Ir&Gr>=Ur&ba>=Ur,Qe&=Ye.y!=null,Qe&=Ye.f!=null,Qe&=Ye.ea!=null,Dr==12&&(Qe&=Vr>=Ir,Qe&=la<=Ye.Tc,Qe&=Ye.F!=null)}else Qe=0;Ye=Qe?0:2}}return Ye!=0||gr!=null&&gr.fd&&(Ye=Xc(Sr)),Ye}var cl=64,Rs=[0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535,131071,262143,524287,1048575,2097151,4194303,8388607,16777215],Ss=24,wo=32,bo=8,Wo=[0,0,1,1,2,2,2,2,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7];Ca("Predictor0","PredictorAdd0"),fr.Predictor0=function(){return 4278190080},fr.Predictor1=function(Ye){return Ye},fr.Predictor2=function(Ye,Qe,gr){return Qe[gr+0]},fr.Predictor3=function(Ye,Qe,gr){return Qe[gr+1]},fr.Predictor4=function(Ye,Qe,gr){return Qe[gr-1]},fr.Predictor5=function(Ye,Qe,gr){return Xa(Xa(Ye,Qe[gr+1]),Qe[gr+0])},fr.Predictor6=function(Ye,Qe,gr){return Xa(Ye,Qe[gr-1])},fr.Predictor7=function(Ye,Qe,gr){return Xa(Ye,Qe[gr+0])},fr.Predictor8=function(Ye,Qe,gr){return Xa(Qe[gr-1],Qe[gr+0])},fr.Predictor9=function(Ye,Qe,gr){return Xa(Qe[gr+0],Qe[gr+1])},fr.Predictor10=function(Ye,Qe,gr){return Xa(Xa(Ye,Qe[gr-1]),Xa(Qe[gr+0],Qe[gr+1]))},fr.Predictor11=function(Ye,Qe,gr){var Sr=Qe[gr+0];return 0>=on(Sr>>24&255,Ye>>24&255,(Qe=Qe[gr-1])>>24&255)+on(Sr>>16&255,Ye>>16&255,Qe>>16&255)+on(Sr>>8&255,Ye>>8&255,Qe>>8&255)+on(255&Sr,255&Ye,255&Qe)?Sr:Ye},fr.Predictor12=function(Ye,Qe,gr){var Sr=Qe[gr+0];return(Ya((Ye>>24&255)+(Sr>>24&255)-((Qe=Qe[gr-1])>>24&255))<<24|Ya((Ye>>16&255)+(Sr>>16&255)-(Qe>>16&255))<<16|Ya((Ye>>8&255)+(Sr>>8&255)-(Qe>>8&255))<<8|Ya((255&Ye)+(255&Sr)-(255&Qe)))>>>0},fr.Predictor13=function(Ye,Qe,gr){var Sr=Qe[gr-1];return(nn((Ye=Xa(Ye,Qe[gr+0]))>>24&255,Sr>>24&255)<<24|nn(Ye>>16&255,Sr>>16&255)<<16|nn(Ye>>8&255,Sr>>8&255)<<8|nn(255&Ye,255&Sr))>>>0};var ac=fr.PredictorAdd0;fr.PredictorAdd1=yn,Ca("Predictor2","PredictorAdd2"),Ca("Predictor3","PredictorAdd3"),Ca("Predictor4","PredictorAdd4"),Ca("Predictor5","PredictorAdd5"),Ca("Predictor6","PredictorAdd6"),Ca("Predictor7","PredictorAdd7"),Ca("Predictor8","PredictorAdd8"),Ca("Predictor9","PredictorAdd9"),Ca("Predictor10","PredictorAdd10"),Ca("Predictor11","PredictorAdd11"),Ca("Predictor12","PredictorAdd12"),Ca("Predictor13","PredictorAdd13");var nc=fr.PredictorAdd2;en("ColorIndexInverseTransform","MapARGB","32b",function(Ye){return Ye>>8&255},function(Ye){return Ye}),en("VP8LColorIndexInverseTransformAlpha","MapAlpha","8b",function(Ye){return Ye},function(Ye){return Ye>>8&255});var Oi,pu=fr.ColorIndexInverseTransform,So=fr.MapARGB,Ao=fr.VP8LColorIndexInverseTransformAlpha,ss=fr.MapAlpha,Vo=fr.VP8LPredictorsAdd=[];Vo.length=16,(fr.VP8LPredictors=[]).length=16,(fr.VP8LPredictorsAdd_C=[]).length=16,(fr.VP8LPredictors_C=[]).length=16;var ic,sc,Go,Yo,Eo,Fl,Os,Ko,ds,Us,ti,Yn,pi,Pi,To,uo,Ll,qc,Yu,Nf,Ff,Lf,Ku,$u,Dl,zs,Wc,Ps,Ml=Ce(511),gu=Ce(2041),Vc=Ce(225),Gc=Ce(767),mu=0,$o=gu,Yc=Vc,ps=Gc,os=Ml,_u=0,gs=1,xu=2,Hs=3,Kc=4,oc=5,ul=6,$c=7,vu=8,cc=9,yu=10,Xs=[2,3,7],uc=[3,3,11],Ol=[280,256,256,256,40],wu=[0,1,1,1,0],Zc=[17,18,0,1,2,3,4,5,16,6,7,8,9,10,11,12,13,14,15],qs=[24,7,23,25,40,6,39,41,22,26,38,42,56,5,55,57,21,27,54,58,37,43,72,4,71,73,20,28,53,59,70,74,36,44,88,69,75,52,60,3,87,89,19,29,86,90,35,45,68,76,85,91,51,61,104,2,103,105,18,30,102,106,34,46,84,92,67,77,101,107,50,62,120,1,119,121,83,93,17,31,100,108,66,78,118,122,33,47,117,123,49,63,99,109,82,94,0,116,124,65,79,16,32,98,110,48,115,125,81,95,64,114,126,97,111,80,113,127,96,112],Ws=[2954,2956,2958,2962,2970,2986,3018,3082,3212,3468,3980,5004],hl=8,Vs=[4,5,6,7,8,9,10,10,11,12,13,14,15,16,17,17,18,19,20,20,21,21,22,22,23,23,24,25,25,26,27,28,29,30,31,32,33,34,35,36,37,37,38,39,40,41,42,43,44,45,46,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,76,77,78,79,80,81,82,83,84,85,86,87,88,89,91,93,95,96,98,100,101,102,104,106,108,110,112,114,116,118,122,124,126,128,130,132,134,136,138,140,143,145,148,151,154,157],Gs=[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,60,62,64,66,68,70,72,74,76,78,80,82,84,86,88,90,92,94,96,98,100,102,104,106,108,110,112,114,116,119,122,125,128,131,134,137,140,143,146,149,152,155,158,161,164,167,170,173,177,181,185,189,193,197,201,205,209,213,217,221,225,229,234,239,245,249,254,259,264,269,274,279,284],Is=null,Df=[[173,148,140,0],[176,155,140,135,0],[180,157,141,134,130,0],[254,254,243,230,196,177,153,140,133,130,129,0]],Zu=[0,1,4,8,5,2,3,6,9,12,13,10,7,11,14,15],bu=[-0,1,-1,2,-2,3,4,6,-3,5,-4,-5,-6,7,-7,8,-8,-9],Mf=[[[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]],[[253,136,254,255,228,219,128,128,128,128,128],[189,129,242,255,227,213,255,219,128,128,128],[106,126,227,252,214,209,255,255,128,128,128]],[[1,98,248,255,236,226,255,255,128,128,128],[181,133,238,254,221,234,255,154,128,128,128],[78,134,202,247,198,180,255,219,128,128,128]],[[1,185,249,255,243,255,128,128,128,128,128],[184,150,247,255,236,224,128,128,128,128,128],[77,110,216,255,236,230,128,128,128,128,128]],[[1,101,251,255,241,255,128,128,128,128,128],[170,139,241,252,236,209,255,255,128,128,128],[37,116,196,243,228,255,255,255,128,128,128]],[[1,204,254,255,245,255,128,128,128,128,128],[207,160,250,255,238,128,128,128,128,128,128],[102,103,231,255,211,171,128,128,128,128,128]],[[1,152,252,255,240,255,128,128,128,128,128],[177,135,243,255,234,225,128,128,128,128,128],[80,129,211,255,194,224,128,128,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[246,1,255,128,128,128,128,128,128,128,128],[255,128,128,128,128,128,128,128,128,128,128]]],[[[198,35,237,223,193,187,162,160,145,155,62],[131,45,198,221,172,176,220,157,252,221,1],[68,47,146,208,149,167,221,162,255,223,128]],[[1,149,241,255,221,224,255,255,128,128,128],[184,141,234,253,222,220,255,199,128,128,128],[81,99,181,242,176,190,249,202,255,255,128]],[[1,129,232,253,214,197,242,196,255,255,128],[99,121,210,250,201,198,255,202,128,128,128],[23,91,163,242,170,187,247,210,255,255,128]],[[1,200,246,255,234,255,128,128,128,128,128],[109,178,241,255,231,245,255,255,128,128,128],[44,130,201,253,205,192,255,255,128,128,128]],[[1,132,239,251,219,209,255,165,128,128,128],[94,136,225,251,218,190,255,255,128,128,128],[22,100,174,245,186,161,255,199,128,128,128]],[[1,182,249,255,232,235,128,128,128,128,128],[124,143,241,255,227,234,128,128,128,128,128],[35,77,181,251,193,211,255,205,128,128,128]],[[1,157,247,255,236,231,255,255,128,128,128],[121,141,235,255,225,227,255,255,128,128,128],[45,99,188,251,195,217,255,224,128,128,128]],[[1,1,251,255,213,255,128,128,128,128,128],[203,1,248,255,255,128,128,128,128,128,128],[137,1,177,255,224,255,128,128,128,128,128]]],[[[253,9,248,251,207,208,255,192,128,128,128],[175,13,224,243,193,185,249,198,255,255,128],[73,17,171,221,161,179,236,167,255,234,128]],[[1,95,247,253,212,183,255,255,128,128,128],[239,90,244,250,211,209,255,255,128,128,128],[155,77,195,248,188,195,255,255,128,128,128]],[[1,24,239,251,218,219,255,205,128,128,128],[201,51,219,255,196,186,128,128,128,128,128],[69,46,190,239,201,218,255,228,128,128,128]],[[1,191,251,255,255,128,128,128,128,128,128],[223,165,249,255,213,255,128,128,128,128,128],[141,124,248,255,255,128,128,128,128,128,128]],[[1,16,248,255,255,128,128,128,128,128,128],[190,36,230,255,236,255,128,128,128,128,128],[149,1,255,128,128,128,128,128,128,128,128]],[[1,226,255,128,128,128,128,128,128,128,128],[247,192,255,128,128,128,128,128,128,128,128],[240,128,255,128,128,128,128,128,128,128,128]],[[1,134,252,255,255,128,128,128,128,128,128],[213,62,250,255,255,128,128,128,128,128,128],[55,93,255,128,128,128,128,128,128,128,128]],[[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128],[128,128,128,128,128,128,128,128,128,128,128]]],[[[202,24,213,235,186,191,220,160,240,175,255],[126,38,182,232,169,184,228,174,255,187,128],[61,46,138,219,151,178,240,170,255,216,128]],[[1,112,230,250,199,191,247,159,255,255,128],[166,109,228,252,211,215,255,174,128,128,128],[39,77,162,232,172,180,245,178,255,255,128]],[[1,52,220,246,198,199,249,220,255,255,128],[124,74,191,243,183,193,250,221,255,255,128],[24,71,130,219,154,170,243,182,255,255,128]],[[1,182,225,249,219,240,255,224,128,128,128],[149,150,226,252,216,205,255,171,128,128,128],[28,108,170,242,183,194,254,223,255,255,128]],[[1,81,230,252,204,203,255,192,128,128,128],[123,102,209,247,188,196,255,233,128,128,128],[20,95,153,243,164,173,255,203,128,128,128]],[[1,222,248,255,216,213,128,128,128,128,128],[168,175,246,252,235,205,255,255,128,128,128],[47,116,215,255,211,212,255,255,128,128,128]],[[1,121,236,253,212,214,255,255,128,128,128],[141,84,213,252,201,202,255,219,128,128,128],[42,80,160,240,162,185,255,205,128,128,128]],[[1,1,255,128,128,128,128,128,128,128,128],[244,1,255,128,128,128,128,128,128,128,128],[238,1,255,128,128,128,128,128,128,128,128]]]],ls=[[[231,120,48,89,115,113,120,152,112],[152,179,64,126,170,118,46,70,95],[175,69,143,80,85,82,72,155,103],[56,58,10,171,218,189,17,13,152],[114,26,17,163,44,195,21,10,173],[121,24,80,195,26,62,44,64,85],[144,71,10,38,171,213,144,34,26],[170,46,55,19,136,160,33,206,71],[63,20,8,114,114,208,12,9,226],[81,40,11,96,182,84,29,16,36]],[[134,183,89,137,98,101,106,165,148],[72,187,100,130,157,111,32,75,80],[66,102,167,99,74,62,40,234,128],[41,53,9,178,241,141,26,8,107],[74,43,26,146,73,166,49,23,157],[65,38,105,160,51,52,31,115,128],[104,79,12,27,217,255,87,17,7],[87,68,71,44,114,51,15,186,23],[47,41,14,110,182,183,21,17,194],[66,45,25,102,197,189,23,18,22]],[[88,88,147,150,42,46,45,196,205],[43,97,183,117,85,38,35,179,61],[39,53,200,87,26,21,43,232,171],[56,34,51,104,114,102,29,93,77],[39,28,85,171,58,165,90,98,64],[34,22,116,206,23,34,43,166,73],[107,54,32,26,51,1,81,43,31],[68,25,106,22,64,171,36,225,114],[34,19,21,102,132,188,16,76,124],[62,18,78,95,85,57,50,48,51]],[[193,101,35,159,215,111,89,46,111],[60,148,31,172,219,228,21,18,111],[112,113,77,85,179,255,38,120,114],[40,42,1,196,245,209,10,25,109],[88,43,29,140,166,213,37,43,154],[61,63,30,155,67,45,68,1,209],[100,80,8,43,154,1,51,26,71],[142,78,78,16,255,128,34,197,171],[41,40,5,102,211,183,4,1,221],[51,50,17,168,209,192,23,25,82]],[[138,31,36,171,27,166,38,44,229],[67,87,58,169,82,115,26,59,179],[63,59,90,180,59,166,93,73,154],[40,40,21,116,143,209,34,39,175],[47,15,16,183,34,223,49,45,183],[46,17,33,183,6,98,15,32,183],[57,46,22,24,128,1,54,17,37],[65,32,73,115,28,128,23,128,205],[40,3,9,115,51,192,18,6,223],[87,37,9,115,59,77,64,21,47]],[[104,55,44,218,9,54,53,130,226],[64,90,70,205,40,41,23,26,57],[54,57,112,184,5,41,38,166,213],[30,34,26,133,152,116,10,32,134],[39,19,53,221,26,114,32,73,255],[31,9,65,234,2,15,1,118,73],[75,32,12,51,192,255,160,43,51],[88,31,35,67,102,85,55,186,85],[56,21,23,111,59,205,45,37,192],[55,38,70,124,73,102,1,34,98]],[[125,98,42,88,104,85,117,175,82],[95,84,53,89,128,100,113,101,45],[75,79,123,47,51,128,81,171,1],[57,17,5,71,102,57,53,41,49],[38,33,13,121,57,73,26,1,85],[41,10,67,138,77,110,90,47,114],[115,21,2,10,102,255,166,23,6],[101,29,16,10,85,128,101,196,26],[57,18,10,102,102,213,34,20,43],[117,20,15,36,163,128,68,1,26]],[[102,61,71,37,34,53,31,243,192],[69,60,71,38,73,119,28,222,37],[68,45,128,34,1,47,11,245,171],[62,17,19,70,146,85,55,62,70],[37,43,37,154,100,163,85,160,1],[63,9,92,136,28,64,32,201,85],[75,15,9,9,64,255,184,119,16],[86,6,28,5,64,255,25,248,1],[56,8,17,132,137,255,55,116,128],[58,15,20,82,135,57,26,121,40]],[[164,50,31,137,154,133,25,35,218],[51,103,44,131,131,123,31,6,158],[86,40,64,135,148,224,45,183,128],[22,26,17,131,240,154,14,1,209],[45,16,21,91,64,222,7,1,197],[56,21,39,155,60,138,23,102,213],[83,12,13,54,192,255,68,47,28],[85,26,85,85,128,128,32,146,171],[18,11,7,63,144,171,4,4,246],[35,27,10,146,174,171,12,26,128]],[[190,80,35,99,180,80,126,54,45],[85,126,47,87,176,51,41,20,32],[101,75,128,139,118,146,116,128,85],[56,41,15,176,236,85,37,9,62],[71,30,17,119,118,255,17,18,138],[101,38,60,138,55,70,43,26,142],[146,36,19,30,171,255,97,27,20],[138,45,61,62,219,1,81,188,64],[32,41,20,117,151,142,20,21,163],[112,19,12,61,195,128,48,4,24]]],vi=[[[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[176,246,255,255,255,255,255,255,255,255,255],[223,241,252,255,255,255,255,255,255,255,255],[249,253,253,255,255,255,255,255,255,255,255]],[[255,244,252,255,255,255,255,255,255,255,255],[234,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255]],[[255,246,254,255,255,255,255,255,255,255,255],[239,253,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[251,255,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[251,254,254,255,255,255,255,255,255,255,255],[254,255,254,255,255,255,255,255,255,255,255]],[[255,254,253,255,254,255,255,255,255,255,255],[250,255,254,255,254,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[217,255,255,255,255,255,255,255,255,255,255],[225,252,241,253,255,255,254,255,255,255,255],[234,250,241,250,253,255,253,254,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[223,254,254,255,255,255,255,255,255,255,255],[238,253,254,254,255,255,255,255,255,255,255]],[[255,248,254,255,255,255,255,255,255,255,255],[249,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,255,255,255,255,255,255,255,255,255],[247,254,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[252,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[253,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[186,251,250,255,255,255,255,255,255,255,255],[234,251,244,254,255,255,255,255,255,255,255],[251,251,243,253,254,255,254,255,255,255,255]],[[255,253,254,255,255,255,255,255,255,255,255],[236,253,254,255,255,255,255,255,255,255,255],[251,253,253,254,254,255,255,255,255,255,255]],[[255,254,254,255,255,255,255,255,255,255,255],[254,254,254,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,254,255,255,255,255,255,255,255,255,255],[254,254,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]],[[[248,255,255,255,255,255,255,255,255,255,255],[250,254,252,254,255,255,255,255,255,255,255],[248,254,249,253,255,255,255,255,255,255,255]],[[255,253,253,255,255,255,255,255,255,255,255],[246,253,253,255,255,255,255,255,255,255,255],[252,254,251,254,254,255,255,255,255,255,255]],[[255,254,252,255,255,255,255,255,255,255,255],[248,254,253,255,255,255,255,255,255,255,255],[253,255,254,254,255,255,255,255,255,255,255]],[[255,251,254,255,255,255,255,255,255,255,255],[245,251,254,255,255,255,255,255,255,255,255],[253,253,254,255,255,255,255,255,255,255,255]],[[255,251,253,255,255,255,255,255,255,255,255],[252,253,254,255,255,255,255,255,255,255,255],[255,254,255,255,255,255,255,255,255,255,255]],[[255,252,255,255,255,255,255,255,255,255,255],[249,255,254,255,255,255,255,255,255,255,255],[255,255,254,255,255,255,255,255,255,255,255]],[[255,255,253,255,255,255,255,255,255,255,255],[250,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]],[[255,255,255,255,255,255,255,255,255,255,255],[254,255,255,255,255,255,255,255,255,255,255],[255,255,255,255,255,255,255,255,255,255,255]]]],Hn=[0,1,2,3,6,4,5,6,6,6,6,6,6,6,6,7,0],As=[],Ni=[],fo=[],dl=1,Ju=2,Zo=[],cs=[];zo("UpsampleRgbLinePair",Ho,3),zo("UpsampleBgrLinePair",es,3),zo("UpsampleRgbaLinePair",bs,4),zo("UpsampleBgraLinePair",yo,4),zo("UpsampleArgbLinePair",tc,4),zo("UpsampleRgba4444LinePair",ll,2),zo("UpsampleRgb565LinePair",ol,2);var Pl=fr.UpsampleRgbLinePair,Qu=fr.UpsampleBgrLinePair,fc=fr.UpsampleRgbaLinePair,Su=fr.UpsampleBgraLinePair,pl=fr.UpsampleArgbLinePair,ko=fr.UpsampleRgba4444LinePair,gl=fr.UpsampleRgb565LinePair,Ys=16,hc=1<<Ys-1,Il=-227,ml=482,Au=6,_l=0,us=Ce(256),Eu=Ce(256),Of=Ce(256),bh=Ce(256),Sh=Ce(ml-Il),Ah=Ce(ml-Il);Xo("YuvToRgbRow",Ho,3),Xo("YuvToBgrRow",es,3),Xo("YuvToRgbaRow",bs,4),Xo("YuvToBgraRow",yo,4),Xo("YuvToArgbRow",tc,4),Xo("YuvToRgba4444Row",ll,2),Xo("YuvToRgb565Row",ol,2);var Ii=[0,4,8,12,128,132,136,140,256,260,264,268,384,388,392,396],dc=[0,2,8],Jc=[8,7,6,4,4,2,2,2,1,1,1,1],Qc=1;this.WebPDecodeRGBA=function(Ye,Qe,gr,Sr,Dr){var Ir=gs,Br=new Ia,Ur=new ka;Br.ba=Ur,Ur.S=Ir,Ur.width=[Ur.width],Ur.height=[Ur.height];var qr=Ur.width,Gr=Ur.height,na=new La;if(na==null||Ye==null)var ba=2;else t(na!=null),ba=lo(Ye,Qe,gr,na.width,na.height,na.Pd,na.Qd,na.format,null);if(ba!=0?qr=0:(qr!=null&&(qr[0]=na.width[0]),Gr!=null&&(Gr[0]=na.height[0]),qr=1),qr){Ur.width=Ur.width[0],Ur.height=Ur.height[0],Sr!=null&&(Sr[0]=Ur.width),Dr!=null&&(Dr[0]=Ur.height);e:{if(Sr=new Lo,(Dr=new qa).data=Ye,Dr.w=Qe,Dr.ha=gr,Dr.kd=1,Qe=[0],t(Dr!=null),((Ye=lo(Dr.data,Dr.w,Dr.ha,null,null,null,Qe,null,Dr))==0||Ye==7)&&Qe[0]&&(Ye=4),(Qe=Ye)==0){if(t(Br!=null),Sr.data=Dr.data,Sr.w=Dr.w+Dr.offset,Sr.ha=Dr.ha-Dr.offset,Sr.put=sn,Sr.ac=Tn,Sr.bc=Gi,Sr.ma=Br,Dr.xa){if((Ye=ya())==null){Br=1;break e}if((function(Vr,la){var da=[0],Ma=[0],ma=[0];t:for(;;){if(Vr==null)return 0;if(la==null)return Vr.a=2,0;if(Vr.l=la,Vr.a=0,ir(Vr.m,la.data,la.w,la.ha),!Yi(Vr.m,da,Ma,ma)){Vr.a=3;break t}if(Vr.xb=Ju,la.width=da[0],la.height=Ma[0],!wa(da[0],Ma[0],1,Vr,null))break t;return 1}return t(Vr.a!=0),0})(Ye,Sr)){if(Sr=(Qe=co(Sr.width,Sr.height,Br.Oa,Br.ba))==0){t:{Sr=Ye;r:for(;;){if(Sr==null){Sr=0;break t}if(t(Sr.s.yc!=null),t(Sr.s.Ya!=null),t(0<Sr.s.Wb),t((gr=Sr.l)!=null),t((Dr=gr.ma)!=null),Sr.xb!=0){if(Sr.ca=Dr.ba,Sr.tb=Dr.tb,t(Sr.ca!=null),!qo(Dr.Oa,gr,Hs)){Sr.a=2;break r}if(!Sa(Sr,gr.width)||gr.da)break r;if((gr.da||pa(Sr.ca.S))&&so(),11>Sr.ca.S||(alert("todo:WebPInitConvertARGBToYUV"),Sr.ca.f.kb.F!=null&&so()),Sr.Pb&&0<Sr.s.ua&&Sr.s.vb.X==null&&!Cr(Sr.s.vb,Sr.s.Wa.Xa)){Sr.a=1;break r}Sr.xb=0}if(!ga(Sr,Sr.V,Sr.Ba,Sr.c,Sr.i,gr.o,zr))break r;Dr.Dc=Sr.Ma,Sr=1;break t}t(Sr.a!=0),Sr=0}Sr=!Sr}Sr&&(Qe=Ye.a)}else Qe=Ye.a}else{if((Ye=new ao)==null){Br=1;break e}if(Ye.Fa=Dr.na,Ye.P=Dr.P,Ye.qc=Dr.Sa,mo(Ye,Sr)){if((Qe=co(Sr.width,Sr.height,Br.Oa,Br.ba))==0){if(Ye.Aa=0,gr=Br.Oa,t((Dr=Ye)!=null),gr!=null){if(0<(qr=0>(qr=gr.Md)?0:100<qr?255:255*qr/100)){for(Gr=na=0;4>Gr;++Gr)12>(ba=Dr.pb[Gr]).lc&&(ba.ia=qr*Jc[0>ba.lc?0:ba.lc]>>3),na|=ba.ia;na&&(alert("todo:VP8InitRandom"),Dr.ia=1)}Dr.Ga=gr.Id,100<Dr.Ga?Dr.Ga=100:0>Dr.Ga&&(Dr.Ga=0)}(function(Vr,la){if(Vr==null)return 0;if(la==null)return ei(Vr,2,"NULL VP8Io parameter in VP8Decode().");if(!Vr.cb&&!mo(Vr,la))return 0;if(t(Vr.cb),la.ac==null||la.ac(la)){la.ob&&(Vr.L=0);var da=dc[Vr.L];if(Vr.L==2?(Vr.yb=0,Vr.zb=0):(Vr.yb=la.v-da>>4,Vr.zb=la.j-da>>4,0>Vr.yb&&(Vr.yb=0),0>Vr.zb&&(Vr.zb=0)),Vr.Va=la.o+15+da>>4,Vr.Hb=la.va+15+da>>4,Vr.Hb>Vr.za&&(Vr.Hb=Vr.za),Vr.Va>Vr.Ub&&(Vr.Va=Vr.Ub),0<Vr.L){var Ma=Vr.ed;for(da=0;4>da;++da){var ma;if(Vr.Qa.Cb){var Da=Vr.Qa.Lb[da];Vr.Qa.Fb||(Da+=Ma.Tb)}else Da=Ma.Tb;for(ma=0;1>=ma;++ma){var Ba=Vr.gd[da][ma],Ga=Da;if(Ma.Pc&&(Ga+=Ma.vd[0],ma&&(Ga+=Ma.od[0])),0<(Ga=0>Ga?0:63<Ga?63:Ga)){var Ha=Ga;0<Ma.wb&&(Ha=4<Ma.wb?Ha>>2:Ha>>1)>9-Ma.wb&&(Ha=9-Ma.wb),1>Ha&&(Ha=1),Ba.dd=Ha,Ba.tc=2*Ga+Ha,Ba.ld=40<=Ga?2:15<=Ga?1:0}else Ba.tc=0;Ba.La=ma}}}da=0}else ei(Vr,6,"Frame setup failed"),da=Vr.a;if(da=da==0){if(da){Vr.$c=0,0<Vr.Aa||(Vr.Ic=Qc);t:{da=Vr.Ic,Ma=4*(Ha=Vr.za);var xn=32*Ha,cn=Ha+1,Dn=0<Vr.L?Ha*(0<Vr.Aa?2:1):0,pn=(Vr.Aa==2?2:1)*Ha;if((Ba=Ma+832+(ma=3*(16*da+dc[Vr.L])/2*xn)+(Da=Vr.Fa!=null&&0<Vr.Fa.length?Vr.Kc.c*Vr.Kc.i:0))!=Ba)da=0;else{if(Ba>Vr.Vb){if(Vr.Vb=0,Vr.Ec=Ce(Ba),Vr.Fc=0,Vr.Ec==null){da=ei(Vr,1,"no memory during frame initialization.");break t}Vr.Vb=Ba}Ba=Vr.Ec,Ga=Vr.Fc,Vr.Ac=Ba,Vr.Bc=Ga,Ga+=Ma,Vr.Gd=De(xn,Fs),Vr.Hd=0,Vr.rb=De(cn+1,ci),Vr.sb=1,Vr.wa=Dn?De(Dn,Un):null,Vr.Y=0,Vr.D.Nb=0,Vr.D.wa=Vr.wa,Vr.D.Y=Vr.Y,0<Vr.Aa&&(Vr.D.Y+=Ha),t(!0),Vr.oc=Ba,Vr.pc=Ga,Ga+=832,Vr.ya=De(pn,to),Vr.aa=0,Vr.D.ya=Vr.ya,Vr.D.aa=Vr.aa,Vr.Aa==2&&(Vr.D.aa+=Ha),Vr.R=16*Ha,Vr.B=8*Ha,Ha=(xn=dc[Vr.L])*Vr.R,xn=xn/2*Vr.B,Vr.sa=Ba,Vr.ta=Ga+Ha,Vr.qa=Vr.sa,Vr.ra=Vr.ta+16*da*Vr.R+xn,Vr.Ha=Vr.qa,Vr.Ia=Vr.ra+8*da*Vr.B+xn,Vr.$c=0,Ga+=ma,Vr.mb=Da?Ba:null,Vr.nb=Da?Ga:null,t(Ga+Da<=Vr.Fc+Vr.Vb),Lc(Vr),Ee(Vr.Ac,Vr.Bc,0,Ma),da=1}}if(da){if(la.ka=0,la.y=Vr.sa,la.O=Vr.ta,la.f=Vr.qa,la.N=Vr.ra,la.ea=Vr.Ha,la.Vd=Vr.Ia,la.fa=Vr.R,la.Rc=Vr.B,la.F=null,la.J=0,!mu){for(da=-255;255>=da;++da)Ml[255+da]=0>da?-da:da;for(da=-1020;1020>=da;++da)gu[1020+da]=-128>da?-128:127<da?127:da;for(da=-112;112>=da;++da)Vc[112+da]=-16>da?-16:15<da?15:da;for(da=-255;510>=da;++da)Gc[255+da]=0>da?0:255<da?255:da;mu=1}Os=no,Ko=Dc,Us=ws,ti=Mc,Yn=Oc,ds=iu,pi=hu,Pi=jo,To=Lr,uo=Kr,Ll=du,qc=cr,Yu=ra,Nf=fa,Ff=Oo,Lf=Po,Ku=Rl,$u=Uc,Ni[0]=uu,Ni[1]=su,Ni[2]=cu,Ni[3]=Bc,Ni[4]=Ls,Ni[5]=jc,Ni[6]=ns,Ni[7]=Tl,Ni[8]=kl,Ni[9]=Ds,As[0]=io,As[1]=Pc,As[2]=Ic,As[3]=lu,As[4]=Do,As[5]=El,As[6]=sl,fo[0]=Zl,fo[1]=ou,fo[2]=_o,fo[3]=fu,fo[4]=Qi,fo[5]=Jl,fo[6]=xo,da=1}else da=0}da&&(da=(function(zn,yi){for(zn.M=0;zn.M<zn.Va;++zn.M){var On,un=zn.Jc[zn.M&zn.Xb],rn=zn.m,Ti=zn;for(On=0;On<Ti.za;++On){var Cn=rn,Pn=Ti,si=Pn.Ac,Zi=Pn.Bc+4*On,fs=Pn.zc,gi=Pn.ya[Pn.aa+On];if(Pn.Qa.Bb?gi.$b=kr(Cn,Pn.Pa.jb[0])?2+kr(Cn,Pn.Pa.jb[2]):kr(Cn,Pn.Pa.jb[1]):gi.$b=0,Pn.kc&&(gi.Ad=kr(Cn,Pn.Bd)),gi.Za=!kr(Cn,145)+0,gi.Za){var zi=gi.Ob,ms=0;for(Pn=0;4>Pn;++Pn){var Hi,jn=fs[0+Pn];for(Hi=0;4>Hi;++Hi){jn=ls[si[Zi+Hi]][jn];for(var Zn=bu[kr(Cn,jn[0])];0<Zn;)Zn=bu[2*Zn+kr(Cn,jn[Zn])];jn=-Zn,si[Zi+Hi]=jn}n(zi,ms,si,Zi,4),ms+=4,fs[0+Pn]=jn}}else jn=kr(Cn,156)?kr(Cn,128)?1:3:kr(Cn,163)?2:0,gi.Ob[0]=jn,Ee(si,Zi,jn,4),Ee(fs,0,jn,4);gi.Dd=kr(Cn,142)?kr(Cn,114)?kr(Cn,183)?1:3:2:0}if(Ti.m.Ka)return ei(zn,7,"Premature end-of-partition0 encountered.");for(;zn.ja<zn.za;++zn.ja){if(Ti=un,Cn=(rn=zn).rb[rn.sb-1],si=rn.rb[rn.sb+rn.ja],On=rn.ya[rn.aa+rn.ja],Zi=rn.kc?On.Ad:0)Cn.la=si.la=0,On.Za||(Cn.Na=si.Na=0),On.Hc=0,On.Gc=0,On.ia=0;else{var ki,ri;if(Cn=si,si=Ti,Zi=rn.Pa.Xc,fs=rn.ya[rn.aa+rn.ja],gi=rn.pb[fs.$b],Pn=fs.ad,zi=0,ms=rn.rb[rn.sb-1],jn=Hi=0,Ee(Pn,zi,0,384),fs.Za)var Ji=0,Ci=Zi[3];else{Zn=Ce(16);var Jn=Cn.Na+ms.Na;if(Jn=Is(si,Zi[1],Jn,gi.Eb,0,Zn,0),Cn.Na=ms.Na=(0<Jn)+0,1<Jn)Os(Zn,0,Pn,zi);else{var Bi=Zn[0]+3>>3;for(Zn=0;256>Zn;Zn+=16)Pn[zi+Zn]=Bi}Ji=1,Ci=Zi[0]}var oi=15&Cn.la,Xi=15&ms.la;for(Zn=0;4>Zn;++Zn){var qi=1&Xi;for(Bi=ri=0;4>Bi;++Bi)oi=oi>>1|(qi=(Jn=Is(si,Ci,Jn=qi+(1&oi),gi.Sc,Ji,Pn,zi))>Ji)<<7,ri=ri<<2|(3<Jn?3:1<Jn?2:Pn[zi+0]!=0),zi+=16;oi>>=4,Xi=Xi>>1|qi<<7,Hi=(Hi<<8|ri)>>>0}for(Ci=oi,Ji=Xi>>4,ki=0;4>ki;ki+=2){for(ri=0,oi=Cn.la>>4+ki,Xi=ms.la>>4+ki,Zn=0;2>Zn;++Zn){for(qi=1&Xi,Bi=0;2>Bi;++Bi)Jn=qi+(1&oi),oi=oi>>1|(qi=0<(Jn=Is(si,Zi[2],Jn,gi.Qc,0,Pn,zi)))<<3,ri=ri<<2|(3<Jn?3:1<Jn?2:Pn[zi+0]!=0),zi+=16;oi>>=2,Xi=Xi>>1|qi<<5}jn|=ri<<4*ki,Ci|=oi<<4<<ki,Ji|=(240&Xi)<<ki}Cn.la=Ci,ms.la=Ji,fs.Hc=Hi,fs.Gc=jn,fs.ia=43690&jn?0:gi.ia,Zi=!(Hi|jn)}if(0<rn.L&&(rn.wa[rn.Y+rn.ja]=rn.gd[On.$b][On.Za],rn.wa[rn.Y+rn.ja].La|=!Zi),Ti.Ka)return ei(zn,7,"Premature end-of-file encountered.")}if(Lc(zn),rn=yi,Ti=1,On=(un=zn).D,Cn=0<un.L&&un.M>=un.zb&&un.M<=un.Va,un.Aa==0)t:{if(On.M=un.M,On.uc=Cn,Ms(un,On),Ti=1,On=(ri=un.D).Nb,Cn=(jn=dc[un.L])*un.R,si=jn/2*un.B,Zn=16*On*un.R,Bi=8*On*un.B,Zi=un.sa,fs=un.ta-Cn+Zn,gi=un.qa,Pn=un.ra-si+Bi,zi=un.Ha,ms=un.Ia-si+Bi,Xi=(oi=ri.M)==0,Hi=oi>=un.Va-1,un.Aa==2&&Ms(un,ri),ri.uc)for(qi=(Jn=un).D.M,t(Jn.D.uc),ri=Jn.yb;ri<Jn.Hb;++ri){Ji=ri,Ci=qi;var ui=(Kn=(Wi=Jn).D).Nb;ki=Wi.R;var Kn=Kn.wa[Kn.Y+Ji],_s=Wi.sa,Fi=Wi.ta+16*ui*ki+16*Ji,Sn=Kn.dd,An=Kn.tc;if(An!=0)if(t(3<=An),Wi.L==1)0<Ji&&Lf(_s,Fi,ki,An+4),Kn.La&&$u(_s,Fi,ki,An),0<Ci&&Ff(_s,Fi,ki,An+4),Kn.La&&Ku(_s,Fi,ki,An);else{var Qn=Wi.B,Ns=Wi.qa,Ks=Wi.ra+8*ui*Qn+8*Ji,Es=Wi.Ha,Wi=Wi.Ia+8*ui*Qn+8*Ji;ui=Kn.ld,0<Ji&&(Pi(_s,Fi,ki,An+4,Sn,ui),uo(Ns,Ks,Es,Wi,Qn,An+4,Sn,ui)),Kn.La&&(qc(_s,Fi,ki,An,Sn,ui),Nf(Ns,Ks,Es,Wi,Qn,An,Sn,ui)),0<Ci&&(pi(_s,Fi,ki,An+4,Sn,ui),To(Ns,Ks,Es,Wi,Qn,An+4,Sn,ui)),Kn.La&&(Ll(_s,Fi,ki,An,Sn,ui),Yu(Ns,Ks,Es,Wi,Qn,An,Sn,ui))}}if(un.ia&&alert("todo:DitherRow"),rn.put!=null){if(ri=16*oi,oi=16*(oi+1),Xi?(rn.y=un.sa,rn.O=un.ta+Zn,rn.f=un.qa,rn.N=un.ra+Bi,rn.ea=un.Ha,rn.W=un.Ia+Bi):(ri-=jn,rn.y=Zi,rn.O=fs,rn.f=gi,rn.N=Pn,rn.ea=zi,rn.W=ms),Hi||(oi-=jn),oi>rn.o&&(oi=rn.o),rn.F=null,rn.J=null,un.Fa!=null&&0<un.Fa.length&&ri<oi&&(rn.J=di(un,rn,ri,oi-ri),rn.F=un.mb,rn.F==null&&rn.F.length==0)){Ti=ei(un,3,"Could not decode alpha data.");break t}ri<rn.j&&(jn=rn.j-ri,ri=rn.j,t(!(1&jn)),rn.O+=un.R*jn,rn.N+=un.B*(jn>>1),rn.W+=un.B*(jn>>1),rn.F!=null&&(rn.J+=rn.width*jn)),ri<oi&&(rn.O+=rn.v,rn.N+=rn.v>>1,rn.W+=rn.v>>1,rn.F!=null&&(rn.J+=rn.v),rn.ka=ri-rn.j,rn.U=rn.va-rn.v,rn.T=oi-ri,Ti=rn.put(rn))}On+1!=un.Ic||Hi||(n(un.sa,un.ta-Cn,Zi,fs+16*un.R,Cn),n(un.qa,un.ra-si,gi,Pn+8*un.B,si),n(un.Ha,un.Ia-si,zi,ms+8*un.B,si))}if(!Ti)return ei(zn,6,"Output aborted.")}return 1})(Vr,la)),la.bc!=null&&la.bc(la),da&=1}return da?(Vr.cb=0,da):0})(Ye,Sr)||(Qe=Ye.a)}}else Qe=Ye.a}Qe==0&&Br.Oa!=null&&Br.Oa.fd&&(Qe=Xc(Br.ba))}Br=Qe}Ir=Br!=0?null:11>Ir?Ur.f.RGBA.eb:Ur.f.kb.y}else Ir=null;return Ir};var Tu=[3,4,3,4,4,2,2,4,4,4,2,1,1]};function Oe(fr,Rr){for(var mr="",wr=0;wr<4;wr++)mr+=String.fromCharCode(fr[Rr++]);return mr}function Be(fr,Rr){return fr[Rr+0]|fr[Rr+1]<<8}function He(fr,Rr){return(fr[Rr+0]|fr[Rr+1]<<8|fr[Rr+2]<<16)>>>0}function Ve(fr,Rr){return(fr[Rr+0]|fr[Rr+1]<<8|fr[Rr+2]<<16|fr[Rr+3]<<24)>>>0}new ze;var Xe=[0],We=[0],Ge=[],$e=new ze,Ke=e,rr=(function(fr,Rr){var mr={},wr=0,Fr=!1,Mr=0,Hr=0;if(mr.frames=[],!(function(Je,nr){for(var or=0;or<4;or++)if(Je[nr+or]!="RIFF".charCodeAt(or))return!0;return!1})(fr,Rr)){for(Ve(fr,Rr+=4),Rr+=8;Rr<fr.length;){var Nr=Oe(fr,Rr),Ar=Ve(fr,Rr+=4);Rr+=4;var xr=Ar+(1&Ar);switch(Nr){case"VP8 ":case"VP8L":mr.frames[wr]===void 0&&(mr.frames[wr]={}),(ur=mr.frames[wr]).src_off=Fr?Hr:Rr-8,ur.src_size=Mr+Ar+8,wr++,Fr&&(Fr=!1,Mr=0,Hr=0);break;case"VP8X":(ur=mr.header={}).feature_flags=fr[Rr];var ir=Rr+4;ur.canvas_width=1+He(fr,ir),ir+=3,ur.canvas_height=1+He(fr,ir),ir+=3;break;case"ALPH":Fr=!0,Mr=xr+8,Hr=Rr-8;break;case"ANIM":(ur=mr.header).bgcolor=Ve(fr,Rr),ir=Rr+4,ur.loop_count=Be(fr,ir),ir+=2;break;case"ANMF":var _r,ur;(ur=mr.frames[wr]={}).offset_x=2*He(fr,Rr),Rr+=3,ur.offset_y=2*He(fr,Rr),Rr+=3,ur.width=1+He(fr,Rr),Rr+=3,ur.height=1+He(fr,Rr),Rr+=3,ur.duration=He(fr,Rr),Rr+=3,_r=fr[Rr++],ur.dispose=1&_r,ur.blend=_r>>1&1}Nr!="ANMF"&&(Rr+=xr)}return mr}})(Ke,0);rr.response=Ke,rr.rgbaoutput=!0,rr.dataurl=!1;var tr=rr.header?rr.header:null,sr=rr.frames?rr.frames:null;if(tr){tr.loop_counter=tr.loop_count,Xe=[tr.canvas_height],We=[tr.canvas_width];for(var ar=0;ar<sr.length&&sr[ar].blend!=0;ar++);}var hr=sr[0],pr=$e.WebPDecodeRGBA(Ke,hr.src_off,hr.src_size,We,Xe);hr.rgba=pr,hr.imgwidth=We[0],hr.imgheight=Xe[0];for(var yr=0;yr<We[0]*Xe[0]*4;yr++)Ge[yr]=pr[yr];return this.width=We,this.height=Xe,this.data=Ge,this}(function(e){var t,r,n,Ee,Ce,De,Me,ze,Oe,Be=function(Je){return Je=Je||{},this.isStrokeTransparent=Je.isStrokeTransparent||!1,this.strokeOpacity=Je.strokeOpacity||1,this.strokeStyle=Je.strokeStyle||"#000000",this.fillStyle=Je.fillStyle||"#000000",this.isFillTransparent=Je.isFillTransparent||!1,this.fillOpacity=Je.fillOpacity||1,this.font=Je.font||"10px sans-serif",this.textBaseline=Je.textBaseline||"alphabetic",this.textAlign=Je.textAlign||"left",this.lineWidth=Je.lineWidth||1,this.lineJoin=Je.lineJoin||"miter",this.lineCap=Je.lineCap||"butt",this.path=Je.path||[],this.transform=Je.transform!==void 0?Je.transform.clone():new ze,this.globalCompositeOperation=Je.globalCompositeOperation||"normal",this.globalAlpha=Je.globalAlpha||1,this.clip_path=Je.clip_path||[],this.currentPoint=Je.currentPoint||new De,this.miterLimit=Je.miterLimit||10,this.lastPoint=Je.lastPoint||new De,this.lineDashOffset=Je.lineDashOffset||0,this.lineDash=Je.lineDash||[],this.margin=Je.margin||[0,0,0,0],this.prevPageLastElemOffset=Je.prevPageLastElemOffset||0,this.ignoreClearRect=typeof Je.ignoreClearRect!="boolean"||Je.ignoreClearRect,this};e.events.push(["initialized",function(){this.context2d=new He(this),t=this.internal.f2,r=this.internal.getCoordinateString,n=this.internal.getVerticalCoordinateString,Ee=this.internal.getHorizontalCoordinate,Ce=this.internal.getVerticalCoordinate,De=this.internal.Point,Me=this.internal.Rectangle,ze=this.internal.Matrix,Oe=new Be}]);var He=function(Je){Object.defineProperty(this,"canvas",{get:function(){return{parentNode:!1,style:!1}}});var nr=Je;Object.defineProperty(this,"pdf",{get:function(){return nr}});var or=!1;Object.defineProperty(this,"pageWrapXEnabled",{get:function(){return or},set:function(Cr){or=!!Cr}});var lr=!1;Object.defineProperty(this,"pageWrapYEnabled",{get:function(){return lr},set:function(Cr){lr=!!Cr}});var St=0;Object.defineProperty(this,"posX",{get:function(){return St},set:function(Cr){isNaN(Cr)||(St=Cr)}});var dr=0;Object.defineProperty(this,"posY",{get:function(){return dr},set:function(Cr){isNaN(Cr)||(dr=Cr)}}),Object.defineProperty(this,"margin",{get:function(){return Oe.margin},set:function(Cr){var Jr;typeof Cr=="number"?Jr=[Cr,Cr,Cr,Cr]:((Jr=new Array(4))[0]=Cr[0],Jr[1]=Cr.length>=2?Cr[1]:Jr[0],Jr[2]=Cr.length>=3?Cr[2]:Jr[0],Jr[3]=Cr.length>=4?Cr[3]:Jr[1]),Oe.margin=Jr}});var vr=!1;Object.defineProperty(this,"autoPaging",{get:function(){return vr},set:function(Cr){vr=Cr}});var br=0;Object.defineProperty(this,"lastBreak",{get:function(){return br},set:function(Cr){br=Cr}});var kr=[];Object.defineProperty(this,"pageBreaks",{get:function(){return kr},set:function(Cr){kr=Cr}}),Object.defineProperty(this,"ctx",{get:function(){return Oe},set:function(Cr){Cr instanceof Be&&(Oe=Cr)}}),Object.defineProperty(this,"path",{get:function(){return Oe.path},set:function(Cr){Oe.path=Cr}});var Pr=[];Object.defineProperty(this,"ctxStack",{get:function(){return Pr},set:function(Cr){Pr=Cr}}),Object.defineProperty(this,"fillStyle",{get:function(){return this.ctx.fillStyle},set:function(Cr){var Jr;Jr=Ve(Cr),this.ctx.fillStyle=Jr.style,this.ctx.isFillTransparent=Jr.a===0,this.ctx.fillOpacity=Jr.a,this.pdf.setFillColor(Jr.r,Jr.g,Jr.b,{a:Jr.a}),this.pdf.setTextColor(Jr.r,Jr.g,Jr.b,{a:Jr.a})}}),Object.defineProperty(this,"strokeStyle",{get:function(){return this.ctx.strokeStyle},set:function(Cr){var Jr=Ve(Cr);this.ctx.strokeStyle=Jr.style,this.ctx.isStrokeTransparent=Jr.a===0,this.ctx.strokeOpacity=Jr.a,Jr.a===0?this.pdf.setDrawColor(255,255,255):(Jr.a,this.pdf.setDrawColor(Jr.r,Jr.g,Jr.b))}}),Object.defineProperty(this,"lineCap",{get:function(){return this.ctx.lineCap},set:function(Cr){["butt","round","square"].indexOf(Cr)!==-1&&(this.ctx.lineCap=Cr,this.pdf.setLineCap(Cr))}}),Object.defineProperty(this,"lineWidth",{get:function(){return this.ctx.lineWidth},set:function(Cr){isNaN(Cr)||(this.ctx.lineWidth=Cr,this.pdf.setLineWidth(Cr))}}),Object.defineProperty(this,"lineJoin",{get:function(){return this.ctx.lineJoin},set:function(Cr){["bevel","round","miter"].indexOf(Cr)!==-1&&(this.ctx.lineJoin=Cr,this.pdf.setLineJoin(Cr))}}),Object.defineProperty(this,"miterLimit",{get:function(){return this.ctx.miterLimit},set:function(Cr){isNaN(Cr)||(this.ctx.miterLimit=Cr,this.pdf.setMiterLimit(Cr))}}),Object.defineProperty(this,"textBaseline",{get:function(){return this.ctx.textBaseline},set:function(Cr){this.ctx.textBaseline=Cr}}),Object.defineProperty(this,"textAlign",{get:function(){return this.ctx.textAlign},set:function(Cr){["right","end","center","left","start"].indexOf(Cr)!==-1&&(this.ctx.textAlign=Cr)}});var Er=null,Zr=null,ua=null;Object.defineProperty(this,"fontFaces",{get:function(){return ua},set:function(Cr){Er=null,Zr=null,ua=Cr}}),Object.defineProperty(this,"font",{get:function(){return this.ctx.font},set:function(Cr){var Jr;if(this.ctx.font=Cr,(Jr=/^\s*(?=(?:(?:[-a-z]+\s*){0,2}(italic|oblique))?)(?=(?:(?:[-a-z]+\s*){0,2}(small-caps))?)(?=(?:(?:[-a-z]+\s*){0,2}(bold(?:er)?|lighter|[1-9]00))?)(?:(?:normal|\1|\2|\3)\s*){0,3}((?:xx?-)?(?:small|large)|medium|smaller|larger|[.\d]+(?:\%|in|[cem]m|ex|p[ctx]))(?:\s*\/\s*(normal|[.\d]+(?:\%|in|[cem]m|ex|p[ctx])))?\s*([-_,\"\'\sa-z0-9]+?)\s*$/i.exec(Cr))!==null){var Qr=Jr[1];Jr[2];var oa=Jr[3],ta=Jr[4];Jr[5];var Na=Jr[6],Ca=/^([.\d]+)((?:%|in|[cem]m|ex|p[ctx]))$/i.exec(ta)[2];ta=Math.floor(Ca==="px"?parseFloat(ta)*this.pdf.internal.scaleFactor:Ca==="em"?parseFloat(ta)*this.pdf.getFontSize():parseFloat(ta)*this.pdf.internal.scaleFactor),this.pdf.setFontSize(ta);var za=(function(en){var Bn,vn,va=[],aa=en.trim();if(aa==="")return Jt;if(aa in Mt)return[Mt[aa]];for(;aa!=="";){switch(vn=null,Bn=(aa=Et(aa)).charAt(0)){case'"':case"'":vn=Rt(aa.substring(1),Bn);break;default:vn=Dt(aa)}if(vn===null||(va.push(vn[0]),(aa=Et(vn[1]))!==""&&aa.charAt(0)!==","))return Jt;aa=aa.replace(/^,/,"")}return va})(Na);if(this.fontFaces){var Xa=(function(en,Bn){var vn=en.getFontList(),va=JSON.stringify(vn);if(Er===null||Zr!==va){var aa=(function(ia){var Oa=[];return Object.keys(ia).forEach(function(ca){ia[ca].forEach(function(pa){var xa=null;switch(pa){case"bold":xa={family:ca,weight:"bold"};break;case"italic":xa={family:ca,style:"italic"};break;case"bolditalic":xa={family:ca,weight:"bold",style:"italic"};break;case"":case"normal":xa={family:ca}}xa!==null&&(xa.ref={name:ca,style:pa},Oa.push(xa))})}),Oa})(vn);Er=(function(ia){for(var Oa={},ca=0;ca<ia.length;++ca){var pa=Ct(ia[ca]),xa=pa.family,$a=pa.stretch,ka=pa.style,La=pa.weight;Oa[xa]=Oa[xa]||{},Oa[xa][$a]=Oa[xa][$a]||{},Oa[xa][$a][ka]=Oa[xa][$a][ka]||{},Oa[xa][$a][ka][La]=pa}return Oa})(aa.concat(Bn)),Zr=va}return Er})(this.pdf,this.fontFaces),Ya=za.map(function(en){return{family:en,stretch:"normal",weight:oa,style:Qr}}),nn=(function(en,Bn,vn){for(var va=(vn=vn||{}).defaultFontFamily||"times",aa=Object.assign({},Bt,vn.genericFontFamilies||{}),ia=null,Oa=null,ca=0;ca<Bn.length;++ca)if(aa[(ia=Ct(Bn[ca])).family]&&(ia.family=aa[ia.family]),en.hasOwnProperty(ia.family)){Oa=en[ia.family];break}if(!(Oa=Oa||en[va]))throw new Error("Could not find a font-family for the rule '"+qt(ia)+"' and default family '"+va+"'.");if(Oa=(function(pa,xa){if(xa[pa])return xa[pa];var $a=Ft[pa],ka=$a<=Ft.normal?-1:1,La=Ot(xa,kt,$a,ka);if(!La)throw new Error("Could not find a matching font-stretch value for "+pa);return La})(ia.stretch,Oa),Oa=(function(pa,xa){if(xa[pa])return xa[pa];for(var $a=Pt[pa],ka=0;ka<$a.length;++ka)if(xa[$a[ka]])return xa[$a[ka]];throw new Error("Could not find a matching font-style for "+pa)})(ia.style,Oa),!(Oa=(function(pa,xa){if(xa[pa])return xa[pa];if(pa===400&&xa[500])return xa[500];if(pa===500&&xa[400])return xa[400];var $a=jt[pa],ka=Ot(xa,It,$a,pa<400?-1:1);if(!ka)throw new Error("Could not find a matching font-weight for value "+pa);return ka})(ia.weight,Oa)))throw new Error("Failed to resolve a font for the rule '"+qt(ia)+"'.");return Oa})(Xa,Ya);this.pdf.setFont(nn.ref.name,nn.ref.style)}else{var on="";(oa==="bold"||parseInt(oa,10)>=700||Qr==="bold")&&(on="bold"),Qr==="italic"&&(on+="italic"),on.length===0&&(on="normal");for(var yn="",fn={arial:"Helvetica",Arial:"Helvetica",verdana:"Helvetica",Verdana:"Helvetica",helvetica:"Helvetica",Helvetica:"Helvetica","sans-serif":"Helvetica",fixed:"Courier",monospace:"Courier",terminal:"Courier",cursive:"Times",fantasy:"Times",serif:"Times"},Qa=0;Qa<za.length;Qa++){if(this.pdf.internal.getFont(za[Qa],on,{noFallback:!0,disableWarning:!0})!==void 0){yn=za[Qa];break}if(on==="bolditalic"&&this.pdf.internal.getFont(za[Qa],"bold",{noFallback:!0,disableWarning:!0})!==void 0)yn=za[Qa],on="bold";else if(this.pdf.internal.getFont(za[Qa],"normal",{noFallback:!0,disableWarning:!0})!==void 0){yn=za[Qa],on="normal";break}}if(yn===""){for(var Ka=0;Ka<za.length;Ka++)if(fn[za[Ka]]){yn=fn[za[Ka]];break}}yn=yn===""?"Times":yn,this.pdf.setFont(yn,on)}}}}),Object.defineProperty(this,"globalCompositeOperation",{get:function(){return this.ctx.globalCompositeOperation},set:function(Cr){this.ctx.globalCompositeOperation=Cr}}),Object.defineProperty(this,"globalAlpha",{get:function(){return this.ctx.globalAlpha},set:function(Cr){this.ctx.globalAlpha=Cr}}),Object.defineProperty(this,"lineDashOffset",{get:function(){return this.ctx.lineDashOffset},set:function(Cr){this.ctx.lineDashOffset=Cr,ur.call(this)}}),Object.defineProperty(this,"lineDash",{get:function(){return this.ctx.lineDash},set:function(Cr){this.ctx.lineDash=Cr,ur.call(this)}}),Object.defineProperty(this,"ignoreClearRect",{get:function(){return this.ctx.ignoreClearRect},set:function(Cr){this.ctx.ignoreClearRect=!!Cr}})};He.prototype.setLineDash=function(Je){this.lineDash=Je},He.prototype.getLineDash=function(){return this.lineDash.length%2?this.lineDash.concat(this.lineDash):this.lineDash.slice()},He.prototype.fill=function(){sr.call(this,"fill",!1)},He.prototype.stroke=function(){sr.call(this,"stroke",!1)},He.prototype.beginPath=function(){this.path=[{type:"begin"}]},He.prototype.moveTo=function(Je,nr){if(isNaN(Je)||isNaN(nr))throw o.error("jsPDF.context2d.moveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.moveTo");var or=this.ctx.transform.applyToPoint(new De(Je,nr));this.path.push({type:"mt",x:or.x,y:or.y}),this.ctx.lastPoint=new De(Je,nr)},He.prototype.closePath=function(){var Je=new De(0,0),nr=0;for(nr=this.path.length-1;nr!==-1;nr--)if(this.path[nr].type==="begin"&&_typeof(this.path[nr+1])==="object"&&typeof this.path[nr+1].x=="number"){Je=new De(this.path[nr+1].x,this.path[nr+1].y);break}this.path.push({type:"close"}),this.ctx.lastPoint=new De(Je.x,Je.y)},He.prototype.lineTo=function(Je,nr){if(isNaN(Je)||isNaN(nr))throw o.error("jsPDF.context2d.lineTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.lineTo");var or=this.ctx.transform.applyToPoint(new De(Je,nr));this.path.push({type:"lt",x:or.x,y:or.y}),this.ctx.lastPoint=new De(or.x,or.y)},He.prototype.clip=function(){this.ctx.clip_path=JSON.parse(JSON.stringify(this.path)),sr.call(this,null,!0)},He.prototype.quadraticCurveTo=function(Je,nr,or,lr){if(isNaN(or)||isNaN(lr)||isNaN(Je)||isNaN(nr))throw o.error("jsPDF.context2d.quadraticCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.quadraticCurveTo");var St=this.ctx.transform.applyToPoint(new De(or,lr)),dr=this.ctx.transform.applyToPoint(new De(Je,nr));this.path.push({type:"qct",x1:dr.x,y1:dr.y,x:St.x,y:St.y}),this.ctx.lastPoint=new De(St.x,St.y)},He.prototype.bezierCurveTo=function(Je,nr,or,lr,St,dr){if(isNaN(St)||isNaN(dr)||isNaN(Je)||isNaN(nr)||isNaN(or)||isNaN(lr))throw o.error("jsPDF.context2d.bezierCurveTo: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.bezierCurveTo");var vr=this.ctx.transform.applyToPoint(new De(St,dr)),br=this.ctx.transform.applyToPoint(new De(Je,nr)),kr=this.ctx.transform.applyToPoint(new De(or,lr));this.path.push({type:"bct",x1:br.x,y1:br.y,x2:kr.x,y2:kr.y,x:vr.x,y:vr.y}),this.ctx.lastPoint=new De(vr.x,vr.y)},He.prototype.arc=function(Je,nr,or,lr,St,dr){if(isNaN(Je)||isNaN(nr)||isNaN(or)||isNaN(lr)||isNaN(St))throw o.error("jsPDF.context2d.arc: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.arc");if(dr=!!dr,!this.ctx.transform.isIdentity){var vr=this.ctx.transform.applyToPoint(new De(Je,nr));Je=vr.x,nr=vr.y;var br=this.ctx.transform.applyToPoint(new De(0,or)),kr=this.ctx.transform.applyToPoint(new De(0,0));or=Math.sqrt(Math.pow(br.x-kr.x,2)+Math.pow(br.y-kr.y,2))}Math.abs(St-lr)>=2*Math.PI&&(lr=0,St=2*Math.PI),this.path.push({type:"arc",x:Je,y:nr,radius:or,startAngle:lr,endAngle:St,counterclockwise:dr})},He.prototype.arcTo=function(Je,nr,or,lr,St){throw new Error("arcTo not implemented.")},He.prototype.rect=function(Je,nr,or,lr){if(isNaN(Je)||isNaN(nr)||isNaN(or)||isNaN(lr))throw o.error("jsPDF.context2d.rect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rect");this.moveTo(Je,nr),this.lineTo(Je+or,nr),this.lineTo(Je+or,nr+lr),this.lineTo(Je,nr+lr),this.lineTo(Je,nr),this.lineTo(Je+or,nr),this.lineTo(Je,nr)},He.prototype.fillRect=function(Je,nr,or,lr){if(isNaN(Je)||isNaN(nr)||isNaN(or)||isNaN(lr))throw o.error("jsPDF.context2d.fillRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillRect");if(!Xe.call(this)){var St={};this.lineCap!=="butt"&&(St.lineCap=this.lineCap,this.lineCap="butt"),this.lineJoin!=="miter"&&(St.lineJoin=this.lineJoin,this.lineJoin="miter"),this.beginPath(),this.rect(Je,nr,or,lr),this.fill(),St.hasOwnProperty("lineCap")&&(this.lineCap=St.lineCap),St.hasOwnProperty("lineJoin")&&(this.lineJoin=St.lineJoin)}},He.prototype.strokeRect=function(Je,nr,or,lr){if(isNaN(Je)||isNaN(nr)||isNaN(or)||isNaN(lr))throw o.error("jsPDF.context2d.strokeRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeRect");We.call(this)||(this.beginPath(),this.rect(Je,nr,or,lr),this.stroke())},He.prototype.clearRect=function(Je,nr,or,lr){if(isNaN(Je)||isNaN(nr)||isNaN(or)||isNaN(lr))throw o.error("jsPDF.context2d.clearRect: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.clearRect");this.ignoreClearRect||(this.fillStyle="#ffffff",this.fillRect(Je,nr,or,lr))},He.prototype.save=function(Je){Je=typeof Je!="boolean"||Je;for(var nr=this.pdf.internal.getCurrentPageInfo().pageNumber,or=0;or<this.pdf.internal.getNumberOfPages();or++)this.pdf.setPage(or+1),this.pdf.internal.out("q");if(this.pdf.setPage(nr),Je){this.ctx.fontSize=this.pdf.internal.getFontSize();var lr=new Be(this.ctx);this.ctxStack.push(this.ctx),this.ctx=lr}},He.prototype.restore=function(Je){Je=typeof Je!="boolean"||Je;for(var nr=this.pdf.internal.getCurrentPageInfo().pageNumber,or=0;or<this.pdf.internal.getNumberOfPages();or++)this.pdf.setPage(or+1),this.pdf.internal.out("Q");this.pdf.setPage(nr),Je&&this.ctxStack.length!==0&&(this.ctx=this.ctxStack.pop(),this.fillStyle=this.ctx.fillStyle,this.strokeStyle=this.ctx.strokeStyle,this.font=this.ctx.font,this.lineCap=this.ctx.lineCap,this.lineWidth=this.ctx.lineWidth,this.lineJoin=this.ctx.lineJoin,this.lineDash=this.ctx.lineDash,this.lineDashOffset=this.ctx.lineDashOffset)},He.prototype.toDataURL=function(){throw new Error("toDataUrl not implemented.")};var Ve=function(Je){var nr,or,lr,St;if(Je.isCanvasGradient===!0&&(Je=Je.getColor()),!Je)return{r:0,g:0,b:0,a:0,style:Je};if(/transparent|rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*0+\s*\)/.test(Je))nr=0,or=0,lr=0,St=0;else{var dr=/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/.exec(Je);if(dr!==null)nr=parseInt(dr[1]),or=parseInt(dr[2]),lr=parseInt(dr[3]),St=1;else if((dr=/rgba\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*,\s*([\d.]+)\s*\)/.exec(Je))!==null)nr=parseInt(dr[1]),or=parseInt(dr[2]),lr=parseInt(dr[3]),St=parseFloat(dr[4]);else{if(St=1,typeof Je=="string"&&Je.charAt(0)!=="#"){var vr=new h(Je);Je=vr.ok?vr.toHex():"#000000"}Je.length===4?(nr=Je.substring(1,2),nr+=nr,or=Je.substring(2,3),or+=or,lr=Je.substring(3,4),lr+=lr):(nr=Je.substring(1,3),or=Je.substring(3,5),lr=Je.substring(5,7)),nr=parseInt(nr,16),or=parseInt(or,16),lr=parseInt(lr,16)}}return{r:nr,g:or,b:lr,a:St,style:Je}},Xe=function(){return this.ctx.isFillTransparent||this.globalAlpha==0},We=function(){return!!(this.ctx.isStrokeTransparent||this.globalAlpha==0)};He.prototype.fillText=function(Je,nr,or,lr){if(isNaN(nr)||isNaN(or)||typeof Je!="string")throw o.error("jsPDF.context2d.fillText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.fillText");if(lr=isNaN(lr)?void 0:lr,!Xe.call(this)){var St=xr(this.ctx.transform.rotation),dr=this.ctx.transform.scaleX;wr.call(this,{text:Je,x:nr,y:or,scale:dr,angle:St,align:this.textAlign,maxWidth:lr})}},He.prototype.strokeText=function(Je,nr,or,lr){if(isNaN(nr)||isNaN(or)||typeof Je!="string")throw o.error("jsPDF.context2d.strokeText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.strokeText");if(!We.call(this)){lr=isNaN(lr)?void 0:lr;var St=xr(this.ctx.transform.rotation),dr=this.ctx.transform.scaleX;wr.call(this,{text:Je,x:nr,y:or,scale:dr,renderingMode:"stroke",angle:St,align:this.textAlign,maxWidth:lr})}},He.prototype.measureText=function(Je){if(typeof Je!="string")throw o.error("jsPDF.context2d.measureText: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.measureText");var nr=this.pdf,or=this.pdf.internal.scaleFactor,lr=nr.internal.getFontSize(),St=nr.getStringUnitWidth(Je)*lr/nr.internal.scaleFactor;return new function(dr){var vr=(dr=dr||{}).width||0;return Object.defineProperty(this,"width",{get:function(){return vr}}),this}({width:St*=Math.round(96*or/72*1e4)/1e4})},He.prototype.scale=function(Je,nr){if(isNaN(Je)||isNaN(nr))throw o.error("jsPDF.context2d.scale: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.scale");var or=new ze(Je,0,0,nr,0,0);this.ctx.transform=this.ctx.transform.multiply(or)},He.prototype.rotate=function(Je){if(isNaN(Je))throw o.error("jsPDF.context2d.rotate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.rotate");var nr=new ze(Math.cos(Je),Math.sin(Je),-Math.sin(Je),Math.cos(Je),0,0);this.ctx.transform=this.ctx.transform.multiply(nr)},He.prototype.translate=function(Je,nr){if(isNaN(Je)||isNaN(nr))throw o.error("jsPDF.context2d.translate: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.translate");var or=new ze(1,0,0,1,Je,nr);this.ctx.transform=this.ctx.transform.multiply(or)},He.prototype.transform=function(Je,nr,or,lr,St,dr){if(isNaN(Je)||isNaN(nr)||isNaN(or)||isNaN(lr)||isNaN(St)||isNaN(dr))throw o.error("jsPDF.context2d.transform: Invalid arguments",arguments),new Error("Invalid arguments passed to jsPDF.context2d.transform");var vr=new ze(Je,nr,or,lr,St,dr);this.ctx.transform=this.ctx.transform.multiply(vr)},He.prototype.setTransform=function(Je,nr,or,lr,St,dr){Je=isNaN(Je)?1:Je,nr=isNaN(nr)?0:nr,or=isNaN(or)?0:or,lr=isNaN(lr)?1:lr,St=isNaN(St)?0:St,dr=isNaN(dr)?0:dr,this.ctx.transform=new ze(Je,nr,or,lr,St,dr)};var Ge=function(){return this.margin[0]>0||this.margin[1]>0||this.margin[2]>0||this.margin[3]>0};He.prototype.drawImage=function(Je,nr,or,lr,St,dr,vr,br,kr){var Pr=this.pdf.getImageProperties(Je),Er=1,Zr=1,ua=1,Cr=1;lr!==void 0&&br!==void 0&&(ua=br/lr,Cr=kr/St,Er=Pr.width/lr*br/lr,Zr=Pr.height/St*kr/St),dr===void 0&&(dr=nr,vr=or,nr=0,or=0),lr!==void 0&&br===void 0&&(br=lr,kr=St),lr===void 0&&br===void 0&&(br=Pr.width,kr=Pr.height);var Jr=this.ctx.transform.decompose(),Qr=xr(Jr.rotate.shx),oa=new ze,ta=(oa=(oa=(oa=oa.multiply(Jr.translate)).multiply(Jr.skew)).multiply(Jr.scale)).applyToRectangle(new Me(dr-nr*ua,vr-or*Cr,lr*Er,St*Zr));if(this.autoPaging){for(var Na,Ca=$e.call(this,ta),za=[],Xa=0;Xa<Ca.length;Xa+=1)za.indexOf(Ca[Xa])===-1&&za.push(Ca[Xa]);tr(za);for(var Ya=za[0],nn=za[za.length-1],on=Ya;on<nn+1;on++){this.pdf.setPage(on);var yn=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],fn=on===1?this.posY+this.margin[0]:this.margin[0],Qa=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Ka=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],en=on===1?0:Qa+(on-2)*Ka;if(this.ctx.clip_path.length!==0){var Bn=this.path;Na=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=rr(Na,this.posX+this.margin[3],-en+fn+this.ctx.prevPageLastElemOffset),ar.call(this,"fill",!0),this.path=Bn}var vn=JSON.parse(JSON.stringify(ta));vn=rr([vn],this.posX+this.margin[3],-en+fn+this.ctx.prevPageLastElemOffset)[0];var va=(on>Ya||on<nn)&&Ge.call(this);va&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],yn,Ka,null).clip().discardPath()),this.pdf.addImage(Je,"JPEG",vn.x,vn.y,vn.w,vn.h,null,null,Qr),va&&this.pdf.restoreGraphicsState()}}else this.pdf.addImage(Je,"JPEG",ta.x,ta.y,ta.w,ta.h,null,null,Qr)};var $e=function(Je,nr,or){var lr=[];nr=nr||this.pdf.internal.pageSize.width,or=or||this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2];var St=this.posY+this.ctx.prevPageLastElemOffset;switch(Je.type){default:case"mt":case"lt":lr.push(Math.floor((Je.y+St)/or)+1);break;case"arc":lr.push(Math.floor((Je.y+St-Je.radius)/or)+1),lr.push(Math.floor((Je.y+St+Je.radius)/or)+1);break;case"qct":var dr=ir(this.ctx.lastPoint.x,this.ctx.lastPoint.y,Je.x1,Je.y1,Je.x,Je.y);lr.push(Math.floor((dr.y+St)/or)+1),lr.push(Math.floor((dr.y+dr.h+St)/or)+1);break;case"bct":var vr=_r(this.ctx.lastPoint.x,this.ctx.lastPoint.y,Je.x1,Je.y1,Je.x2,Je.y2,Je.x,Je.y);lr.push(Math.floor((vr.y+St)/or)+1),lr.push(Math.floor((vr.y+vr.h+St)/or)+1);break;case"rect":lr.push(Math.floor((Je.y+St)/or)+1),lr.push(Math.floor((Je.y+Je.h+St)/or)+1)}for(var br=0;br<lr.length;br+=1)for(;this.pdf.internal.getNumberOfPages()<lr[br];)Ke.call(this);return lr},Ke=function(){var Je=this.fillStyle,nr=this.strokeStyle,or=this.font,lr=this.lineCap,St=this.lineWidth,dr=this.lineJoin;this.pdf.addPage(),this.fillStyle=Je,this.strokeStyle=nr,this.font=or,this.lineCap=lr,this.lineWidth=St,this.lineJoin=dr},rr=function(Je,nr,or){for(var lr=0;lr<Je.length;lr++)switch(Je[lr].type){case"bct":Je[lr].x2+=nr,Je[lr].y2+=or;case"qct":Je[lr].x1+=nr,Je[lr].y1+=or;default:Je[lr].x+=nr,Je[lr].y+=or}return Je},tr=function(Je){return Je.sort(function(nr,or){return nr-or})},sr=function(Je,nr){var or=this.fillStyle,lr=this.strokeStyle,St=this.lineCap,dr=this.lineWidth,vr=Math.abs(dr*this.ctx.transform.scaleX),br=this.lineJoin;if(this.autoPaging){for(var kr,Pr,Er=JSON.parse(JSON.stringify(this.path)),Zr=JSON.parse(JSON.stringify(this.path)),ua=[],Cr=0;Cr<Zr.length;Cr++)if(Zr[Cr].x!==void 0)for(var Jr=$e.call(this,Zr[Cr]),Qr=0;Qr<Jr.length;Qr+=1)ua.indexOf(Jr[Qr])===-1&&ua.push(Jr[Qr]);for(var oa=0;oa<ua.length;oa++)for(;this.pdf.internal.getNumberOfPages()<ua[oa];)Ke.call(this);tr(ua);for(var ta=ua[0],Na=ua[ua.length-1],Ca=ta;Ca<Na+1;Ca++){this.pdf.setPage(Ca),this.fillStyle=or,this.strokeStyle=lr,this.lineCap=St,this.lineWidth=vr,this.lineJoin=br;var za=this.pdf.internal.pageSize.width-this.margin[3]-this.margin[1],Xa=Ca===1?this.posY+this.margin[0]:this.margin[0],Ya=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],nn=this.pdf.internal.pageSize.height-this.margin[0]-this.margin[2],on=Ca===1?0:Ya+(Ca-2)*nn;if(this.ctx.clip_path.length!==0){var yn=this.path;kr=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=rr(kr,this.posX+this.margin[3],-on+Xa+this.ctx.prevPageLastElemOffset),ar.call(this,Je,!0),this.path=yn}if(Pr=JSON.parse(JSON.stringify(Er)),this.path=rr(Pr,this.posX+this.margin[3],-on+Xa+this.ctx.prevPageLastElemOffset),nr===!1||Ca===0){var fn=(Ca>ta||Ca<Na)&&Ge.call(this);fn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],za,nn,null).clip().discardPath()),ar.call(this,Je,nr),fn&&this.pdf.restoreGraphicsState()}this.lineWidth=dr}this.path=Er}else this.lineWidth=vr,ar.call(this,Je,nr),this.lineWidth=dr},ar=function(Je,nr){if((Je!=="stroke"||nr||!We.call(this))&&(Je==="stroke"||nr||!Xe.call(this))){for(var or,lr,St=[],dr=this.path,vr=0;vr<dr.length;vr++){var br=dr[vr];switch(br.type){case"begin":St.push({begin:!0});break;case"close":St.push({close:!0});break;case"mt":St.push({start:br,deltas:[],abs:[]});break;case"lt":var kr=St.length;if(dr[vr-1]&&!isNaN(dr[vr-1].x)&&(or=[br.x-dr[vr-1].x,br.y-dr[vr-1].y],kr>0)){for(;kr>=0;kr--)if(St[kr-1].close!==!0&&St[kr-1].begin!==!0){St[kr-1].deltas.push(or),St[kr-1].abs.push(br);break}}break;case"bct":or=[br.x1-dr[vr-1].x,br.y1-dr[vr-1].y,br.x2-dr[vr-1].x,br.y2-dr[vr-1].y,br.x-dr[vr-1].x,br.y-dr[vr-1].y],St[St.length-1].deltas.push(or);break;case"qct":var Pr=dr[vr-1].x+2/3*(br.x1-dr[vr-1].x),Er=dr[vr-1].y+2/3*(br.y1-dr[vr-1].y),Zr=br.x+2/3*(br.x1-br.x),ua=br.y+2/3*(br.y1-br.y),Cr=br.x,Jr=br.y;or=[Pr-dr[vr-1].x,Er-dr[vr-1].y,Zr-dr[vr-1].x,ua-dr[vr-1].y,Cr-dr[vr-1].x,Jr-dr[vr-1].y],St[St.length-1].deltas.push(or);break;case"arc":St.push({deltas:[],abs:[],arc:!0}),Array.isArray(St[St.length-1].abs)&&St[St.length-1].abs.push(br)}}lr=nr?null:Je==="stroke"?"stroke":"fill";for(var Qr=!1,oa=0;oa<St.length;oa++)if(St[oa].arc)for(var ta=St[oa].abs,Na=0;Na<ta.length;Na++){var Ca=ta[Na];Ca.type==="arc"?yr.call(this,Ca.x,Ca.y,Ca.radius,Ca.startAngle,Ca.endAngle,Ca.counterclockwise,void 0,nr,!Qr):Fr.call(this,Ca.x,Ca.y),Qr=!0}else if(St[oa].close===!0)this.pdf.internal.out("h"),Qr=!1;else if(St[oa].begin!==!0){var za=St[oa].start.x,Xa=St[oa].start.y;Mr.call(this,St[oa].deltas,za,Xa),Qr=!0}lr&&fr.call(this,lr),nr&&Rr.call(this)}},hr=function(Je){var nr=this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor,or=nr*(this.pdf.internal.getLineHeightFactor()-1);switch(this.ctx.textBaseline){case"bottom":return Je-or;case"top":return Je+nr-or;case"hanging":return Je+nr-2*or;case"middle":return Je+nr/2-or;default:return Je}},pr=function(Je){return Je+this.pdf.internal.getFontSize()/this.pdf.internal.scaleFactor*(this.pdf.internal.getLineHeightFactor()-1)};He.prototype.createLinearGradient=function(){var Je=function(){};return Je.colorStops=[],Je.addColorStop=function(nr,or){this.colorStops.push([nr,or])},Je.getColor=function(){return this.colorStops.length===0?"#000000":this.colorStops[0][1]},Je.isCanvasGradient=!0,Je},He.prototype.createPattern=function(){return this.createLinearGradient()},He.prototype.createRadialGradient=function(){return this.createLinearGradient()};var yr=function(Je,nr,or,lr,St,dr,vr,br,kr){for(var Pr=Nr.call(this,or,lr,St,dr),Er=0;Er<Pr.length;Er++){var Zr=Pr[Er];Er===0&&(kr?mr.call(this,Zr.x1+Je,Zr.y1+nr):Fr.call(this,Zr.x1+Je,Zr.y1+nr)),Hr.call(this,Je,nr,Zr.x2,Zr.y2,Zr.x3,Zr.y3,Zr.x4,Zr.y4)}br?Rr.call(this):fr.call(this,vr)},fr=function(Je){switch(Je){case"stroke":this.pdf.internal.out("S");break;case"fill":this.pdf.internal.out("f")}},Rr=function(){this.pdf.clip(),this.pdf.discardPath()},mr=function(Je,nr){this.pdf.internal.out(r(Je)+" "+n(nr)+" m")},wr=function(Je){var nr;switch(Je.align){case"right":case"end":nr="right";break;case"center":nr="center";break;default:nr="left"}var or,lr,St,dr=this.pdf.getTextDimensions(Je.text),vr=hr.call(this,Je.y),br=pr.call(this,vr)-dr.h,kr=this.ctx.transform.applyToPoint(new De(Je.x,vr));if(this.autoPaging){var Pr=this.ctx.transform.decompose(),Er=new ze;Er=(Er=(Er=Er.multiply(Pr.translate)).multiply(Pr.skew)).multiply(Pr.scale);for(var Zr=this.ctx.transform.applyToRectangle(new Me(Je.x,vr,dr.w,dr.h)),ua=Er.applyToRectangle(new Me(Je.x,br,dr.w,dr.h)),Cr=$e.call(this,ua),Jr=[],Qr=0;Qr<Cr.length;Qr+=1)Jr.indexOf(Cr[Qr])===-1&&Jr.push(Cr[Qr]);tr(Jr);for(var oa=Jr[0],ta=Jr[Jr.length-1],Na=oa;Na<ta+1;Na++){this.pdf.setPage(Na);var Ca=Na===1?this.posY+this.margin[0]:this.margin[0],za=this.pdf.internal.pageSize.height-this.posY-this.margin[0]-this.margin[2],Xa=this.pdf.internal.pageSize.height-this.margin[2],Ya=Xa-this.margin[0],nn=this.pdf.internal.pageSize.width-this.margin[1],on=nn-this.margin[3],yn=Na===1?0:za+(Na-2)*Ya;if(this.ctx.clip_path.length!==0){var fn=this.path;or=JSON.parse(JSON.stringify(this.ctx.clip_path)),this.path=rr(or,this.posX+this.margin[3],-1*yn+Ca),ar.call(this,"fill",!0),this.path=fn}var Qa=rr([JSON.parse(JSON.stringify(ua))],this.posX+this.margin[3],-yn+Ca+this.ctx.prevPageLastElemOffset)[0];Je.scale>=.01&&(lr=this.pdf.internal.getFontSize(),this.pdf.setFontSize(lr*Je.scale),St=this.lineWidth,this.lineWidth=St*Je.scale);var Ka=this.autoPaging!=="text";if(Ka||Qa.y+Qa.h<=Xa){if(Ka||Qa.y>=Ca&&Qa.x<=nn){var en=Ka?Je.text:this.pdf.splitTextToSize(Je.text,Je.maxWidth||nn-Qa.x)[0],Bn=rr([JSON.parse(JSON.stringify(Zr))],this.posX+this.margin[3],-yn+Ca+this.ctx.prevPageLastElemOffset)[0],vn=Ka&&(Na>oa||Na<ta)&&Ge.call(this);vn&&(this.pdf.saveGraphicsState(),this.pdf.rect(this.margin[3],this.margin[0],on,Ya,null).clip().discardPath()),this.pdf.text(en,Bn.x,Bn.y,{angle:Je.angle,align:nr,renderingMode:Je.renderingMode}),vn&&this.pdf.restoreGraphicsState()}}else Qa.y<Xa&&(this.ctx.prevPageLastElemOffset+=Xa-Qa.y);Je.scale>=.01&&(this.pdf.setFontSize(lr),this.lineWidth=St)}}else Je.scale>=.01&&(lr=this.pdf.internal.getFontSize(),this.pdf.setFontSize(lr*Je.scale),St=this.lineWidth,this.lineWidth=St*Je.scale),this.pdf.text(Je.text,kr.x+this.posX,kr.y+this.posY,{angle:Je.angle,align:nr,renderingMode:Je.renderingMode,maxWidth:Je.maxWidth}),Je.scale>=.01&&(this.pdf.setFontSize(lr),this.lineWidth=St)},Fr=function(Je,nr,or,lr){or=or||0,lr=lr||0,this.pdf.internal.out(r(Je+or)+" "+n(nr+lr)+" l")},Mr=function(Je,nr,or){return this.pdf.lines(Je,nr,or,null,null)},Hr=function(Je,nr,or,lr,St,dr,vr,br){this.pdf.internal.out([t(Ee(or+Je)),t(Ce(lr+nr)),t(Ee(St+Je)),t(Ce(dr+nr)),t(Ee(vr+Je)),t(Ce(br+nr)),"c"].join(" "))},Nr=function(Je,nr,or,lr){for(var St=2*Math.PI,dr=Math.PI/2;nr>or;)nr-=St;var vr=Math.abs(or-nr);vr<St&&lr&&(vr=St-vr);for(var br=[],kr=lr?-1:1,Pr=nr;vr>1e-5;){var Er=Pr+kr*Math.min(vr,dr);br.push(Ar.call(this,Je,Pr,Er)),vr-=Math.abs(Er-Pr),Pr=Er}return br},Ar=function(Je,nr,or){var lr=(or-nr)/2,St=Je*Math.cos(lr),dr=Je*Math.sin(lr),vr=St,br=-dr,kr=vr*vr+br*br,Pr=kr+vr*St+br*dr,Er=4/3*(Math.sqrt(2*kr*Pr)-Pr)/(vr*dr-br*St),Zr=vr-Er*br,ua=br+Er*vr,Cr=Zr,Jr=-ua,Qr=lr+nr,oa=Math.cos(Qr),ta=Math.sin(Qr);return{x1:Je*Math.cos(nr),y1:Je*Math.sin(nr),x2:Zr*oa-ua*ta,y2:Zr*ta+ua*oa,x3:Cr*oa-Jr*ta,y3:Cr*ta+Jr*oa,x4:Je*Math.cos(or),y4:Je*Math.sin(or)}},xr=function(Je){return 180*Je/Math.PI},ir=function(Je,nr,or,lr,St,dr){var vr=Je+.5*(or-Je),br=nr+.5*(lr-nr),kr=St+.5*(or-St),Pr=dr+.5*(lr-dr),Er=Math.min(Je,St,vr,kr),Zr=Math.max(Je,St,vr,kr),ua=Math.min(nr,dr,br,Pr),Cr=Math.max(nr,dr,br,Pr);return new Me(Er,ua,Zr-Er,Cr-ua)},_r=function(Je,nr,or,lr,St,dr,vr,br){var kr,Pr,Er,Zr,ua,Cr,Jr,Qr,oa,ta,Na,Ca,za,Xa,Ya=or-Je,nn=lr-nr,on=St-or,yn=dr-lr,fn=vr-St,Qa=br-dr;for(Pr=0;Pr<41;Pr++)oa=(Jr=(Er=Je+(kr=Pr/40)*Ya)+kr*((ua=or+kr*on)-Er))+kr*(ua+kr*(St+kr*fn-ua)-Jr),ta=(Qr=(Zr=nr+kr*nn)+kr*((Cr=lr+kr*yn)-Zr))+kr*(Cr+kr*(dr+kr*Qa-Cr)-Qr),Pr==0?(Na=oa,Ca=ta,za=oa,Xa=ta):(Na=Math.min(Na,oa),Ca=Math.min(Ca,ta),za=Math.max(za,oa),Xa=Math.max(Xa,ta));return new Me(Math.round(Na),Math.round(Ca),Math.round(za-Na),Math.round(Xa-Ca))},ur=function(){if(this.prevLineDash||this.ctx.lineDash.length||this.ctx.lineDashOffset){var Je,nr,or=(Je=this.ctx.lineDash,nr=this.ctx.lineDashOffset,JSON.stringify({lineDash:Je,lineDashOffset:nr}));this.prevLineDash!==or&&(this.pdf.setLineDash(this.ctx.lineDash,this.ctx.lineDashOffset),this.prevLineDash=or)}}})(E.API),(function(e){var t=function(De){var Me,ze,Oe,Be,He,Ve,Xe,We,Ge,$e;for(ze=[],Oe=0,Be=(De+=Me="\0\0\0\0".slice(De.length%4||4)).length;Be>Oe;Oe+=4)(He=(De.charCodeAt(Oe)<<24)+(De.charCodeAt(Oe+1)<<16)+(De.charCodeAt(Oe+2)<<8)+De.charCodeAt(Oe+3))!==0?(Ve=(He=((He=((He=((He=(He-($e=He%85))/85)-(Ge=He%85))/85)-(We=He%85))/85)-(Xe=He%85))/85)%85,ze.push(Ve+33,Xe+33,We+33,Ge+33,$e+33)):ze.push(122);return(function(Ke,rr){for(var tr=rr;tr>0;tr--)Ke.pop()})(ze,Me.length),String.fromCharCode.apply(String,ze)+"~>"},r=function(De){var Me,ze,Oe,Be,He,Ve=String,Xe="length",We=255,Ge="charCodeAt",$e="slice",Ke="replace";for(De[$e](-2),De=De[$e](0,-2)[Ke](/\s/g,"")[Ke]("z","!!!!!"),Oe=[],Be=0,He=(De+=Me="uuuuu"[$e](De[Xe]%5||5))[Xe];He>Be;Be+=5)ze=52200625*(De[Ge](Be)-33)+614125*(De[Ge](Be+1)-33)+7225*(De[Ge](Be+2)-33)+85*(De[Ge](Be+3)-33)+(De[Ge](Be+4)-33),Oe.push(We&ze>>24,We&ze>>16,We&ze>>8,We&ze);return(function(rr,tr){for(var sr=tr;sr>0;sr--)rr.pop()})(Oe,Me[Xe]),Ve.fromCharCode.apply(Ve,Oe)},n=function(De){return De.split("").map(function(Me){return("0"+Me.charCodeAt().toString(16)).slice(-2)}).join("")+">"},Ee=function(De){var Me=new RegExp(/^([0-9A-Fa-f]{2})+$/);if((De=De.replace(/\s/g,"")).indexOf(">")!==-1&&(De=De.substr(0,De.indexOf(">"))),De.length%2&&(De+="0"),Me.test(De)===!1)return"";for(var ze="",Oe=0;Oe<De.length;Oe+=2)ze+=String.fromCharCode("0x"+(De[Oe]+De[Oe+1]));return ze},Ce=function(De){for(var Me=new Uint8Array(De.length),ze=De.length;ze--;)Me[ze]=De.charCodeAt(ze);return(Me=zlibSync(Me)).reduce(function(Oe,Be){return Oe+String.fromCharCode(Be)},"")};e.processDataByFilters=function(De,Me){var ze=0,Oe=De||"",Be=[];for(typeof(Me=Me||[])=="string"&&(Me=[Me]),ze=0;ze<Me.length;ze+=1)switch(Me[ze]){case"ASCII85Decode":case"/ASCII85Decode":Oe=r(Oe),Be.push("/ASCII85Encode");break;case"ASCII85Encode":case"/ASCII85Encode":Oe=t(Oe),Be.push("/ASCII85Decode");break;case"ASCIIHexDecode":case"/ASCIIHexDecode":Oe=Ee(Oe),Be.push("/ASCIIHexEncode");break;case"ASCIIHexEncode":case"/ASCIIHexEncode":Oe=n(Oe),Be.push("/ASCIIHexDecode");break;case"FlateEncode":case"/FlateEncode":Oe=Ce(Oe),Be.push("/FlateDecode");break;default:throw new Error('The filter: "'+Me[ze]+'" is not implemented')}return{data:Oe,reverseChain:Be.reverse().join(" ")}}})(E.API),(function(e){e.loadFile=function(t,r,n){return(function(Ee,Ce,De){Ce=Ce!==!1,De=typeof De=="function"?De:function(){};var Me=void 0;try{Me=(function(ze,Oe,Be){var He=new XMLHttpRequest,Ve=0,Xe=function(We){var Ge=We.length,$e=[],Ke=String.fromCharCode;for(Ve=0;Ve<Ge;Ve+=1)$e.push(Ke(255&We.charCodeAt(Ve)));return $e.join("")};if(He.open("GET",ze,!Oe),He.overrideMimeType("text/plain; charset=x-user-defined"),Oe===!1&&(He.onload=function(){He.status===200?Be(Xe(this.responseText)):Be(void 0)}),He.send(null),Oe&&He.status===200)return Xe(He.responseText)})(Ee,Ce,De)}catch{}return Me})(t,r,n)},e.allowFsRead=void 0,e.loadImageFile=e.loadFile})(E.API),(function(e){function t(){return(i.html2canvas?Promise.resolve(i.html2canvas):__vitePreload(()=>import("./html2canvas.esm-B0tyYwQk.js"),[])).catch(function(Me){return Promise.reject(new Error("Could not load html2canvas: "+Me))}).then(function(Me){return Me.default?Me.default:Me})}function r(){return(i.DOMPurify?Promise.resolve(i.DOMPurify):__vitePreload(()=>import("./purify.es-B9ZVCkUG.js"),[])).catch(function(Me){return Promise.reject(new Error("Could not load dompurify: "+Me))}).then(function(Me){return Me.default?Me.default:Me})}var n=function(Me){var ze=_typeof(Me);return ze==="undefined"?"undefined":ze==="string"||Me instanceof String?"string":ze==="number"||Me instanceof Number?"number":ze==="function"||Me instanceof Function?"function":Me&&Me.constructor===Array?"array":Me&&Me.nodeType===1?"element":ze==="object"?"object":"unknown"},Ee=function(Me,ze){var Oe=document.createElement(Me);for(var Be in ze.className&&(Oe.className=ze.className),ze.innerHTML&&ze.dompurify&&(Oe.innerHTML=ze.dompurify.sanitize(ze.innerHTML)),ze.style)Oe.style[Be]=ze.style[Be];return Oe},Ce=function Me(ze,Oe){for(var Be=ze.nodeType===3?document.createTextNode(ze.nodeValue):ze.cloneNode(!1),He=ze.firstChild;He;He=He.nextSibling)Oe!==!0&&He.nodeType===1&&He.nodeName==="SCRIPT"||Be.appendChild(Me(He,Oe));return ze.nodeType===1&&(ze.nodeName==="CANVAS"?(Be.width=ze.width,Be.height=ze.height,Be.getContext("2d").drawImage(ze,0,0)):ze.nodeName!=="TEXTAREA"&&ze.nodeName!=="SELECT"||(Be.value=ze.value),Be.addEventListener("load",function(){Be.scrollTop=ze.scrollTop,Be.scrollLeft=ze.scrollLeft},!0)),Be},De=function Me(ze){var Oe=Object.assign(Me.convert(Promise.resolve()),JSON.parse(JSON.stringify(Me.template))),Be=Me.convert(Promise.resolve(),Oe);return(Be=Be.setProgress(1,Me,1,[Me])).set(ze)};(De.prototype=Object.create(Promise.prototype)).constructor=De,De.convert=function(Me,ze){return Me.__proto__=ze||De.prototype,Me},De.template={prop:{src:null,container:null,overlay:null,canvas:null,img:null,pdf:null,pageSize:null,callback:function(){}},progress:{val:0,state:null,n:0,stack:[]},opt:{filename:"file.pdf",margin:[0,0,0,0],enableLinks:!0,x:0,y:0,html2canvas:{},jsPDF:{},backgroundColor:"transparent"}},De.prototype.from=function(Me,ze){return this.then(function(){switch(ze=ze||(function(Oe){switch(n(Oe)){case"string":return"string";case"element":return Oe.nodeName.toLowerCase()==="canvas"?"canvas":"element";default:return"unknown"}})(Me),ze){case"string":return this.then(r).then(function(Oe){return this.set({src:Ee("div",{innerHTML:Me,dompurify:Oe})})});case"element":return this.set({src:Me});case"canvas":return this.set({canvas:Me});case"img":return this.set({img:Me});default:return this.error("Unknown source type.")}})},De.prototype.to=function(Me){switch(Me){case"container":return this.toContainer();case"canvas":return this.toCanvas();case"img":return this.toImg();case"pdf":return this.toPdf();default:return this.error("Invalid target.")}},De.prototype.toContainer=function(){return this.thenList([function(){return this.prop.src||this.error("Cannot duplicate - no source HTML.")},function(){return this.prop.pageSize||this.setPageSize()}]).then(function(){var Me={position:"relative",display:"inline-block",width:(typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?Math.max(this.prop.src.clientWidth,this.prop.src.scrollWidth,this.prop.src.offsetWidth):this.opt.windowWidth)+"px",left:0,right:0,top:0,margin:"auto",backgroundColor:this.opt.backgroundColor},ze=Ce(this.prop.src,this.opt.html2canvas.javascriptEnabled);ze.tagName==="BODY"&&(Me.height=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,document.documentElement.offsetHeight)+"px"),this.prop.overlay=Ee("div",{className:"html2pdf__overlay",style:{position:"fixed",overflow:"hidden",zIndex:1e3,left:"-100000px",right:0,bottom:0,top:0}}),this.prop.container=Ee("div",{className:"html2pdf__container",style:Me}),this.prop.container.appendChild(ze),this.prop.container.firstChild.appendChild(Ee("div",{style:{clear:"both",border:"0 none transparent",margin:0,padding:0,height:0}})),this.prop.container.style.float="none",this.prop.overlay.appendChild(this.prop.container),document.body.appendChild(this.prop.overlay),this.prop.container.firstChild.style.position="relative",this.prop.container.height=Math.max(this.prop.container.firstChild.clientHeight,this.prop.container.firstChild.scrollHeight,this.prop.container.firstChild.offsetHeight)+"px"})},De.prototype.toCanvas=function(){var Me=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(Me).then(t).then(function(ze){var Oe=Object.assign({},this.opt.html2canvas);return delete Oe.onrendered,ze(this.prop.container,Oe)}).then(function(ze){(this.opt.html2canvas.onrendered||function(){})(ze),this.prop.canvas=ze,document.body.removeChild(this.prop.overlay)})},De.prototype.toContext2d=function(){var Me=[function(){return document.body.contains(this.prop.container)||this.toContainer()}];return this.thenList(Me).then(t).then(function(ze){var Oe=this.opt.jsPDF,Be=this.opt.fontFaces,He=typeof this.opt.width!="number"||isNaN(this.opt.width)||typeof this.opt.windowWidth!="number"||isNaN(this.opt.windowWidth)?1:this.opt.width/this.opt.windowWidth,Ve=Object.assign({async:!0,allowTaint:!0,scale:He,scrollX:this.opt.scrollX||0,scrollY:this.opt.scrollY||0,backgroundColor:"#ffffff",imageTimeout:15e3,logging:!0,proxy:null,removeContainer:!0,foreignObjectRendering:!1,useCORS:!1},this.opt.html2canvas);if(delete Ve.onrendered,Oe.context2d.autoPaging=this.opt.autoPaging===void 0||this.opt.autoPaging,Oe.context2d.posX=this.opt.x,Oe.context2d.posY=this.opt.y,Oe.context2d.margin=this.opt.margin,Oe.context2d.fontFaces=Be,Be)for(var Xe=0;Xe<Be.length;++Xe){var We=Be[Xe],Ge=We.src.find(function($e){return $e.format==="truetype"});Ge&&Oe.addFont(Ge.url,We.ref.name,We.ref.style)}return Ve.windowHeight=Ve.windowHeight||0,Ve.windowHeight=Ve.windowHeight==0?Math.max(this.prop.container.clientHeight,this.prop.container.scrollHeight,this.prop.container.offsetHeight):Ve.windowHeight,Oe.context2d.save(!0),ze(this.prop.container,Ve)}).then(function(ze){this.opt.jsPDF.context2d.restore(!0),(this.opt.html2canvas.onrendered||function(){})(ze),this.prop.canvas=ze,document.body.removeChild(this.prop.overlay)})},De.prototype.toImg=function(){return this.thenList([function(){return this.prop.canvas||this.toCanvas()}]).then(function(){var Me=this.prop.canvas.toDataURL("image/"+this.opt.image.type,this.opt.image.quality);this.prop.img=document.createElement("img"),this.prop.img.src=Me})},De.prototype.toPdf=function(){return this.thenList([function(){return this.toContext2d()}]).then(function(){this.prop.pdf=this.prop.pdf||this.opt.jsPDF})},De.prototype.output=function(Me,ze,Oe){return(Oe=Oe||"pdf").toLowerCase()==="img"||Oe.toLowerCase()==="image"?this.outputImg(Me,ze):this.outputPdf(Me,ze)},De.prototype.outputPdf=function(Me,ze){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){return this.prop.pdf.output(Me,ze)})},De.prototype.outputImg=function(Me){return this.thenList([function(){return this.prop.img||this.toImg()}]).then(function(){switch(Me){case void 0:case"img":return this.prop.img;case"datauristring":case"dataurlstring":return this.prop.img.src;case"datauri":case"dataurl":return document.location.href=this.prop.img.src;default:throw'Image output type "'+Me+'" is not supported.'}})},De.prototype.save=function(Me){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).set(Me?{filename:Me}:null).then(function(){this.prop.pdf.save(this.opt.filename)})},De.prototype.doCallback=function(){return this.thenList([function(){return this.prop.pdf||this.toPdf()}]).then(function(){this.prop.callback(this.prop.pdf)})},De.prototype.set=function(Me){if(n(Me)!=="object")return this;var ze=Object.keys(Me||{}).map(function(Oe){if(Oe in De.template.prop)return function(){this.prop[Oe]=Me[Oe]};switch(Oe){case"margin":return this.setMargin.bind(this,Me.margin);case"jsPDF":return function(){return this.opt.jsPDF=Me.jsPDF,this.setPageSize()};case"pageSize":return this.setPageSize.bind(this,Me.pageSize);default:return function(){this.opt[Oe]=Me[Oe]}}},this);return this.then(function(){return this.thenList(ze)})},De.prototype.get=function(Me,ze){return this.then(function(){var Oe=Me in De.template.prop?this.prop[Me]:this.opt[Me];return ze?ze(Oe):Oe})},De.prototype.setMargin=function(Me){return this.then(function(){switch(n(Me)){case"number":Me=[Me,Me,Me,Me];case"array":if(Me.length===2&&(Me=[Me[0],Me[1],Me[0],Me[1]]),Me.length===4)break;default:return this.error("Invalid margin array.")}this.opt.margin=Me}).then(this.setPageSize)},De.prototype.setPageSize=function(Me){function ze(Oe,Be){return Math.floor(Oe*Be/72*96)}return this.then(function(){(Me=Me||E.getPageSize(this.opt.jsPDF)).hasOwnProperty("inner")||(Me.inner={width:Me.width-this.opt.margin[1]-this.opt.margin[3],height:Me.height-this.opt.margin[0]-this.opt.margin[2]},Me.inner.px={width:ze(Me.inner.width,Me.k),height:ze(Me.inner.height,Me.k)},Me.inner.ratio=Me.inner.height/Me.inner.width),this.prop.pageSize=Me})},De.prototype.setProgress=function(Me,ze,Oe,Be){return Me!=null&&(this.progress.val=Me),ze!=null&&(this.progress.state=ze),Oe!=null&&(this.progress.n=Oe),Be!=null&&(this.progress.stack=Be),this.progress.ratio=this.progress.val/this.progress.state,this},De.prototype.updateProgress=function(Me,ze,Oe,Be){return this.setProgress(Me?this.progress.val+Me:null,ze||null,Oe?this.progress.n+Oe:null,Be?this.progress.stack.concat(Be):null)},De.prototype.then=function(Me,ze){var Oe=this;return this.thenCore(Me,ze,function(Be,He){return Oe.updateProgress(null,null,1,[Be]),Promise.prototype.then.call(this,function(Ve){return Oe.updateProgress(null,Be),Ve}).then(Be,He).then(function(Ve){return Oe.updateProgress(1),Ve})})},De.prototype.thenCore=function(Me,ze,Oe){Oe=Oe||Promise.prototype.then;var Be=this;Me&&(Me=Me.bind(Be)),ze&&(ze=ze.bind(Be));var He=Promise.toString().indexOf("[native code]")!==-1&&Promise.name==="Promise"?Be:De.convert(Object.assign({},Be),Promise.prototype),Ve=Oe.call(He,Me,ze);return De.convert(Ve,Be.__proto__)},De.prototype.thenExternal=function(Me,ze){return Promise.prototype.then.call(this,Me,ze)},De.prototype.thenList=function(Me){var ze=this;return Me.forEach(function(Oe){ze=ze.thenCore(Oe)}),ze},De.prototype.catch=function(Me){Me&&(Me=Me.bind(this));var ze=Promise.prototype.catch.call(this,Me);return De.convert(ze,this)},De.prototype.catchExternal=function(Me){return Promise.prototype.catch.call(this,Me)},De.prototype.error=function(Me){return this.then(function(){throw new Error(Me)})},De.prototype.using=De.prototype.set,De.prototype.saveAs=De.prototype.save,De.prototype.export=De.prototype.output,De.prototype.run=De.prototype.then,E.getPageSize=function(Me,ze,Oe){if(_typeof(Me)==="object"){var Be=Me;Me=Be.orientation,ze=Be.unit||ze,Oe=Be.format||Oe}ze=ze||"mm",Oe=Oe||"a4",Me=(""+(Me||"P")).toLowerCase();var He,Ve=(""+Oe).toLowerCase(),Xe={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89],a5:[419.53,595.28],a6:[297.64,419.53],a7:[209.76,297.64],a8:[147.4,209.76],a9:[104.88,147.4],a10:[73.7,104.88],b0:[2834.65,4008.19],b1:[2004.09,2834.65],b2:[1417.32,2004.09],b3:[1000.63,1417.32],b4:[708.66,1000.63],b5:[498.9,708.66],b6:[354.33,498.9],b7:[249.45,354.33],b8:[175.75,249.45],b9:[124.72,175.75],b10:[87.87,124.72],c0:[2599.37,3676.54],c1:[1836.85,2599.37],c2:[1298.27,1836.85],c3:[918.43,1298.27],c4:[649.13,918.43],c5:[459.21,649.13],c6:[323.15,459.21],c7:[229.61,323.15],c8:[161.57,229.61],c9:[113.39,161.57],c10:[79.37,113.39],dl:[311.81,623.62],letter:[612,792],"government-letter":[576,756],legal:[612,1008],"junior-legal":[576,360],ledger:[1224,792],tabloid:[792,1224],"credit-card":[153,243]};switch(ze){case"pt":He=1;break;case"mm":He=72/25.4;break;case"cm":He=72/2.54;break;case"in":He=72;break;case"px":He=.75;break;case"pc":case"em":He=12;break;case"ex":He=6;break;default:throw"Invalid unit: "+ze}var We,Ge=0,$e=0;if(Xe.hasOwnProperty(Ve))Ge=Xe[Ve][1]/He,$e=Xe[Ve][0]/He;else try{Ge=Oe[1],$e=Oe[0]}catch{throw new Error("Invalid format: "+Oe)}if(Me==="p"||Me==="portrait")Me="p",$e>Ge&&(We=$e,$e=Ge,Ge=We);else{if(Me!=="l"&&Me!=="landscape")throw"Invalid orientation: "+Me;Me="l",Ge>$e&&(We=$e,$e=Ge,Ge=We)}return{width:$e,height:Ge,unit:ze,k:He,orientation:Me}},e.html=function(Me,ze){(ze=ze||{}).callback=ze.callback||function(){},ze.html2canvas=ze.html2canvas||{},ze.html2canvas.canvas=ze.html2canvas.canvas||this.canvas,ze.jsPDF=ze.jsPDF||this,ze.fontFaces=ze.fontFaces?ze.fontFaces.map(Ct):null;var Oe=new De(ze);return ze.worker?Oe:Oe.from(Me).doCallback()}})(E.API),E.API.addJS=function(e){return Ut=e,this.internal.events.subscribe("postPutResources",function(){Tt=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/Names [(EmbeddedJS) "+(Tt+1)+" 0 R]"),this.internal.out(">>"),this.internal.out("endobj"),zt=this.internal.newObject(),this.internal.out("<<"),this.internal.out("/S /JavaScript"),this.internal.out("/JS ("+Ut+")"),this.internal.out(">>"),this.internal.out("endobj")}),this.internal.events.subscribe("putCatalog",function(){Tt!==void 0&&zt!==void 0&&this.internal.out("/Names <</JavaScript "+Tt+" 0 R>>")}),this},(function(e){var t;e.events.push(["postPutResources",function(){var r=this,n=/^(\d+) 0 obj$/;if(this.outline.root.children.length>0)for(var Ee=r.outline.render().split(/\r\n/),Ce=0;Ce<Ee.length;Ce++){var De=Ee[Ce],Me=n.exec(De);if(Me!=null){var ze=Me[1];r.internal.newObjectDeferredBegin(ze,!1)}r.internal.write(De)}if(this.outline.createNamedDestinations){var Oe=this.internal.pages.length,Be=[];for(Ce=0;Ce<Oe;Ce++){var He=r.internal.newObject();Be.push(He);var Ve=r.internal.getPageInfo(Ce+1);r.internal.write("<< /D["+Ve.objId+" 0 R /XYZ null null null]>> endobj")}var Xe=r.internal.newObject();for(r.internal.write("<< /Names [ "),Ce=0;Ce<Be.length;Ce++)r.internal.write("(page_"+(Ce+1)+")"+Be[Ce]+" 0 R");r.internal.write(" ] >>","endobj"),t=r.internal.newObject(),r.internal.write("<< /Dests "+Xe+" 0 R"),r.internal.write(">>","endobj")}}]),e.events.push(["putCatalog",function(){var r=this;r.outline.root.children.length>0&&(r.internal.write("/Outlines",this.outline.makeRef(this.outline.root)),this.outline.createNamedDestinations&&r.internal.write("/Names "+t+" 0 R"))}]),e.events.push(["initialized",function(){var r=this;r.outline={createNamedDestinations:!1,root:{children:[]}},r.outline.add=function(n,Ee,Ce){var De={title:Ee,options:Ce,children:[]};return n==null&&(n=this.root),n.children.push(De),De},r.outline.render=function(){return this.ctx={},this.ctx.val="",this.ctx.pdf=r,this.genIds_r(this.root),this.renderRoot(this.root),this.renderItems(this.root),this.ctx.val},r.outline.genIds_r=function(n){n.id=r.internal.newObjectDeferred();for(var Ee=0;Ee<n.children.length;Ee++)this.genIds_r(n.children[Ee])},r.outline.renderRoot=function(n){this.objStart(n),this.line("/Type /Outlines"),n.children.length>0&&(this.line("/First "+this.makeRef(n.children[0])),this.line("/Last "+this.makeRef(n.children[n.children.length-1]))),this.line("/Count "+this.count_r({count:0},n)),this.objEnd()},r.outline.renderItems=function(n){for(var Ee=this.ctx.pdf.internal.getVerticalCoordinateString,Ce=0;Ce<n.children.length;Ce++){var De=n.children[Ce];this.objStart(De),this.line("/Title "+this.makeString(De.title)),this.line("/Parent "+this.makeRef(n)),Ce>0&&this.line("/Prev "+this.makeRef(n.children[Ce-1])),Ce<n.children.length-1&&this.line("/Next "+this.makeRef(n.children[Ce+1])),De.children.length>0&&(this.line("/First "+this.makeRef(De.children[0])),this.line("/Last "+this.makeRef(De.children[De.children.length-1])));var Me=this.count=this.count_r({count:0},De);if(Me>0&&this.line("/Count "+Me),De.options&&De.options.pageNumber){var ze=r.internal.getPageInfo(De.options.pageNumber);this.line("/Dest ["+ze.objId+" 0 R /XYZ 0 "+Ee(0)+" 0]")}this.objEnd()}for(var Oe=0;Oe<n.children.length;Oe++)this.renderItems(n.children[Oe])},r.outline.line=function(n){this.ctx.val+=n+`\r
`},r.outline.makeRef=function(n){return n.id+" 0 R"},r.outline.makeString=function(n){return"("+r.internal.pdfEscape(n)+")"},r.outline.objStart=function(n){this.ctx.val+=`\r
`+n.id+` 0 obj\r
<<\r
`},r.outline.objEnd=function(){this.ctx.val+=`>> \r
endobj\r
`},r.outline.count_r=function(n,Ee){for(var Ce=0;Ce<Ee.children.length;Ce++)n.count++,this.count_r(n,Ee.children[Ce]);return n.count}}])})(E.API),(function(e){var t=[192,193,194,195,196,197,198,199];e.processJPEG=function(r,n,Ee,Ce,De,Me){var ze,Oe=this.decode.DCT_DECODE,Be=null;if(typeof r=="string"||this.__addimage__.isArrayBuffer(r)||this.__addimage__.isArrayBufferView(r)){switch(r=De||r,r=this.__addimage__.isArrayBuffer(r)?new Uint8Array(r):r,ze=(function(He){for(var Ve,Xe=256*He.charCodeAt(4)+He.charCodeAt(5),We=He.length,Ge={width:0,height:0,numcomponents:1},$e=4;$e<We;$e+=2){if($e+=Xe,t.indexOf(He.charCodeAt($e+1))!==-1){Ve=256*He.charCodeAt($e+5)+He.charCodeAt($e+6),Ge={width:256*He.charCodeAt($e+7)+He.charCodeAt($e+8),height:Ve,numcomponents:He.charCodeAt($e+9)};break}Xe=256*He.charCodeAt($e+2)+He.charCodeAt($e+3)}return Ge})(r=this.__addimage__.isArrayBufferView(r)?this.__addimage__.arrayBufferToBinaryString(r):r),ze.numcomponents){case 1:Me=this.color_spaces.DEVICE_GRAY;break;case 4:Me=this.color_spaces.DEVICE_CMYK;break;case 3:Me=this.color_spaces.DEVICE_RGB}Be={data:r,width:ze.width,height:ze.height,colorSpace:Me,bitsPerComponent:8,filter:Oe,index:n,alias:Ee}}return Be}})(E.API),E.API.processPNG=function(e,t,r,n){if(this.__addimage__.isArrayBuffer(e)&&(e=new Uint8Array(e)),this.__addimage__.isArrayBufferView(e)){var Ee,Ce=decodePng(e,{checkCrc:!0}),De=Ce.width,Me=Ce.height,ze=Ce.channels,Oe=Ce.palette,Be=Ce.depth;Ee=Oe&&ze===1?(function(yr){for(var fr=yr.width,Rr=yr.height,mr=yr.data,wr=yr.palette,Fr=yr.depth,Mr=!1,Hr=[],Nr=[],Ar=void 0,xr=!1,ir=0,_r=0;_r<wr.length;_r++){var ur=_slicedToArray(wr[_r],4),Je=ur[0],nr=ur[1],or=ur[2],lr=ur[3];Hr.push(Je,nr,or),lr!=null&&(lr===0?(ir++,Nr.length<1&&Nr.push(_r)):lr<255&&(xr=!0))}if(xr||ir>1){Mr=!0,Nr=void 0;var St=fr*Rr;Ar=new Uint8Array(St);for(var dr=new DataView(mr.buffer),vr=0;vr<St;vr++){var br=re(dr,vr,Fr),kr=_slicedToArray(wr[br],4)[3];Ar[vr]=kr}}else ir===0&&(Nr=void 0);return{colorSpace:"Indexed",colorsPerPixel:1,sMaskBitsPerComponent:Mr?8:void 0,colorBytes:mr,alphaBytes:Ar,needSMask:Mr,palette:Hr,mask:Nr}})(Ce):ze===2||ze===4?(function(yr){for(var fr=yr.data,Rr=yr.width,mr=yr.height,wr=yr.channels,Fr=yr.depth,Mr=wr===2?"DeviceGray":"DeviceRGB",Hr=wr-1,Nr=Rr*mr,Ar=Hr,xr=Nr*Ar,ir=1*Nr,_r=Math.ceil(xr*Fr/8),ur=Math.ceil(ir*Fr/8),Je=new Uint8Array(_r),nr=new Uint8Array(ur),or=new DataView(fr.buffer),lr=new DataView(Je.buffer),St=new DataView(nr.buffer),dr=!1,vr=0;vr<Nr;vr++){for(var br=vr*wr,kr=0;kr<Ar;kr++)ie(lr,re(or,br+kr,Fr),vr*Ar+kr,Fr);var Pr=re(or,br+Ar,Fr);Pr<(1<<Fr)-1&&(dr=!0),ie(St,Pr,1*vr,Fr)}return{colorSpace:Mr,colorsPerPixel:Hr,sMaskBitsPerComponent:dr?Fr:void 0,colorBytes:Je,alphaBytes:nr,needSMask:dr}})(Ce):(function(yr){var fr=yr.data,Rr=yr.channels===1?"DeviceGray":"DeviceRGB";return{colorSpace:Rr,colorsPerPixel:Rr==="DeviceGray"?1:3,colorBytes:fr instanceof Uint16Array?(function(mr){for(var wr=mr.length,Fr=new Uint8Array(2*wr),Mr=new DataView(Fr.buffer,Fr.byteOffset,Fr.byteLength),Hr=0;Hr<wr;Hr++)Mr.setUint16(2*Hr,mr[Hr],!1);return Fr})(fr):fr,needSMask:!1}})(Ce);var He,Ve,Xe,We=Ee,Ge=We.colorSpace,$e=We.colorsPerPixel,Ke=We.sMaskBitsPerComponent,rr=We.colorBytes,tr=We.alphaBytes,sr=We.needSMask,ar=We.palette,hr=We.mask,pr=null;return n!==E.API.image_compression.NONE&&typeof zlibSync=="function"?(pr=(function(yr){var fr;switch(yr){case E.API.image_compression.FAST:fr=11;break;case E.API.image_compression.MEDIUM:fr=13;break;case E.API.image_compression.SLOW:fr=14;break;default:fr=12}return fr})(n),He=this.decode.FLATE_DECODE,Ve="/Predictor ".concat(pr," /Colors ").concat($e," /BitsPerComponent ").concat(Be," /Columns ").concat(De),e=Xt(rr,Math.ceil(De*$e*Be/8),$e,Be,n),sr&&(Xe=Xt(tr,Math.ceil(De*Ke/8),1,Ke,n))):(He=void 0,Ve=void 0,e=rr,sr&&(Xe=tr)),(this.__addimage__.isArrayBuffer(e)||this.__addimage__.isArrayBufferView(e))&&(e=this.__addimage__.arrayBufferToBinaryString(e)),(Xe&&this.__addimage__.isArrayBuffer(Xe)||this.__addimage__.isArrayBufferView(Xe))&&(Xe=this.__addimage__.arrayBufferToBinaryString(Xe)),{alias:r,data:e,index:t,filter:He,decodeParameters:Ve,transparency:hr,palette:ar,sMask:Xe,predictor:pr,width:De,height:Me,bitsPerComponent:Be,sMaskBitsPerComponent:Ke,colorSpace:Ge}}},(function(e){e.processGIF89A=function(t,r,n,Ee){var Ce=new oe(t),De=Ce.width,Me=Ce.height,ze=[];Ce.decodeAndBlitFrameRGBA(0,ze);var Oe={data:ze,width:De,height:Me},Be=new ue(100).encode(Oe,100);return e.processJPEG.call(this,Be,r,n,Ee)},e.processGIF87A=e.processGIF89A})(E.API),ce.prototype.parseHeader=function(){if(this.fileSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.datav.getUint32(this.pos,!0),this.pos+=4,this.offset=this.datav.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.width=this.datav.getUint32(this.pos,!0),this.pos+=4,this.height=this.datav.getInt32(this.pos,!0),this.pos+=4,this.planes=this.datav.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.datav.getUint16(this.pos,!0),this.pos+=2,this.compress=this.datav.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.datav.getUint32(this.pos,!0),this.pos+=4,this.hr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.vr=this.datav.getUint32(this.pos,!0),this.pos+=4,this.colors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.datav.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){var e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(var t=0;t<e;t++){var r=this.datav.getUint8(this.pos++,!0),n=this.datav.getUint8(this.pos++,!0),Ee=this.datav.getUint8(this.pos++,!0),Ce=this.datav.getUint8(this.pos++,!0);this.palette[t]={red:Ee,green:n,blue:r,quad:Ce}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)},ce.prototype.parseBGR=function(){this.pos=this.offset;try{var e="bit"+this.bitPP,t=this.width*this.height*4;this.data=new Uint8Array(t),this[e]()}catch(r){o.log("bit decode error:"+r)}},ce.prototype.bit1=function(){var e,t=Math.ceil(this.width/8),r=t%4;for(e=this.height-1;e>=0;e--){for(var n=this.bottom_up?e:this.height-1-e,Ee=0;Ee<t;Ee++)for(var Ce=this.datav.getUint8(this.pos++,!0),De=n*this.width*4+8*Ee*4,Me=0;Me<8&&8*Ee+Me<this.width;Me++){var ze=this.palette[Ce>>7-Me&1];this.data[De+4*Me]=ze.blue,this.data[De+4*Me+1]=ze.green,this.data[De+4*Me+2]=ze.red,this.data[De+4*Me+3]=255}r!==0&&(this.pos+=4-r)}},ce.prototype.bit4=function(){for(var e=Math.ceil(this.width/2),t=e%4,r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,Ee=0;Ee<e;Ee++){var Ce=this.datav.getUint8(this.pos++,!0),De=n*this.width*4+2*Ee*4,Me=Ce>>4,ze=15&Ce,Oe=this.palette[Me];if(this.data[De]=Oe.blue,this.data[De+1]=Oe.green,this.data[De+2]=Oe.red,this.data[De+3]=255,2*Ee+1>=this.width)break;Oe=this.palette[ze],this.data[De+4]=Oe.blue,this.data[De+4+1]=Oe.green,this.data[De+4+2]=Oe.red,this.data[De+4+3]=255}t!==0&&(this.pos+=4-t)}},ce.prototype.bit8=function(){for(var e=this.width%4,t=this.height-1;t>=0;t--){for(var r=this.bottom_up?t:this.height-1-t,n=0;n<this.width;n++){var Ee=this.datav.getUint8(this.pos++,!0),Ce=r*this.width*4+4*n;if(Ee<this.palette.length){var De=this.palette[Ee];this.data[Ce]=De.red,this.data[Ce+1]=De.green,this.data[Ce+2]=De.blue,this.data[Ce+3]=255}else this.data[Ce]=255,this.data[Ce+1]=255,this.data[Ce+2]=255,this.data[Ce+3]=255}e!==0&&(this.pos+=4-e)}},ce.prototype.bit15=function(){for(var e=this.width%3,t=parseInt("11111",2),r=this.height-1;r>=0;r--){for(var n=this.bottom_up?r:this.height-1-r,Ee=0;Ee<this.width;Ee++){var Ce=this.datav.getUint16(this.pos,!0);this.pos+=2;var De=(Ce&t)/t*255|0,Me=(Ce>>5&t)/t*255|0,ze=(Ce>>10&t)/t*255|0,Oe=Ce>>15?255:0,Be=n*this.width*4+4*Ee;this.data[Be]=ze,this.data[Be+1]=Me,this.data[Be+2]=De,this.data[Be+3]=Oe}this.pos+=e}},ce.prototype.bit16=function(){for(var e=this.width%3,t=parseInt("11111",2),r=parseInt("111111",2),n=this.height-1;n>=0;n--){for(var Ee=this.bottom_up?n:this.height-1-n,Ce=0;Ce<this.width;Ce++){var De=this.datav.getUint16(this.pos,!0);this.pos+=2;var Me=(De&t)/t*255|0,ze=(De>>5&r)/r*255|0,Oe=(De>>11)/t*255|0,Be=Ee*this.width*4+4*Ce;this.data[Be]=Oe,this.data[Be+1]=ze,this.data[Be+2]=Me,this.data[Be+3]=255}this.pos+=e}},ce.prototype.bit24=function(){for(var e=this.height-1;e>=0;e--){for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),Ee=this.datav.getUint8(this.pos++,!0),Ce=this.datav.getUint8(this.pos++,!0),De=t*this.width*4+4*r;this.data[De]=Ce,this.data[De+1]=Ee,this.data[De+2]=n,this.data[De+3]=255}this.pos+=this.width%4}},ce.prototype.bit32=function(){for(var e=this.height-1;e>=0;e--)for(var t=this.bottom_up?e:this.height-1-e,r=0;r<this.width;r++){var n=this.datav.getUint8(this.pos++,!0),Ee=this.datav.getUint8(this.pos++,!0),Ce=this.datav.getUint8(this.pos++,!0),De=this.datav.getUint8(this.pos++,!0),Me=t*this.width*4+4*r;this.data[Me]=Ce,this.data[Me+1]=Ee,this.data[Me+2]=n,this.data[Me+3]=De}},ce.prototype.getData=function(){return this.data},(function(e){e.processBMP=function(t,r,n,Ee){var Ce=new ce(t,!1),De=Ce.width,Me=Ce.height,ze={data:Ce.getData(),width:De,height:Me},Oe=new ue(100).encode(ze,100);return e.processJPEG.call(this,Oe,r,n,Ee)}})(E.API),le.prototype.getData=function(){return this.data},(function(e){e.processWEBP=function(t,r,n,Ee){var Ce=new le(t),De=Ce.width,Me=Ce.height,ze={data:Ce.getData(),width:De,height:Me},Oe=new ue(100).encode(ze,100);return e.processJPEG.call(this,Oe,r,n,Ee)}})(E.API),E.API.processRGBA=function(e,t,r){for(var n=e.data,Ee=n.length,Ce=new Uint8Array(Ee/4*3),De=new Uint8Array(Ee/4),Me=0,ze=0,Oe=0;Oe<Ee;Oe+=4){var Be=n[Oe],He=n[Oe+1],Ve=n[Oe+2],Xe=n[Oe+3];Ce[Me++]=Be,Ce[Me++]=He,Ce[Me++]=Ve,De[ze++]=Xe}var We=this.__addimage__.arrayBufferToBinaryString(Ce);return{alpha:this.__addimage__.arrayBufferToBinaryString(De),data:We,index:t,alias:r,colorSpace:"DeviceRGB",bitsPerComponent:8,width:e.width,height:e.height}},E.API.setLanguage=function(e){return this.internal.languageSettings===void 0&&(this.internal.languageSettings={},this.internal.languageSettings.isSubscribed=!1),{af:"Afrikaans",sq:"Albanian",ar:"Arabic (Standard)","ar-DZ":"Arabic (Algeria)","ar-BH":"Arabic (Bahrain)","ar-EG":"Arabic (Egypt)","ar-IQ":"Arabic (Iraq)","ar-JO":"Arabic (Jordan)","ar-KW":"Arabic (Kuwait)","ar-LB":"Arabic (Lebanon)","ar-LY":"Arabic (Libya)","ar-MA":"Arabic (Morocco)","ar-OM":"Arabic (Oman)","ar-QA":"Arabic (Qatar)","ar-SA":"Arabic (Saudi Arabia)","ar-SY":"Arabic (Syria)","ar-TN":"Arabic (Tunisia)","ar-AE":"Arabic (U.A.E.)","ar-YE":"Arabic (Yemen)",an:"Aragonese",hy:"Armenian",as:"Assamese",ast:"Asturian",az:"Azerbaijani",eu:"Basque",be:"Belarusian",bn:"Bengali",bs:"Bosnian",br:"Breton",bg:"Bulgarian",my:"Burmese",ca:"Catalan",ch:"Chamorro",ce:"Chechen",zh:"Chinese","zh-HK":"Chinese (Hong Kong)","zh-CN":"Chinese (PRC)","zh-SG":"Chinese (Singapore)","zh-TW":"Chinese (Taiwan)",cv:"Chuvash",co:"Corsican",cr:"Cree",hr:"Croatian",cs:"Czech",da:"Danish",nl:"Dutch (Standard)","nl-BE":"Dutch (Belgian)",en:"English","en-AU":"English (Australia)","en-BZ":"English (Belize)","en-CA":"English (Canada)","en-IE":"English (Ireland)","en-JM":"English (Jamaica)","en-NZ":"English (New Zealand)","en-PH":"English (Philippines)","en-ZA":"English (South Africa)","en-TT":"English (Trinidad & Tobago)","en-GB":"English (United Kingdom)","en-US":"English (United States)","en-ZW":"English (Zimbabwe)",eo:"Esperanto",et:"Estonian",fo:"Faeroese",fj:"Fijian",fi:"Finnish",fr:"French (Standard)","fr-BE":"French (Belgium)","fr-CA":"French (Canada)","fr-FR":"French (France)","fr-LU":"French (Luxembourg)","fr-MC":"French (Monaco)","fr-CH":"French (Switzerland)",fy:"Frisian",fur:"Friulian",gd:"Gaelic (Scots)","gd-IE":"Gaelic (Irish)",gl:"Galacian",ka:"Georgian",de:"German (Standard)","de-AT":"German (Austria)","de-DE":"German (Germany)","de-LI":"German (Liechtenstein)","de-LU":"German (Luxembourg)","de-CH":"German (Switzerland)",el:"Greek",gu:"Gujurati",ht:"Haitian",he:"Hebrew",hi:"Hindi",hu:"Hungarian",is:"Icelandic",id:"Indonesian",iu:"Inuktitut",ga:"Irish",it:"Italian (Standard)","it-CH":"Italian (Switzerland)",ja:"Japanese",kn:"Kannada",ks:"Kashmiri",kk:"Kazakh",km:"Khmer",ky:"Kirghiz",tlh:"Klingon",ko:"Korean","ko-KP":"Korean (North Korea)","ko-KR":"Korean (South Korea)",la:"Latin",lv:"Latvian",lt:"Lithuanian",lb:"Luxembourgish",mk:"North Macedonia",ms:"Malay",ml:"Malayalam",mt:"Maltese",mi:"Maori",mr:"Marathi",mo:"Moldavian",nv:"Navajo",ng:"Ndonga",ne:"Nepali",no:"Norwegian",nb:"Norwegian (Bokmal)",nn:"Norwegian (Nynorsk)",oc:"Occitan",or:"Oriya",om:"Oromo",fa:"Persian","fa-IR":"Persian/Iran",pl:"Polish",pt:"Portuguese","pt-BR":"Portuguese (Brazil)",pa:"Punjabi","pa-IN":"Punjabi (India)","pa-PK":"Punjabi (Pakistan)",qu:"Quechua",rm:"Rhaeto-Romanic",ro:"Romanian","ro-MO":"Romanian (Moldavia)",ru:"Russian","ru-MO":"Russian (Moldavia)",sz:"Sami (Lappish)",sg:"Sango",sa:"Sanskrit",sc:"Sardinian",sd:"Sindhi",si:"Singhalese",sr:"Serbian",sk:"Slovak",sl:"Slovenian",so:"Somani",sb:"Sorbian",es:"Spanish","es-AR":"Spanish (Argentina)","es-BO":"Spanish (Bolivia)","es-CL":"Spanish (Chile)","es-CO":"Spanish (Colombia)","es-CR":"Spanish (Costa Rica)","es-DO":"Spanish (Dominican Republic)","es-EC":"Spanish (Ecuador)","es-SV":"Spanish (El Salvador)","es-GT":"Spanish (Guatemala)","es-HN":"Spanish (Honduras)","es-MX":"Spanish (Mexico)","es-NI":"Spanish (Nicaragua)","es-PA":"Spanish (Panama)","es-PY":"Spanish (Paraguay)","es-PE":"Spanish (Peru)","es-PR":"Spanish (Puerto Rico)","es-ES":"Spanish (Spain)","es-UY":"Spanish (Uruguay)","es-VE":"Spanish (Venezuela)",sx:"Sutu",sw:"Swahili",sv:"Swedish","sv-FI":"Swedish (Finland)","sv-SV":"Swedish (Sweden)",ta:"Tamil",tt:"Tatar",te:"Teluga",th:"Thai",tig:"Tigre",ts:"Tsonga",tn:"Tswana",tr:"Turkish",tk:"Turkmen",uk:"Ukrainian",hsb:"Upper Sorbian",ur:"Urdu",ve:"Venda",vi:"Vietnamese",vo:"Volapuk",wa:"Walloon",cy:"Welsh",xh:"Xhosa",ji:"Yiddish",zu:"Zulu"}[e]!==void 0&&(this.internal.languageSettings.languageCode=e,this.internal.languageSettings.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){this.internal.write("/Lang ("+this.internal.languageSettings.languageCode+")")}),this.internal.languageSettings.isSubscribed=!0)),this},Ht=E.API,Wt=Ht.getCharWidthsArray=function(e,t){var r,n,Ee=(t=t||{}).font||this.internal.getFont(),Ce=t.fontSize||this.internal.getFontSize(),De=t.charSpace||this.internal.getCharSpace(),Me=t.widths?t.widths:Ee.metadata.Unicode.widths,ze=Me.fof?Me.fof:1,Oe=t.kerning?t.kerning:Ee.metadata.Unicode.kerning,Be=Oe.fof?Oe.fof:1,He=t.doKerning!==!1,Ve=0,Xe=e.length,We=0,Ge=Me[0]||ze,$e=[];for(r=0;r<Xe;r++)n=e.charCodeAt(r),typeof Ee.metadata.widthOfString=="function"?$e.push((Ee.metadata.widthOfGlyph(Ee.metadata.characterToGlyph(n))+De*(1e3/Ce)||0)/1e3):(Ve=He&&_typeof(Oe[n])==="object"&&!isNaN(parseInt(Oe[n][We],10))?Oe[n][We]/Be:0,$e.push((Me[n]||Ge)/ze+Ve)),We=n;return $e},Vt=Ht.getStringUnitWidth=function(e,t){var r=(t=t||{}).fontSize||this.internal.getFontSize(),n=t.font||this.internal.getFont(),Ee=t.charSpace||this.internal.getCharSpace();return Ht.processArabic&&(e=Ht.processArabic(e)),typeof n.metadata.widthOfString=="function"?n.metadata.widthOfString(e,r,Ee)/r:Wt.apply(this,arguments).reduce(function(Ce,De){return Ce+De},0)},Gt=function(e,t,r,n){for(var Ee=[],Ce=0,De=e.length,Me=0;Ce!==De&&Me+t[Ce]<r;)Me+=t[Ce],Ce++;Ee.push(e.slice(0,Ce));var ze=Ce;for(Me=0;Ce!==De;)Me+t[Ce]>n&&(Ee.push(e.slice(ze,Ce)),Me=0,ze=Ce),Me+=t[Ce],Ce++;return ze!==Ce&&Ee.push(e.slice(ze,Ce)),Ee},Yt=function(e,t,r){r||(r={});var n,Ee,Ce,De,Me,ze,Oe,Be=[],He=[Be],Ve=r.textIndent||0,Xe=0,We=0,Ge=e.split(" "),$e=Wt.apply(this,[" ",r])[0];if(ze=r.lineIndent===-1?Ge[0].length+2:r.lineIndent||0){var Ke=Array(ze).join(" "),rr=[];Ge.map(function(sr){(sr=sr.split(/\s*\n/)).length>1?rr=rr.concat(sr.map(function(ar,hr){return(hr&&ar.length?`
`:"")+ar})):rr.push(sr[0])}),Ge=rr,ze=Vt.apply(this,[Ke,r])}for(Ce=0,De=Ge.length;Ce<De;Ce++){var tr=0;if(n=Ge[Ce],ze&&n[0]==`
`&&(n=n.substr(1),tr=1),Ve+Xe+(We=(Ee=Wt.apply(this,[n,r])).reduce(function(sr,ar){return sr+ar},0))>t||tr){if(We>t){for(Me=Gt.apply(this,[n,Ee,t-(Ve+Xe),t]),Be.push(Me.shift()),Be=[Me.pop()];Me.length;)He.push([Me.shift()]);We=Ee.slice(n.length-(Be[0]?Be[0].length:0)).reduce(function(sr,ar){return sr+ar},0)}else Be=[n];He.push(Be),Ve=We+ze,Xe=$e}else Be.push(n),Ve+=Xe+We,Xe=$e}return Oe=ze?function(sr,ar){return(ar?Ke:"")+sr.join(" ")}:function(sr){return sr.join(" ")},He.map(Oe)},Ht.splitTextToSize=function(e,t,r){var n,Ee=(r=r||{}).fontSize||this.internal.getFontSize(),Ce=function(Be){if(Be.widths&&Be.kerning)return{widths:Be.widths,kerning:Be.kerning};var He=this.internal.getFont(Be.fontName,Be.fontStyle),Ve="Unicode";return He.metadata[Ve]?{widths:He.metadata[Ve].widths||{0:1},kerning:He.metadata[Ve].kerning||{}}:{font:He.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}.call(this,r);n=Array.isArray(e)?e:String(e).split(/\r?\n/);var De=1*this.internal.scaleFactor*t/Ee;Ce.textIndent=r.textIndent?1*r.textIndent*this.internal.scaleFactor/Ee:0,Ce.lineIndent=r.lineIndent;var Me,ze,Oe=[];for(Me=0,ze=n.length;Me<ze;Me++)Oe=Oe.concat(Yt.apply(this,[n[Me],De,Ce]));return Oe},(function(e){e.__fontmetrics__=e.__fontmetrics__||{};for(var t="0123456789abcdef",r="klmnopqrstuvwxyz",n={},Ee={},Ce=0;Ce<16;Ce++)n[r[Ce]]=t[Ce],Ee[t[Ce]]=r[Ce];var De=function(Ve){return"0x"+parseInt(Ve,10).toString(16)},Me=e.__fontmetrics__.compress=function(Ve){var Xe,We,Ge,$e,Ke=["{"];for(var rr in Ve){if(Xe=Ve[rr],isNaN(parseInt(rr,10))?We="'"+rr+"'":(rr=parseInt(rr,10),We=(We=De(rr).slice(2)).slice(0,-1)+Ee[We.slice(-1)]),typeof Xe=="number")Xe<0?(Ge=De(Xe).slice(3),$e="-"):(Ge=De(Xe).slice(2),$e=""),Ge=$e+Ge.slice(0,-1)+Ee[Ge.slice(-1)];else{if(_typeof(Xe)!=="object")throw new Error("Don't know what to do with value type "+_typeof(Xe)+".");Ge=Me(Xe)}Ke.push(We+Ge)}return Ke.push("}"),Ke.join("")},ze=e.__fontmetrics__.uncompress=function(Ve){if(typeof Ve!="string")throw new Error("Invalid argument passed to uncompress.");for(var Xe,We,Ge,$e,Ke={},rr=1,tr=Ke,sr=[],ar="",hr="",pr=Ve.length-1,yr=1;yr<pr;yr+=1)($e=Ve[yr])=="'"?Xe?(Ge=Xe.join(""),Xe=void 0):Xe=[]:Xe?Xe.push($e):$e=="{"?(sr.push([tr,Ge]),tr={},Ge=void 0):$e=="}"?((We=sr.pop())[0][We[1]]=tr,Ge=void 0,tr=We[0]):$e=="-"?rr=-1:Ge===void 0?n.hasOwnProperty($e)?(ar+=n[$e],Ge=parseInt(ar,16)*rr,rr=1,ar=""):ar+=$e:n.hasOwnProperty($e)?(hr+=n[$e],tr[Ge]=parseInt(hr,16)*rr,rr=1,Ge=void 0,hr=""):hr+=$e;return Ke},Oe={codePages:["WinAnsiEncoding"],WinAnsiEncoding:ze("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},Be={Unicode:{Courier:Oe,"Courier-Bold":Oe,"Courier-BoldOblique":Oe,"Courier-Oblique":Oe,Helvetica:Oe,"Helvetica-Bold":Oe,"Helvetica-BoldOblique":Oe,"Helvetica-Oblique":Oe,"Times-Roman":Oe,"Times-Bold":Oe,"Times-BoldItalic":Oe,"Times-Italic":Oe}},He={Unicode:{"Courier-Oblique":ze("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":ze("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":ze("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:ze("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":ze("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":ze("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:ze("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:ze("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":ze("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:ze("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":ze("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":ze("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":ze("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":ze("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};e.events.push(["addFont",function(Ve){var Xe=Ve.font,We=He.Unicode[Xe.postScriptName];We&&(Xe.metadata.Unicode={},Xe.metadata.Unicode.widths=We.widths,Xe.metadata.Unicode.kerning=We.kerning);var Ge=Be.Unicode[Xe.postScriptName];Ge&&(Xe.metadata.Unicode.encoding=Ge,Xe.encoding=Ge.codePages[0])}])})(E.API),(function(e){var t=function(r){for(var n=r.length,Ee=new Uint8Array(n),Ce=0;Ce<n;Ce++)Ee[Ce]=r.charCodeAt(Ce);return Ee};e.API.events.push(["addFont",function(r){var n=void 0,Ee=r.font,Ce=r.instance;if(!Ee.isStandardFont){if(Ce===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+Ee.postScriptName+"').");if(typeof(n=Ce.existsFileInVFS(Ee.postScriptName)===!1?Ce.loadFile(Ee.postScriptName):Ce.getFileFromVFS(Ee.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+Ee.postScriptName+"').");(function(De,Me){Me=/^\x00\x01\x00\x00/.test(Me)?t(Me):t(f(Me)),De.metadata=e.API.TTFFont.open(Me),De.metadata.Unicode=De.metadata.Unicode||{encoding:{},kerning:{},widths:[]},De.metadata.glyIdsUsed=[0]})(Ee,n)}}])})(E),E.API.addSvgAsImage=function(e,t,r,n,Ee,Ce,De,Me){if(isNaN(t)||isNaN(r))throw o.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(n)||isNaN(Ee))throw o.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var ze=document.createElement("canvas");ze.width=n,ze.height=Ee;var Oe=ze.getContext("2d");Oe.fillStyle="#fff",Oe.fillRect(0,0,ze.width,ze.height);var Be={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},He=this;return(i.canvg?Promise.resolve(i.canvg):__vitePreload(()=>import("./index.es-B8cTO27A.js"),[])).catch(function(Ve){return Promise.reject(new Error("Could not load canvg: "+Ve))}).then(function(Ve){return Ve.default?Ve.default:Ve}).then(function(Ve){return Ve.fromString(Oe,e,Be)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(Ve){return Ve.render(Be)}).then(function(){He.addImage(ze.toDataURL("image/jpeg",1),t,r,n,Ee,De,Me)})},E.API.putTotalPages=function(e){var t,r=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(e,"g"),r=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(e,this.internal.getFont()),"g"),r=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var n=1;n<=this.internal.getNumberOfPages();n++)for(var Ee=0;Ee<this.internal.pages[n].length;Ee++)this.internal.pages[n][Ee]=this.internal.pages[n][Ee].replace(t,r);return this},E.API.viewerPreferences=function(e,t){var r;e=e||{},t=t||!1;var n,Ee,Ce,De={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},Me=Object.keys(De),ze=[],Oe=0,Be=0,He=0;function Ve(We,Ge){var $e,Ke=!1;for($e=0;$e<We.length;$e+=1)We[$e]===Ge&&(Ke=!0);return Ke}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(De)),this.internal.viewerpreferences.isSubscribed=!1),r=this.internal.viewerpreferences.configuration,e==="reset"||t===!0){var Xe=Me.length;for(He=0;He<Xe;He+=1)r[Me[He]].value=r[Me[He]].defaultValue,r[Me[He]].explicitSet=!1}if(_typeof(e)==="object"){for(Ee in e)if(Ce=e[Ee],Ve(Me,Ee)&&Ce!==void 0){if(r[Ee].type==="boolean"&&typeof Ce=="boolean")r[Ee].value=Ce;else if(r[Ee].type==="name"&&Ve(r[Ee].valueSet,Ce))r[Ee].value=Ce;else if(r[Ee].type==="integer"&&Number.isInteger(Ce))r[Ee].value=Ce;else if(r[Ee].type==="array"){for(Oe=0;Oe<Ce.length;Oe+=1)if(n=!0,Ce[Oe].length===1&&typeof Ce[Oe][0]=="number")ze.push(String(Ce[Oe]-1));else if(Ce[Oe].length>1){for(Be=0;Be<Ce[Oe].length;Be+=1)typeof Ce[Oe][Be]!="number"&&(n=!1);n===!0&&ze.push([Ce[Oe][0]-1,Ce[Oe][1]-1].join(" "))}r[Ee].value="["+ze.join(" ")+"]"}else r[Ee].value=r[Ee].defaultValue;r[Ee].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var We,Ge=[];for(We in r)r[We].explicitSet===!0&&(r[We].type==="name"?Ge.push("/"+We+" /"+r[We].value):Ge.push("/"+We+" "+r[We].value));Ge.length!==0&&this.internal.write(`/ViewerPreferences
<<
`+Ge.join(`
`)+`
>>`)}),this.internal.viewerpreferences.isSubscribed=!0),this.internal.viewerpreferences.configuration=r,this},(function(e){var t=function(){var n='<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"><rdf:Description rdf:about="" xmlns:jspdf="'+this.internal.__metadata__.namespaceuri+'"><jspdf:metadata>',Ee=unescape(encodeURIComponent('<x:xmpmeta xmlns:x="adobe:ns:meta/">')),Ce=unescape(encodeURIComponent(n)),De=unescape(encodeURIComponent(this.internal.__metadata__.metadata)),Me=unescape(encodeURIComponent("</jspdf:metadata></rdf:Description></rdf:RDF>")),ze=unescape(encodeURIComponent("</x:xmpmeta>")),Oe=Ce.length+De.length+Me.length+Ee.length+ze.length;this.internal.__metadata__.metadata_object_number=this.internal.newObject(),this.internal.write("<< /Type /Metadata /Subtype /XML /Length "+Oe+" >>"),this.internal.write("stream"),this.internal.write(Ee+Ce+De+Me+ze),this.internal.write("endstream"),this.internal.write("endobj")},r=function(){this.internal.__metadata__.metadata_object_number&&this.internal.write("/Metadata "+this.internal.__metadata__.metadata_object_number+" 0 R")};e.addMetadata=function(n,Ee){return this.internal.__metadata__===void 0&&(this.internal.__metadata__={metadata:n,namespaceuri:Ee||"http://jspdf.default.namespaceuri/"},this.internal.events.subscribe("putCatalog",r),this.internal.events.subscribe("postPutResources",t)),this}})(E.API),(function(e){var t=e.API,r=t.pdfEscape16=function(Ce,De){for(var Me,ze=De.metadata.Unicode.widths,Oe=["","0","00","000","0000"],Be=[""],He=0,Ve=Ce.length;He<Ve;++He){if(Me=De.metadata.characterToGlyph(Ce.charCodeAt(He)),De.metadata.glyIdsUsed.push(Me),De.metadata.toUnicode[Me]=Ce.charCodeAt(He),ze.indexOf(Me)==-1&&(ze.push(Me),ze.push([parseInt(De.metadata.widthOfGlyph(Me),10)])),Me=="0")return Be.join("");Me=Me.toString(16),Be.push(Oe[4-Me.length],Me)}return Be.join("")},n=function(Ce){var De,Me,ze,Oe,Be,He,Ve;for(Be=`/CIDInit /ProcSet findresource begin
12 dict begin
begincmap
/CIDSystemInfo <<
  /Registry (Adobe)
  /Ordering (UCS)
  /Supplement 0
>> def
/CMapName /Adobe-Identity-UCS def
/CMapType 2 def
1 begincodespacerange
<0000><ffff>
endcodespacerange`,ze=[],He=0,Ve=(Me=Object.keys(Ce).sort(function(Xe,We){return Xe-We})).length;He<Ve;He++)De=Me[He],ze.length>=100&&(Be+=`
`+ze.length+` beginbfchar
`+ze.join(`
`)+`
endbfchar`,ze=[]),Ce[De]!==void 0&&Ce[De]!==null&&typeof Ce[De].toString=="function"&&(Oe=("0000"+Ce[De].toString(16)).slice(-4),De=("0000"+(+De).toString(16)).slice(-4),ze.push("<"+De+"><"+Oe+">"));return ze.length&&(Be+=`
`+ze.length+` beginbfchar
`+ze.join(`
`)+`
endbfchar
`),Be+`endcmap
CMapName currentdict /CMap defineresource pop
end
end`};t.events.push(["putFont",function(Ce){(function(De){var Me=De.font,ze=De.out,Oe=De.newObject,Be=De.putStream;if(Me.metadata instanceof e.API.TTFFont&&Me.encoding==="Identity-H"){for(var He=Me.metadata.Unicode.widths,Ve=Me.metadata.subset.encode(Me.metadata.glyIdsUsed,1),Xe="",We=0;We<Ve.length;We++)Xe+=String.fromCharCode(Ve[We]);var Ge=Oe();Be({data:Xe,addLength1:!0,objectId:Ge}),ze("endobj");var $e=Oe();Be({data:n(Me.metadata.toUnicode),addLength1:!0,objectId:$e}),ze("endobj");var Ke=Oe();ze("<<"),ze("/Type /FontDescriptor"),ze("/FontName /"+j(Me.fontName)),ze("/FontFile2 "+Ge+" 0 R"),ze("/FontBBox "+e.API.PDFObject.convert(Me.metadata.bbox)),ze("/Flags "+Me.metadata.flags),ze("/StemV "+Me.metadata.stemV),ze("/ItalicAngle "+Me.metadata.italicAngle),ze("/Ascent "+Me.metadata.ascender),ze("/Descent "+Me.metadata.decender),ze("/CapHeight "+Me.metadata.capHeight),ze(">>"),ze("endobj");var rr=Oe();ze("<<"),ze("/Type /Font"),ze("/BaseFont /"+j(Me.fontName)),ze("/FontDescriptor "+Ke+" 0 R"),ze("/W "+e.API.PDFObject.convert(He)),ze("/CIDToGIDMap /Identity"),ze("/DW 1000"),ze("/Subtype /CIDFontType2"),ze("/CIDSystemInfo"),ze("<<"),ze("/Supplement 0"),ze("/Registry (Adobe)"),ze("/Ordering ("+Me.encoding+")"),ze(">>"),ze(">>"),ze("endobj"),Me.objectNumber=Oe(),ze("<<"),ze("/Type /Font"),ze("/Subtype /Type0"),ze("/ToUnicode "+$e+" 0 R"),ze("/BaseFont /"+j(Me.fontName)),ze("/Encoding /"+Me.encoding),ze("/DescendantFonts ["+rr+" 0 R]"),ze(">>"),ze("endobj"),Me.isAlreadyPutted=!0}})(Ce)}]),t.events.push(["putFont",function(Ce){(function(De){var Me=De.font,ze=De.out,Oe=De.newObject,Be=De.putStream;if(Me.metadata instanceof e.API.TTFFont&&Me.encoding==="WinAnsiEncoding"){for(var He=Me.metadata.rawData,Ve="",Xe=0;Xe<He.length;Xe++)Ve+=String.fromCharCode(He[Xe]);var We=Oe();Be({data:Ve,addLength1:!0,objectId:We}),ze("endobj");var Ge=Oe();Be({data:n(Me.metadata.toUnicode),addLength1:!0,objectId:Ge}),ze("endobj");var $e=Oe();ze("<<"),ze("/Descent "+Me.metadata.decender),ze("/CapHeight "+Me.metadata.capHeight),ze("/StemV "+Me.metadata.stemV),ze("/Type /FontDescriptor"),ze("/FontFile2 "+We+" 0 R"),ze("/Flags 96"),ze("/FontBBox "+e.API.PDFObject.convert(Me.metadata.bbox)),ze("/FontName /"+j(Me.fontName)),ze("/ItalicAngle "+Me.metadata.italicAngle),ze("/Ascent "+Me.metadata.ascender),ze(">>"),ze("endobj"),Me.objectNumber=Oe();for(var Ke=0;Ke<Me.metadata.hmtx.widths.length;Ke++)Me.metadata.hmtx.widths[Ke]=parseInt(Me.metadata.hmtx.widths[Ke]*(1e3/Me.metadata.head.unitsPerEm));ze("<</Subtype/TrueType/Type/Font/ToUnicode "+Ge+" 0 R/BaseFont/"+j(Me.fontName)+"/FontDescriptor "+$e+" 0 R/Encoding/"+Me.encoding+" /FirstChar 29 /LastChar 255 /Widths "+e.API.PDFObject.convert(Me.metadata.hmtx.widths)+">>"),ze("endobj"),Me.isAlreadyPutted=!0}})(Ce)}]);var Ee=function(Ce){var De,Me=Ce.text||"",ze=Ce.x,Oe=Ce.y,Be=Ce.options||{},He=Ce.mutex||{},Ve=He.pdfEscape,Xe=He.activeFontKey,We=He.fonts,Ge=Xe,$e="",Ke=0,rr="",tr=We[Ge].encoding;if(We[Ge].encoding!=="Identity-H")return{text:Me,x:ze,y:Oe,options:Be,mutex:He};for(rr=Me,Ge=Xe,Array.isArray(Me)&&(rr=Me[0]),Ke=0;Ke<rr.length;Ke+=1)We[Ge].metadata.hasOwnProperty("cmap")&&(De=We[Ge].metadata.cmap.unicode.codeMap[rr[Ke].charCodeAt(0)]),De||rr[Ke].charCodeAt(0)<256&&We[Ge].metadata.hasOwnProperty("Unicode")?$e+=rr[Ke]:$e+="";var sr="";return parseInt(Ge.slice(1))<14||tr==="WinAnsiEncoding"?sr=Ve($e,Ge).split("").map(function(ar){return ar.charCodeAt(0).toString(16)}).join(""):tr==="Identity-H"&&(sr=r($e,We[Ge])),He.isHex=!0,{text:sr,x:ze,y:Oe,options:Be,mutex:He}};t.events.push(["postProcessText",function(Ce){var De=Ce.text||"",Me=[],ze={text:De,x:Ce.x,y:Ce.y,options:Ce.options,mutex:Ce.mutex};if(Array.isArray(De)){var Oe=0;for(Oe=0;Oe<De.length;Oe+=1)Array.isArray(De[Oe])&&De[Oe].length===3?Me.push([Ee(Object.assign({},ze,{text:De[Oe][0]})).text,De[Oe][1],De[Oe][2]]):Me.push(Ee(Object.assign({},ze,{text:De[Oe]})).text);Ce.text=Me}else Ce.text=Ee(Object.assign({},ze,{text:De})).text}])})(E),(function(e){var t=function(){return this.internal.vFS===void 0&&(this.internal.vFS={}),!0};e.existsFileInVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0},e.addFileToVFS=function(r,n){return t.call(this),this.internal.vFS[r]=n,this},e.getFileFromVFS=function(r){return t.call(this),this.internal.vFS[r]!==void 0?this.internal.vFS[r]:null}})(E.API),(function(e){e.__bidiEngine__=e.prototype.__bidiEngine__=function(n){var Ee,Ce,De,Me,ze,Oe,Be,He=t,Ve=[[0,3,0,1,0,0,0],[0,3,0,1,2,2,0],[0,3,0,17,2,0,1],[0,3,5,5,4,1,0],[0,3,21,21,4,0,1],[0,3,5,5,4,2,0]],Xe=[[2,0,1,1,0,1,0],[2,0,1,1,0,2,0],[2,0,2,1,3,2,0],[2,0,2,33,3,1,1]],We={L:0,R:1,EN:2,AN:3,N:4,B:5,S:6},Ge={0:0,5:1,6:2,7:3,32:4,251:5,254:6,255:7},$e=["(",")","(","<",">","<","[","]","[","{","}","{","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","","",""],Ke=new RegExp(/^([1-4|9]|1[0-9]|2[0-9]|3[0168]|4[04589]|5[012]|7[78]|159|16[0-9]|17[0-2]|21[569]|22[03489]|250)$/),rr=!1,tr=0;this.__bidiEngine__={};var sr=function(mr){var wr=mr.charCodeAt(),Fr=wr>>8,Mr=Ge[Fr];return Mr!==void 0?He[256*Mr+(255&wr)]:Fr===252||Fr===253?"AL":Ke.test(Fr)?"L":Fr===8?"R":"N"},ar=function(mr){for(var wr,Fr=0;Fr<mr.length;Fr++){if((wr=sr(mr.charAt(Fr)))==="L")return!1;if(wr==="R")return!0}return!1},hr=function(mr,wr,Fr,Mr){var Hr,Nr,Ar,xr,ir=wr[Mr];switch(ir){case"L":case"R":case"LRE":case"RLE":case"LRO":case"RLO":case"PDF":rr=!1;break;case"N":case"AN":break;case"EN":rr&&(ir="AN");break;case"AL":rr=!0,ir="R";break;case"WS":case"BN":ir="N";break;case"CS":Mr<1||Mr+1>=wr.length||(Hr=Fr[Mr-1])!=="EN"&&Hr!=="AN"||(Nr=wr[Mr+1])!=="EN"&&Nr!=="AN"?ir="N":rr&&(Nr="AN"),ir=Nr===Hr?Nr:"N";break;case"ES":ir=(Hr=Mr>0?Fr[Mr-1]:"B")==="EN"&&Mr+1<wr.length&&wr[Mr+1]==="EN"?"EN":"N";break;case"ET":if(Mr>0&&Fr[Mr-1]==="EN"){ir="EN";break}if(rr){ir="N";break}for(Ar=Mr+1,xr=wr.length;Ar<xr&&wr[Ar]==="ET";)Ar++;ir=Ar<xr&&wr[Ar]==="EN"?"EN":"N";break;case"NSM":if(De&&!Me){for(xr=wr.length,Ar=Mr+1;Ar<xr&&wr[Ar]==="NSM";)Ar++;if(Ar<xr){var _r=mr[Mr],ur=_r>=1425&&_r<=2303||_r===64286;if(Hr=wr[Ar],ur&&(Hr==="R"||Hr==="AL")){ir="R";break}}}ir=Mr<1||(Hr=wr[Mr-1])==="B"?"N":Fr[Mr-1];break;case"B":rr=!1,Ee=!0,ir=tr;break;case"S":Ce=!0,ir="N"}return ir},pr=function(mr,wr,Fr){var Mr=mr.split("");return Fr&&yr(Mr,Fr,{hiLevel:tr}),Mr.reverse(),wr&&wr.reverse(),Mr.join("")},yr=function(mr,wr,Fr){var Mr,Hr,Nr,Ar,xr,ir=-1,_r=mr.length,ur=0,Je=[],nr=tr?Xe:Ve,or=[];for(rr=!1,Ee=!1,Ce=!1,Hr=0;Hr<_r;Hr++)or[Hr]=sr(mr[Hr]);for(Nr=0;Nr<_r;Nr++){if(xr=ur,Je[Nr]=hr(mr,or,Je,Nr),Mr=240&(ur=nr[xr][We[Je[Nr]]]),ur&=15,wr[Nr]=Ar=nr[ur][5],Mr>0)if(Mr===16){for(Hr=ir;Hr<Nr;Hr++)wr[Hr]=1;ir=-1}else ir=-1;if(nr[ur][6])ir===-1&&(ir=Nr);else if(ir>-1){for(Hr=ir;Hr<Nr;Hr++)wr[Hr]=Ar;ir=-1}or[Nr]==="B"&&(wr[Nr]=0),Fr.hiLevel|=Ar}Ce&&(function(lr,St,dr){for(var vr=0;vr<dr;vr++)if(lr[vr]==="S"){St[vr]=tr;for(var br=vr-1;br>=0&&lr[br]==="WS";br--)St[br]=tr}})(or,wr,_r)},fr=function(mr,wr,Fr,Mr,Hr){if(!(Hr.hiLevel<mr)){if(mr===1&&tr===1&&!Ee)return wr.reverse(),void(Fr&&Fr.reverse());for(var Nr,Ar,xr,ir,_r=wr.length,ur=0;ur<_r;){if(Mr[ur]>=mr){for(xr=ur+1;xr<_r&&Mr[xr]>=mr;)xr++;for(ir=ur,Ar=xr-1;ir<Ar;ir++,Ar--)Nr=wr[ir],wr[ir]=wr[Ar],wr[Ar]=Nr,Fr&&(Nr=Fr[ir],Fr[ir]=Fr[Ar],Fr[Ar]=Nr);ur=xr}ur++}}},Rr=function(mr,wr,Fr){var Mr=mr.split(""),Hr={hiLevel:tr};return Fr||(Fr=[]),yr(Mr,Fr,Hr),(function(Nr,Ar,xr){if(xr.hiLevel!==0&&Be)for(var ir,_r=0;_r<Nr.length;_r++)Ar[_r]===1&&(ir=$e.indexOf(Nr[_r]))>=0&&(Nr[_r]=$e[ir+1])})(Mr,Fr,Hr),fr(2,Mr,wr,Fr,Hr),fr(1,Mr,wr,Fr,Hr),Mr.join("")};return this.__bidiEngine__.doBidiReorder=function(mr,wr,Fr){if((function(Hr,Nr){if(Nr)for(var Ar=0;Ar<Hr.length;Ar++)Nr[Ar]=Ar;Me===void 0&&(Me=ar(Hr)),Oe===void 0&&(Oe=ar(Hr))})(mr,wr),De||!ze||Oe)if(De&&ze&&Me^Oe)tr=Me?1:0,mr=pr(mr,wr,Fr);else if(!De&&ze&&Oe)tr=Me?1:0,mr=Rr(mr,wr,Fr),mr=pr(mr,wr);else if(!De||Me||ze||Oe){if(De&&!ze&&Me^Oe)mr=pr(mr,wr),Me?(tr=0,mr=Rr(mr,wr,Fr)):(tr=1,mr=Rr(mr,wr,Fr),mr=pr(mr,wr));else if(De&&Me&&!ze&&Oe)tr=1,mr=Rr(mr,wr,Fr),mr=pr(mr,wr);else if(!De&&!ze&&Me^Oe){var Mr=Be;Me?(tr=1,mr=Rr(mr,wr,Fr),tr=0,Be=!1,mr=Rr(mr,wr,Fr),Be=Mr):(tr=0,mr=Rr(mr,wr,Fr),mr=pr(mr,wr),tr=1,Be=!1,mr=Rr(mr,wr,Fr),Be=Mr,mr=pr(mr,wr))}}else tr=0,mr=Rr(mr,wr,Fr);else tr=Me?1:0,mr=Rr(mr,wr,Fr);return mr},this.__bidiEngine__.setOptions=function(mr){mr&&(De=mr.isInputVisual,ze=mr.isOutputVisual,Me=mr.isInputRtl,Oe=mr.isOutputRtl,Be=mr.isSymmetricSwapping)},this.__bidiEngine__.setOptions(n),this.__bidiEngine__};var t=["BN","BN","BN","BN","BN","BN","BN","BN","BN","S","B","S","WS","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","B","B","B","S","WS","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","BN","BN","BN","BN","BN","BN","B","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","BN","CS","N","ET","ET","ET","ET","N","N","N","N","L","N","N","BN","N","N","ET","ET","EN","EN","N","L","N","N","N","EN","L","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","L","L","L","L","L","L","L","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","L","N","N","N","N","N","ET","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","NSM","R","NSM","NSM","R","NSM","NSM","R","NSM","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","N","N","N","N","N","R","R","R","R","R","N","N","N","N","N","N","N","N","N","N","N","AN","AN","AN","AN","AN","AN","N","N","AL","ET","ET","AL","CS","AL","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","AN","AN","AN","AN","AN","AN","AN","AN","AN","ET","AN","AN","AL","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AN","N","NSM","NSM","NSM","NSM","NSM","NSM","AL","AL","NSM","NSM","N","NSM","NSM","NSM","NSM","AL","AL","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","AL","AL","NSM","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","R","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","R","R","N","N","N","N","R","N","N","N","N","N","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","WS","BN","BN","BN","L","R","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","B","LRE","RLE","PDF","LRO","RLO","CS","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","WS","BN","BN","BN","BN","BN","N","LRI","RLI","FSI","PDI","BN","BN","BN","BN","BN","BN","EN","L","N","N","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","L","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","ES","ES","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","N","N","N","N","N","R","NSM","R","R","R","R","R","R","R","R","R","R","ES","R","R","R","R","R","R","R","R","R","R","R","R","R","N","R","R","R","R","R","N","R","N","R","R","N","R","R","N","R","R","R","R","R","R","R","R","R","R","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","NSM","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","CS","N","CS","N","N","CS","N","N","N","N","N","N","N","N","N","ET","N","N","ES","ES","N","N","N","N","N","ET","ET","N","N","N","N","N","AL","AL","AL","AL","AL","N","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","AL","N","N","BN","N","N","N","ET","ET","ET","N","N","N","N","N","ES","CS","ES","CS","CS","EN","EN","EN","EN","EN","EN","EN","EN","EN","EN","CS","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","N","N","N","N","N","N","N","N","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","L","N","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","L","L","L","N","N","L","L","L","N","N","N","ET","ET","N","N","N","ET","ET","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N","N"],r=new e.__bidiEngine__({isInputVisual:!0});e.API.events.push(["postProcessText",function(n){var Ee=n.text;n.x,n.y;var Ce=n.options||{};n.mutex,Ce.lang;var De=[];if(Ce.isInputVisual=typeof Ce.isInputVisual!="boolean"||Ce.isInputVisual,r.setOptions(Ce),Object.prototype.toString.call(Ee)==="[object Array]"){var Me=0;for(De=[],Me=0;Me<Ee.length;Me+=1)Object.prototype.toString.call(Ee[Me])==="[object Array]"?De.push([r.doBidiReorder(Ee[Me][0]),Ee[Me][1],Ee[Me][2]]):De.push([r.doBidiReorder(Ee[Me])]);n.text=De}else n.text=r.doBidiReorder(Ee);r.setOptions({isInputVisual:!0})}])})(E),E.API.TTFFont=(function(){function e(t){var r;if(this.rawData=t,r=this.contents=new fe(t),this.contents.pos=4,r.readString(4)==="ttcf")throw new Error("TTCF not supported.");r.pos=0,this.parse(),this.subset=new je(this),this.registerTTF()}return e.open=function(t){return new e(t)},e.prototype.parse=function(){return this.directory=new de(this.contents),this.head=new me(this),this.name=new xe(this),this.cmap=new be(this),this.toUnicode={},this.hhea=new ye(this),this.maxp=new Ae(this),this.hmtx=new Se(this),this.post=new Ne(this),this.os2=new we(this),this.loca=new Ie(this),this.glyf=new Pe(this),this.ascender=this.os2.exists&&this.os2.ascender||this.hhea.ascender,this.decender=this.os2.exists&&this.os2.decender||this.hhea.decender,this.lineGap=this.os2.exists&&this.os2.lineGap||this.hhea.lineGap,this.bbox=[this.head.xMin,this.head.yMin,this.head.xMax,this.head.yMax]},e.prototype.registerTTF=function(){var t,r,n,Ee,Ce;if(this.scaleFactor=1e3/this.head.unitsPerEm,this.bbox=function(){var De,Me,ze,Oe;for(Oe=[],De=0,Me=(ze=this.bbox).length;De<Me;De++)t=ze[De],Oe.push(Math.round(t*this.scaleFactor));return Oe}.call(this),this.stemV=0,this.post.exists?(n=255&(Ee=this.post.italic_angle),32768&(r=Ee>>16)&&(r=-(1+(65535^r))),this.italicAngle=+(r+"."+n)):this.italicAngle=0,this.ascender=Math.round(this.ascender*this.scaleFactor),this.decender=Math.round(this.decender*this.scaleFactor),this.lineGap=Math.round(this.lineGap*this.scaleFactor),this.capHeight=this.os2.exists&&this.os2.capHeight||this.ascender,this.xHeight=this.os2.exists&&this.os2.xHeight||0,this.familyClass=(this.os2.exists&&this.os2.familyClass||0)>>8,this.isSerif=(Ce=this.familyClass)===1||Ce===2||Ce===3||Ce===4||Ce===5||Ce===7,this.isScript=this.familyClass===10,this.flags=0,this.post.isFixedPitch&&(this.flags|=1),this.isSerif&&(this.flags|=2),this.isScript&&(this.flags|=8),this.italicAngle!==0&&(this.flags|=64),this.flags|=32,!this.cmap.unicode)throw new Error("No unicode cmap for font")},e.prototype.characterToGlyph=function(t){var r;return((r=this.cmap.unicode)!=null?r.codeMap[t]:void 0)||0},e.prototype.widthOfGlyph=function(t){var r;return r=1e3/this.head.unitsPerEm,this.hmtx.forGlyph(t).advance*r},e.prototype.widthOfString=function(t,r,n){var Ee,Ce,De,Me;for(De=0,Ce=0,Me=(t=""+t).length;0<=Me?Ce<Me:Ce>Me;Ce=0<=Me?++Ce:--Ce)Ee=t.charCodeAt(Ce),De+=this.widthOfGlyph(this.characterToGlyph(Ee))+n*(1e3/r)||0;return De*(r/1e3)},e.prototype.lineHeight=function(t,r){var n;return r==null&&(r=!1),n=r?this.lineGap:0,(this.ascender+n-this.decender)/1e3*t},e})();var he,fe=(function(){function e(t){this.data=t??[],this.pos=0,this.length=this.data.length}return e.prototype.readByte=function(){return this.data[this.pos++]},e.prototype.writeByte=function(t){return this.data[this.pos++]=t},e.prototype.readUInt32=function(){return 16777216*this.readByte()+(this.readByte()<<16)+(this.readByte()<<8)+this.readByte()},e.prototype.writeUInt32=function(t){return this.writeByte(t>>>24&255),this.writeByte(t>>16&255),this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt32=function(){var t;return(t=this.readUInt32())>=2147483648?t-4294967296:t},e.prototype.writeInt32=function(t){return t<0&&(t+=4294967296),this.writeUInt32(t)},e.prototype.readUInt16=function(){return this.readByte()<<8|this.readByte()},e.prototype.writeUInt16=function(t){return this.writeByte(t>>8&255),this.writeByte(255&t)},e.prototype.readInt16=function(){var t;return(t=this.readUInt16())>=32768?t-65536:t},e.prototype.writeInt16=function(t){return t<0&&(t+=65536),this.writeUInt16(t)},e.prototype.readString=function(t){var r,n;for(n=[],r=0;0<=t?r<t:r>t;r=0<=t?++r:--r)n[r]=String.fromCharCode(this.readByte());return n.join("")},e.prototype.writeString=function(t){var r,n,Ee;for(Ee=[],r=0,n=t.length;0<=n?r<n:r>n;r=0<=n?++r:--r)Ee.push(this.writeByte(t.charCodeAt(r)));return Ee},e.prototype.readShort=function(){return this.readInt16()},e.prototype.writeShort=function(t){return this.writeInt16(t)},e.prototype.readLongLong=function(){var t,r,n,Ee,Ce,De,Me,ze;return t=this.readByte(),r=this.readByte(),n=this.readByte(),Ee=this.readByte(),Ce=this.readByte(),De=this.readByte(),Me=this.readByte(),ze=this.readByte(),128&t?-1*(72057594037927940*(255^t)+281474976710656*(255^r)+1099511627776*(255^n)+4294967296*(255^Ee)+16777216*(255^Ce)+65536*(255^De)+256*(255^Me)+(255^ze)+1):72057594037927940*t+281474976710656*r+1099511627776*n+4294967296*Ee+16777216*Ce+65536*De+256*Me+ze},e.prototype.writeLongLong=function(t){var r,n;return r=Math.floor(t/4294967296),n=4294967295&t,this.writeByte(r>>24&255),this.writeByte(r>>16&255),this.writeByte(r>>8&255),this.writeByte(255&r),this.writeByte(n>>24&255),this.writeByte(n>>16&255),this.writeByte(n>>8&255),this.writeByte(255&n)},e.prototype.readInt=function(){return this.readInt32()},e.prototype.writeInt=function(t){return this.writeInt32(t)},e.prototype.read=function(t){var r,n;for(r=[],n=0;0<=t?n<t:n>t;n=0<=t?++n:--n)r.push(this.readByte());return r},e.prototype.write=function(t){var r,n,Ee,Ce;for(Ce=[],n=0,Ee=t.length;n<Ee;n++)r=t[n],Ce.push(this.writeByte(r));return Ce},e})(),de=(function(){var e;function t(r){var n,Ee,Ce;for(this.scalarType=r.readInt(),this.tableCount=r.readShort(),this.searchRange=r.readShort(),this.entrySelector=r.readShort(),this.rangeShift=r.readShort(),this.tables={},Ee=0,Ce=this.tableCount;0<=Ce?Ee<Ce:Ee>Ce;Ee=0<=Ce?++Ee:--Ee)n={tag:r.readString(4),checksum:r.readInt(),offset:r.readInt(),length:r.readInt()},this.tables[n.tag]=n}return t.prototype.encode=function(r){var n,Ee,Ce,De,Me,ze,Oe,Be,He,Ve,Xe,We,Ge;for(Ge in Xe=Object.keys(r).length,ze=Math.log(2),He=16*Math.floor(Math.log(Xe)/ze),De=Math.floor(He/ze),Be=16*Xe-He,(Ee=new fe).writeInt(this.scalarType),Ee.writeShort(Xe),Ee.writeShort(He),Ee.writeShort(De),Ee.writeShort(Be),Ce=16*Xe,Oe=Ee.pos+Ce,Me=null,We=[],r)for(Ve=r[Ge],Ee.writeString(Ge),Ee.writeInt(e(Ve)),Ee.writeInt(Oe),Ee.writeInt(Ve.length),We=We.concat(Ve),Ge==="head"&&(Me=Oe),Oe+=Ve.length;Oe%4;)We.push(0),Oe++;return Ee.write(We),n=2981146554-e(Ee.data),Ee.pos=Me+8,Ee.writeUInt32(n),Ee.data},e=function(r){var n,Ee,Ce,De;for(r=_e.call(r);r.length%4;)r.push(0);for(Ce=new fe(r),Ee=0,n=0,De=r.length;n<De;n=n+=4)Ee+=Ce.readUInt32();return 4294967295&Ee},t})(),pe={}.hasOwnProperty,ge=function(e,t){for(var r in t)pe.call(t,r)&&(e[r]=t[r]);function n(){this.constructor=e}return n.prototype=t.prototype,e.prototype=new n,e.__super__=t.prototype,e};he=(function(){function e(t){var r;this.file=t,r=this.file.directory.tables[this.tag],this.exists=!!r,r&&(this.offset=r.offset,this.length=r.length,this.parse(this.file.contents))}return e.prototype.parse=function(){},e.prototype.encode=function(){},e.prototype.raw=function(){return this.exists?(this.file.contents.pos=this.offset,this.file.contents.read(this.length)):null},e})();var me=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ge(e,he),e.prototype.tag="head",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.revision=t.readInt(),this.checkSumAdjustment=t.readInt(),this.magicNumber=t.readInt(),this.flags=t.readShort(),this.unitsPerEm=t.readShort(),this.created=t.readLongLong(),this.modified=t.readLongLong(),this.xMin=t.readShort(),this.yMin=t.readShort(),this.xMax=t.readShort(),this.yMax=t.readShort(),this.macStyle=t.readShort(),this.lowestRecPPEM=t.readShort(),this.fontDirectionHint=t.readShort(),this.indexToLocFormat=t.readShort(),this.glyphDataFormat=t.readShort()},e.prototype.encode=function(t){var r;return(r=new fe).writeInt(this.version),r.writeInt(this.revision),r.writeInt(this.checkSumAdjustment),r.writeInt(this.magicNumber),r.writeShort(this.flags),r.writeShort(this.unitsPerEm),r.writeLongLong(this.created),r.writeLongLong(this.modified),r.writeShort(this.xMin),r.writeShort(this.yMin),r.writeShort(this.xMax),r.writeShort(this.yMax),r.writeShort(this.macStyle),r.writeShort(this.lowestRecPPEM),r.writeShort(this.fontDirectionHint),r.writeShort(t),r.writeShort(this.glyphDataFormat),r.data},e})(),ve=(function(){function e(t,r){var n,Ee,Ce,De,Me,ze,Oe,Be,He,Ve,Xe,We,Ge,$e,Ke,rr,tr;switch(this.platformID=t.readUInt16(),this.encodingID=t.readShort(),this.offset=r+t.readInt(),He=t.pos,t.pos=this.offset,this.format=t.readUInt16(),this.length=t.readUInt16(),this.language=t.readUInt16(),this.isUnicode=this.platformID===3&&this.encodingID===1&&this.format===4||this.platformID===0&&this.format===4,this.codeMap={},this.format){case 0:for(ze=0;ze<256;++ze)this.codeMap[ze]=t.readByte();break;case 4:for(Xe=t.readUInt16(),Ve=Xe/2,t.pos+=6,Ce=(function(){var sr,ar;for(ar=[],ze=sr=0;0<=Ve?sr<Ve:sr>Ve;ze=0<=Ve?++sr:--sr)ar.push(t.readUInt16());return ar})(),t.pos+=2,Ge=(function(){var sr,ar;for(ar=[],ze=sr=0;0<=Ve?sr<Ve:sr>Ve;ze=0<=Ve?++sr:--sr)ar.push(t.readUInt16());return ar})(),Oe=(function(){var sr,ar;for(ar=[],ze=sr=0;0<=Ve?sr<Ve:sr>Ve;ze=0<=Ve?++sr:--sr)ar.push(t.readUInt16());return ar})(),Be=(function(){var sr,ar;for(ar=[],ze=sr=0;0<=Ve?sr<Ve:sr>Ve;ze=0<=Ve?++sr:--sr)ar.push(t.readUInt16());return ar})(),Ee=(this.length-t.pos+this.offset)/2,Me=(function(){var sr,ar;for(ar=[],ze=sr=0;0<=Ee?sr<Ee:sr>Ee;ze=0<=Ee?++sr:--sr)ar.push(t.readUInt16());return ar})(),ze=Ke=0,tr=Ce.length;Ke<tr;ze=++Ke)for($e=Ce[ze],n=rr=We=Ge[ze];We<=$e?rr<=$e:rr>=$e;n=We<=$e?++rr:--rr)Be[ze]===0?De=n+Oe[ze]:(De=Me[Be[ze]/2+(n-We)-(Ve-ze)]||0)!==0&&(De+=Oe[ze]),this.codeMap[n]=65535&De}t.pos=He}return e.encode=function(t,r){var n,Ee,Ce,De,Me,ze,Oe,Be,He,Ve,Xe,We,Ge,$e,Ke,rr,tr,sr,ar,hr,pr,yr,fr,Rr,mr,wr,Fr,Mr,Hr,Nr,Ar,xr,ir,_r,ur,Je,nr,or,lr,St,dr,vr,br,kr,Pr,Er;switch(Mr=new fe,De=Object.keys(t).sort(function(Zr,ua){return Zr-ua}),r){case"macroman":for(Ge=0,$e=(function(){var Zr=[];for(We=0;We<256;++We)Zr.push(0);return Zr})(),rr={0:0},Ce={},Hr=0,ir=De.length;Hr<ir;Hr++)rr[br=t[Ee=De[Hr]]]==null&&(rr[br]=++Ge),Ce[Ee]={old:t[Ee],new:rr[t[Ee]]},$e[Ee]=rr[t[Ee]];return Mr.writeUInt16(1),Mr.writeUInt16(0),Mr.writeUInt32(12),Mr.writeUInt16(0),Mr.writeUInt16(262),Mr.writeUInt16(0),Mr.write($e),{charMap:Ce,subtable:Mr.data,maxGlyphID:Ge+1};case"unicode":for(wr=[],He=[],tr=0,rr={},n={},Ke=Oe=null,Nr=0,_r=De.length;Nr<_r;Nr++)rr[ar=t[Ee=De[Nr]]]==null&&(rr[ar]=++tr),n[Ee]={old:ar,new:rr[ar]},Me=rr[ar]-Ee,Ke!=null&&Me===Oe||(Ke&&He.push(Ke),wr.push(Ee),Oe=Me),Ke=Ee;for(Ke&&He.push(Ke),He.push(65535),wr.push(65535),Rr=2*(fr=wr.length),yr=2*Math.pow(Math.log(fr)/Math.LN2,2),Ve=Math.log(yr/2)/Math.LN2,pr=2*fr-yr,ze=[],hr=[],Xe=[],We=Ar=0,ur=wr.length;Ar<ur;We=++Ar){if(mr=wr[We],Be=He[We],mr===65535){ze.push(0),hr.push(0);break}if(mr-(Fr=n[mr].new)>=32768)for(ze.push(0),hr.push(2*(Xe.length+fr-We)),Ee=xr=mr;mr<=Be?xr<=Be:xr>=Be;Ee=mr<=Be?++xr:--xr)Xe.push(n[Ee].new);else ze.push(Fr-mr),hr.push(0)}for(Mr.writeUInt16(3),Mr.writeUInt16(1),Mr.writeUInt32(12),Mr.writeUInt16(4),Mr.writeUInt16(16+8*fr+2*Xe.length),Mr.writeUInt16(0),Mr.writeUInt16(Rr),Mr.writeUInt16(yr),Mr.writeUInt16(Ve),Mr.writeUInt16(pr),dr=0,Je=He.length;dr<Je;dr++)Ee=He[dr],Mr.writeUInt16(Ee);for(Mr.writeUInt16(0),vr=0,nr=wr.length;vr<nr;vr++)Ee=wr[vr],Mr.writeUInt16(Ee);for(kr=0,or=ze.length;kr<or;kr++)Me=ze[kr],Mr.writeUInt16(Me);for(Pr=0,lr=hr.length;Pr<lr;Pr++)sr=hr[Pr],Mr.writeUInt16(sr);for(Er=0,St=Xe.length;Er<St;Er++)Ge=Xe[Er],Mr.writeUInt16(Ge);return{charMap:n,subtable:Mr.data,maxGlyphID:tr+1}}},e})(),be=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ge(e,he),e.prototype.tag="cmap",e.prototype.parse=function(t){var r,n,Ee;for(t.pos=this.offset,this.version=t.readUInt16(),Ee=t.readUInt16(),this.tables=[],this.unicode=null,n=0;0<=Ee?n<Ee:n>Ee;n=0<=Ee?++n:--n)r=new ve(t,this.offset),this.tables.push(r),r.isUnicode&&this.unicode==null&&(this.unicode=r);return!0},e.encode=function(t,r){var n,Ee;return r==null&&(r="macroman"),n=ve.encode(t,r),(Ee=new fe).writeUInt16(0),Ee.writeUInt16(1),n.table=Ee.data.concat(n.subtable),n},e})(),ye=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ge(e,he),e.prototype.tag="hhea",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.ascender=t.readShort(),this.decender=t.readShort(),this.lineGap=t.readShort(),this.advanceWidthMax=t.readShort(),this.minLeftSideBearing=t.readShort(),this.minRightSideBearing=t.readShort(),this.xMaxExtent=t.readShort(),this.caretSlopeRise=t.readShort(),this.caretSlopeRun=t.readShort(),this.caretOffset=t.readShort(),t.pos+=8,this.metricDataFormat=t.readShort(),this.numberOfMetrics=t.readUInt16()},e})(),we=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ge(e,he),e.prototype.tag="OS/2",e.prototype.parse=function(t){if(t.pos=this.offset,this.version=t.readUInt16(),this.averageCharWidth=t.readShort(),this.weightClass=t.readUInt16(),this.widthClass=t.readUInt16(),this.type=t.readShort(),this.ySubscriptXSize=t.readShort(),this.ySubscriptYSize=t.readShort(),this.ySubscriptXOffset=t.readShort(),this.ySubscriptYOffset=t.readShort(),this.ySuperscriptXSize=t.readShort(),this.ySuperscriptYSize=t.readShort(),this.ySuperscriptXOffset=t.readShort(),this.ySuperscriptYOffset=t.readShort(),this.yStrikeoutSize=t.readShort(),this.yStrikeoutPosition=t.readShort(),this.familyClass=t.readShort(),this.panose=(function(){var r,n;for(n=[],r=0;r<10;++r)n.push(t.readByte());return n})(),this.charRange=(function(){var r,n;for(n=[],r=0;r<4;++r)n.push(t.readInt());return n})(),this.vendorID=t.readString(4),this.selection=t.readShort(),this.firstCharIndex=t.readShort(),this.lastCharIndex=t.readShort(),this.version>0&&(this.ascent=t.readShort(),this.descent=t.readShort(),this.lineGap=t.readShort(),this.winAscent=t.readShort(),this.winDescent=t.readShort(),this.codePageRange=(function(){var r,n;for(n=[],r=0;r<2;r=++r)n.push(t.readInt());return n})(),this.version>1))return this.xHeight=t.readShort(),this.capHeight=t.readShort(),this.defaultChar=t.readShort(),this.breakChar=t.readShort(),this.maxContext=t.readShort()},e})(),Ne=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ge(e,he),e.prototype.tag="post",e.prototype.parse=function(t){var r,n,Ee;switch(t.pos=this.offset,this.format=t.readInt(),this.italicAngle=t.readInt(),this.underlinePosition=t.readShort(),this.underlineThickness=t.readShort(),this.isFixedPitch=t.readInt(),this.minMemType42=t.readInt(),this.maxMemType42=t.readInt(),this.minMemType1=t.readInt(),this.maxMemType1=t.readInt(),this.format){case 65536:case 196608:break;case 131072:var Ce;for(n=t.readUInt16(),this.glyphNameIndex=[],Ce=0;0<=n?Ce<n:Ce>n;Ce=0<=n?++Ce:--Ce)this.glyphNameIndex.push(t.readUInt16());for(this.names=[],Ee=[];t.pos<this.offset+this.length;)r=t.readByte(),Ee.push(this.names.push(t.readString(r)));return Ee;case 151552:return n=t.readUInt16(),this.offsets=t.read(n);case 262144:return this.map=function(){var De,Me,ze;for(ze=[],Ce=De=0,Me=this.file.maxp.numGlyphs;0<=Me?De<Me:De>Me;Ce=0<=Me?++De:--De)ze.push(t.readUInt32());return ze}.call(this)}},e})(),Le=function(e,t){this.raw=e,this.length=e.length,this.platformID=t.platformID,this.encodingID=t.encodingID,this.languageID=t.languageID},xe=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ge(e,he),e.prototype.tag="name",e.prototype.parse=function(t){var r,n,Ee,Ce,De,Me,ze,Oe,Be,He,Ve;for(t.pos=this.offset,t.readShort(),r=t.readShort(),Me=t.readShort(),n=[],Ce=0;0<=r?Ce<r:Ce>r;Ce=0<=r?++Ce:--Ce)n.push({platformID:t.readShort(),encodingID:t.readShort(),languageID:t.readShort(),nameID:t.readShort(),length:t.readShort(),offset:this.offset+Me+t.readShort()});for(ze={},Ce=Be=0,He=n.length;Be<He;Ce=++Be)Ee=n[Ce],t.pos=Ee.offset,Oe=t.readString(Ee.length),De=new Le(Oe,Ee),ze[Ve=Ee.nameID]==null&&(ze[Ve]=[]),ze[Ee.nameID].push(De);this.strings=ze,this.copyright=ze[0],this.fontFamily=ze[1],this.fontSubfamily=ze[2],this.uniqueSubfamily=ze[3],this.fontName=ze[4],this.version=ze[5];try{this.postscriptName=ze[6][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}catch{this.postscriptName=ze[4][0].raw.replace(/[\x00-\x19\x80-\xff]/g,"")}return this.trademark=ze[7],this.manufacturer=ze[8],this.designer=ze[9],this.description=ze[10],this.vendorUrl=ze[11],this.designerUrl=ze[12],this.license=ze[13],this.licenseUrl=ze[14],this.preferredFamily=ze[15],this.preferredSubfamily=ze[17],this.compatibleFull=ze[18],this.sampleText=ze[19]},e})(),Ae=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ge(e,he),e.prototype.tag="maxp",e.prototype.parse=function(t){return t.pos=this.offset,this.version=t.readInt(),this.numGlyphs=t.readUInt16(),this.maxPoints=t.readUInt16(),this.maxContours=t.readUInt16(),this.maxCompositePoints=t.readUInt16(),this.maxComponentContours=t.readUInt16(),this.maxZones=t.readUInt16(),this.maxTwilightPoints=t.readUInt16(),this.maxStorage=t.readUInt16(),this.maxFunctionDefs=t.readUInt16(),this.maxInstructionDefs=t.readUInt16(),this.maxStackElements=t.readUInt16(),this.maxSizeOfInstructions=t.readUInt16(),this.maxComponentElements=t.readUInt16(),this.maxComponentDepth=t.readUInt16()},e})(),Se=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ge(e,he),e.prototype.tag="hmtx",e.prototype.parse=function(t){var r,n,Ee,Ce,De,Me,ze;for(t.pos=this.offset,this.metrics=[],r=0,Me=this.file.hhea.numberOfMetrics;0<=Me?r<Me:r>Me;r=0<=Me?++r:--r)this.metrics.push({advance:t.readUInt16(),lsb:t.readInt16()});for(Ee=this.file.maxp.numGlyphs-this.file.hhea.numberOfMetrics,this.leftSideBearings=(function(){var Oe,Be;for(Be=[],r=Oe=0;0<=Ee?Oe<Ee:Oe>Ee;r=0<=Ee?++Oe:--Oe)Be.push(t.readInt16());return Be})(),this.widths=function(){var Oe,Be,He,Ve;for(Ve=[],Oe=0,Be=(He=this.metrics).length;Oe<Be;Oe++)Ce=He[Oe],Ve.push(Ce.advance);return Ve}.call(this),n=this.widths[this.widths.length-1],ze=[],r=De=0;0<=Ee?De<Ee:De>Ee;r=0<=Ee?++De:--De)ze.push(this.widths.push(n));return ze},e.prototype.forGlyph=function(t){return t in this.metrics?this.metrics[t]:{advance:this.metrics[this.metrics.length-1].advance,lsb:this.leftSideBearings[t-this.metrics.length]}},e})(),_e=[].slice,Pe=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ge(e,he),e.prototype.tag="glyf",e.prototype.parse=function(){return this.cache={}},e.prototype.glyphFor=function(t){var r,n,Ee,Ce,De,Me,ze,Oe,Be,He;return t in this.cache?this.cache[t]:(Ce=this.file.loca,r=this.file.contents,n=Ce.indexOf(t),(Ee=Ce.lengthOf(t))===0?this.cache[t]=null:(r.pos=this.offset+n,De=(Me=new fe(r.read(Ee))).readShort(),Oe=Me.readShort(),He=Me.readShort(),ze=Me.readShort(),Be=Me.readShort(),this.cache[t]=De===-1?new Fe(Me,Oe,He,ze,Be):new ke(Me,De,Oe,He,ze,Be),this.cache[t]))},e.prototype.encode=function(t,r,n){var Ee,Ce,De,Me,ze;for(De=[],Ce=[],Me=0,ze=r.length;Me<ze;Me++)Ee=t[r[Me]],Ce.push(De.length),Ee&&(De=De.concat(Ee.encode(n)));return Ce.push(De.length),{table:De,offsets:Ce}},e})(),ke=(function(){function e(t,r,n,Ee,Ce,De){this.raw=t,this.numberOfContours=r,this.xMin=n,this.yMin=Ee,this.xMax=Ce,this.yMax=De,this.compound=!1}return e.prototype.encode=function(){return this.raw.data},e})(),Fe=(function(){function e(t,r,n,Ee,Ce){var De,Me;for(this.raw=t,this.xMin=r,this.yMin=n,this.xMax=Ee,this.yMax=Ce,this.compound=!0,this.glyphIDs=[],this.glyphOffsets=[],De=this.raw;Me=De.readShort(),this.glyphOffsets.push(De.pos),this.glyphIDs.push(De.readUInt16()),32&Me;)De.pos+=1&Me?4:2,128&Me?De.pos+=8:64&Me?De.pos+=4:8&Me&&(De.pos+=2)}return e.prototype.encode=function(){var t,r,n;for(r=new fe(_e.call(this.raw.data)),t=0,n=this.glyphIDs.length;t<n;++t)r.pos=this.glyphOffsets[t];return r.data},e})(),Ie=(function(){function e(){return e.__super__.constructor.apply(this,arguments)}return ge(e,he),e.prototype.tag="loca",e.prototype.parse=function(t){var r,n;return t.pos=this.offset,r=this.file.head.indexToLocFormat,this.offsets=r===0?function(){var Ee,Ce;for(Ce=[],n=0,Ee=this.length;n<Ee;n+=2)Ce.push(2*t.readUInt16());return Ce}.call(this):function(){var Ee,Ce;for(Ce=[],n=0,Ee=this.length;n<Ee;n+=4)Ce.push(t.readUInt32());return Ce}.call(this)},e.prototype.indexOf=function(t){return this.offsets[t]},e.prototype.lengthOf=function(t){return this.offsets[t+1]-this.offsets[t]},e.prototype.encode=function(t,r){for(var n=new Uint32Array(this.offsets.length),Ee=0,Ce=0,De=0;De<n.length;++De)if(n[De]=Ee,Ce<r.length&&r[Ce]==De){++Ce,n[De]=Ee;var Me=this.offsets[De],ze=this.offsets[De+1]-Me;ze>0&&(Ee+=ze)}for(var Oe=new Array(4*n.length),Be=0;Be<n.length;++Be)Oe[4*Be+3]=255&n[Be],Oe[4*Be+2]=(65280&n[Be])>>8,Oe[4*Be+1]=(16711680&n[Be])>>16,Oe[4*Be]=(4278190080&n[Be])>>24;return Oe},e})(),je=(function(){function e(t){this.font=t,this.subset={},this.unicodes={},this.next=33}return e.prototype.generateCmap=function(){var t,r,n,Ee,Ce;for(r in Ee=this.font.cmap.tables[0].codeMap,t={},Ce=this.subset)n=Ce[r],t[r]=Ee[n];return t},e.prototype.glyphsFor=function(t){var r,n,Ee,Ce,De,Me,ze;for(Ee={},De=0,Me=t.length;De<Me;De++)Ee[Ce=t[De]]=this.font.glyf.glyphFor(Ce);for(Ce in r=[],Ee)(n=Ee[Ce])!=null&&n.compound&&r.push.apply(r,n.glyphIDs);if(r.length>0)for(Ce in ze=this.glyphsFor(r))n=ze[Ce],Ee[Ce]=n;return Ee},e.prototype.encode=function(t,r){var n,Ee,Ce,De,Me,ze,Oe,Be,He,Ve,Xe,We,Ge,$e,Ke;for(Ee in n=be.encode(this.generateCmap(),"unicode"),De=this.glyphsFor(t),Xe={0:0},Ke=n.charMap)Xe[(ze=Ke[Ee]).old]=ze.new;for(We in Ve=n.maxGlyphID,De)We in Xe||(Xe[We]=Ve++);return Be=(function(rr){var tr,sr;for(tr in sr={},rr)sr[rr[tr]]=tr;return sr})(Xe),He=Object.keys(Be).sort(function(rr,tr){return rr-tr}),Ge=(function(){var rr,tr,sr;for(sr=[],rr=0,tr=He.length;rr<tr;rr++)Me=He[rr],sr.push(Be[Me]);return sr})(),Ce=this.font.glyf.encode(De,Ge,Xe),Oe=this.font.loca.encode(Ce.offsets,Ge),$e={cmap:this.font.cmap.raw(),glyf:Ce.table,loca:Oe,hmtx:this.font.hmtx.raw(),hhea:this.font.hhea.raw(),maxp:this.font.maxp.raw(),post:this.font.post.raw(),name:this.font.name.raw(),head:this.font.head.encode(r)},this.font.os2.exists&&($e["OS/2"]=this.font.os2.raw()),this.font.directory.encode($e)},e})();E.API.PDFObject=(function(){var e;function t(){}return e=function(r,n){return(Array(n+1).join("0")+r).slice(-n)},t.convert=function(r){var n,Ee,Ce,De;if(Array.isArray(r))return"["+(function(){var Me,ze,Oe;for(Oe=[],Me=0,ze=r.length;Me<ze;Me++)n=r[Me],Oe.push(t.convert(n));return Oe})().join(" ")+"]";if(typeof r=="string")return"/"+r;if(r?.isString)return"("+r+")";if(r instanceof Date)return"(D:"+e(r.getUTCFullYear(),4)+e(r.getUTCMonth(),2)+e(r.getUTCDate(),2)+e(r.getUTCHours(),2)+e(r.getUTCMinutes(),2)+e(r.getUTCSeconds(),2)+"Z)";if({}.toString.call(r)==="[object Object]"){for(Ee in Ce=["<<"],r)De=r[Ee],Ce.push("/"+Ee+" "+t.convert(De));return Ce.push(">>"),Ce.join(`
`)}return""+r},t})();function autoTableText(e,t,r,n,Ee){n=n||{};var Ce=1.15,De=Ee.internal.scaleFactor,Me=Ee.internal.getFontSize()/De,ze=Ee.getLineHeightFactor?Ee.getLineHeightFactor():Ce,Oe=Me*ze,Be=/\r\n|\r|\n/g,He="",Ve=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(He=typeof e=="string"?e.split(Be):e,Ve=He.length||1),r+=Me*(2-Ce),n.valign==="middle"?r-=Ve/2*Oe:n.valign==="bottom"&&(r-=Ve*Oe),n.halign==="center"||n.halign==="right"){var Xe=Me;if(n.halign==="center"&&(Xe*=.5),He&&Ve>=1){for(var We=0;We<He.length;We++)Ee.text(He[We],t-Ee.getStringUnitWidth(He[We])*Xe,r),r+=Oe;return Ee}t-=Ee.getStringUnitWidth(e)*Xe}return n.halign==="justify"?Ee.text(e,t,r,{maxWidth:n.maxWidth||100,align:"justify"}):Ee.text(e,t,r),Ee}var globalDefaults={},DocHandler=(function(){function e(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(t,r){r===void 0&&(r=null),r?r.__autoTableDocumentDefaults=t:globalDefaults=t},e.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},e.prototype.applyStyles=function(t,r){var n,Ee,Ce;r===void 0&&(r=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var De=this.jsPDFDocument.internal.getFont(),Me=De.fontStyle,ze=De.fontName;if(t.font&&(ze=t.font),t.fontStyle){Me=t.fontStyle;var Oe=this.getFontList()[ze];Oe&&Oe.indexOf(Me)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(Oe[0]),Me=Oe[0])}if(this.jsPDFDocument.setFont(ze,Me),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!r){var Be=e.unifyColor(t.fillColor);Be&&(n=this.jsPDFDocument).setFillColor.apply(n,Be),Be=e.unifyColor(t.textColor),Be&&(Ee=this.jsPDFDocument).setTextColor.apply(Ee,Be),Be=e.unifyColor(t.lineColor),Be&&(Ce=this.jsPDFDocument).setDrawColor.apply(Ce,Be),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(t,r,n){return this.jsPDFDocument.splitTextToSize(t,r,n)},e.prototype.rect=function(t,r,n,Ee,Ce){return this.jsPDFDocument.rect(t,r,n,Ee,Ce)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return globalDefaults||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e})(),extendStatics=function(e,t){return extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var Ee in n)Object.prototype.hasOwnProperty.call(n,Ee)&&(r[Ee]=n[Ee])},extendStatics(e,t)};function __extends(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");extendStatics(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}typeof SuppressedError=="function"&&SuppressedError;var HtmlRowInput=(function(e){__extends(t,e);function t(r){var n=e.call(this)||this;return n._element=r,n}return t})(Array);function defaultStyles(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function getTheme(e){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[e]}function getStringWidth(e,t,r){r.applyStyles(t,!0);var n=Array.isArray(e)?e:[e],Ee=n.map(function(Ce){return r.getTextWidth(Ce)}).reduce(function(Ce,De){return Math.max(Ce,De)},0);return Ee}function addTableBorder(e,t,r,n){var Ee=t.settings.tableLineWidth,Ce=t.settings.tableLineColor;e.applyStyles({lineWidth:Ee,lineColor:Ce});var De=getFillStyle(Ee,!1);De&&e.rect(r.x,r.y,t.getWidth(e.pageSize().width),n.y-r.y,De)}function getFillStyle(e,t){var r=e>0,n=t||t===0;return r&&n?"DF":r?"S":n?"F":null}function parseSpacing(e,t){var r,n,Ee,Ce;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=t}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(r=e.left)!==null&&r!==void 0?r:t,top:(n=e.top)!==null&&n!==void 0?n:t,right:(Ee=e.right)!==null&&Ee!==void 0?Ee:t,bottom:(Ce=e.bottom)!==null&&Ce!==void 0?Ce:t}):(typeof e!="number"&&(e=t),{top:e,right:e,bottom:e,left:e})}function getPageAvailableWidth(e,t){var r=parseSpacing(t.settings.margin,0);return e.pageSize().width-(r.left+r.right)}function parseCss(e,t,r,n,Ee){var Ce={},De=1.3333333333333333,Me=parseColor(t,function(tr){return Ee.getComputedStyle(tr).backgroundColor});Me!=null&&(Ce.fillColor=Me);var ze=parseColor(t,function(tr){return Ee.getComputedStyle(tr).color});ze!=null&&(Ce.textColor=ze);var Oe=parsePadding(n,r);Oe&&(Ce.cellPadding=Oe);var Be="borderTopColor",He=De*r,Ve=n.borderTopWidth;if(n.borderBottomWidth===Ve&&n.borderRightWidth===Ve&&n.borderLeftWidth===Ve){var Xe=(parseFloat(Ve)||0)/He;Xe&&(Ce.lineWidth=Xe)}else Ce.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/He,right:(parseFloat(n.borderRightWidth)||0)/He,bottom:(parseFloat(n.borderBottomWidth)||0)/He,left:(parseFloat(n.borderLeftWidth)||0)/He},Ce.lineWidth.top||(Ce.lineWidth.right?Be="borderRightColor":Ce.lineWidth.bottom?Be="borderBottomColor":Ce.lineWidth.left&&(Be="borderLeftColor"));var We=parseColor(t,function(tr){return Ee.getComputedStyle(tr)[Be]});We!=null&&(Ce.lineColor=We);var Ge=["left","right","center","justify"];Ge.indexOf(n.textAlign)!==-1&&(Ce.halign=n.textAlign),Ge=["middle","bottom","top"],Ge.indexOf(n.verticalAlign)!==-1&&(Ce.valign=n.verticalAlign);var $e=parseInt(n.fontSize||"");isNaN($e)||(Ce.fontSize=$e/De);var Ke=parseFontStyle(n);Ke&&(Ce.fontStyle=Ke);var rr=(n.fontFamily||"").toLowerCase();return e.indexOf(rr)!==-1&&(Ce.font=rr),Ce}function parseFontStyle(e){var t="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(t="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(t+="italic"),t}function parseColor(e,t){var r=realColor(e,t);if(!r)return null;var n=r.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var Ee=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],Ce=parseInt(n[4]);return Ce===0||isNaN(Ee[0])||isNaN(Ee[1])||isNaN(Ee[2])?null:Ee}function realColor(e,t){var r=t(e);return r==="rgba(0, 0, 0, 0)"||r==="transparent"||r==="initial"||r==="inherit"?e.parentElement==null?null:realColor(e.parentElement,t):r}function parsePadding(e,t){var r=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],n=96/(72/t),Ee=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,Ce=r.map(function(Me){return parseInt(Me||"0")/n}),De=parseSpacing(Ce,0);return Ee>De.top&&(De.top=Ee),Ee>De.bottom&&(De.bottom=Ee),De}function parseHtml(e,t,r,n,Ee){var Ce,De;n===void 0&&(n=!1),Ee===void 0&&(Ee=!1);var Me;typeof t=="string"?Me=r.document.querySelector(t):Me=t;var ze=Object.keys(e.getFontList()),Oe=e.scaleFactor(),Be=[],He=[],Ve=[];if(!Me)return console.error("Html table could not be found with input: ",t),{head:Be,body:He,foot:Ve};for(var Xe=0;Xe<Me.rows.length;Xe++){var We=Me.rows[Xe],Ge=(De=(Ce=We?.parentElement)===null||Ce===void 0?void 0:Ce.tagName)===null||De===void 0?void 0:De.toLowerCase(),$e=parseRowContent(ze,Oe,r,We,n,Ee);$e&&(Ge==="thead"?Be.push($e):Ge==="tfoot"?Ve.push($e):He.push($e))}return{head:Be,body:He,foot:Ve}}function parseRowContent(e,t,r,n,Ee,Ce){for(var De=new HtmlRowInput(n),Me=0;Me<n.cells.length;Me++){var ze=n.cells[Me],Oe=r.getComputedStyle(ze);if(Ee||Oe.display!=="none"){var Be=void 0;Ce&&(Be=parseCss(e,ze,t,Oe,r)),De.push({rowSpan:ze.rowSpan,colSpan:ze.colSpan,styles:Be,_element:ze,content:parseCellContent(ze)})}}var He=r.getComputedStyle(n);if(De.length>0&&(Ee||He.display!=="none"))return De}function parseCellContent(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(r){return r.trim()}).join(`
`),t.innerText||t.textContent||""}function validateInput(e,t,r){for(var n=0,Ee=[e,t,r];n<Ee.length;n++){var Ce=Ee[n];Ce&&typeof Ce!="object"&&console.error("The options parameter should be of type object, is: "+typeof Ce),Ce.startY&&typeof Ce.startY!="number"&&(console.error("Invalid value for startY option",Ce.startY),delete Ce.startY)}}function assign(e,t,r,n,Ee){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var Ce=Object(e),De=1;De<arguments.length;De++){var Me=arguments[De];if(Me!=null)for(var ze in Me)Object.prototype.hasOwnProperty.call(Me,ze)&&(Ce[ze]=Me[ze])}return Ce}function parseInput(e,t){var r=new DocHandler(e),n=r.getDocumentOptions(),Ee=r.getGlobalOptions();validateInput(Ee,n,t);var Ce=assign({},Ee,n,t),De;typeof window<"u"&&(De=window);var Me=parseStyles(Ee,n,t),ze=parseHooks(Ee,n,t),Oe=parseSettings(r,Ce),Be=parseContent$1(r,Ce,De);return{id:t.tableId,content:Be,hooks:ze,styles:Me,settings:Oe}}function parseStyles(e,t,r){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},Ee=function(ze){if(ze==="columnStyles"){var Oe=e[ze],Be=t[ze],He=r[ze];n.columnStyles=assign({},Oe,Be,He)}else{var Ve=[e,t,r],Xe=Ve.map(function(We){return We[ze]||{}});n[ze]=assign({},Xe[0],Xe[1],Xe[2])}},Ce=0,De=Object.keys(n);Ce<De.length;Ce++){var Me=De[Ce];Ee(Me)}return n}function parseHooks(e,t,r){for(var n=[e,t,r],Ee={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},Ce=0,De=n;Ce<De.length;Ce++){var Me=De[Ce];Me.didParseCell&&Ee.didParseCell.push(Me.didParseCell),Me.willDrawCell&&Ee.willDrawCell.push(Me.willDrawCell),Me.didDrawCell&&Ee.didDrawCell.push(Me.didDrawCell),Me.willDrawPage&&Ee.willDrawPage.push(Me.willDrawPage),Me.didDrawPage&&Ee.didDrawPage.push(Me.didDrawPage)}return Ee}function parseSettings(e,t){var r,n,Ee,Ce,De,Me,ze,Oe,Be,He,Ve,Xe,We=parseSpacing(t.margin,40/e.scaleFactor()),Ge=(r=getStartY(e,t.startY))!==null&&r!==void 0?r:We.top,$e;t.showFoot===!0?$e="everyPage":t.showFoot===!1?$e="never":$e=(n=t.showFoot)!==null&&n!==void 0?n:"everyPage";var Ke;t.showHead===!0?Ke="everyPage":t.showHead===!1?Ke="never":Ke=(Ee=t.showHead)!==null&&Ee!==void 0?Ee:"everyPage";var rr=(Ce=t.useCss)!==null&&Ce!==void 0?Ce:!1,tr=t.theme||(rr?"plain":"striped"),sr=!!t.horizontalPageBreak,ar=(De=t.horizontalPageBreakRepeat)!==null&&De!==void 0?De:null;return{includeHiddenHtml:(Me=t.includeHiddenHtml)!==null&&Me!==void 0?Me:!1,useCss:rr,theme:tr,startY:Ge,margin:We,pageBreak:(ze=t.pageBreak)!==null&&ze!==void 0?ze:"auto",rowPageBreak:(Oe=t.rowPageBreak)!==null&&Oe!==void 0?Oe:"auto",tableWidth:(Be=t.tableWidth)!==null&&Be!==void 0?Be:"auto",showHead:Ke,showFoot:$e,tableLineWidth:(He=t.tableLineWidth)!==null&&He!==void 0?He:0,tableLineColor:(Ve=t.tableLineColor)!==null&&Ve!==void 0?Ve:200,horizontalPageBreak:sr,horizontalPageBreakRepeat:ar,horizontalPageBreakBehaviour:(Xe=t.horizontalPageBreakBehaviour)!==null&&Xe!==void 0?Xe:"afterAllRows"}}function getStartY(e,t){var r=e.getLastAutoTable(),n=e.scaleFactor(),Ee=e.pageNumber(),Ce=!1;if(r&&r.startPageNumber){var De=r.startPageNumber+r.pageNumber-1;Ce=De===Ee}return typeof t=="number"?t:(t==null||t===!1)&&Ce&&r?.finalY!=null?r.finalY+20/n:null}function parseContent$1(e,t,r){var n=t.head||[],Ee=t.body||[],Ce=t.foot||[];if(t.html){var De=t.includeHiddenHtml;if(r){var Me=parseHtml(e,t.html,r,De,t.useCss)||{};n=Me.head||n,Ee=Me.body||n,Ce=Me.foot||n}else console.error("Cannot parse html in non browser environment")}var ze=t.columns||parseColumns(n,Ee,Ce);return{columns:ze,head:n,body:Ee,foot:Ce}}function parseColumns(e,t,r){var n=e[0]||t[0]||r[0]||[],Ee=[];return Object.keys(n).filter(function(Ce){return Ce!=="_element"}).forEach(function(Ce){var De=1,Me;Array.isArray(n)?Me=n[parseInt(Ce)]:Me=n[Ce],typeof Me=="object"&&!Array.isArray(Me)&&(De=Me?.colSpan||1);for(var ze=0;ze<De;ze++){var Oe=void 0;Array.isArray(n)?Oe=Ee.length:Oe=Ce+(ze>0?"_".concat(ze):"");var Be={dataKey:Oe};Ee.push(Be)}}),Ee}var HookData=(function(){function e(t,r,n){this.table=r,this.pageNumber=r.pageNumber,this.settings=r.settings,this.cursor=n,this.doc=t.getDocument()}return e})(),CellHookData=(function(e){__extends(t,e);function t(r,n,Ee,Ce,De,Me){var ze=e.call(this,r,n,Me)||this;return ze.cell=Ee,ze.row=Ce,ze.column=De,ze.section=Ce.section,ze}return t})(HookData),Table=(function(){function e(t,r){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=r.columns,this.head=r.head,this.body=r.body,this.foot=r.foot}return e.prototype.getHeadHeight=function(t){return this.head.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.getFootHeight=function(t){return this.foot.reduce(function(r,n){return r+n.getMaxCellHeight(t)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(t,r,n,Ee,Ce,De){for(var Me=0,ze=r;Me<ze.length;Me++){var Oe=ze[Me],Be=new CellHookData(t,this,n,Ee,Ce,De),He=Oe(Be)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],He)return!1}return!0},e.prototype.callEndPageHooks=function(t,r){t.applyStyles(t.userStyles);for(var n=0,Ee=this.hooks.didDrawPage;n<Ee.length;n++){var Ce=Ee[n];Ce(new HookData(t,this,r))}},e.prototype.callWillDrawPageHooks=function(t,r){for(var n=0,Ee=this.hooks.willDrawPage;n<Ee.length;n++){var Ce=Ee[n];Ce(new HookData(t,this,r))}},e.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var r=this.columns.reduce(function(Ee,Ce){return Ee+Ce.wrappedWidth},0);return r}else{var n=this.settings.margin;return t-n.left-n.right}},e})(),Row=(function(){function e(t,r,n,Ee,Ce){Ce===void 0&&(Ce=!1),this.height=0,this.raw=t,t instanceof HtmlRowInput&&(this.raw=t._element,this.element=t._element),this.index=r,this.section=n,this.cells=Ee,this.spansMultiplePages=Ce}return e.prototype.getMaxCellHeight=function(t){var r=this;return t.reduce(function(n,Ee){var Ce;return Math.max(n,((Ce=r.cells[Ee.index])===null||Ce===void 0?void 0:Ce.height)||0)},0)},e.prototype.hasRowSpan=function(t){var r=this;return t.filter(function(n){var Ee=r.cells[n.index];return Ee?Ee.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(t,r){return this.getMaxCellHeight(r)<=t},e.prototype.getMinimumRowHeight=function(t,r){var n=this;return t.reduce(function(Ee,Ce){var De=n.cells[Ce.index];if(!De)return 0;var Me=r.getLineHeight(De.styles.fontSize),ze=De.padding("vertical"),Oe=ze+Me;return Oe>Ee?Oe:Ee},0)},e})(),Cell=(function(){function e(t,r,n){var Ee;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=r,this.section=n,this.raw=t;var Ce=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,Ce=(Ee=t.content)!==null&&Ee!==void 0?Ee:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var De=Ce!=null?""+Ce:"",Me=/\r\n|\r|\n/g;this.text=De.split(Me)}return e.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var r=this.height-this.padding("vertical");t=this.y+r/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var Ee=this.width-this.padding("horizontal");n=this.x+Ee/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:t}},e.prototype.getContentHeight=function(t,r){r===void 0&&(r=1.15);var n=Array.isArray(this.text)?this.text.length:1,Ee=this.styles.fontSize/t*r,Ce=n*Ee+this.padding("vertical");return Math.max(Ce,this.styles.minCellHeight)},e.prototype.padding=function(t){var r=parseSpacing(this.styles.cellPadding,0);return t==="vertical"?r.top+r.bottom:t==="horizontal"?r.left+r.right:r[t]},e})(),Column=(function(){function e(t,r,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=r,this.index=n}return e.prototype.getMaxCustomCellWidth=function(t){for(var r=0,n=0,Ee=t.allRows();n<Ee.length;n++){var Ce=Ee[n],De=Ce.cells[this.index];De&&typeof De.styles.cellWidth=="number"&&(r=Math.max(r,De.styles.cellWidth))}return r},e})();function calculateWidths(e,t){calculate(e,t);var r=[],n=0;t.columns.forEach(function(Ce){var De=Ce.getMaxCustomCellWidth(t);De?Ce.width=De:(Ce.width=Ce.wrappedWidth,r.push(Ce)),n+=Ce.width});var Ee=t.getWidth(e.pageSize().width)-n;Ee&&(Ee=resizeColumns(r,Ee,function(Ce){return Math.max(Ce.minReadableWidth,Ce.minWidth)})),Ee&&(Ee=resizeColumns(r,Ee,function(Ce){return Ce.minWidth})),Ee=Math.abs(Ee),!t.settings.horizontalPageBreak&&Ee>.1/e.scaleFactor()&&(Ee=Ee<1?Ee:Math.round(Ee),console.log("Of the table content, ".concat(Ee," units width could not fit page"))),applyColSpans(t),fitContent(t,e),applyRowSpans(t)}function calculate(e,t){var r=e.scaleFactor(),n=t.settings.horizontalPageBreak,Ee=getPageAvailableWidth(e,t);t.allRows().forEach(function(Ce){for(var De=0,Me=t.columns;De<Me.length;De++){var ze=Me[De],Oe=Ce.cells[ze.index];if(Oe){var Be=t.hooks.didParseCell;t.callCellHooks(e,Be,Oe,Ce,ze,null);var He=Oe.padding("horizontal");Oe.contentWidth=getStringWidth(Oe.text,Oe.styles,e)+He;var Ve=getStringWidth(Oe.text.join(" ").split(/[^\S\u00A0]+/),Oe.styles,e);if(Oe.minReadableWidth=Ve+Oe.padding("horizontal"),typeof Oe.styles.cellWidth=="number")Oe.minWidth=Oe.styles.cellWidth,Oe.wrappedWidth=Oe.styles.cellWidth;else if(Oe.styles.cellWidth==="wrap"||n===!0)Oe.contentWidth>Ee?(Oe.minWidth=Ee,Oe.wrappedWidth=Ee):(Oe.minWidth=Oe.contentWidth,Oe.wrappedWidth=Oe.contentWidth);else{var Xe=10/r;Oe.minWidth=Oe.styles.minCellWidth||Xe,Oe.wrappedWidth=Oe.contentWidth,Oe.minWidth>Oe.wrappedWidth&&(Oe.wrappedWidth=Oe.minWidth)}}}}),t.allRows().forEach(function(Ce){for(var De=0,Me=t.columns;De<Me.length;De++){var ze=Me[De],Oe=Ce.cells[ze.index];if(Oe&&Oe.colSpan===1)ze.wrappedWidth=Math.max(ze.wrappedWidth,Oe.wrappedWidth),ze.minWidth=Math.max(ze.minWidth,Oe.minWidth),ze.minReadableWidth=Math.max(ze.minReadableWidth,Oe.minReadableWidth);else{var Be=t.styles.columnStyles[ze.dataKey]||t.styles.columnStyles[ze.index]||{},He=Be.cellWidth||Be.minCellWidth;He&&typeof He=="number"&&(ze.minWidth=He,ze.wrappedWidth=He)}Oe&&(Oe.colSpan>1&&!ze.minWidth&&(ze.minWidth=Oe.minWidth),Oe.colSpan>1&&!ze.wrappedWidth&&(ze.wrappedWidth=Oe.minWidth))}})}function resizeColumns(e,t,r){for(var n=t,Ee=e.reduce(function(Xe,We){return Xe+We.wrappedWidth},0),Ce=0;Ce<e.length;Ce++){var De=e[Ce],Me=De.wrappedWidth/Ee,ze=n*Me,Oe=De.width+ze,Be=r(De),He=Oe<Be?Be:Oe;t-=He-De.width,De.width=He}if(t=Math.round(t*1e10)/1e10,t){var Ve=e.filter(function(Xe){return t<0?Xe.width>r(Xe):!0});Ve.length&&(t=resizeColumns(Ve,t,r))}return t}function applyRowSpans(e){for(var t={},r=1,n=e.allRows(),Ee=0;Ee<n.length;Ee++)for(var Ce=n[Ee],De=0,Me=e.columns;De<Me.length;De++){var ze=Me[De],Oe=t[ze.index];if(r>1)r--,delete Ce.cells[ze.index];else if(Oe)Oe.cell.height+=Ce.height,r=Oe.cell.colSpan,delete Ce.cells[ze.index],Oe.left--,Oe.left<=1&&delete t[ze.index];else{var Be=Ce.cells[ze.index];if(!Be)continue;if(Be.height=Ce.height,Be.rowSpan>1){var He=n.length-Ee,Ve=Be.rowSpan>He?He:Be.rowSpan;t[ze.index]={cell:Be,left:Ve,row:Ce}}}}}function applyColSpans(e){for(var t=e.allRows(),r=0;r<t.length;r++)for(var n=t[r],Ee=null,Ce=0,De=0,Me=0;Me<e.columns.length;Me++){var ze=e.columns[Me];if(De-=1,De>1&&e.columns[Me+1])Ce+=ze.width,delete n.cells[ze.index];else if(Ee){var Oe=Ee;delete n.cells[ze.index],Ee=null,Oe.width=ze.width+Ce}else{var Oe=n.cells[ze.index];if(!Oe)continue;if(De=Oe.colSpan,Ce=0,Oe.colSpan>1){Ee=Oe,Ce+=ze.width;continue}Oe.width=ze.width+Ce}}}function fitContent(e,t){for(var r={count:0,height:0},n=0,Ee=e.allRows();n<Ee.length;n++){for(var Ce=Ee[n],De=0,Me=e.columns;De<Me.length;De++){var ze=Me[De],Oe=Ce.cells[ze.index];if(Oe){t.applyStyles(Oe.styles,!0);var Be=Oe.width-Oe.padding("horizontal");if(Oe.styles.overflow==="linebreak")Oe.text=t.splitTextToSize(Oe.text,Be+1/t.scaleFactor(),{fontSize:Oe.styles.fontSize});else if(Oe.styles.overflow==="ellipsize")Oe.text=ellipsize(Oe.text,Be,Oe.styles,t,"...");else if(Oe.styles.overflow==="hidden")Oe.text=ellipsize(Oe.text,Be,Oe.styles,t,"");else if(typeof Oe.styles.overflow=="function"){var He=Oe.styles.overflow(Oe.text,Be);typeof He=="string"?Oe.text=[He]:Oe.text=He}Oe.contentHeight=Oe.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var Ve=Oe.contentHeight/Oe.rowSpan;Oe.rowSpan>1&&r.count*r.height<Ve*Oe.rowSpan?r={height:Ve,count:Oe.rowSpan}:r&&r.count>0&&r.height>Ve&&(Ve=r.height),Ve>Ce.height&&(Ce.height=Ve)}}r.count--}}function ellipsize(e,t,r,n,Ee){return e.map(function(Ce){return ellipsizeStr(Ce,t,r,n,Ee)})}function ellipsizeStr(e,t,r,n,Ee){var Ce=1e4*n.scaleFactor();if(t=Math.ceil(t*Ce)/Ce,t>=getStringWidth(e,r,n))return e;for(;t<getStringWidth(e+Ee,r,n)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+Ee}function createTable(e,t){var r=new DocHandler(e),n=parseContent(t,r.scaleFactor()),Ee=new Table(t,n);return calculateWidths(r,Ee),r.applyStyles(r.userStyles),Ee}function parseContent(e,t){var r=e.content,n=createColumns(r.columns);if(r.head.length===0){var Ee=generateSectionRow(n,"head");Ee&&r.head.push(Ee)}if(r.foot.length===0){var Ee=generateSectionRow(n,"foot");Ee&&r.foot.push(Ee)}var Ce=e.settings.theme,De=e.styles;return{columns:n,head:parseSection("head",r.head,n,De,Ce,t),body:parseSection("body",r.body,n,De,Ce,t),foot:parseSection("foot",r.foot,n,De,Ce,t)}}function parseSection(e,t,r,n,Ee,Ce){var De={},Me=t.map(function(ze,Oe){for(var Be=0,He={},Ve=0,Xe=0,We=0,Ge=r;We<Ge.length;We++){var $e=Ge[We];if(De[$e.index]==null||De[$e.index].left===0)if(Xe===0){var Ke=void 0;Array.isArray(ze)?Ke=ze[$e.index-Ve-Be]:Ke=ze[$e.dataKey];var rr={};typeof Ke=="object"&&!Array.isArray(Ke)&&(rr=Ke?.styles||{});var tr=cellStyles(e,$e,Oe,Ee,n,Ce,rr),sr=new Cell(Ke,tr,e);He[$e.dataKey]=sr,He[$e.index]=sr,Xe=sr.colSpan-1,De[$e.index]={left:sr.rowSpan-1,times:Xe}}else Xe--,Ve++;else De[$e.index].left--,Xe=De[$e.index].times,Be++}return new Row(ze,Oe,e,He)});return Me}function generateSectionRow(e,t){var r={};return e.forEach(function(n){if(n.raw!=null){var Ee=getSectionTitle(t,n.raw);Ee!=null&&(r[n.dataKey]=Ee)}}),Object.keys(r).length>0?r:null}function getSectionTitle(e,t){if(e==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(e==="foot"&&typeof t=="object")return t.footer;return null}function createColumns(e){return e.map(function(t,r){var n,Ee;return typeof t=="object"?Ee=(n=t.dataKey)!==null&&n!==void 0?n:r:Ee=r,new Column(Ee,t,r)})}function cellStyles(e,t,r,n,Ee,Ce,De){var Me=getTheme(n),ze;e==="head"?ze=Ee.headStyles:e==="body"?ze=Ee.bodyStyles:e==="foot"&&(ze=Ee.footStyles);var Oe=assign({},Me.table,Me[e],Ee.styles,ze),Be=Ee.columnStyles[t.dataKey]||Ee.columnStyles[t.index]||{},He=e==="body"?Be:{},Ve=e==="body"&&r%2===0?assign({},Me.alternateRow,Ee.alternateRowStyles):{},Xe=defaultStyles(Ce),We=assign({},Xe,Oe,Ve,He);return assign(We,De)}function getColumnsCanFitInPage(e,t,r){var n;r===void 0&&(r={});var Ee=getPageAvailableWidth(e,t),Ce=new Map,De=[],Me=[],ze=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?ze=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(ze=[t.settings.horizontalPageBreakRepeat]),ze.forEach(function(Ve){var Xe=t.columns.find(function(We){return We.dataKey===Ve||We.index===Ve});Xe&&!Ce.has(Xe.index)&&(Ce.set(Xe.index,!0),De.push(Xe.index),Me.push(t.columns[Xe.index]),Ee-=Xe.wrappedWidth)});for(var Oe=!0,Be=(n=r?.start)!==null&&n!==void 0?n:0;Be<t.columns.length;){if(Ce.has(Be)){Be++;continue}var He=t.columns[Be].wrappedWidth;if(Oe||Ee>=He)Oe=!1,De.push(Be),Me.push(t.columns[Be]),Ee-=He;else break;Be++}return{colIndexes:De,columns:Me,lastIndex:Be-1}}function calculateAllColumnsCanFitInPage(e,t){for(var r=[],n=0;n<t.columns.length;n++){var Ee=getColumnsCanFitInPage(e,t,{start:n});Ee.columns.length&&(r.push(Ee),n=Ee.lastIndex)}return r}function drawTable(e,t){var r=t.settings,n=r.startY,Ee=r.margin,Ce={x:Ee.left,y:n},De=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),Me=n+Ee.bottom+De;if(r.pageBreak==="avoid"){var ze=t.body,Oe=ze.reduce(function(Ve,Xe){return Ve+Xe.height},0);Me+=Oe}var Be=new DocHandler(e);(r.pageBreak==="always"||r.startY!=null&&Me>Be.pageSize().height)&&(nextPage(Be),Ce.y=Ee.top),t.callWillDrawPageHooks(Be,Ce);var He=assign({},Ce);t.startPageNumber=Be.pageNumber(),r.horizontalPageBreak?printTableWithHorizontalPageBreak(Be,t,He,Ce):(Be.applyStyles(Be.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(Ve){return printRow(Be,t,Ve,Ce,t.columns)}),Be.applyStyles(Be.userStyles),t.body.forEach(function(Ve,Xe){var We=Xe===t.body.length-1;printFullRow(Be,t,Ve,We,He,Ce,t.columns)}),Be.applyStyles(Be.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(Ve){return printRow(Be,t,Ve,Ce,t.columns)})),addTableBorder(Be,t,He,Ce),t.callEndPageHooks(Be,Ce),t.finalY=Ce.y,e.lastAutoTable=t,Be.applyStyles(Be.userStyles)}function printTableWithHorizontalPageBreak(e,t,r,n){var Ee=calculateAllColumnsCanFitInPage(e,t),Ce=t.settings;if(Ce.horizontalPageBreakBehaviour==="afterAllRows")Ee.forEach(function(Oe,Be){e.applyStyles(e.userStyles),Be>0?addPage(e,t,r,n,Oe.columns,!0):printHead(e,t,n,Oe.columns),printBody(e,t,r,n,Oe.columns),printFoot(e,t,n,Oe.columns)});else for(var De=-1,Me=Ee[0],ze=function(){var Oe=De;if(Me){e.applyStyles(e.userStyles);var Be=Me.columns;De>=0?addPage(e,t,r,n,Be,!0):printHead(e,t,n,Be),Oe=printBodyWithoutPageBreaks(e,t,De+1,n,Be),printFoot(e,t,n,Be)}var He=Oe-De;Ee.slice(1).forEach(function(Ve){e.applyStyles(e.userStyles),addPage(e,t,r,n,Ve.columns,!0),printBodyWithoutPageBreaks(e,t,De+1,n,Ve.columns,He),printFoot(e,t,n,Ve.columns)}),De=Oe};De<t.body.length-1;)ze()}function printHead(e,t,r,n){var Ee=t.settings;e.applyStyles(e.userStyles),(Ee.showHead==="firstPage"||Ee.showHead==="everyPage")&&t.head.forEach(function(Ce){return printRow(e,t,Ce,r,n)})}function printBody(e,t,r,n,Ee){e.applyStyles(e.userStyles),t.body.forEach(function(Ce,De){var Me=De===t.body.length-1;printFullRow(e,t,Ce,Me,r,n,Ee)})}function printBodyWithoutPageBreaks(e,t,r,n,Ee,Ce){e.applyStyles(e.userStyles),Ce=Ce??t.body.length;var De=Math.min(r+Ce,t.body.length),Me=-1;return t.body.slice(r,De).forEach(function(ze,Oe){var Be=r+Oe===t.body.length-1,He=getRemainingPageSpace(e,t,Be,n);ze.canEntireRowFit(He,Ee)&&(printRow(e,t,ze,n,Ee),Me=r+Oe)}),Me}function printFoot(e,t,r,n){var Ee=t.settings;e.applyStyles(e.userStyles),(Ee.showFoot==="lastPage"||Ee.showFoot==="everyPage")&&t.foot.forEach(function(Ce){return printRow(e,t,Ce,r,n)})}function getRemainingLineCount(e,t,r){var n=r.getLineHeight(e.styles.fontSize),Ee=e.padding("vertical"),Ce=Math.floor((t-Ee)/n);return Math.max(0,Ce)}function modifyRowToFit(e,t,r,n){var Ee={};e.spansMultiplePages=!0,e.height=0;for(var Ce=0,De=0,Me=r.columns;De<Me.length;De++){var ze=Me[De],Oe=e.cells[ze.index];if(Oe){Array.isArray(Oe.text)||(Oe.text=[Oe.text]);var Be=new Cell(Oe.raw,Oe.styles,Oe.section);Be=assign(Be,Oe),Be.text=[];var He=getRemainingLineCount(Oe,t,n);Oe.text.length>He&&(Be.text=Oe.text.splice(He,Oe.text.length));var Ve=n.scaleFactor(),Xe=n.getLineHeightFactor();Oe.contentHeight=Oe.getContentHeight(Ve,Xe),Oe.contentHeight>=t&&(Oe.contentHeight=t,Be.styles.minCellHeight-=t),Oe.contentHeight>e.height&&(e.height=Oe.contentHeight),Be.contentHeight=Be.getContentHeight(Ve,Xe),Be.contentHeight>Ce&&(Ce=Be.contentHeight),Ee[ze.index]=Be}}var We=new Row(e.raw,-1,e.section,Ee,!0);We.height=Ce;for(var Ge=0,$e=r.columns;Ge<$e.length;Ge++){var ze=$e[Ge],Be=We.cells[ze.index];Be&&(Be.height=We.height);var Oe=e.cells[ze.index];Oe&&(Oe.height=e.height)}return We}function shouldPrintOnCurrentPage(e,t,r,n){var Ee=e.pageSize().height,Ce=n.settings.margin,De=Ce.top+Ce.bottom,Me=Ee-De;t.section==="body"&&(Me-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var ze=t.getMinimumRowHeight(n.columns,e),Oe=ze<r;if(ze>Me)return console.log("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!Oe)return!1;var Be=t.hasRowSpan(n.columns),He=t.getMaxCellHeight(n.columns)>Me;return He?(Be&&console.log("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(Be||n.settings.rowPageBreak==="avoid")}function printFullRow(e,t,r,n,Ee,Ce,De){var Me=getRemainingPageSpace(e,t,n,Ce);if(r.canEntireRowFit(Me,De))printRow(e,t,r,Ce,De);else if(shouldPrintOnCurrentPage(e,r,Me,t)){var ze=modifyRowToFit(r,Me,t,e);printRow(e,t,r,Ce,De),addPage(e,t,Ee,Ce,De),printFullRow(e,t,ze,n,Ee,Ce,De)}else addPage(e,t,Ee,Ce,De),printFullRow(e,t,r,n,Ee,Ce,De)}function printRow(e,t,r,n,Ee){n.x=t.settings.margin.left;for(var Ce=0,De=Ee;Ce<De.length;Ce++){var Me=De[Ce],ze=r.cells[Me.index];if(!ze){n.x+=Me.width;continue}e.applyStyles(ze.styles),ze.x=n.x,ze.y=n.y;var Oe=t.callCellHooks(e,t.hooks.willDrawCell,ze,r,Me,n);if(Oe===!1){n.x+=Me.width;continue}drawCellRect(e,ze,n);var Be=ze.getTextPos();autoTableText(ze.text,Be.x,Be.y,{halign:ze.styles.halign,valign:ze.styles.valign,maxWidth:Math.ceil(ze.width-ze.padding("left")-ze.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,ze,r,Me,n),n.x+=Me.width}n.y+=r.height}function drawCellRect(e,t,r){var n=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof n.lineWidth=="number"){var Ee=getFillStyle(n.lineWidth,n.fillColor);Ee&&e.rect(t.x,r.y,t.width,t.height,Ee)}else typeof n.lineWidth=="object"&&(n.fillColor&&e.rect(t.x,r.y,t.width,t.height,"F"),drawCellBorders(e,t,r,n.lineWidth))}function drawCellBorders(e,t,r,n){var Ee,Ce,De,Me;n.top&&(Ee=r.x,Ce=r.y,De=r.x+t.width,Me=r.y,n.right&&(De+=.5*n.right),n.left&&(Ee-=.5*n.left),ze(n.top,Ee,Ce,De,Me)),n.bottom&&(Ee=r.x,Ce=r.y+t.height,De=r.x+t.width,Me=r.y+t.height,n.right&&(De+=.5*n.right),n.left&&(Ee-=.5*n.left),ze(n.bottom,Ee,Ce,De,Me)),n.left&&(Ee=r.x,Ce=r.y,De=r.x,Me=r.y+t.height,n.top&&(Ce-=.5*n.top),n.bottom&&(Me+=.5*n.bottom),ze(n.left,Ee,Ce,De,Me)),n.right&&(Ee=r.x+t.width,Ce=r.y,De=r.x+t.width,Me=r.y+t.height,n.top&&(Ce-=.5*n.top),n.bottom&&(Me+=.5*n.bottom),ze(n.right,Ee,Ce,De,Me));function ze(Oe,Be,He,Ve,Xe){e.getDocument().setLineWidth(Oe),e.getDocument().line(Be,He,Ve,Xe,"S")}}function getRemainingPageSpace(e,t,r,n){var Ee=t.settings.margin.bottom,Ce=t.settings.showFoot;return(Ce==="everyPage"||Ce==="lastPage"&&r)&&(Ee+=t.getFootHeight(t.columns)),e.pageSize().height-n.y-Ee}function addPage(e,t,r,n,Ee,Ce){Ee===void 0&&(Ee=[]),Ce===void 0&&(Ce=!1),e.applyStyles(e.userStyles),t.settings.showFoot==="everyPage"&&!Ce&&t.foot.forEach(function(Me){return printRow(e,t,Me,n,Ee)}),t.callEndPageHooks(e,n);var De=t.settings.margin;addTableBorder(e,t,r,n),nextPage(e),t.pageNumber++,n.x=De.left,n.y=De.top,r.y=De.top,t.callWillDrawPageHooks(e,n),t.settings.showHead==="everyPage"&&(t.head.forEach(function(Me){return printRow(e,t,Me,n,Ee)}),e.applyStyles(e.userStyles))}function nextPage(e){var t=e.pageNumber();e.setPage(t+1);var r=e.pageNumber();return r===t?(e.addPage(),!0):!1}function applyPlugin(e){e.API.autoTable=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0],Ee=parseInput(this,n),Ce=createTable(this,Ee);return drawTable(this,Ce),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(t,r,n,Ee){autoTableText(t,r,n,Ee,this)},e.API.autoTableSetDefaults=function(t){return DocHandler.setDefaults(t,this),this},e.autoTableSetDefaults=function(t,r){DocHandler.setDefaults(t,r)},e.API.autoTableHtmlToJson=function(t,r){var n;if(r===void 0&&(r=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var Ee=new DocHandler(this),Ce=parseHtml(Ee,t,window,r,!1),De=Ce.head,Me=Ce.body,ze=((n=De[0])===null||n===void 0?void 0:n.map(function(Oe){return Oe.content}))||[];return{columns:ze,rows:Me,data:Me}}}var _a;function autoTable(e,t){var r=parseInput(e,t),n=createTable(e,r);drawTable(e,n)}try{if(typeof window<"u"&&window){var anyWindow=window,jsPDF=anyWindow.jsPDF||((_a=anyWindow.jspdf)===null||_a===void 0?void 0:_a.jsPDF);jsPDF&&applyPlugin(jsPDF)}}catch(e){console.error("Could not apply autoTable plugin",e)}const pdfjs=pdf||pdfjsLib;pdfjs?.GlobalWorkerOptions&&(pdfjs.GlobalWorkerOptions.workerSrc=`https://cdnjs.cloudflare.com/ajax/libs/pdf.js/${pdfjs.version||"3.11.174"}/pdf.worker.min.js`);const loadCustomFont=async(e,t)=>{const r="https://cdn.jsdelivr.net/npm/open-sans-all@0.1.3/fonts/open-sans-regular.ttf";try{const n=await fetch(r);if(n.ok){const Ee=await n.blob(),Ce=await new Promise((De,Me)=>{const ze=new FileReader;ze.onload=()=>{const Oe=ze.result;De(Oe.split(",")[1])},ze.onerror=Me,ze.readAsDataURL(Ee)});return e.addFileToVFS(`${t}.ttf`,Ce),e.addFont(`${t}.ttf`,t,"normal"),e.addFont(`${t}.ttf`,t,"bold"),e.setFont(t),!0}}catch(n){console.warn("Could not load custom font, using fallback.",n)}return!1},generateManualDutyPDF=async(e,t,r,n,Ee="",Ce=new Set,De={},Me="",ze=[225,255,224])=>{const Oe=new E("l","mm","a4"),Be="OpenSans",He=await loadCustomFont(Oe,Be);He||Oe.setFont("helvetica");const Ve=Ee?Ee.toLocaleUpperCase("tr-TR"):"OKUL MDRL";Oe.setFontSize(14),Oe.setTextColor(0,0,0),Oe.text(Ve,148.5,10,{align:"center"}),Oe.setFontSize(11),Oe.text("HAFTALIK NBET ZELGES",148.5,16,{align:"center"});const Xe=["GN",...e,"NBET DAREC"],We=t.map(rr=>[rr.toLocaleUpperCase("tr-TR"),...e.map(tr=>r[rr]?.[tr]||""),r[rr]?.ADMIN||""]);autoTable(Oe,{startY:35,head:[Xe],body:We,theme:"grid",styles:{font:He?Be:"helvetica",fontSize:8,cellPadding:2,halign:"center",valign:"middle",textColor:0,fontStyle:"normal",lineColor:[100,100,100],lineWidth:.1,minCellHeight:14,overflow:"linebreak"},headStyles:{fillColor:[240,240,240],textColor:0,lineWidth:.2,fontStyle:"bold",minCellHeight:10},alternateRowStyles:{fillColor:ze},columnStyles:{0:{cellWidth:25,fontStyle:"bold"}},didParseCell:rr=>{if(rr.section==="body"&&rr.column.index>0){const tr=t[rr.row.index],sr=rr.column.index-1,ar=sr<e.length?e[sr]:"ADMIN";if(ar==="ADMIN")return;const hr=De[tr]?.[ar],pr=`${tr}-${ar}`;Ce.has(pr)?(rr.cell.styles.fillColor=[255,235,59],rr.cell.styles.textColor=[0,0,0]):hr?.isDuplicate?(rr.cell.styles.fillColor=[255,200,200],rr.cell.styles.textColor=[0,0,0]):hr?.prefViolation&&(rr.cell.styles.fillColor=[230,210,255],rr.cell.styles.textColor=[0,0,0])}}});let Ge=Oe.lastAutoTable.finalY+8;if(Ce.size>0){Oe.setFontSize(8),Oe.setFont(Be,"bold");const rr="NOT: Personel yetersizlii nedeniyle sar ile iaretli alanlarda retmene haftada birden fazla nbet grevi verilmitir.",tr=Oe.getTextWidth(rr);Oe.setFillColor(255,235,59),Oe.rect(13,Ge-3,tr+2,4,"F"),Oe.setTextColor(0,0,0),Oe.text(rr,14,Ge),Oe.setFont(Be,"normal"),Ge+=6}const $e=["NBET RETMENLERN GREVLER:","1- Gnlk vakit izelgesini uygulamak.","2- retmenlerin derslere zamannda girip girmediini izlemek ve ynetime bildirmek.","3- Bina, tesis ve temizlik kontrollerini yapmak, eksikleri gidermek veya ilgililere iletmek.","4- Bahe, koridor ve snflardaki rencileri gzetlemek.","5- Beklenmedik olaylarda gerekli tedbirleri alp ynetimi bilgilendirmek.","6- Nbet sresince okul disiplini ve dzenini takip etmek.","7- Nbet sonunda rapor yazarak nbet defterini imzalamak."];if(Oe.setFontSize(7.5),Oe.setTextColor(80,80,80),Ge+$e.length*4.5>180&&(Oe.addPage(),Ge=20),$e.forEach(rr=>{Oe.text(rr,14,Ge),Ge+=4.5}),n){let rr=Ge+15;rr>190&&(Oe.addPage(),rr=40);const tr=240;Oe.setTextColor(0,0,0),Me&&(Oe.setFontSize(9),Oe.text(Me,tr,rr-6,{align:"center"})),Oe.setFontSize(10),Oe.setFont(Be,"bold"),Oe.text(n.toLocaleUpperCase("tr-TR"),tr,rr,{align:"center"}),Oe.setFont(Be,"normal"),Oe.setFontSize(9),Oe.text("Okul Mdr",tr,rr+5,{align:"center"})}Oe.setFontSize(7),Oe.setTextColor(150,150,150),Oe.text("Bu program KML Biliim, Fizik retmeni Kemal B. tarafndan hazrlanm, cretsiz bir programdr.",148.5,202,{align:"center"}),Oe.text(" 2026 Tm Haklar Sakldr.",148.5,206,{align:"center"});const Ke=Me?Me.replace(/[\s\.\-\/]/g,"_"):new Date().toLocaleDateString("tr-TR").replace(/\./g,"_");Oe.save(`nobet_cizelgesi_${Ke}.pdf`)},shuffleArray=e=>{const t=[...e];for(let r=t.length-1;r>0;r--){const n=Math.floor(Math.random()*(r+1));[t[r],t[n]]=[t[n],t[r]]}return t},DEFAULT_LOCATIONS=["BAHE","KANTN","GR GNEY","GR KUZEY","1 KAT GNEY","1. KAT KUZEY","2. KAT GNEY","2. KAT KUZEY","3.KAT GNEY","3.KAT KUZEY"],PDF_THEMES=[{id:"green",name:"Yeil (Standart)",rgb:[225,255,224],tailwind:"bg-green-100 text-green-800 ring-green-300"},{id:"blue",name:"Pastel Mavi",rgb:[220,240,255],tailwind:"bg-sky-100 text-sky-800 ring-sky-300"},{id:"gray",name:"Resmi Gri",rgb:[240,240,240],tailwind:"bg-gray-100 text-gray-800 ring-gray-300"},{id:"yellow",name:"Pastel Sar",rgb:[255,250,220],tailwind:"bg-yellow-100 text-yellow-800 ring-yellow-300"},{id:"rose",name:"Gl Rengi",rgb:[255,235,235],tailwind:"bg-rose-100 text-rose-800 ring-rose-300"},{id:"purple",name:"Lavanta",rgb:[245,235,255],tailwind:"bg-purple-100 text-purple-800 ring-purple-300"}],App=()=>{const[e,t]=reactExports.useState([]),[r,n]=reactExports.useState(DEFAULT_LOCATIONS),[Ee,Ce]=reactExports.useState({}),[De,Me]=reactExports.useState(new Set),[ze,Oe]=reactExports.useState({}),[Be,He]=reactExports.useState(!1),[Ve,Xe]=reactExports.useState(!1),[We,Ge]=reactExports.useState(""),[$e,Ke]=reactExports.useState(""),[rr,tr]=reactExports.useState(""),[sr,ar]=reactExports.useState(!1),[hr,pr]=reactExports.useState(null),[yr,fr]=reactExports.useState(PDF_THEMES[0]),[Rr,mr]=reactExports.useState(!1),[wr,Fr]=reactExports.useState(new Set),[Mr,Hr]=reactExports.useState(!1),[Nr,Ar]=reactExports.useState(""),[xr,ir]=reactExports.useState(!1),[_r,ur]=reactExports.useState({email:"",message:""}),[Je,nr]=reactExports.useState(!1),[or,lr]=reactExports.useState(null),[St,dr]=reactExports.useState(null),[vr,br]=reactExports.useState(null),[kr,Pr]=reactExports.useState([]),[Er,Zr]=reactExports.useState(!1),ua=reactExports.useRef(null),Cr=reactExports.useMemo(()=>Ve?ALL_DAYS:WEEKDAYS,[Ve]);reactExports.useEffect(()=>{const ca=ua.current;if(!ca)return;const pa=xa=>{ca.scrollWidth>ca.clientWidth&&xa.deltaY!==0&&(xa.preventDefault(),ca.scrollLeft+=xa.deltaY)};return ca.addEventListener("wheel",pa,{passive:!1}),()=>{ca.removeEventListener("wheel",pa)}},[]);const Jr=()=>{exportAllDataToExcel(e,Ee,r,{schoolName:$e,directorName:We,dutyDate:rr,ignoredTeachers:Array.from(wr),includeWeekends:Ve},ze,De,Cr)},Qr=async ca=>{ar(!0);try{const pa=await importAllDataFromExcel(ca);t(pa.schedules),Ce(pa.grid),n(pa.locations),Ke(pa.settings.schoolName),Ge(pa.settings.directorName),tr(pa.settings.dutyDate),Fr(new Set(pa.settings.ignoredTeachers)),Oe(pa.teacherPrefs||{}),Me(pa.approvedMultiDayDuties||new Set),Xe(pa.settings.includeWeekends||!1),dr({isOpen:!0,title:"Baarl",message:`Excel yedek dosyas baaryla yklendi.${pa.settings.includeWeekends?`
Hafta sonu nbetleri aktifletirildi.`:""}`})}catch{dr({isOpen:!0,title:"Hata",message:"Excel dosyas okunamad. Ltfen geerli bir yedek dosyas setiinizden emin olun."})}finally{ar(!1)}},oa=reactExports.useMemo(()=>{const ca={};return e.forEach(pa=>{ca[pa.name.toLocaleUpperCase("tr-TR")]={totalDuties:0,dutyDays:new Set}}),Object.entries(Ee).forEach(([pa,xa])=>{Object.values(xa).forEach($a=>{if(!$a)return;const ka=$a.trim().toLocaleUpperCase("tr-TR");ca[ka]&&(ca[ka].totalDuties+=1,ca[ka].dutyDays.add(pa))})}),ca},[Ee,e]),ta=async ca=>{ar(!0);try{const pa=await parseSchedulePDF(ca);pa.sort(($a,ka)=>$a.name.localeCompare(ka.name,"tr-TR")),t(pa);const xa=[];pa.forEach($a=>{let ka=0;Object.values($a.schedule).forEach(La=>{ka+=La.filter(Wa=>Wa.className&&Wa.className.trim()!=="").length}),ka<12&&ka>0&&xa.push({name:$a.name,hours:ka,role:ka<3?"DIRECTOR":"ADMIN"})}),xa.length>0&&(Pr(xa),Zr(!0)),Oe($a=>{const ka={...$a};return pa.forEach(La=>{const Wa=La.name.toLocaleUpperCase("tr-TR");ka[Wa]||(ka[Wa]=new Set)}),ka})}catch{dr({isOpen:!0,title:"Hata",message:"Dosya ilenirken hata olutu."})}finally{ar(!1)}},Na=()=>{const ca=new Set;let pa="";const xa=[];kr.forEach($a=>{const ka=$a.name.toLocaleUpperCase("tr-TR");$a.role==="DIRECTOR"?(pa=$a.name,ca.add(ka)):$a.role==="ADMIN"&&(xa.push($a.name),ca.add(ka))}),Fr(ca),pa&&Ge(pa),xa.length>0&&Ce($a=>{const ka={...$a};return Cr.forEach((La,Wa)=>{if(ka[La]||(ka[La]={}),!ka[La].ADMIN){const _n=Wa%xa.length;ka[La].ADMIN=xa[_n]}}),ka}),Zr(!1),dr({isOpen:!0,title:"lem Tamamland",message:"Setiiniz idareci ayarlar sisteme uyguland."})},Ca=ca=>{if(!ca.trim())return;const pa=ca.split(/\r?\n/),xa=[];let $a=0;const ka=new Set(e.map(La=>La.name.toLocaleUpperCase("tr-TR")));pa.forEach(La=>{let Wa=La.replace(/^[0-9\s\.\-\>\:\*\_]+/,"").replace(/\s+/g," ").trim().toLocaleUpperCase("tr-TR");Wa.length>3&&!ka.has(Wa)&&!/T\.C|MDRL|LSES/.test(Wa)&&(xa.push({name:Wa,schedule:{}}),ka.add(Wa),$a++)}),$a>0&&(t(La=>[...La,...xa].sort((Wa,_n)=>Wa.name.localeCompare(_n.name,"tr-TR"))),Hr(!1),Ar(""))},za=async()=>{try{const ca=await navigator.clipboard.readText();Ca(ca)}catch{Hr(!0)}},Xa=(ca,pa)=>{ca.stopPropagation(),ca.preventDefault();const xa=r[pa];xa&&(Ce($a=>{const ka={...$a};return Object.keys(ka).forEach(La=>{if(ka[La]){const Wa={...ka[La]};delete Wa[xa],ka[La]=Wa}}),ka}),n($a=>$a.filter((ka,La)=>La!==pa)))},Ya=(ca,pa,xa)=>{ca.stopPropagation(),ca.preventDefault();const $a=xa==="left"?pa:pa+1,ka="YEN YER";n(La=>{const Wa=[...La];return Wa.splice($a,0,ka),Wa}),setTimeout(()=>{pr({index:$a,value:ka})},50)},nn=(ca,pa)=>{const xa=pa.trim().toLocaleUpperCase("tr-TR");if(!xa){pr(null);return}const $a=r[ca];n(ka=>{const La=[...ka];return La[ca]=xa,La}),Ce(ka=>{const La={...ka};return Object.keys(La).forEach(Wa=>{La[Wa]&&La[Wa][$a]&&(La[Wa][xa]=La[Wa][$a],delete La[Wa][$a])}),La}),pr(null)},on=ca=>{Me(pa=>{const xa=new Set(pa);return xa.has(ca)?xa.delete(ca):xa.add(ca),xa})},yn=async ca=>{ca.preventDefault(),nr(!0);try{(await fetch("https://formspree.io/f/mlgnjbav",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(_r)})).ok&&(dr({isOpen:!0,title:"Mesaj letildi",message:"Mesajnz gnderildi."}),ir(!1),ur({email:"",message:""}))}finally{nr(!1)}},fn=(ca,pa)=>{Ce(xa=>{const $a={...xa};return(pa?[pa]:Cr).forEach(La=>{if(!$a[La])return;const Wa=$a[La],_n={...Wa};r.forEach((hn,Fn)=>{let Tn=ca==="forward"?(Fn-1+r.length)%r.length:(Fn+1)%r.length;const sn=r[Tn];_n[hn]=Wa[sn]||""}),Wa.ADMIN&&(_n.ADMIN=Wa.ADMIN),$a[La]=_n}),$a})},Qa=ca=>{if(e.length===0)return;const pa={},xa={};e.forEach(ka=>xa[ka.name.toLocaleUpperCase("tr-TR")]=0);const $a=We.trim().toLocaleUpperCase("tr-TR");Cr.forEach(ka=>{pa[ka]={};let La=e.filter(_n=>{const hn=_n.name.toLocaleUpperCase("tr-TR");if(hn===$a||wr.has(hn)||ze[hn]?.has(ka))return!1;if(ca){const Fn=_n.schedule[ka];if(!Fn)return ka==="Cumartesi"||ka==="Pazar";const Tn=Fn.filter(sn=>sn.className&&sn.className.trim()!=="").length;if(Tn===0||Tn===8)return!1}return!0});if(La.length===0)return;La=shuffleArray(La),La.sort((_n,hn)=>{const Fn=_n.name.toLocaleUpperCase("tr-TR"),Tn=hn.name.toLocaleUpperCase("tr-TR"),sn=xa[Fn],Gi=xa[Tn];if(sn!==Gi)return sn-Gi;if(ca){const Yi=Si=>{const bi=Si.schedule[ka];if(!bi)return ka==="Cumartesi"||ka==="Pazar"?10:0;const Ln=bi.filter($n=>$n.className&&$n.className.trim()!=="").length;return Ln>=4&&Ln<=6?100:Ln===3||Ln===7?50:Ln>0?10:0};return Yi(hn)-Yi(_n)}return 0});let Wa=0;r.forEach(_n=>{if(La.length===0)return;Wa>=La.length&&(Wa=0);const hn=La[Wa];pa[ka][_n]=hn.name,xa[hn.name.toLocaleUpperCase("tr-TR")]++,Wa++}),Ee[ka]?.ADMIN&&(pa[ka].ADMIN=Ee[ka].ADMIN)}),Ce(pa)},Ka=reactExports.useMemo(()=>{const ca={},pa={},xa={},$a=new Map(e.map(ka=>[ka.name.toLocaleUpperCase("tr-TR"),ka]));return Cr.forEach(ka=>{ca[ka]={},xa[ka]={};const La=Ee[ka]||{};Object.entries(La).forEach(([Wa,_n])=>{const hn=_n;if(!hn)return;const Fn=hn.trim().toLocaleUpperCase("tr-TR");xa[ka][Fn]=(xa[ka][Fn]||0)+1,pa[Fn]||(pa[Fn]=new Set),pa[Fn].add(ka)})}),Cr.forEach(ka=>{const La=Ee[ka]||{};[...r,"ADMIN"].forEach(Wa=>{const _n=(La[Wa]||"").trim().toLocaleUpperCase("tr-TR");let hn=0,Fn=!1;if(_n){const Tn=$a.get(_n);Tn&&Object.keys(Tn.schedule).length>0&&(Tn.schedule[ka]&&(hn=Tn.schedule[ka].filter(sn=>sn.className&&sn.className.trim()!=="").length),hn===0&&(ka==="Cumartesi"||ka==="Pazar"||(Fn=!0)))}ca[ka][Wa]={isDuplicate:_n?xa[ka][_n]>1:!1,isMultiDay:_n?(pa[_n]?.size||0)>1:!1,prefViolation:_n?ze[_n]?.has(ka):!1,lessonCount:hn,hasZeroLessons:Fn}})}),ca},[Ee,r,e,ze,Cr]),en=reactExports.useMemo(()=>or?e.map(ca=>{const pa=ca.name.toLocaleUpperCase("tr-TR"),xa=ca.schedule[or],$a=!!xa,ka=xa?xa.filter(sn=>sn.className&&sn.className.trim()!=="").length:0,La=oa[pa]||{totalDuties:0,dutyDays:new Set},Wa=La.dutyDays.has(or),_n=La.totalDuties;let hn="",Fn="";Wa?(Fn="",hn="[ATANDI] - BUGN ZATEN LSTEDE"):_n>0?(Fn="",hn=`DER GNLERDE ${_n} NBET VAR`):ze[pa]?.has(or)?(Fn="",hn="TERCH KAPALI"):$a?ka===0?(Fn="",hn="DERS YOK (0 Saat)"):ka===8?(Fn="",hn="FULL DOLU (8 Saat)"):(Fn="",hn="TAMAMEN MSAT"):(Fn="",hn="DERS PROGRAMI YOK");const Tn=$a?`[${ka} Ders]`:"";return jsxRuntimeExports.jsx("option",{value:ca.name,label:`${Fn} ${Tn} ${hn}`},ca.name)}):e.map(ca=>jsxRuntimeExports.jsx("option",{value:ca.name},ca.name)),[e,or,ze,oa]),Bn=ca=>{const pa=ca.toLocaleUpperCase("tr-TR");Oe(xa=>{const $a={...xa},ka=$a[pa]||new Set,La=Cr.every(Wa=>ka.has(Wa));return $a[pa]=La?new Set:new Set(Cr),$a})},vn=()=>{const ca=e.map(xa=>xa.name.toLocaleUpperCase("tr-TR"));if(ca.every(xa=>ze[xa]&&Cr.every($a=>ze[xa].has($a))))Oe({});else{const xa={};ca.forEach($a=>xa[$a]=new Set(Cr)),Oe(xa)}},va=reactExports.useMemo(()=>e.length===0?!1:e.every(ca=>ze[ca.name.toLocaleUpperCase("tr-TR")]&&Cr.every(pa=>ze[ca.name.toLocaleUpperCase("tr-TR")].has(pa))),[e,ze,Cr]),aa=()=>{br({isOpen:!0,title:"Program Sfrla",message:"Tm veriler silinecek ve program tamamen sfrlanacak. Devam etmek istiyor musunuz?",onConfirm:()=>{t([]),n(DEFAULT_LOCATIONS),Ce({}),Me(new Set),Oe({}),Ge(""),Ke(""),tr(""),Fr(new Set),Xe(!1),br(null)}})},ia=()=>{br({isOpen:!0,title:"Tabloyu Boalt",message:"Tm atamalar silinecek. Emin misiniz?",onConfirm:()=>{Ce({}),Me(new Set),br(null)}})},Oa=()=>{br({isOpen:!0,title:"Konumlar Sfrla",message:"Nbet yerleri varsaylan listeye dndrlecek. Devam edilsin mi?",onConfirm:()=>{n(DEFAULT_LOCATIONS),br(null)}})};return jsxRuntimeExports.jsxs("div",{className:"min-h-screen bg-gray-100 flex flex-col font-['Inter'] overflow-hidden relative text-gray-900",children:[jsxRuntimeExports.jsx("button",{onClick:()=>ir(!0),className:"fixed bottom-6 right-6 p-4 bg-indigo-600 text-white rounded-full shadow-2xl hover:scale-110 hover:bg-indigo-700 transition-all z-[900] group flex items-center justify-center border-4 border-white",children:jsxRuntimeExports.jsx(MessageSquare,{className:"h-6 w-6 group-hover:animate-pulse"})}),jsxRuntimeExports.jsx("datalist",{id:"teacherSuggestions",children:en}),Er&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-[3500] flex items-center justify-center bg-black/60 backdrop-blur-md",children:jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-3xl shadow-2xl w-[600px] max-h-[80vh] flex flex-col border border-gray-100 animate-in zoom-in duration-300",children:[jsxRuntimeExports.jsxs("div",{className:"p-8 border-b bg-gray-50 rounded-t-3xl",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[jsxRuntimeExports.jsx(ShieldCheck,{className:"h-6 w-6 text-indigo-600"}),jsxRuntimeExports.jsx("h3",{className:"text-xl font-black text-gray-900",children:"dareci ve Mdr Belirleme"})]}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:"Ders yk 12 saatten az olan retmenler aada listelenmitir. Kimlerin idareci olarak nbetten muaf tutulacan ve dareci stununa atanacan seiniz."})]}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:jsxRuntimeExports.jsx("div",{className:"space-y-4",children:kr.map((ca,pa)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between p-4 rounded-2xl border-2 transition-all bg-white hover:border-indigo-200",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col",children:[jsxRuntimeExports.jsx("span",{className:"font-bold text-gray-900",children:ca.name}),jsxRuntimeExports.jsxs("span",{className:"text-[10px] font-black text-indigo-500 uppercase",children:[ca.hours," Saat Ders Yk"]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsxs("button",{onClick:()=>{const xa=[...kr];xa[pa].role="DIRECTOR",Pr(xa)},className:`px-3 py-2 rounded-xl text-[10px] font-black border transition-all flex items-center gap-1.5 ${ca.role==="DIRECTOR"?"bg-amber-100 border-amber-300 text-amber-700 shadow-sm":"bg-gray-50 border-gray-200 text-gray-400 hover:bg-gray-100"}`,children:[jsxRuntimeExports.jsx(CircleUser,{className:"h-3.5 w-3.5"})," MDR"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>{const xa=[...kr];xa[pa].role="ADMIN",Pr(xa)},className:`px-3 py-2 rounded-xl text-[10px] font-black border transition-all flex items-center gap-1.5 ${ca.role==="ADMIN"?"bg-indigo-100 border-indigo-300 text-indigo-700 shadow-sm":"bg-gray-50 border-gray-200 text-gray-400 hover:bg-gray-100"}`,children:[jsxRuntimeExports.jsx(ShieldCheck,{className:"h-3.5 w-3.5"})," DAREC"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>{const xa=[...kr];xa[pa].role="TEACHER",Pr(xa)},className:`px-3 py-2 rounded-xl text-[10px] font-black border transition-all flex items-center gap-1.5 ${ca.role==="TEACHER"?"bg-emerald-100 border-emerald-300 text-emerald-700 shadow-sm":"bg-gray-50 border-gray-200 text-gray-400 hover:bg-gray-100"}`,children:[jsxRuntimeExports.jsx(UserCheck,{className:"h-3.5 w-3.5"})," RETMEN"]})]})]},pa))})}),jsxRuntimeExports.jsxs("div",{className:"p-8 border-t bg-gray-50 rounded-b-3xl flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>Zr(!1),className:"flex-1 py-4 bg-white border border-gray-200 text-gray-500 font-black text-xs rounded-2xl shadow-sm hover:bg-gray-100 transition-all",children:"PTAL"}),jsxRuntimeExports.jsx("button",{onClick:Na,className:"flex-[2] py-4 bg-indigo-600 text-white font-black text-xs rounded-2xl shadow-xl hover:bg-indigo-700 transition-all",children:"SEMLER ONAYLA VE UYGULA"})]})]})}),vr&&vr.isOpen&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-[3000] flex items-center justify-center bg-black/50 backdrop-blur-sm",children:jsxRuntimeExports.jsx("div",{className:"bg-white rounded-2xl shadow-2xl p-6 w-[400px] border border-gray-100 animate-in zoom-in duration-200",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center text-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:"p-3 rounded-full bg-amber-50 text-amber-500",children:jsxRuntimeExports.jsx(TriangleAlert,{className:"h-8 w-8"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-black text-gray-900 mb-2",children:vr.title}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 font-medium",children:vr.message})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3 w-full mt-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>br(null),className:"flex-1 py-3 bg-gray-100 font-bold rounded-xl text-gray-600",children:"PTAL"}),jsxRuntimeExports.jsx("button",{onClick:vr.onConfirm,className:"flex-1 py-3 bg-red-600 text-white font-bold rounded-xl shadow-lg",children:"EVET, YAP"})]})]})})}),Mr&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 backdrop-blur-sm",children:jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl p-6 w-[500px] border border-gray-100 flex flex-col gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2",children:[jsxRuntimeExports.jsx(ClipboardList,{className:"h-5 w-5 text-indigo-600"}),jsxRuntimeExports.jsx("h3",{className:"text-lg font-black text-gray-900",children:"sim Listesi Yaptr"})]}),jsxRuntimeExports.jsx("button",{onClick:()=>{Hr(!1),Ar("")},className:"p-2 hover:bg-gray-100 rounded-full",children:jsxRuntimeExports.jsx(X$1,{className:"h-5 w-5 text-gray-500"})})]}),jsxRuntimeExports.jsx("textarea",{className:"w-full h-64 border border-gray-200 rounded-xl p-3 text-sm font-mono outline-none resize-none bg-gray-50",placeholder:`rnek:
Ahmet Ylmaz
Aye Demir...`,value:Nr,onChange:ca=>Ar(ca.target.value),autoFocus:!0}),jsxRuntimeExports.jsxs("div",{className:"flex gap-3",children:[jsxRuntimeExports.jsx("button",{onClick:()=>{Hr(!1),Ar("")},className:"flex-1 py-3 bg-gray-100 font-bold rounded-xl",children:"PTAL"}),jsxRuntimeExports.jsx("button",{onClick:()=>Ca(Nr),className:"flex-[2] py-3 bg-indigo-600 text-white font-bold rounded-xl shadow-lg",children:"LSTEY EKLE"})]})]})}),xr&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/60 backdrop-blur-md",children:jsxRuntimeExports.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-[450px] overflow-hidden",children:[jsxRuntimeExports.jsxs("div",{className:"bg-indigo-600 p-6 flex justify-between items-start",children:[jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsxs("h3",{className:"text-xl font-black text-white flex items-center gap-2",children:[jsxRuntimeExports.jsx(MessageSquare,{className:"h-5 w-5"})," letiim"]})}),jsxRuntimeExports.jsx("button",{onClick:()=>ir(!1),className:"text-white/70 p-1 hover:bg-white/10 rounded-full",children:jsxRuntimeExports.jsx(X$1,{className:"h-5 w-5"})})]}),jsxRuntimeExports.jsxs("form",{onSubmit:yn,className:"p-6 flex flex-col gap-4",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"E-Posta"}),jsxRuntimeExports.jsx("input",{type:"email",required:!0,className:"w-full border border-gray-200 rounded-xl px-4 py-3 text-sm bg-gray-50",value:_r.email,onChange:ca=>ur(pa=>({...pa,email:ca.target.value}))})]}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("label",{className:"block text-xs font-bold text-gray-700 mb-1",children:"Mesajnz"}),jsxRuntimeExports.jsx("textarea",{required:!0,className:"w-full border border-gray-200 rounded-xl px-4 py-3 text-sm bg-gray-50 h-32",value:_r.message,onChange:ca=>ur(pa=>({...pa,message:ca.target.value}))})]}),jsxRuntimeExports.jsx("button",{disabled:Je,type:"submit",className:"w-full bg-gray-900 text-white font-bold py-3 rounded-xl shadow-lg",children:"GNDER"})]})]})}),St&&St.isOpen&&jsxRuntimeExports.jsx("div",{className:"fixed inset-0 z-[2000] flex items-center justify-center bg-black/50 backdrop-blur-sm",children:jsxRuntimeExports.jsx("div",{className:"bg-white rounded-2xl shadow-2xl p-6 w-[350px] border border-gray-100",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center text-center gap-4",children:[jsxRuntimeExports.jsx("div",{className:`p-3 rounded-full ${St.title==="Hata"||St.title==="Uyar"?"bg-red-50 text-red-500":"bg-emerald-50 text-emerald-500"}`,children:St.title==="Hata"||St.title==="Uyar"?jsxRuntimeExports.jsx(CircleAlert,{className:"h-8 w-8"}):jsxRuntimeExports.jsx(CircleCheckBig,{className:"h-8 w-8"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h3",{className:"text-lg font-black text-gray-900 mb-2",children:St.title}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500 font-medium whitespace-pre-line",children:St.message})]}),jsxRuntimeExports.jsx("button",{onClick:()=>dr(null),className:"w-full py-3 bg-gray-900 text-white font-bold rounded-xl shadow-lg",children:"TAMAM"})]})})}),jsxRuntimeExports.jsxs("header",{className:"bg-white border-b h-16 flex items-center justify-between px-8 shadow-sm shrink-0 z-[100]",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-3",children:[jsxRuntimeExports.jsx("div",{className:"bg-indigo-600 p-2 rounded-xl shadow-lg",children:jsxRuntimeExports.jsx(FileSpreadsheet,{className:"h-6 w-6 text-white"})}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h1",{className:"text-xl font-black text-gray-900 leading-none",children:"Nbet Datm Paneli"}),jsxRuntimeExports.jsx("p",{className:"text-[10px] font-bold text-indigo-500 uppercase tracking-widest mt-1",children:"Akll Okul Ynetim Sistemi"})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-4",children:[jsxRuntimeExports.jsx("button",{onClick:aa,className:"p-2.5 rounded-xl bg-gray-200 hover:bg-gray-300 transition-all shadow-sm group",title:"Program Sfrla",children:jsxRuntimeExports.jsx(Power,{className:"h-5 w-5 text-gray-500 group-hover:text-gray-700"})}),jsxRuntimeExports.jsxs("button",{onClick:()=>He(!Be),className:"px-4 py-2 rounded-xl text-xs font-black bg-white border border-gray-200 text-gray-600 hover:bg-gray-50 flex items-center gap-2",children:[jsxRuntimeExports.jsx(Settings2,{className:"h-4 w-4 text-indigo-600"})," RETMEN TERCHLER"]}),jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("button",{onClick:()=>mr(!Rr),className:`p-2 rounded-xl border transition-all ${yr.tailwind}`,title:"Renk Se",children:jsxRuntimeExports.jsx(Palette,{className:"h-4 w-4"})}),Rr&&jsxRuntimeExports.jsxs("div",{className:"absolute top-full right-0 mt-2 bg-white rounded-xl shadow-xl border border-gray-100 p-2 w-48 z-[150] animate-in slide-in-from-top-2 duration-150",children:[jsxRuntimeExports.jsx("h4",{className:"text-[10px] font-bold text-gray-400 uppercase tracking-wider mb-2 px-2",children:"PDF Satr Rengi"}),jsxRuntimeExports.jsx("div",{className:"flex flex-col gap-1",children:PDF_THEMES.map(ca=>jsxRuntimeExports.jsxs("button",{onClick:()=>{fr(ca),mr(!1)},className:`flex items-center gap-2 px-3 py-2 rounded-lg text-xs font-bold transition-colors w-full text-left hover:bg-gray-50 ${yr.id===ca.id?"bg-gray-50 ring-1 ring-indigo-200":""}`,children:[jsxRuntimeExports.jsx("div",{className:`w-4 h-4 rounded-full border shadow-sm ${ca.tailwind.split(" ")[0]}`}),jsxRuntimeExports.jsx("span",{className:"text-gray-700",children:ca.name}),yr.id===ca.id&&jsxRuntimeExports.jsx(CircleCheck,{className:"h-3 w-3 ml-auto text-indigo-600"})]},ca.id))})]})]}),jsxRuntimeExports.jsxs("button",{onClick:()=>generateManualDutyPDF(r,Cr,Ee,We,$e,De,Ka,rr,yr.rgb),className:"px-4 py-2 rounded-xl text-xs font-black bg-emerald-600 hover:bg-emerald-700 text-white flex items-center gap-2 shadow-lg",children:[jsxRuntimeExports.jsx(Printer,{className:"h-4 w-4"})," PDF IKTISI AL"]}),jsxRuntimeExports.jsxs("button",{onClick:ia,className:"flex items-center gap-2 bg-red-600 text-white hover:bg-red-700 px-6 py-2 rounded-xl text-xs font-black shadow-lg",children:[jsxRuntimeExports.jsx(Trash,{className:"h-4 w-4"})," TABLOYU BOALT"]})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[jsxRuntimeExports.jsxs("aside",{className:"w-80 bg-white border-r p-6 overflow-y-auto shrink-0 flex flex-col gap-6 shadow-sm z-40",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-4",children:[jsxRuntimeExports.jsxs("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest flex items-center gap-2",children:[jsxRuntimeExports.jsx(School,{className:"h-3 w-3"})," OKUL BLGLER"]}),jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Okul Ad",value:$e,onChange:ca=>Ke(ca.target.value),className:"w-full border border-gray-200 rounded-lg px-3 py-2 text-xs font-semibold outline-none focus:border-indigo-500"}),jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Tarih",value:rr,onChange:ca=>tr(ca.target.value),className:"w-full border border-gray-200 rounded-lg px-3 py-2 text-xs font-semibold outline-none focus:border-indigo-500"}),jsxRuntimeExports.jsx("input",{type:"text",placeholder:"Okul Mdr",value:We,onChange:ca=>Ge(ca.target.value),className:"w-full border border-gray-200 rounded-lg px-3 py-2 text-xs font-semibold outline-none focus:border-indigo-500"})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4 border-t pt-4",children:[jsxRuntimeExports.jsxs("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest flex items-center gap-2",children:[jsxRuntimeExports.jsx(BookOpen,{className:"h-3 w-3"})," PROGRAM YNETM"]}),jsxRuntimeExports.jsxs("div",{className:"relative group",children:[jsxRuntimeExports.jsxs("button",{className:"w-full py-4 rounded-xl font-black text-xs flex items-center justify-center gap-2 border-2 bg-white border-indigo-100 text-indigo-600 hover:border-indigo-300",children:[jsxRuntimeExports.jsx(BookOpen,{className:"h-4 w-4"})," DERS PROGRAMI AL"]}),jsxRuntimeExports.jsx("input",{type:"file",accept:"application/pdf",onChange:ca=>ca.target.files&&ta(ca.target.files[0]),className:"absolute inset-0 opacity-0 cursor-pointer"})]}),jsxRuntimeExports.jsxs("button",{onClick:za,className:"w-full py-4 rounded-xl font-black text-xs flex items-center justify-center gap-2 border-2 bg-white border-indigo-100 text-indigo-500 hover:border-indigo-300 hover:bg-indigo-50",children:[jsxRuntimeExports.jsx(ClipboardList,{className:"h-4 w-4"})," PANODAN SM EKLE (EXCEL)"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>Qa(!0),className:"w-full bg-amber-500 hover:bg-amber-600 text-white py-4 rounded-xl font-black text-xs flex items-center justify-center gap-2 shadow-lg transition-all",children:[jsxRuntimeExports.jsx(Zap,{className:"h-4 w-4 fill-white"})," TASLAI AKILLI DOLDUR"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>Qa(!1),className:"w-full bg-purple-500 hover:bg-purple-600 text-white py-3 rounded-xl font-black text-xs flex items-center justify-center gap-2 shadow-lg transition-all",children:[jsxRuntimeExports.jsx(Shuffle,{className:"h-4 w-4 fill-white"})," RASTGELE DAIT"]}),jsxRuntimeExports.jsxs("div",{className:"pt-2",children:[jsxRuntimeExports.jsxs("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest flex items-center gap-2 mb-2",children:[jsxRuntimeExports.jsx(Settings2,{className:"h-3 w-3"})," SSTEM AYARLARI"]}),jsxRuntimeExports.jsxs("button",{onClick:()=>Xe(!Ve),className:`w-full py-3 rounded-xl font-black text-xs flex items-center justify-between px-4 border-2 transition-all ${Ve?"bg-indigo-50 border-indigo-200 text-indigo-700":"bg-gray-50 border-gray-100 text-gray-400"}`,children:[jsxRuntimeExports.jsx("span",{children:"Hafta Sonu Gnlerini A"}),Ve?jsxRuntimeExports.jsx(ToggleRight,{className:"h-5 w-5 text-indigo-600"}):jsxRuntimeExports.jsx(ToggleLeft,{className:"h-5 w-5"})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"space-y-4 border-t pt-4",children:[jsxRuntimeExports.jsxs("label",{className:"text-[10px] font-black text-gray-400 uppercase tracking-widest flex items-center gap-2",children:[jsxRuntimeExports.jsx(Layers,{className:"h-3 w-3"})," VER YEDEKLEME"]}),jsxRuntimeExports.jsxs("button",{onClick:Jr,className:"w-full py-4 rounded-xl font-black text-xs flex items-center justify-center gap-2 bg-white border-2 border-red-200 text-red-600 hover:bg-red-50 shadow-md transition-transform active:scale-95",children:[jsxRuntimeExports.jsx(Save,{className:"h-5 w-5 text-red-600"})," KAYDET"]}),jsxRuntimeExports.jsxs("div",{className:"relative group",children:[jsxRuntimeExports.jsxs("button",{className:"w-full py-4 rounded-xl font-black text-xs flex items-center justify-center gap-2 border-2 border-dashed border-amber-200 text-amber-700 bg-amber-50/30 hover:border-amber-400 hover:bg-amber-50 transition-all",children:[jsxRuntimeExports.jsx(FolderOpen,{className:"h-5 w-5 text-amber-500"})," A"]}),jsxRuntimeExports.jsx("input",{type:"file",accept:".xlsx, .xls",onChange:ca=>ca.target.files&&Qr(ca.target.files[0]),className:"absolute inset-0 opacity-0 cursor-pointer"})]})]})]}),jsxRuntimeExports.jsxs("main",{ref:ua,className:"flex-1 overflow-auto bg-gray-50 p-8 relative",children:[sr&&jsxRuntimeExports.jsxs("div",{className:"absolute inset-0 bg-white/50 backdrop-blur-sm z-[500] flex items-center justify-center flex-col gap-4 animate-in fade-in duration-300",children:[jsxRuntimeExports.jsx("div",{className:"w-16 h-16 border-4 border-indigo-600 border-t-transparent rounded-full animate-spin shadow-xl"}),jsxRuntimeExports.jsx("p",{className:"font-black text-indigo-600 animate-pulse",children:"VERLER LENYOR..."})]}),jsxRuntimeExports.jsx("div",{className:"bg-white rounded-[2rem] shadow-2xl border-4 border-white overflow-hidden min-w-fit mb-8 relative",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-left border-collapse",children:[jsxRuntimeExports.jsx("thead",{children:jsxRuntimeExports.jsxs("tr",{className:"bg-gray-50 border-b-2",children:[jsxRuntimeExports.jsx("th",{className:"p-3 text-[10px] font-black text-gray-400 uppercase w-32 sticky left-0 bg-gray-50 z-30 border-r",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-2",children:[jsxRuntimeExports.jsx("span",{className:"mb-1",children:"GNLER"}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1.5 bg-white p-1.5 rounded-lg shadow-sm border border-gray-200",children:[jsxRuntimeExports.jsx("button",{onClick:()=>fn("backward"),className:"text-indigo-600 hover:bg-indigo-50 p-1 rounded-md transition-all active:scale-90",title:"Tm Gnleri Geri Sar",children:jsxRuntimeExports.jsx(RotateCcw,{className:"h-3 w-3"})}),jsxRuntimeExports.jsx("button",{onClick:Oa,className:"text-gray-400 hover:text-indigo-600 hover:bg-indigo-50 p-1 rounded-md transition-all active:rotate-180",title:"Varsayla Dndr",children:jsxRuntimeExports.jsx(RefreshCw,{className:"h-3 w-3"})}),jsxRuntimeExports.jsx("button",{onClick:()=>fn("forward"),className:"text-indigo-600 hover:bg-indigo-50 p-1 rounded-md transition-all active:scale-90",title:"Tm Gnleri leri Sar",children:jsxRuntimeExports.jsx(RotateCw,{className:"h-3 w-3"})})]})]})}),r.map((ca,pa)=>jsxRuntimeExports.jsx("th",{className:"p-0 border-r min-w-[170px] text-center bg-gray-50/50 relative",children:hr?.index===pa?jsxRuntimeExports.jsx("div",{className:"p-2 h-full flex items-center justify-center",children:jsxRuntimeExports.jsx("input",{autoFocus:!0,type:"text",className:"w-full bg-white border-2 border-indigo-500 rounded-lg px-2 py-2 text-[10px] font-black uppercase outline-none shadow-md text-center",value:hr.value,onChange:xa=>pr({...hr,value:xa.target.value}),onBlur:()=>nn(pa,hr.value),onKeyDown:xa=>xa.key==="Enter"&&nn(pa,hr.value)})}):jsxRuntimeExports.jsxs("div",{className:"flex flex-col h-full w-full group",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center justify-between px-2 py-1 bg-gray-100 border-b border-gray-200 w-full select-none opacity-0 group-hover:opacity-100 transition-opacity",children:[jsxRuntimeExports.jsx("button",{onClick:xa=>Ya(xa,pa,"left"),className:"bg-white hover:bg-indigo-100 text-indigo-600 p-1 rounded transition-colors shadow-sm",children:jsxRuntimeExports.jsx(Plus,{className:"h-3 w-3"})}),jsxRuntimeExports.jsx("button",{onClick:xa=>Xa(xa,pa),className:"bg-red-50 hover:bg-red-600 hover:text-white text-red-500 p-1 rounded transition-all shadow-sm",children:jsxRuntimeExports.jsx(Trash2,{className:"h-3 w-3"})}),jsxRuntimeExports.jsx("button",{onClick:xa=>Ya(xa,pa,"right"),className:"bg-white hover:bg-indigo-100 text-indigo-600 p-1 rounded transition-colors shadow-sm",children:jsxRuntimeExports.jsx(Plus,{className:"h-3 w-3"})})]}),jsxRuntimeExports.jsx("div",{onClick:()=>pr({index:pa,value:ca}),className:"flex-1 py-3 flex items-center justify-center cursor-pointer hover:bg-indigo-50 transition-colors w-full",children:jsxRuntimeExports.jsx("span",{className:"text-[11px] font-black text-gray-700 uppercase select-none",children:ca})})]})},`${ca}-${pa}`)),jsxRuntimeExports.jsx("th",{className:"p-4 text-[10px] font-black text-red-700 uppercase min-w-[150px] bg-red-50 text-center",children:"DAREC"})]})}),jsxRuntimeExports.jsx("tbody",{className:"divide-y divide-gray-100",children:Cr.map(ca=>jsxRuntimeExports.jsxs("tr",{className:"group",children:[jsxRuntimeExports.jsx("td",{className:"p-3 border-r sticky left-0 bg-white group-hover:bg-gray-50 z-20 shadow-[2px_0_5px_rgba(0,0,0,0.02)]",children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col items-center gap-1",children:[jsxRuntimeExports.jsx("span",{className:"font-black text-sm text-gray-900",children:ca}),jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[jsxRuntimeExports.jsx("button",{onClick:()=>fn("backward",ca),className:"p-1 rounded bg-indigo-50 text-indigo-600 hover:bg-indigo-100 transition-colors",title:`${ca} geri sar`,children:jsxRuntimeExports.jsx(RotateCcw,{className:"h-3 w-3"})}),jsxRuntimeExports.jsx("button",{onClick:()=>fn("forward",ca),className:"p-1 rounded bg-indigo-50 text-indigo-600 hover:bg-indigo-100 transition-colors",title:`${ca} ileri sar`,children:jsxRuntimeExports.jsx(RotateCw,{className:"h-3 w-3"})})]})]})}),r.map(pa=>{const xa=Ka[ca]?.[pa],$a=Ee[ca]?.[pa]||"",ka=`${ca}-${pa}`,La=De.has(ka);let Wa="bg-white";return xa?.isDuplicate?Wa="bg-red-50 border-red-300 ring-2 ring-red-100 text-red-600":xa?.hasZeroLessons?Wa="bg-orange-100 border-orange-400 text-orange-900 ring-2 ring-orange-200 animate-pulse font-bold":xa?.isMultiDay?Wa=La?"bg-amber-100 border-amber-300":"bg-amber-50 border-amber-200":xa?.prefViolation&&(Wa="bg-purple-50 border-purple-200"),jsxRuntimeExports.jsxs("td",{className:"p-1 border-r relative group/cell min-w-[170px]",children:[jsxRuntimeExports.jsxs("div",{className:"relative flex items-center",children:[jsxRuntimeExports.jsx("input",{list:"teacherSuggestions",type:"text",className:`w-full p-2 text-[11px] font-bold border rounded-xl outline-none transition-all text-center shadow-sm ${Wa} focus:ring-2 focus:ring-indigo-200`,placeholder:"Se...",value:$a,onFocus:()=>lr(ca),onBlur:()=>setTimeout(()=>lr(null),200),onChange:_n=>Ce(hn=>({...hn,[ca]:{...hn[ca]||{},[pa]:_n.target.value}}))}),xa?.lessonCount!==void 0&&xa.lessonCount!==null&&jsxRuntimeExports.jsx("span",{className:`absolute bottom-0.5 left-2 text-[9px] font-bold pointer-events-none ${xa.hasZeroLessons?"text-orange-700":"text-gray-400"}`,children:xa.lessonCount>0?`${xa.lessonCount} Ders`:xa.hasZeroLessons?"DERSI YOK":""}),xa?.isMultiDay&&!xa?.isDuplicate&&jsxRuntimeExports.jsx("button",{onClick:_n=>{_n.preventDefault(),_n.stopPropagation(),on(ka)},className:`absolute top-1 left-1 p-1 rounded-full shadow-sm z-10 transition-all ${La?"bg-amber-500 text-white":"bg-white text-gray-300 hover:text-amber-500"}`,title:"Haftalk Ek Nbeti Onayla",children:jsxRuntimeExports.jsx(Star,{className:"h-3 w-3",fill:La?"currentColor":"none"})}),$a&&jsxRuntimeExports.jsx("button",{onClick:_n=>{_n.preventDefault(),_n.stopPropagation(),Ce(hn=>{const Fn={...hn},Tn={...Fn[ca]||{}};return delete Tn[pa],Fn[ca]=Tn,Fn})},className:"absolute right-2 p-2 rounded-full bg-red-500 text-white opacity-0 group-hover/cell:opacity-100 transition-all hover:scale-110 z-10 cursor-pointer shadow-md",title:"Atamay kaldr",children:jsxRuntimeExports.jsx(X$1,{className:"h-3.5 w-3.5"})})]}),xa?.prefViolation&&jsxRuntimeExports.jsx("div",{className:"absolute top-1 right-1 text-purple-600",children:jsxRuntimeExports.jsx(TriangleAlert,{className:"h-3 w-3"})})]},`${ca}-${pa}`)}),jsxRuntimeExports.jsx("td",{className:"p-2 bg-red-50/10 relative",children:jsxRuntimeExports.jsx("input",{list:"teacherSuggestions",type:"text",onFocus:()=>lr(ca),className:"w-full p-2 text-[11px] font-extrabold text-red-900 border border-red-100 bg-red-50/40 rounded-xl outline-none text-center",value:Ee[ca]?.ADMIN||"",onChange:pa=>Ce(xa=>({...xa,[ca]:{...xa[ca]||{},ADMIN:pa.target.value}}))})})]},ca))})]})}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4 mb-8",children:[jsxRuntimeExports.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-sm border border-gray-100 flex flex-col justify-center",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[jsxRuntimeExports.jsx("div",{className:"bg-indigo-600 p-1.5 rounded-lg",children:jsxRuntimeExports.jsx(Zap,{className:"h-4 w-4 text-white"})}),jsxRuntimeExports.jsx("h2",{className:"text-sm font-black text-gray-900 tracking-tight",children:"Sistemin Gl zellikleri"})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:[jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-100 hover:border-indigo-200 transition-colors",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsx(Settings2,{className:"h-4 w-4 text-indigo-600"}),jsxRuntimeExports.jsx("h4",{className:"font-bold text-gray-900 text-[10px]",children:"retmen Tercihleri"})]}),jsxRuntimeExports.jsx("p",{className:"text-[9px] text-gray-500 leading-snug",children:"retmenlerin nbet tutmak istemedii gnleri tanmlayn."})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-100 hover:border-indigo-200 transition-colors",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsx(CalendarDays,{className:"h-4 w-4 text-amber-500"}),jsxRuntimeExports.jsx("h4",{className:"font-bold text-gray-900 text-[10px]",children:"Akll Analiz"})]}),jsxRuntimeExports.jsx("p",{className:"text-[9px] text-gray-500 leading-snug",children:"4-6 dersi olan gne ncelik verir. 0 veya 8 dersi olana yazmaz."})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-100 hover:border-indigo-200 transition-colors",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsx(ClipboardList,{className:"h-4 w-4 text-emerald-500"}),jsxRuntimeExports.jsx("h4",{className:"font-bold text-gray-900 text-[10px]",children:"Hzl Liste"})]}),jsxRuntimeExports.jsx("p",{className:"text-[9px] text-gray-500 leading-snug",children:"Excel/Word listelerini kopyalayp tek tkla aktarn."})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-100 hover:border-indigo-200 transition-colors",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsx(Printer,{className:"h-4 w-4 text-red-500"}),jsxRuntimeExports.jsx("h4",{className:"font-bold text-gray-900 text-[10px]",children:"Resmi PDF"})]}),jsxRuntimeExports.jsx("p",{className:"text-[9px] text-gray-500 leading-snug",children:"Ynetmelik ve imza sirks eklenmi resmi kt."})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-100 hover:border-indigo-200 transition-colors",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsx(PanelsTopLeft,{className:"h-4 w-4 text-purple-500"}),jsxRuntimeExports.jsx("h4",{className:"font-bold text-gray-900 text-[10px]",children:"Esnek Mimari"})]}),jsxRuntimeExports.jsx("p",{className:"text-[9px] text-gray-500 leading-snug",children:"Nbet yerlerini stunlardan kolayca dzenleyin."})]}),jsxRuntimeExports.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg border border-gray-100 hover:border-indigo-200 transition-colors",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[jsxRuntimeExports.jsx(Shuffle,{className:"h-4 w-4 text-blue-500"}),jsxRuntimeExports.jsx("h4",{className:"font-bold text-gray-900 text-[10px]",children:"Rastgele Datm"})]}),jsxRuntimeExports.jsx("p",{className:"text-[9px] text-gray-500 leading-snug",children:"Program olmasa bile adaletli datm yapn."})]})]})]}),jsxRuntimeExports.jsxs("div",{className:"bg-indigo-900 text-white p-5 rounded-2xl shadow-xl relative overflow-hidden flex flex-col justify-center",children:[jsxRuntimeExports.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-indigo-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 -mr-16 -mt-16 animate-pulse"}),jsxRuntimeExports.jsx("div",{className:"absolute bottom-0 left-0 w-64 h-64 bg-purple-500 rounded-full mix-blend-multiply filter blur-3xl opacity-20 -ml-16 -mb-16 animate-pulse"}),jsxRuntimeExports.jsxs("div",{className:"relative z-10",children:[jsxRuntimeExports.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[jsxRuntimeExports.jsx("div",{className:"bg-white/10 p-1.5 rounded-lg backdrop-blur-sm border border-white/10",children:jsxRuntimeExports.jsx(CircleQuestionMark,{className:"h-4 w-4 text-white"})}),jsxRuntimeExports.jsx("h2",{className:"text-sm font-black text-white tracking-tight",children:"Hzl Kullanm Klavuzu"})]}),jsxRuntimeExports.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-3",children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-start group",children:[jsxRuntimeExports.jsx("div",{className:"w-5 h-5 rounded-full bg-indigo-500 text-white flex items-center justify-center font-bold text-[10px] shrink-0 shadow-lg border border-indigo-400 group-hover:scale-110 transition-transform",children:"1"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h5",{className:"font-bold text-[10px] text-indigo-100 uppercase",children:"Manuel Liste"}),jsxRuntimeExports.jsx("p",{className:"text-[9px] text-indigo-200/80 leading-tight",children:'Panodan kopyaladnz retmen listesini "sim Ekle" ile saniyeler iinde aktarn.'})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-start group",children:[jsxRuntimeExports.jsx("div",{className:"w-5 h-5 rounded-full bg-indigo-500 text-white flex items-center justify-center font-bold text-[10px] shrink-0 shadow-lg border border-indigo-400 group-hover:scale-110 transition-transform",children:"2"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h5",{className:"font-bold text-[10px] text-indigo-100 uppercase",children:"Program Ykleme"}),jsxRuntimeExports.jsx("p",{className:"text-[9px] text-indigo-200/80 leading-tight",children:"Elinizde varsa PDF formatndaki retmen ders programlarn sisteme ykleyin."})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-start group",children:[jsxRuntimeExports.jsx("div",{className:"w-5 h-5 rounded-full bg-indigo-500 text-white flex items-center justify-center font-bold text-[10px] shrink-0 shadow-lg border border-indigo-400 group-hover:scale-110 transition-transform",children:"3"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h5",{className:"font-bold text-[10px] text-indigo-100 uppercase",children:"Tercihleri Girin"}),jsxRuntimeExports.jsx("p",{className:"text-[9px] text-indigo-200/80 leading-tight",children:'retmenlerin nbet tutmak istemedii gnleri "Tercihler" mensnden iaretleyin.'})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-start group",children:[jsxRuntimeExports.jsx("div",{className:"w-5 h-5 rounded-full bg-indigo-500 text-white flex items-center justify-center font-bold text-[10px] shrink-0 shadow-lg border border-indigo-400 group-hover:scale-110 transition-transform",children:"4"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h5",{className:"font-bold text-[10px] text-indigo-100 uppercase",children:"Akll Doldur"}),jsxRuntimeExports.jsx("p",{className:"text-[9px] text-indigo-200/80 leading-tight",children:'"Tasla Akll Doldur" butonu ile ders ykne gre akmasz planlama yapn.'})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-start group",children:[jsxRuntimeExports.jsx("div",{className:"w-5 h-5 rounded-full bg-indigo-500 text-white flex items-center justify-center font-bold text-[10px] shrink-0 shadow-lg border border-indigo-400 group-hover:scale-110 transition-transform",children:"5"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h5",{className:"font-bold text-[10px] text-indigo-100 uppercase",children:"Gnleri Kaydr"}),jsxRuntimeExports.jsx("p",{className:"text-[9px] text-indigo-200/80 leading-tight",children:"Tablo balndaki oklarla tm nbetleri bir sonraki gne kolayca devredin."})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-start group",children:[jsxRuntimeExports.jsx("div",{className:"w-5 h-5 rounded-full bg-indigo-500 text-white flex items-center justify-center font-bold text-[10px] shrink-0 shadow-lg border border-indigo-400 group-hover:scale-110 transition-transform",children:"6"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h5",{className:"font-bold text-[10px] text-indigo-100 uppercase",children:"Yedekle ve A"}),jsxRuntimeExports.jsx("p",{className:"text-[9px] text-indigo-200/80 leading-tight",children:'almanz "Kaydet" ile Excel olarak saklayn, dilediinizde "A" ile geri ykleyin.'})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-start group",children:[jsxRuntimeExports.jsx("div",{className:"w-5 h-5 rounded-full bg-indigo-500 text-white flex items-center justify-center font-bold text-[10px] shrink-0 shadow-lg border border-indigo-400 group-hover:scale-110 transition-transform",children:"7"}),jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h5",{className:"font-bold text-[10px] text-indigo-100 uppercase",children:"PDF kts"}),jsxRuntimeExports.jsx("p",{className:"text-[9px] text-indigo-200/80 leading-tight",children:"Renkleri sein ve resmi imza sirks ieren profesyonel PDF dosyasn aln."})]})]})]})]})]})]}),jsxRuntimeExports.jsxs("footer",{className:"mt-8 mb-4 text-center",children:[jsxRuntimeExports.jsx("p",{className:"text-[11px] text-gray-400 font-medium",children:"Bu program fizik retmeni Kemal B. tarafndan yaplm idarecilerimizin hizmetine sunulmutur."}),jsxRuntimeExports.jsx("p",{className:"text-[10px] text-gray-300 font-bold mt-1",children:" 2026 Her hakk sakldr."})]})]})]}),Be&&jsxRuntimeExports.jsxs("div",{className:"fixed inset-0 z-[1000] bg-white flex flex-col animate-in fade-in zoom-in duration-200",children:[jsxRuntimeExports.jsx("div",{className:"px-8 py-6 border-b bg-white shadow-sm flex-none z-10",children:jsxRuntimeExports.jsxs("div",{className:"max-w-4xl mx-auto flex justify-between items-center",children:[jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsx("h2",{className:"text-2xl font-black text-gray-900",children:"retmen Msaitlik Durumlar"}),jsxRuntimeExports.jsx("p",{className:"text-sm text-gray-500",children:"Krmz iaretli gnlerde retmenlere otomatik datm yaplmaz."})]}),jsxRuntimeExports.jsx("button",{onClick:()=>He(!1),className:"p-2 bg-gray-100 rounded-full hover:bg-gray-200 transition-colors",children:jsxRuntimeExports.jsx(X$1,{className:"h-6 w-6"})})]})}),jsxRuntimeExports.jsx("div",{className:"flex-1 overflow-y-auto p-8 bg-gray-50",children:jsxRuntimeExports.jsx("div",{className:"max-w-4xl mx-auto",children:jsxRuntimeExports.jsx("div",{className:"bg-white border rounded-2xl overflow-hidden shadow-sm",children:jsxRuntimeExports.jsxs("table",{className:"w-full text-left",children:[jsxRuntimeExports.jsx("thead",{className:"bg-gray-50 border-b",children:jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsxs("th",{className:"p-4 text-xs font-black flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:vn,title:va?"Tmn MSAT Yap":"Tmn TUTMAZ Yap",className:`p-1 rounded-md transition-colors ${va?"text-red-500 hover:bg-red-50":"text-gray-400 hover:text-indigo-600 hover:bg-indigo-50"}`,children:va?jsxRuntimeExports.jsx(ToggleRight,{className:"h-5 w-5"}):jsxRuntimeExports.jsx(ToggleLeft,{className:"h-5 w-5"})}),"RETMEN"]}),Cr.map(ca=>jsxRuntimeExports.jsx("th",{className:"p-4 text-xs font-black text-center",children:ca},ca))]})}),jsxRuntimeExports.jsx("tbody",{className:"divide-y",children:e.map(ca=>{const pa=ca.name.toLocaleUpperCase("tr-TR"),xa=ze[pa]||new Set,$a=Cr.every(ka=>xa.has(ka));return jsxRuntimeExports.jsxs("tr",{children:[jsxRuntimeExports.jsxs("td",{className:"p-4 font-bold text-sm flex items-center gap-2",children:[jsxRuntimeExports.jsx("button",{onClick:()=>Bn(pa),title:$a?"Bu satr MSAT yap":"Bu satr TUTMAZ yap",className:`p-1 rounded-md transition-colors ${$a?"text-red-500 hover:bg-red-50":"text-gray-400 hover:text-indigo-600 hover:bg-indigo-50"}`,children:$a?jsxRuntimeExports.jsx(ToggleRight,{className:"h-4 w-4"}):jsxRuntimeExports.jsx(ToggleLeft,{className:"h-4 w-4"})}),ca.name]}),Cr.map(ka=>{const La=ze[pa]?.has(ka);return jsxRuntimeExports.jsx("td",{className:"p-2",children:jsxRuntimeExports.jsx("button",{onClick:()=>{Oe(Wa=>{const _n={...Wa},hn=new Set(_n[pa]||[]);return hn.has(ka)?hn.delete(ka):hn.add(ka),_n[pa]=hn,_n})},className:`w-full py-1 text-[10px] font-black rounded-lg border-2 ${La?"bg-red-50 border-red-200 text-red-600":"bg-emerald-50 border-emerald-200 text-emerald-600"}`,children:La?"TUTMAZ":"MSAT"})},ka)})]},ca.name)})})]})})})})]})]})},rootElement=document.getElementById("root");if(!rootElement)throw new Error("Could not find root element to mount to");const root=ReactDOM.createRoot(rootElement);root.render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(App,{})}));export{_typeof as _,commonjsGlobal as c,getDefaultExportFromCjs as g};
